

1. <span data-ttu-id="87770-101">Accédez à la page [https://apps.dev.microsoft.com/](https://apps.dev.microsoft.com).</span><span class="sxs-lookup"><span data-stu-id="87770-101">Navigate to [https://apps.dev.microsoft.com/](https://apps.dev.microsoft.com).</span></span>

1. <span data-ttu-id="87770-102">Connectez-vous à votre client Office 365 en utilisant les informations d’identification de l’***administrateur***.</span><span class="sxs-lookup"><span data-stu-id="87770-102">Sign-in with the admin credentials to your Office 365 tenancy.</span></span> <span data-ttu-id="87770-103">Par exemple, MonNom@contoso.onmicrosoft.com</span><span class="sxs-lookup"><span data-stu-id="87770-103">For example, MyName@contoso.onmicrosoft.com</span></span>

1. <span data-ttu-id="87770-104">Cliquez sur **Ajouter une application**.</span><span class="sxs-lookup"><span data-stu-id="87770-104">Click **Add an app**.</span></span>

1. <span data-ttu-id="87770-105">Lorsque vous y êtes invité, entrez **$ADD-IN-NAME$** comme nom d’application, puis appuyez sur **Créer une application**.</span><span class="sxs-lookup"><span data-stu-id="87770-105">When prompted, use “Office-Add-in-ASPNET-SSO” as the app name, and then press Create application.</span></span>

1. <span data-ttu-id="87770-p102">Quand la page de configuration de l’application s’ouvre, copiez l’**ID de l’application** et enregistrez-le. Vous l’utiliserez dans une procédure ultérieure.</span><span class="sxs-lookup"><span data-stu-id="87770-p102">When the configuration page for the app opens, copy the **Application Id** and save it. You'll use it in a later procedure.</span></span>

    > [!NOTE]
    > <span data-ttu-id="87770-p103">Cet ID est la valeur « audience » lorsque d’autres applications, telles que l’application hôte Office (par exemple, PowerPoint, Word, Excel) recherchent un accès autorisé à l’application. Il s’agit également de l’« ID client » de l’application dès que celle-ci recherche un accès autorisé à Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="87770-p103">This ID is the “audience” value when other applications, such as the Office host application (e.g., PowerPoint, Word, Excel), seek authorized access to the application. It is also the “client ID” of the application when it, in turn, seeks authorized access to Microsoft Graph.</span></span>

1. <span data-ttu-id="87770-p104">Dans la section **Secrets de l’application**, appuyez sur **Générer un nouveau mot de passe**. Une boîte de dialogue contextuelle s’ouvre avec un nouveau mot de passe (également appelé « secret de l’application »). *Copiez le mot de passe immédiatement et enregistrez-le avec l’ID de l’application.* Vous en aurez besoin dans une procédure ultérieure. Ensuite, fermez la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="87770-p104">In the **Application Secrets** section, press **Generate New Password**. A popup dialog opens with a new password (also called an “app secret”) displayed. *Copy the password immediately and save it with the application ID.* You'll need it in a later procedure. Then close the dialog.</span></span>

1. <span data-ttu-id="87770-115">Dans la section **Plateformes**, cliquez sur **Ajouter une plateforme**.</span><span class="sxs-lookup"><span data-stu-id="87770-115">In the **Platforms** section, click **Add Platform**.</span></span>

1. <span data-ttu-id="87770-116">Dans la boîte de dialogue qui s’ouvre, sélectionnez **API Web**.</span><span class="sxs-lookup"><span data-stu-id="87770-116">In the dialog that opens, select **Web API**.</span></span>

1. <span data-ttu-id="87770-117">Un **URI d’ID d’application** sous la forme « api://$App ID GUID$ » a été généré.</span><span class="sxs-lookup"><span data-stu-id="87770-117">An **Application ID URI** has been generated of the form “api://{App ID GUID}”.</span></span> <span data-ttu-id="87770-118">Insérez **$FQDN-WITHOUT-PROTOCOL$** (avec une barre oblique « / » à la fin) entre les doubles barres obliques et le GUID.</span><span class="sxs-lookup"><span data-stu-id="87770-118">Insert the **$FQDN-WITHOUT-PROTOCOL$** (with a forward slash "/" appended to the end) between the double forward slashes and the GUID.</span></span> <span data-ttu-id="87770-119">La forme de l’ID entier doit être `api://$FQDN-WITHOUT-PROTOCOL$/$App ID GUID$`; par exemple`api://localhost:6789/c6c1f32b-5e55-4997-881a-753cc1d563b7`.</span><span class="sxs-lookup"><span data-stu-id="87770-119">The entire ID should have the form `api://$FQDN-WITHOUT-PROTOCOL$/$App ID GUID$`; for example `api://localhost:6789/c6c1f32b-5e55-4997-881a-753cc1d563b7`.</span></span>

    > [!NOTE]
    > <span data-ttu-id="87770-120">Si un message d’erreur s’affiche indiquant que le domaine appartient déjà à quelqu’un et que vous en êtes le propriétaire, suivez la procédure décrite dans [Ajouter votre nom de domaine personnalisé à l’aide du Portail Azure Active Directory](/azure/active-directory/add-custom-domain) pour l’inscrire, puis répétez cette étape.</span><span class="sxs-lookup"><span data-stu-id="87770-120">If you get an error saying that the domain is already owned, but you own it, follow the procedure at [Quickstart: Add a custom domain name to Azure Active Directory](/azure/active-directory/add-custom-domain) to register it, and then repeat this step.</span></span> <span data-ttu-id="87770-121">(Cette erreur peut également se produire si vous ne vous êtes pas connecté au client Office 365 avec les informations d’identification d’un administrateur.</span><span class="sxs-lookup"><span data-stu-id="87770-121">(This error can also occur if you are not signed in with credentials of an admin in the Office 365 tenancy.</span></span> <span data-ttu-id="87770-122">Voir l’étape 2.</span><span class="sxs-lookup"><span data-stu-id="87770-122">See step 2.</span></span> <span data-ttu-id="87770-123">Déconnectez-vous, puis reconnectez-vous avec les informations d’identification d’administrateur, puis répétez le processus décrit à l’étape 3.)</span><span class="sxs-lookup"><span data-stu-id="87770-123">Sign out and sign in again with admin credentials and repeat the process from step 3.)</span></span>

    > [!NOTE]
    > <span data-ttu-id="87770-124">La partie domaine du nom de l’**étendue**, juste en dessous de l’**URI d’ID d’application**, change automatiquement en conséquence, avec l’ajout de `/access_as_user` à la fin. Par exemple : `api://localhost:6789/c6c1f32b-5e55-4997-881a-753cc1d563b7/access_as_user`.</span><span class="sxs-lookup"><span data-stu-id="87770-124">The domain part of the **Scope** name just below the **Application ID URI** will automatically change to match.</span></span>

1. <span data-ttu-id="87770-p107">Dans la section **Applications pré-autorisées**, vous identifiez les applications que vous souhaitez autoriser dans l’application web de votre complément. Chacun des ID suivants doit être pré-autorisé. Chaque fois que vous en entrez un, une nouvelle zone de texte vide s’affiche. (Entrez uniquement le GUID.)</span><span class="sxs-lookup"><span data-stu-id="87770-p107">In the **Pre-authorized applications** section, you identify the applications that you want to authorize to your add-in's web application. Each of the following IDs needs to be pre-authorized. Each time you enter one, a new empty textbox appears. (Enter only the GUID.)</span></span>
    * <span data-ttu-id="87770-129">`d3590ed6-52b3-4102-aeff-aad2292ab01c` (Microsoft Office)</span><span class="sxs-lookup"><span data-stu-id="87770-129">`d3590ed6-52b3-4102-aeff-aad2292ab01c` (Microsoft Office)</span></span>
    * <span data-ttu-id="87770-130">`57fb890c-0dab-4253-a5e0-7188c88b2bb4` (Office Online)</span><span class="sxs-lookup"><span data-stu-id="87770-130">`57fb890c-0dab-4253-a5e0-7188c88b2bb4` (Office Online)</span></span>
    * <span data-ttu-id="87770-131">`bc59ab01-8403-45c6-8796-ac3ef710b3e3` (Office Online)</span><span class="sxs-lookup"><span data-stu-id="87770-131">`bc59ab01-8403-45c6-8796-ac3ef710b3e3` (Office Online)</span></span>

1. <span data-ttu-id="87770-132">Ouvrez le menu déroulant **Scope** à côté de chaque **ID d’application** et activez la case à cocher pour `api://$FQDN-WITHOUT-PROTOCOL$/$App ID GUID$/access_as_user`.</span><span class="sxs-lookup"><span data-stu-id="87770-132">Open the **Scope** drop-down beside each **Application ID** and check the box for `api://$FQDN-WITHOUT-PROTOCOL$/$App ID GUID$/access_as_user`.</span></span>

1. <span data-ttu-id="87770-133">En haut de la section **Plateformes**, cliquez sur **Ajouter une plateforme** à nouveau, puis sélectionnez **Web**.</span><span class="sxs-lookup"><span data-stu-id="87770-133">Near the top of the **Platforms** section, click **Add Platform** again and select **Web**.</span></span>

1. <span data-ttu-id="87770-134">Dans la nouvelle section **Web** sous **Plateformes**, entrez les informations suivantes en guise d’**URL de redirection** : `https://$FQDN-WITHOUT-PROTOCOL$`.</span><span class="sxs-lookup"><span data-stu-id="87770-134">In the new **Web** section under **Platforms**, enter the following as a **Redirect URL**: `https://$FQDN-WITHOUT-PROTOCOL$`.</span></span>

1. <span data-ttu-id="87770-p108">Faites défiler jusqu’à la section **Autorisations pour Microsoft Graph** et à la sous-section **Autorisations déléguées**. Utilisez le bouton **Ajouter** pour ouvrir une boîte de dialogue **Sélectionner des autorisations**.</span><span class="sxs-lookup"><span data-stu-id="87770-p108">Scroll down to the **Microsoft Graph Permissions** section, the **Delegated Permissions** subsection. Use the **Add** button to open a **Select Permissions** dialog.</span></span>

1. <span data-ttu-id="87770-137">Dans la boîte de dialogue, activez les cases à cocher en regard de `profile`, et tout autre autorisation AAD ou Microsoft Graph dont votre complément a besoin.</span><span class="sxs-lookup"><span data-stu-id="87770-137">In the dialog box, check the boxes for `profile` and any other AAD and Microsoft Graph permissions that your add-in needs.</span></span> <span data-ttu-id="87770-138">Voici quelques exemples :</span><span class="sxs-lookup"><span data-stu-id="87770-138">The following are examples:</span></span>

    * <span data-ttu-id="87770-139">Files.Read.All</span><span class="sxs-lookup"><span data-stu-id="87770-139">Files.Read.All</span></span>
    * <span data-ttu-id="87770-140">offline_access</span><span class="sxs-lookup"><span data-stu-id="87770-140">offline_access</span></span>
    * <span data-ttu-id="87770-141">openid</span><span class="sxs-lookup"><span data-stu-id="87770-141">openid</span></span>
    * <span data-ttu-id="87770-142">profil</span><span class="sxs-lookup"><span data-stu-id="87770-142">profile</span></span>

    > [!NOTE]
    > <span data-ttu-id="87770-143">L’autorisation `User.Read` est peut-être déjà répertoriée par défaut.</span><span class="sxs-lookup"><span data-stu-id="87770-143">The `User.Read` permission may already be listed by default.</span></span> <span data-ttu-id="87770-144">Une bonne pratique consiste à demander uniquement les autorisations dont vous avez besoin. Ainsi, nous vous recommandons de désactiver la case à cocher de cette autorisation si votre complément n’en a pas réellement besoin.</span><span class="sxs-lookup"><span data-stu-id="87770-144">The  permission may already be listed by default. It is a good practice not to ask for permissions that are not needed, so we recommend that you uncheck the box for this permission.</span></span>

1. <span data-ttu-id="87770-145">Cliquez sur **OK** au bas de la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="87770-145">At the bottom of the dialog, click **OK**.</span></span>

1. <span data-ttu-id="87770-146">Cliquez sur **Enregistrer** au bas de la page d’inscription.</span><span class="sxs-lookup"><span data-stu-id="87770-146">At the bottom of the registration page, click **Save**.</span></span>
