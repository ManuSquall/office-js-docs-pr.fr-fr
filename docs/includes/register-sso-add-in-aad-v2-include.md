

1. <span data-ttu-id="fab81-101">Accédez à la page [portail Azure : enregistrement des applications](https://go.microsoft.com/fwlink/?linkid=2083908) pour enregistrer votre application.</span><span class="sxs-lookup"><span data-stu-id="fab81-101">Navigate to the [Azure portal - App registrations](https://go.microsoft.com/fwlink/?linkid=2083908) page to register your app.</span></span>

1. <span data-ttu-id="fab81-102">Connectez-vous avec les informations d’identification d' ***administrateur*** à votre location Microsoft 365.</span><span class="sxs-lookup"><span data-stu-id="fab81-102">Sign in with the ***admin*** credentials to your Microsoft 365 tenancy.</span></span> <span data-ttu-id="fab81-103">Par exemple, MonNom@contoso.onmicrosoft.com.</span><span class="sxs-lookup"><span data-stu-id="fab81-103">For example, MyName@contoso.onmicrosoft.com.</span></span>

1. <span data-ttu-id="fab81-104">Sélectionnez **Nouvelle inscription**.</span><span class="sxs-lookup"><span data-stu-id="fab81-104">Select **New registration**.</span></span> <span data-ttu-id="fab81-105">Sur la page **Inscrire une application**, définissez les valeurs comme suit.</span><span class="sxs-lookup"><span data-stu-id="fab81-105">On the **Register an application** page, set the values as follows.</span></span>

    * <span data-ttu-id="fab81-106">Donner **$ADD-IN-NAME$** à **Name**.</span><span class="sxs-lookup"><span data-stu-id="fab81-106">Set **Name** to **$ADD-IN-NAME$**.</span></span>
    * <span data-ttu-id="fab81-107">Définissez les **Types de comptes pris en charge** à **Comptes dans un annuaire organisationnel et comptes personnels Microsoft (par ex. Skype, Xbox, Outlook.com)**.</span><span class="sxs-lookup"><span data-stu-id="fab81-107">Set **Supported account types** to **Accounts in any organizational directory and personal Microsoft accounts (e.g. Skype, Xbox, Outlook.com)**.</span></span>
    * <span data-ttu-id="fab81-108">Laissez **Redirect URI** vide.</span><span class="sxs-lookup"><span data-stu-id="fab81-108">Leave **Redirect URI** empty.</span></span>
    * <span data-ttu-id="fab81-109">Choisissez **Inscrire**.</span><span class="sxs-lookup"><span data-stu-id="fab81-109">Choose **Register**.</span></span>

1. <span data-ttu-id="fab81-110">Sur la page **$ADD-IN-NAME$**, copiez et enregistrez les valeurs pour l’**ID de l’application (client)** et l’**ID de répertoire (client)**.</span><span class="sxs-lookup"><span data-stu-id="fab81-110">On the **$ADD-IN-NAME$** page, copy and save the values for the **Application (client) ID** and the **Directory (tenant) ID**.</span></span> <span data-ttu-id="fab81-111">Vous utiliserez les deux plus tard.</span><span class="sxs-lookup"><span data-stu-id="fab81-111">You'll use both of them in later procedures.</span></span>

    > [!NOTE]
    > <span data-ttu-id="fab81-112">Cet ID a la valeur « audience » lorsque d’autres applications, telles que l’application hôte Office (par exemple, PowerPoint, Word, Excel) demandent un accès autorisé à l’application.</span><span class="sxs-lookup"><span data-stu-id="fab81-112">This ID is the "audience" value when other applications, such as the Office host application (e.g., PowerPoint, Word, Excel), seek authorized access to the application.</span></span> <span data-ttu-id="fab81-113">Il s’agit également de l’« ID client » de l’application dès que celle-ci recherche un accès autorisé à Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="fab81-113">It is also the "client ID" of the application when it, in turn, seeks authorized access to Microsoft Graph.</span></span>

1. <span data-ttu-id="fab81-114">Sélectionnez **Certificats et secrets** sous **Gérer**.</span><span class="sxs-lookup"><span data-stu-id="fab81-114">Select **Certificates & secrets** under **Manage**.</span></span> <span data-ttu-id="fab81-115">Sélectionnez le bouton **Nouveau secret client**.</span><span class="sxs-lookup"><span data-stu-id="fab81-115">Select the **New client secret** button.</span></span> <span data-ttu-id="fab81-116">Entrer une valeur pour **Description** puis sélectionnez une option appropriée pour **Expire le** puis **Ajouter**.</span><span class="sxs-lookup"><span data-stu-id="fab81-116">Enter a value for **Description** then select an appropriate option for **Expires** and choose **Add**.</span></span> <span data-ttu-id="fab81-117">*Copier la valeur secrète client immédiatement et enregistrez-la avec l’ID d’application* avant de continuer car vous en aurez besoin dans une procédure plus loin.</span><span class="sxs-lookup"><span data-stu-id="fab81-117">*Copy the client secret value immediately and save it with the application ID* before proceeding as you'll need it in a later procedure.</span></span>

1. <span data-ttu-id="fab81-118">Sélectionnez **Exposer une API** sous **Gérer**.</span><span class="sxs-lookup"><span data-stu-id="fab81-118">Select **Expose an API** under **Manage**.</span></span> <span data-ttu-id="fab81-119">Sélectionnez le lien **Définir** pour générer l’URI de l’ID d’application sous la forme "api://$App ID GUID$".</span><span class="sxs-lookup"><span data-stu-id="fab81-119">Select the **Set** link to generate the Application ID URI in the form "api://$App ID GUID$".</span></span> <span data-ttu-id="fab81-120">Insérez **$FQDN-WITHOUT-PROTOCOL$** (avec une barre oblique « / » à la fin) entre les doubles barres obliques et le GUID.</span><span class="sxs-lookup"><span data-stu-id="fab81-120">Insert the **$FQDN-WITHOUT-PROTOCOL$** (with a forward slash "/" appended to the end) between the double forward slashes and the GUID.</span></span> <span data-ttu-id="fab81-121">La forme de l’ID entier doit être `api://$FQDN-WITHOUT-PROTOCOL$/$App ID GUID$`; par exemple`api://localhost:6789/c6c1f32b-5e55-4997-881a-753cc1d563b7`.</span><span class="sxs-lookup"><span data-stu-id="fab81-121">The entire ID should have the form `api://$FQDN-WITHOUT-PROTOCOL$/$App ID GUID$`; for example `api://localhost:6789/c6c1f32b-5e55-4997-881a-753cc1d563b7`.</span></span>

    > [!NOTE]
    > <span data-ttu-id="fab81-122">Il se peut que vous obteniez une erreur inexacte à ce stade indiquant « l’URI de l’ID d’application doit être une URI valide commençant par HTTPS, API, URN, MS-APPX.</span><span class="sxs-lookup"><span data-stu-id="fab81-122">You may get an inaccurate error at this point saying "The application ID URI must be a valid URI starting with HTTPS, API, URN, MS-APPX.</span></span> <span data-ttu-id="fab81-123">Elle ne doit pas se terminer pas par une barre oblique. »</span><span class="sxs-lookup"><span data-stu-id="fab81-123">It must not end in a slash."</span></span> <span data-ttu-id="fab81-124">Si l’ID respecte les conditions indiquées, ignorez l’erreur et enregistrez vos modifications.</span><span class="sxs-lookup"><span data-stu-id="fab81-124">If the ID meets the stated conditions, ignore the error and save your change.</span></span>

    > [!NOTE]
    > <span data-ttu-id="fab81-125">Si un message d’erreur s’affiche indiquant que le domaine appartient déjà à quelqu’un et que c’est vous qui en êtes le propriétaire, suivez la procédure décrite dans Quickstart [ : Ajouter votre nom de domaine personnalisé à l’aide du Portail Azure Active Directory](/azure/active-directory/add-custom-domain) pour l’inscrire, puis répétez cette étape.</span><span class="sxs-lookup"><span data-stu-id="fab81-125">If you get an error saying that the domain is already owned but you own it, follow the procedure at [Quickstart: Add a custom domain name to Azure Active Directory](/azure/active-directory/add-custom-domain) to register it, and then repeat this step.</span></span> <span data-ttu-id="fab81-126">(Cette erreur peut également se produire si vous n’êtes pas connecté avec des informations d’identification d’un administrateur de la location de Microsoft 365.</span><span class="sxs-lookup"><span data-stu-id="fab81-126">(This error can also occur if you are not signed in with credentials of an admin in the Microsoft 365 tenancy.</span></span> <span data-ttu-id="fab81-127">Voir l’étape 2.</span><span class="sxs-lookup"><span data-stu-id="fab81-127">See step 2.</span></span> <span data-ttu-id="fab81-128">Déconnectez-vous, puis reconnectez-vous avec les informations d’identification d’administrateur, puis répétez le processus décrit à l’étape 3.)</span><span class="sxs-lookup"><span data-stu-id="fab81-128">Sign out and sign in again with admin credentials and repeat the process from step 3.)</span></span>

1. <span data-ttu-id="fab81-129">Sélectionnez le bouton **Ajouter une étendue**.</span><span class="sxs-lookup"><span data-stu-id="fab81-129">Select the **Add a scope** button.</span></span> <span data-ttu-id="fab81-130">Dans le volet qui s’ouvre, entrez `access_as_user` en tant que **nom de l’étendue**.</span><span class="sxs-lookup"><span data-stu-id="fab81-130">In the panel that opens, enter `access_as_user` as the **Scope name**.</span></span>

1. <span data-ttu-id="fab81-131">Donnez la valeur **Administrateurs et utilisateurs** à **Qui peut donner son consentement ?** .</span><span class="sxs-lookup"><span data-stu-id="fab81-131">Set **Who can consent?** to **Admins and users**.</span></span>

1. <span data-ttu-id="fab81-132">Renseignez les champs pour configurer les invites de consentement des administrateurs et utilisateurs avec les valeurs appropriées pour l’étendue `access_as_user` qui permet à l’application Office hôte d’utiliser l’API web de votre complément avec les mêmes droits que l’utilisateur actuel.</span><span class="sxs-lookup"><span data-stu-id="fab81-132">Fill in the fields for configuring the admin and user consent prompts with values that are appropriate for the `access_as_user` scope which enables the Office host application to use your add-in's web APIs with the same rights as the current user.</span></span> <span data-ttu-id="fab81-133">Suggestions :</span><span class="sxs-lookup"><span data-stu-id="fab81-133">Suggestions:</span></span>

    - <span data-ttu-id="fab81-134">**Titre consentement administrateur :** Office peut agir en tant qu’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="fab81-134">**Admin consent title:** Office can act as the user.</span></span>
    - <span data-ttu-id="fab81-135">**Description consentement administrateur :** activez Office pour qu’il appelle l’API de complément web avec les mêmes droits que l’utilisateur actuel.</span><span class="sxs-lookup"><span data-stu-id="fab81-135">**Admin consent description:** Enable Office to call the add-in's web APIs with the same rights as the current user.</span></span>
    - <span data-ttu-id="fab81-136">**Titre consentement utilisateur :** Office peut agir en tant que vous.</span><span class="sxs-lookup"><span data-stu-id="fab81-136">**User consent title:** Office can act as you.</span></span>
    - <span data-ttu-id="fab81-137">**Description consentement administrateur :** activez Office pour qu’il appelle l’API de complément web avec les mêmes droits dont vous disposez.</span><span class="sxs-lookup"><span data-stu-id="fab81-137">**Admin consent description:** Enable Office to call the add-in's web APIs with the same rights that you have.</span></span>

1. <span data-ttu-id="fab81-138">Vérifiez que **State** est défini comme **Enabled**.</span><span class="sxs-lookup"><span data-stu-id="fab81-138">Ensure that **State** is set to **Enabled**.</span></span>

1. <span data-ttu-id="fab81-139">Sélectionnez **Ajouter une étendue**.</span><span class="sxs-lookup"><span data-stu-id="fab81-139">Select **Add scope**.</span></span>

    > [!NOTE]
    > <span data-ttu-id="fab81-140">La partie domaine du **nom de l’étendue** affiché juste sous le champ de texte devrait automatiquement correspondre à l’**URI d’ID d’application** définie à l’étape précédente avec `/access_as_user` ajouté au bout (par exemple, `api://localhost:6789/c6c1f32b-5e55-4997-881a-753cc1d563b7/access_as_user`).</span><span class="sxs-lookup"><span data-stu-id="fab81-140">The domain part of the **Scope name** displayed just below the text field should automatically match the **Application ID URI** set in the previous step, with `/access_as_user` appended to the end; for example, `api://localhost:6789/c6c1f32b-5e55-4997-881a-753cc1d563b7/access_as_user`.</span></span>

1. <span data-ttu-id="fab81-141">Dans la section **Applications client autorisées**, vous identifiez les applications que vous souhaitez autoriser dans l’application web de votre complément.</span><span class="sxs-lookup"><span data-stu-id="fab81-141">In the **Authorized client applications** section, you identify the applications that you want to authorize to your add-in's web application.</span></span> <span data-ttu-id="fab81-142">Chacun des ID suivants doit être pré-autorisé.</span><span class="sxs-lookup"><span data-stu-id="fab81-142">Each of the following IDs needs to be pre-authorized.</span></span>
  
    * <span data-ttu-id="fab81-143">`d3590ed6-52b3-4102-aeff-aad2292ab01c` (Microsoft Office)</span><span class="sxs-lookup"><span data-stu-id="fab81-143">`d3590ed6-52b3-4102-aeff-aad2292ab01c` (Microsoft Office)</span></span>
    * <span data-ttu-id="fab81-144">`ea5a67f6-b6f3-4338-b240-c655ddc3cc8e` (Microsoft Office)</span><span class="sxs-lookup"><span data-stu-id="fab81-144">`ea5a67f6-b6f3-4338-b240-c655ddc3cc8e` (Microsoft Office)</span></span>
    * <span data-ttu-id="fab81-145">`57fb890c-0dab-4253-a5e0-7188c88b2bb4` (Office sur le web)</span><span class="sxs-lookup"><span data-stu-id="fab81-145">`57fb890c-0dab-4253-a5e0-7188c88b2bb4` (Office on the web)</span></span>
    * <span data-ttu-id="fab81-146">`08e18876-6177-487e-b8b5-cf950c1e598c` (Office sur le web)</span><span class="sxs-lookup"><span data-stu-id="fab81-146">`08e18876-6177-487e-b8b5-cf950c1e598c` (Office on the web)</span></span>
    * <span data-ttu-id="fab81-147">`bc59ab01-8403-45c6-8796-ac3ef710b3e3` (Outlook sur le web)</span><span class="sxs-lookup"><span data-stu-id="fab81-147">`bc59ab01-8403-45c6-8796-ac3ef710b3e3` (Outlook on the web)</span></span>

    <span data-ttu-id="fab81-148">Pour chaque ID, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="fab81-148">For each ID, take these steps:</span></span>

      <span data-ttu-id="fab81-149">a.</span><span class="sxs-lookup"><span data-stu-id="fab81-149">a.</span></span> <span data-ttu-id="fab81-150">Sélectionnez le bouton **Ajouter une application cliente** puis, dans le volet qui s’ouvre, définissez l’**ID Client** pour le GUID respectif et cochez la case pour `api://$FQDN-WITHOUT-PROTOCOL$/$App ID GUID$/access_as_user`.</span><span class="sxs-lookup"><span data-stu-id="fab81-150">Select **Add a client application** button then, in the panel that opens, set the **Client ID** to the respective GUID and check the box for `api://$FQDN-WITHOUT-PROTOCOL$/$App ID GUID$/access_as_user`.</span></span>

      <span data-ttu-id="fab81-151">b.</span><span class="sxs-lookup"><span data-stu-id="fab81-151">b.</span></span> <span data-ttu-id="fab81-152">Sélectionnez **Ajouter une application**.</span><span class="sxs-lookup"><span data-stu-id="fab81-152">Select **Add application**.</span></span>

1. <span data-ttu-id="fab81-153">Sous **Gérer**, sélectionnez **Authentification**.</span><span class="sxs-lookup"><span data-stu-id="fab81-153">Select **Authentication** under **Manage**.</span></span> <span data-ttu-id="fab81-154">Dans la section **Rediriger les URI**, sélectionnez **Web** dans la liste déroulante **Type** puis définissez la valeur de **Rediriger l’URI** à `https://$FQDN-WITHOUT-PROTOCOL$`.</span><span class="sxs-lookup"><span data-stu-id="fab81-154">In the **Redirect URIs** section, select **Web** in the **Type** dropdown then set the **Redirect URI** value to `https://$FQDN-WITHOUT-PROTOCOL$`.</span></span>

1. <span data-ttu-id="fab81-155">En haut du formulaire, sélectionnez **Enregistrer**.</span><span class="sxs-lookup"><span data-stu-id="fab81-155">Select **Save** at the top of the form.</span></span>

1. <span data-ttu-id="fab81-156">Sélectionnez **Autorisations API** sous **Gestion** et sélectionnez **Ajouter une autorisation**.</span><span class="sxs-lookup"><span data-stu-id="fab81-156">Select **API permissions** under **Manage** and select **Add a permission**.</span></span> <span data-ttu-id="fab81-157">Dans le volet qui s’ouvre, sélectionnez **Microsoft Graph**, puis **Autorisations déléguées**.</span><span class="sxs-lookup"><span data-stu-id="fab81-157">On the panel that opens, choose **Microsoft Graph** and then choose **Delegated permissions**.</span></span>

1. <span data-ttu-id="fab81-158">Utilisez la zone de recherche **Sélectionnez les autorisations** pour rechercher les autorisations dont votre complément a besoin.</span><span class="sxs-lookup"><span data-stu-id="fab81-158">Use the **Select permissions** search box to search for the permissions your add-in needs.</span></span> <span data-ttu-id="fab81-159">Les éléments suivants sont des exemples.</span><span class="sxs-lookup"><span data-stu-id="fab81-159">The following are examples.</span></span>

    * <span data-ttu-id="fab81-160">Files.Read.All</span><span class="sxs-lookup"><span data-stu-id="fab81-160">Files.Read.All</span></span>
    * <span data-ttu-id="fab81-161">offline_access</span><span class="sxs-lookup"><span data-stu-id="fab81-161">offline_access</span></span>
    * <span data-ttu-id="fab81-162">openid</span><span class="sxs-lookup"><span data-stu-id="fab81-162">openid</span></span>
    * <span data-ttu-id="fab81-163">profil</span><span class="sxs-lookup"><span data-stu-id="fab81-163">profile</span></span>

    > [!NOTE]
    > <span data-ttu-id="fab81-164">L’autorisation `User.Read` est peut-être déjà répertoriée par défaut.</span><span class="sxs-lookup"><span data-stu-id="fab81-164">The `User.Read` permission may already be listed by default.</span></span> <span data-ttu-id="fab81-165">Une bonne pratique consiste à demander uniquement les autorisations dont vous avez besoin. Ainsi, nous vous recommandons de désactiver la case à cocher de cette autorisation si votre complément n’en a pas réellement besoin.</span><span class="sxs-lookup"><span data-stu-id="fab81-165">It is a good practice not to ask for permissions that are not needed, so we recommend that you uncheck the box for this permission if your add-in does not actually need it.</span></span>

1. <span data-ttu-id="fab81-166">Sélectionnez la case à cocher pour chacune des autorisations comme elle apparaît (notez que les autorisations ne restent pas visibles dans la liste lorsque vous sélectionnez chacune d’elles).</span><span class="sxs-lookup"><span data-stu-id="fab81-166">Select the check box for each permission as it appears (note that the permissions will not remain visible in the list as you select each one).</span></span> <span data-ttu-id="fab81-167">Après avoir sélectionné les autorisations dont votre complément a besoin, sélectionnez le bouton **Ajouter des autorisations** situé en bas du panneau.</span><span class="sxs-lookup"><span data-stu-id="fab81-167">After selecting the permissions that your add-in needs, select the **Add permissions** button at the bottom of the panel.</span></span>
