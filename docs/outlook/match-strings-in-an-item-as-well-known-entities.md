---
title: Faire correspondre les chaînes en tant qu’entités connues dans un complément Outlook
description: À l’Office’API JavaScript, vous pouvez obtenir des chaînes qui correspondent à des entités connues spécifiques pour un traitement ultérieur.
ms.date: 04/15/2019
localization_priority: Normal
ms.openlocfilehash: 14faef13050572e8fb85cb8bae7226664bc65a7f
ms.sourcegitcommit: ee9e92a968e4ad23f1e371f00d4888e4203ab772
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/23/2021
ms.locfileid: "53077077"
---
# <a name="match-strings-in-an-outlook-item-as-well-known-entities"></a><span data-ttu-id="46806-103">Mettre en correspondance des chaînes dans un élément Outlook en tant qu’entités connues</span><span class="sxs-lookup"><span data-stu-id="46806-103">Match strings in an Outlook item as well-known entities</span></span>

<span data-ttu-id="46806-p101">Avant d’envoyer un élément de message ou de demande de réunion, Exchange Server analyse le contenu de l’élément, identifie et marque certaines chaînes dans l’objet et le corps similaires aux entités connues d’Exchange (par exemple, adresses e-mail, numéros de téléphone, URL). Les demandes de réunion et les messages sont envoyés par Exchange Server dans une boîte de réception Outlook avec les entités connues marquées.</span><span class="sxs-lookup"><span data-stu-id="46806-p101">Before sending a message or meeting request item, Exchange Server parses the contents of the item, identifies and stamps certain strings in the subject and body that resemble entities well-known to Exchange, for example, email addresses, phone numbers, and URLs. Messages and meeting requests are delivered by Exchange Server in an Outlook Inbox with well-known entities stamped.</span></span> 

<span data-ttu-id="46806-106">À l’Office’API JavaScript, vous pouvez obtenir ces chaînes qui correspondent à des entités connues spécifiques pour un traitement ultérieur.</span><span class="sxs-lookup"><span data-stu-id="46806-106">Using the Office JavaScript API, you can get these strings that match specific well-known entities for further processing.</span></span> <span data-ttu-id="46806-107">Vous pouvez également spécifier une entité connue dans une règle du manifeste du complément pour qu’Outlook puisse activer votre complément quand l’utilisateur affiche un élément contenant des correspondances pour cette entité.</span><span class="sxs-lookup"><span data-stu-id="46806-107">You can also specify a well-known entity in a rule in the add-in manifest so that Outlook can activate your add-in when the user is viewing an item that contains matches for that entity.</span></span> <span data-ttu-id="46806-108">Vous pouvez extraire et effectuer une action sur des correspondances pour cette entité.</span><span class="sxs-lookup"><span data-stu-id="46806-108">You can then extract and take action on matches for the entity.</span></span> 

<span data-ttu-id="46806-109">Pouvoir identifier ou extraire de telles instances à partir d’un message ou d’un rendez-vous sélectionné s’avère très pratique.</span><span class="sxs-lookup"><span data-stu-id="46806-109">Being able to identify or extract such instances from a selected message or appointment is convenient.</span></span> <span data-ttu-id="46806-110">Par exemple, vous pouvez créer un service de recherche sur annuaire inversé comme complément Outlook.</span><span class="sxs-lookup"><span data-stu-id="46806-110">For example, you can build a reverse phone look-up service as an Outlook add-in.</span></span> <span data-ttu-id="46806-111">Le complément peut extraire des chaînes dans l’objet ou le corps de l’élément semblable à un numéro de téléphone, effectuer une recherche sur annuaire inversé et afficher le propriétaire inscrit de chaque numéro de téléphone.</span><span class="sxs-lookup"><span data-stu-id="46806-111">The add-in can extract strings in the item subject or body that resemble a phone number, do a reverse lookup, and display the registered owner of each phone number.</span></span>

<span data-ttu-id="46806-112">Cette rubrique présente ces entités connues, montre des exemples de règles d’activation en fonction de ces entités et explique comment extraire des correspondances d’entités indépendamment de l’utilisation d’entités dans les règles d’activation.</span><span class="sxs-lookup"><span data-stu-id="46806-112">This topic introduces these well-known entities, shows examples of activation rules based on well-known entities, and how to extract entity matches independently of having used entities in activation rules.</span></span>


## <a name="support-for-well-known-entities"></a><span data-ttu-id="46806-113">Prise en charge des entités connues</span><span class="sxs-lookup"><span data-stu-id="46806-113">Support for well-known entities</span></span>

<span data-ttu-id="46806-p104">Exchange Server marque les entités connues dans un élément de message ou de demande de réunion après que l’élément a été envoyé par l’expéditeur et avant qu’il soit remis au destinataire. Ainsi, seuls les éléments ayant transité via Exchange sont marqués, et Outlook peut activer des compléments en fonction de ces marquages quand l’utilisateur affiche ces éléments. En revanche, quand l’utilisateur compose ou affiche un élément du dossier Éléments envoyés, Outlook ne peut pas activer les compléments en fonction des entités connues car l’élément n’a pas transité via Exchange.</span><span class="sxs-lookup"><span data-stu-id="46806-p104">Exchange Server stamps well-known entities in a message or meeting request item after the sender sends the item and before Exchange delivers the item to the recipient. Therefore, only items that have gone through transport in Exchange are stamped, and Outlook can activate add-ins based on these stamps when the user is viewing such items. On the contrary, when the user is composing an item or viewing an item that is in the Sent Items folder, because the item has not gone through transport, Outlook cannot activate add-ins based on well-known entities.</span></span> 

<span data-ttu-id="46806-p105">De même, vous ne pouvez pas extraire les entités connues dans les éléments en cours de composition ou situés dans le dossier Éléments envoyés, car ces éléments n’ont pas transité via Exchange et ne sont pas marqués. Pour plus d’informations sur les types d’éléments qui prennent en charge l’activation, voir [Règles d’activation pour les compléments Outlook](activation-rules.md).</span><span class="sxs-lookup"><span data-stu-id="46806-p105">Similarly, you cannot extract well-known entities in items that are being composed or in the Sent Items folder, as these items have not gone through transport and are not stamped. For additional information about the kinds of items that support activation, see [Activation rules for Outlook add-ins](activation-rules.md).</span></span>

<span data-ttu-id="46806-p106">Le tableau suivant répertorie les entités qu’Exchange Server et Outlook prennent en charge et reconnaissent (d’où le nom « entités connues »), et le type d’objet d’une instance de chaque entité. La reconnaissance du langage naturel d’une chaîne en tant que l’une de ces entités est fondée sur un modèle d’apprentissage qui a été testé sur une grande quantité de données. Par conséquent, la reconnaissance n’est pas déterministe. Pour plus d’informations sur les conditions de reconnaissance, voir [Conseils d’utilisation des entités connues](#tips-for-using-well-known-entities).</span><span class="sxs-lookup"><span data-stu-id="46806-p106">The following table lists the entities that Exchange Server and Outlook support and recognize (hence the name "well-known entities"), and the object type of an instance of each entity. The natural language recognition of a string as one of these entities is based on a learning model that has been trained on a large amount of data. Therefore, the recognition is non-deterministic. See [Tips for using well-known entities](#tips-for-using-well-known-entities) for more information about conditions for recognition.</span></span>

<span data-ttu-id="46806-123">**Tableau 1. Entités prises en charge et leurs types**</span><span class="sxs-lookup"><span data-stu-id="46806-123">**Table 1. Supported entities and their types**</span></span>

|<span data-ttu-id="46806-124">Type d’entité</span><span class="sxs-lookup"><span data-stu-id="46806-124">Entity type</span></span>|<span data-ttu-id="46806-125">Conditions de reconnaissance</span><span class="sxs-lookup"><span data-stu-id="46806-125">Conditions for recognition</span></span>|<span data-ttu-id="46806-126">Type d’objet</span><span class="sxs-lookup"><span data-stu-id="46806-126">Object type</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="46806-127">**Adresse**</span><span class="sxs-lookup"><span data-stu-id="46806-127">**Address**</span></span>|<span data-ttu-id="46806-p107">Adresses aux États-Unis ; par exemple : 1234 Main Street, Redmond, WA 07722. En général, pour qu’une adresse soit reconnue, elle doit suivre la structure d’une adresse postale des États-Unis, où la plupart des éléments sont présents, à savoir numéro de rue, nom de rue, ville, État et code postal. L’adresse peut être spécifiée sur une ou plusieurs lignes.</span><span class="sxs-lookup"><span data-stu-id="46806-p107">United States street addresses; for example: 1234 Main Street, Redmond, WA 07722. Generally, for an address to be recognized, it should follow the structure of a United States postal address, with most of the elements of a street number, street name, city, state, and zip code present. The address can be specified in one or multiple lines.</span></span>|<span data-ttu-id="46806-131">Objet JavaScript **String**</span><span class="sxs-lookup"><span data-stu-id="46806-131">JavaScript **String** object</span></span>|
|<span data-ttu-id="46806-132">**Contact**</span><span class="sxs-lookup"><span data-stu-id="46806-132">**Contact**</span></span>|<span data-ttu-id="46806-133">Une référence aux informations d’une personne telles que reconnues en langage naturel.</span><span class="sxs-lookup"><span data-stu-id="46806-133">A reference to a person's information as recognized in natural language.</span></span> <span data-ttu-id="46806-134">La reconnaissance d’un contact varie selon le contexte.</span><span class="sxs-lookup"><span data-stu-id="46806-134">The recognition of a contact depends on the context.</span></span> <span data-ttu-id="46806-135">Par exemple, une signature à la fin d’un message ou le nom d’une personne apparaissant à proximité des informations suivantes : un numéro de téléphone, une adresse, une adresse électronique et une URL.</span><span class="sxs-lookup"><span data-stu-id="46806-135">For example, a signature at the end of a message, or a person's name appearing in the vicinity of some of the following information: a phone number, address, email address, and URL.</span></span>|<span data-ttu-id="46806-136">Objet [Contact](/javascript/api/outlook/office.contact)</span><span class="sxs-lookup"><span data-stu-id="46806-136">[Contact](/javascript/api/outlook/office.contact) object</span></span>|
|<span data-ttu-id="46806-137">**EmailAddress**</span><span class="sxs-lookup"><span data-stu-id="46806-137">**EmailAddress**</span></span>|<span data-ttu-id="46806-138">Adresses électroniques SMTP.</span><span class="sxs-lookup"><span data-stu-id="46806-138">SMTP email addresses.</span></span>|<span data-ttu-id="46806-139">Objet `String` JavaScript</span><span class="sxs-lookup"><span data-stu-id="46806-139">JavaScript `String` object</span></span>|
|<span data-ttu-id="46806-140">**MeetingSuggestion**</span><span class="sxs-lookup"><span data-stu-id="46806-140">**MeetingSuggestion**</span></span>|<span data-ttu-id="46806-p109">Une référence à un événement ou une réunion. Par exemple, Exchange 2013 reconnaîtrait le texte suivant comme une suggestion de réunion :  _On se voit demain pour déjeuner ?_</span><span class="sxs-lookup"><span data-stu-id="46806-p109">A reference to an event or meeting. For example, Exchange 2013 would recognize the following text as a meeting suggestion:  _Let's meet tomorrow for lunch._</span></span>|<span data-ttu-id="46806-143">Objet [MeetingSuggestion](/javascript/api/outlook/office.meetingsuggestion)</span><span class="sxs-lookup"><span data-stu-id="46806-143">[MeetingSuggestion](/javascript/api/outlook/office.meetingsuggestion) object</span></span>|
|<span data-ttu-id="46806-144">**PhoneNumber**</span><span class="sxs-lookup"><span data-stu-id="46806-144">**PhoneNumber**</span></span>|<span data-ttu-id="46806-145">Numéros de téléphone des États-Unis ; par exemple :  _(235) 555-0110_</span><span class="sxs-lookup"><span data-stu-id="46806-145">United States telephone numbers; for example:  _(235) 555-0110_</span></span>|<span data-ttu-id="46806-146">Objet [PhoneNumber](/javascript/api/outlook/office.phonenumber)</span><span class="sxs-lookup"><span data-stu-id="46806-146">[PhoneNumber](/javascript/api/outlook/office.phonenumber) object</span></span>|
|<span data-ttu-id="46806-147">**TaskSuggestion**</span><span class="sxs-lookup"><span data-stu-id="46806-147">**TaskSuggestion**</span></span>|<span data-ttu-id="46806-p110">Phrases appelant une action. Par exemple :  _Veuillez mettre à jour la feuille de calcul._</span><span class="sxs-lookup"><span data-stu-id="46806-p110">Actionable sentences in an email. For example:  _Please update the spreadsheet._</span></span>|<span data-ttu-id="46806-150">Objet [TaskSuggestion](/javascript/api/outlook/office.tasksuggestion)</span><span class="sxs-lookup"><span data-stu-id="46806-150">[TaskSuggestion](/javascript/api/outlook/office.tasksuggestion) object</span></span>|
|<span data-ttu-id="46806-151">**Url**</span><span class="sxs-lookup"><span data-stu-id="46806-151">**Url**</span></span>|<span data-ttu-id="46806-152">Adresse web qui spécifie explicitement l’identificateur et l’emplacement réseau d’une ressource web.</span><span class="sxs-lookup"><span data-stu-id="46806-152">A web address that explicitly specifies the network location and identifier for a web resource.</span></span> <span data-ttu-id="46806-153">Exchange Server ne nécessite pas le protocole d’accès dans l’adresse web et ne reconnaît pas les URL incorporées dans le texte du lien en tant qu’instances de `Url` l’entité.</span><span class="sxs-lookup"><span data-stu-id="46806-153">Exchange Server does not require the access protocol in the web address, and does not recognize URLs that are embedded in link text as instances of the `Url` entity.</span></span> <span data-ttu-id="46806-154">Exchange Server peuvent correspondre aux exemples suivants : `www.youtube.com/user/officevideos``https://www.youtube.com/user/officevideos`</span><span class="sxs-lookup"><span data-stu-id="46806-154">Exchange Server can match the following examples: `www.youtube.com/user/officevideos` `https://www.youtube.com/user/officevideos`</span></span> |<span data-ttu-id="46806-155">Objet `String` JavaScript</span><span class="sxs-lookup"><span data-stu-id="46806-155">JavaScript `String` object</span></span>|

<br/>

<span data-ttu-id="46806-p112">La figure suivante décrit comment Exchange Server et Outlook prennent en charge les entités connues pour les compléments et indique ce que les compléments peuvent faire avec ces entités connues. Reportez-vous à [Récupération d’entités dans votre complément](#retrieving-entities-in-your-add-in) et [Activation d’un complément basé sur l’existence d’une entité](#activating-an-add-in-based-on-the-existence-of-an-entity) pour plus de détails sur l’utilisation de ces entités.</span><span class="sxs-lookup"><span data-stu-id="46806-p112">The following figure describes how Exchange Server and Outlook support well-known entities for add-ins, and what add-ins can do with well-known entities. See [Retrieving entities in your add-in](#retrieving-entities-in-your-add-in) and [Activating an add-in based on the existence of an entity](#activating-an-add-in-based-on-the-existence-of-an-entity) for more details on how to use these entities.</span></span>

<span data-ttu-id="46806-158">**Prise en charge des entités connues par Exchange Server, Outlook et les compléments**</span><span class="sxs-lookup"><span data-stu-id="46806-158">**How Exchange Server, Outlook, and add-ins support well-known entities**</span></span>

![Prise en charge et utilisation d’entités connues dans l’application de messagerie.](../images/well-known-entities-info.png)


## <a name="permissions-to-extract-entities"></a><span data-ttu-id="46806-160">Autorisations d’extraction d’entités</span><span class="sxs-lookup"><span data-stu-id="46806-160">Permissions to extract entities</span></span>

<span data-ttu-id="46806-161">Pour extraire les entités de votre code JavaScript ou pour activer votre complément à partir de l’existence de certaines entités connues, assurez-vous que vous avez demandé les autorisations appropriées dans le manifeste du complément.</span><span class="sxs-lookup"><span data-stu-id="46806-161">To extract entities in your JavaScript code or to have your add-in activated based on the existence of certain well-known entities, make sure you have requested the appropriate permissions in the add-in manifest.</span></span>

<span data-ttu-id="46806-162">La spécification de l’autorisation restreinte par défaut permet à votre add-in d’extraire `Address` le `MeetingSuggestion` , ou `TaskSuggestion` l’entité.</span><span class="sxs-lookup"><span data-stu-id="46806-162">Specifying the default restricted permission allows your add-in to extract the `Address`, `MeetingSuggestion`, or `TaskSuggestion` entity.</span></span> <span data-ttu-id="46806-163">Pour extraire les autres entités, spécifiez les autorisations de lecture d’élément, de lecture/écriture d’élément ou de lecture/écriture de boîte aux lettres.</span><span class="sxs-lookup"><span data-stu-id="46806-163">To extract any of the other entities, specify read item, read/write item, or read/write mailbox permission.</span></span> <span data-ttu-id="46806-164">Pour le faire dans le fichier manifeste, utilisez l’élément [Permissions](../reference/manifest/permissions.md) et spécifiez l’autorisation appropriée &mdash;**Restricted**, **ReadItem**, **ReadWriteItem**, ou **ReadWriteMailbox**&mdash;, comme dans l’exemple suivant :</span><span class="sxs-lookup"><span data-stu-id="46806-164">To do that in the manifest, use the [Permissions](../reference/manifest/permissions.md) element and specify the appropriate permission&mdash;**Restricted**, **ReadItem**, **ReadWriteItem**, or **ReadWriteMailbox**&mdash;as in the following example:</span></span>

```xml
<Permissions>ReadItem</Permissions>
```


## <a name="retrieving-entities-in-your-add-in"></a><span data-ttu-id="46806-165">Récupération d’entités dans votre complément</span><span class="sxs-lookup"><span data-stu-id="46806-165">Retrieving entities in your add-in</span></span>

<span data-ttu-id="46806-166">Tant que l’objet ou le corps de l’élément consulté par l’utilisateur contient des chaînes qu’Exchange et Outlook peuvent reconnaître comme des entités connues, ces instances sont disponibles pour les compléments, et ce même si un complément n’est pas activé en fonction des entités connues.</span><span class="sxs-lookup"><span data-stu-id="46806-166">As long as the subject or body of the item that is being viewed by the user contains strings that Exchange and Outlook can recognize as well-known entities, these instances are available to add-ins. They are available even if an add-in is not activated based on well-known entities.</span></span> <span data-ttu-id="46806-167">Avec l’autorisation appropriée, vous pouvez utiliser la ou la méthode pour récupérer les entités connues présentes dans le message ou le `getEntities` `getEntitiesByType` rendez-vous actuel.</span><span class="sxs-lookup"><span data-stu-id="46806-167">With the appropriate permission, you can use the `getEntities` or `getEntitiesByType` method to retrieve well-known entities that are present in the current message or appointment.</span></span>

<span data-ttu-id="46806-168">La méthode renvoie un tableau d’objets Entities qui contient toutes les entités `getEntities` connues dans [](/javascript/api/outlook/office.entities) l’élément.</span><span class="sxs-lookup"><span data-stu-id="46806-168">The `getEntities` method returns an array of [Entities](/javascript/api/outlook/office.entities) objects that contains all the well-known entities in the item.</span></span>

<span data-ttu-id="46806-169">Si vous êtes intéressé par un type particulier d’entités, utilisez la méthode qui renvoie uniquement un tableau des `getEntitiesByType` entités de votre choix.</span><span class="sxs-lookup"><span data-stu-id="46806-169">If you're interested in a particular type of entities, use the `getEntitiesByType`method which returns an array of only the entities you want.</span></span> <span data-ttu-id="46806-170">L’énumération [EntityType](/javascript/api/outlook/office.mailboxenums.entitytype) représente tous les types d’entités connues que vous pouvez extraire.</span><span class="sxs-lookup"><span data-stu-id="46806-170">The [EntityType](/javascript/api/outlook/office.mailboxenums.entitytype) enumeration represents all the types of well-known entities you can extract.</span></span>

<span data-ttu-id="46806-171">Après avoir appelé, vous pouvez ensuite utiliser la propriété correspondante de l’objet pour obtenir un tableau `getEntities` `Entities` d’instances d’un type d’entité.</span><span class="sxs-lookup"><span data-stu-id="46806-171">After calling `getEntities`, you can then use the corresponding property of the `Entities` object to obtain an array of instances of a type of entity.</span></span> <span data-ttu-id="46806-172">Selon le type d’entité, les instances dans le tableau peuvent être seulement des chaînes, ou peuvent être mappés avec des objets spécifiques.</span><span class="sxs-lookup"><span data-stu-id="46806-172">Depending on the type of entity, the instances in the array can be just strings, or can map to specific objects.</span></span> 

<span data-ttu-id="46806-173">Comme dans l’exemple illustré dans la figure précédente, pour obtenir des adresses dans l’élément, accédez au tableau renvoyé par `getEntities().addresses[]`.</span><span class="sxs-lookup"><span data-stu-id="46806-173">As an example seen in the earlier figure, to get addresses in the item, access the array returned by `getEntities().addresses[]`.</span></span> <span data-ttu-id="46806-174">La `Entities.addresses` propriété renvoie un tableau de chaînes qui Outlook comme adresses postales.</span><span class="sxs-lookup"><span data-stu-id="46806-174">The `Entities.addresses` property returns an array of strings that Outlook recognizes as postal addresses.</span></span> <span data-ttu-id="46806-175">De même, la propriété renvoie un tableau d’objets que Outlook `Entities.contacts` `Contact` reconnaît en tant qu’informations de contact.</span><span class="sxs-lookup"><span data-stu-id="46806-175">Similarly, the `Entities.contacts` property returns an array of `Contact` objects that Outlook recognizes as contact information.</span></span> <span data-ttu-id="46806-176">Le tableau 1 répertorie le type d’objet d’une instance de chaque entité prise en charge.</span><span class="sxs-lookup"><span data-stu-id="46806-176">Tables 1 lists the object type of an instance of each supported entity.</span></span>

<span data-ttu-id="46806-177">L’exemple suivant illustre comment récupérer des adresses trouvées dans un message.</span><span class="sxs-lookup"><span data-stu-id="46806-177">The following example shows how to retrieve any addresses found in a message.</span></span>

```js
// Get the address entities from the item.
var entities = Office.context.mailbox.item.getEntities();
// Check to make sure that address entities are present.
if (null != entities && null != entities.addresses && undefined != entities.addresses) {
   //Addresses are present, so use them here.
}

```


## <a name="activating-an-add-in-based-on-the-existence-of-an-entity"></a><span data-ttu-id="46806-178">Activation d’un complément basé sur l’existence d’une entité</span><span class="sxs-lookup"><span data-stu-id="46806-178">Activating an add-in based on the existence of an entity</span></span>

<span data-ttu-id="46806-179">Une autre façon d’utiliser des entités connues consiste à faire en sorte qu’Outlook active votre complément selon l’existence de types d’entités dans l’objet ou le corps de l’élément actuellement affiché.</span><span class="sxs-lookup"><span data-stu-id="46806-179">Another way to use well-known entities is to have Outlook activate your add-in based on the existence of one or more types of entities in the subject or body of the currently viewed item.</span></span> <span data-ttu-id="46806-180">Vous pouvez le faire en spécifiant une `ItemHasKnownEntity` règle dans le manifeste du add-in.</span><span class="sxs-lookup"><span data-stu-id="46806-180">You can do so by specifying an `ItemHasKnownEntity` rule in the add-in manifest.</span></span> <span data-ttu-id="46806-181">Le type simple [EntityType](/javascript/api/outlook/office.mailboxenums.entitytype) représente les différents types d’entités connues pris en charge par les `ItemHasKnownEntity` règles.</span><span class="sxs-lookup"><span data-stu-id="46806-181">The [EntityType](/javascript/api/outlook/office.mailboxenums.entitytype) simple type represents the different types of well-known entities supported by `ItemHasKnownEntity` rules.</span></span> <span data-ttu-id="46806-182">Une fois votre complément activé, vous pouvez également récupérer les instances de ces entités pour répondre à vos besoins, comme le décrit la section précédente [Récupération d’entités dans votre complément](#retrieving-entities-in-your-add-in).</span><span class="sxs-lookup"><span data-stu-id="46806-182">After your add-in is activated, you can also retrieve the instances of such entities for your purposes, as described in the previous section [Retrieving entities in your add-in](#retrieving-entities-in-your-add-in).</span></span>

<span data-ttu-id="46806-183">Vous pouvez éventuellement appliquer une expression régulière dans une règle, de manière à filtrer davantage les instances d’une entité et demander à Outlook d’activer un add-in uniquement sur un sous-ensemble des instances de `ItemHasKnownEntity` l’entité.</span><span class="sxs-lookup"><span data-stu-id="46806-183">You can optionally apply a regular expression in an `ItemHasKnownEntity` rule, so as to further filter instances of an entity and have Outlook activate an add-in only on a subset of the instances of the entity.</span></span> <span data-ttu-id="46806-184">Par exemple, vous pouvez spécifier un filtre pour l’entité d’adresse dans un message qui contient un code postal de l’État de Washington commençant par « 98 ».</span><span class="sxs-lookup"><span data-stu-id="46806-184">For example, you can specify a filter for the street address entity in a message that contains a Washington state zip code beginning with "98".</span></span> <span data-ttu-id="46806-185">Pour appliquer un filtre sur les instances d’entité, utilisez les attributs dans l’élément du `RegExFilter` `FilterName` type `Rule` [ItemHasKnownEntity.](../reference/manifest/rule.md#itemhasknownentity-rule)</span><span class="sxs-lookup"><span data-stu-id="46806-185">To apply a filter on the entity instances, use the `RegExFilter` and `FilterName` attributes in the `Rule` element of the [ItemHasKnownEntity](../reference/manifest/rule.md#itemhasknownentity-rule) type.</span></span>

<span data-ttu-id="46806-186">Comme avec d’autres règles d’activation, vous pouvez spécifier plusieurs règles afin de former une collection de règles pour votre complément.</span><span class="sxs-lookup"><span data-stu-id="46806-186">Similar to other activation rules, you can specify multiple rules to form a rule collection for your add-in.</span></span> <span data-ttu-id="46806-187">L’exemple suivant applique une opération « AND » sur 2 règles : une `ItemIs` règle et une `ItemHasKnownEntity` règle.</span><span class="sxs-lookup"><span data-stu-id="46806-187">The following example applies an "AND" operation on 2 rules: an `ItemIs` rule and an `ItemHasKnownEntity` rule.</span></span> <span data-ttu-id="46806-188">Cette collection de règles active le complément lorsque l’élément en cours est un message et qu’Outlook reconnaît une adresse dans l’objet ou le corps de cet élément.</span><span class="sxs-lookup"><span data-stu-id="46806-188">This rule collection activates the add-in whenever the current item is a message and Outlook recognizes an address in the subject or body of that item.</span></span>

```XML
<Rule xsi:type="RuleCollection" Mode="And">
   <Rule xsi:type="ItemIs" ItemType="Message" />
   <Rule xsi:type="ItemHasKnownEntity" EntityType="Address" />
</Rule>
```

<br/>

<span data-ttu-id="46806-189">L’exemple suivant utilise l’élément actuel pour définir une variable sur `getEntitiesByType` les résultats de la collection de règles `addresses` précédente.</span><span class="sxs-lookup"><span data-stu-id="46806-189">The following example uses `getEntitiesByType` of the current item to set a variable `addresses` to the results of the preceding rule collection.</span></span>

```js
var addresses = Office.context.mailbox.item.getEntitiesByType(Office.MailboxEnums.EntityType.Address);
```

<br/>

<span data-ttu-id="46806-190">L’exemple de règle suivant active le add-in chaque fois qu’il existe une URL dans l’objet ou le corps de l’élément actif, et que l’URL contient la chaîne « youtube », quelle que soit la valeur de la `ItemHasKnownEntity` chaîne.</span><span class="sxs-lookup"><span data-stu-id="46806-190">The following `ItemHasKnownEntity` rule example activates the add-in whenever there is a URL in the subject or body of the current item, and the URL contains the string "youtube", regardless of the case of the string.</span></span>

```XML
<Rule xsi:type="ItemHasKnownEntity" 
    EntityType="Url" 
    RegExFilter="youtube"
    FilterName="youtube"
    IgnoreCase="true"/>
```

<br/>

<span data-ttu-id="46806-191">L’exemple suivant utilise l’élément actuel pour définir une variable afin d’obtenir un tableau de résultats qui correspondent à `getFilteredEntitiesByName(name)` l’expression régulière de la règle `videos` `ItemHasKnownEntity` précédente.</span><span class="sxs-lookup"><span data-stu-id="46806-191">The following example uses `getFilteredEntitiesByName(name)` of the current item to set a variable `videos` to get an array of results that match the regular expression in the preceding `ItemHasKnownEntity` rule.</span></span>

```js
var videos = Office.context.mailbox.item.getFilteredEntitiesByName(youtube);
```


## <a name="tips-for-using-well-known-entities"></a><span data-ttu-id="46806-192">Conseils d’utilisation des entités connues</span><span class="sxs-lookup"><span data-stu-id="46806-192">Tips for using well-known entities</span></span>

<span data-ttu-id="46806-193">Si vous utilisez des entités connues dans votre complément, vous devez connaître certaines informations et limites.</span><span class="sxs-lookup"><span data-stu-id="46806-193">There are a few facts and limits you should be aware of if you use well-known entities in your add-in.</span></span> <span data-ttu-id="46806-194">Les éléments suivants s’appliquent tant que votre application est activée lorsque l’utilisateur lit un élément qui contient des correspondances d’entités connues, que vous utilisiez ou non une `ItemHasKnownEntity` règle :</span><span class="sxs-lookup"><span data-stu-id="46806-194">The following applies as long as your add-in is activated when the user is reading an item which contains matches of well-known entities, regardless of whether you use an `ItemHasKnownEntity` rule:</span></span>


- <span data-ttu-id="46806-195">Vous pouvez extraire des chaînes qui sont des entités connues uniquement si les chaînes sont en anglais.</span><span class="sxs-lookup"><span data-stu-id="46806-195">You can extract strings that are well-known entities only if the strings are in English.</span></span>
    
- <span data-ttu-id="46806-196">Vous pouvez extraire des entités connues des 2 000 premiers caractères du corps de l’élément, mais pas au-delà.</span><span class="sxs-lookup"><span data-stu-id="46806-196">You can extract well-known entities from the first 2,000 characters in the item body, but not beyond that limit.</span></span> <span data-ttu-id="46806-197">Cette limite de taille permet d’équilibrer le besoin de fonctionnalité et les performances, de sorte qu’Exchange Server et Outlook ne soient pas ralentis par l’analyse et l’identification des instances d’entités connues dans les longs messages et rendez-vous.</span><span class="sxs-lookup"><span data-stu-id="46806-197">This size limit helps balance the need for functionality and performance, so that Exchange Server and Outlook are not bogged down by parsing and identifying instances of well-known entities in large messages and appointments.</span></span> <span data-ttu-id="46806-198">Notez que cette limite est indépendante du fait que le add-in spécifie ou non une `ItemHasKnownEntity` règle.</span><span class="sxs-lookup"><span data-stu-id="46806-198">Note that this limit is independent of whether the add-in specifies an `ItemHasKnownEntity` rule.</span></span> <span data-ttu-id="46806-199">Si le complément n’utilise pas cette règle, la limite de traitement de règle est celle décrite au point 2 ci-dessous pour les clients riches Outlook.</span><span class="sxs-lookup"><span data-stu-id="46806-199">If the add-in does use such a rule, note also the rule processing limit in item 2 below for the Outlook rich clients.</span></span>
    
- <span data-ttu-id="46806-p123">Vous pouvez extraire des entités à partir de rendez-vous, qui sont des réunions organisées par une personne autre que le propriétaire de la boîte aux lettres. Vous ne pouvez pas extraire d’entités à partir d’éléments de calendrier qui ne sont pas des réunions ou de réunions organisées par le propriétaire de la boîte aux lettres.</span><span class="sxs-lookup"><span data-stu-id="46806-p123">You can extract entities from appointments that are meetings organized by someone other than the mailbox owner. You cannot extract entities from calendar items that are not meetings, or meetings organized by the mailbox owner.</span></span>
    
- <span data-ttu-id="46806-202">Vous pouvez extraire des entités du type à `MeetingSuggestion` partir de messages uniquement, mais pas de rendez-vous.</span><span class="sxs-lookup"><span data-stu-id="46806-202">You can extract entities of the `MeetingSuggestion` type from only messages but not appointments.</span></span>
    
- <span data-ttu-id="46806-203">Vous pouvez extraire des URL qui existent de façon explicite dans le corps d’élément, mais pas des URL incorporées dans un texte de lien hypertexte du corps d’élément HTML.</span><span class="sxs-lookup"><span data-stu-id="46806-203">You can extract URLs that exist explicitly in the item body, but not URLs that are embedded in hyperlinked text in HTML item body.</span></span> <span data-ttu-id="46806-204">Envisagez plutôt `ItemHasRegularExpressionMatch` d’utiliser une règle pour obtenir des URL explicites et incorporées.</span><span class="sxs-lookup"><span data-stu-id="46806-204">Consider using an `ItemHasRegularExpressionMatch` rule instead to get both explicit and embedded URLs.</span></span> <span data-ttu-id="46806-205">Spécifiez en tant que PropertyName et une expression régulière qui correspond aux `BodyAsHTML` URL en tant que _RegExValue_. </span><span class="sxs-lookup"><span data-stu-id="46806-205">Specify `BodyAsHTML` as the _PropertyName_, and a regular expression that matches URLs as the  _RegExValue_.</span></span>
    
- <span data-ttu-id="46806-206">Vous ne pouvez pas extraire des entités à partir d’éléments dans le dossier Éléments envoyés.</span><span class="sxs-lookup"><span data-stu-id="46806-206">You cannot extract entities from items in the Sent Items folder.</span></span>
    
<span data-ttu-id="46806-207">En outre, les dispositions suivantes s’appliquent si vous utilisez une règle [ItemHasKnownEntity](../reference/manifest/rule.md#itemhasknownentity-rule), et cela peut avoir une incidence sur les scénarios pour lesquels vous souhaiteriez que votre complément soit activé :</span><span class="sxs-lookup"><span data-stu-id="46806-207">In addition, the following applies if you use an [ItemHasKnownEntity](../reference/manifest/rule.md#itemhasknownentity-rule) rule, and may affect the scenarios where you'd otherwise expect your add-in to be activated:</span></span>

- <span data-ttu-id="46806-208">Lorsque vous utilisez la règle, attendez Outlook des chaînes d’entité en anglais uniquement, quels que soient les paramètres régionaux par défaut `ItemHasKnownEntity` spécifiés dans le manifeste.</span><span class="sxs-lookup"><span data-stu-id="46806-208">When using the `ItemHasKnownEntity` rule, expect Outlook to match entity strings in only English regardless of the default locale specified in the manifest.</span></span>
    
- <span data-ttu-id="46806-209">Lorsque votre application est en cours d’exécution sur un client riche Outlook, attendez-vous à ce que Outlook applique la règle au premier mégaoctet du corps de l’élément et non au reste du corps au-dessus de cette `ItemHasKnownEntity` limite.</span><span class="sxs-lookup"><span data-stu-id="46806-209">When your add-in is running on an Outlook rich client, expect Outlook to apply the `ItemHasKnownEntity` rule to the first megabyte of the item body and not to the rest of the body over that limit.</span></span>
    
- <span data-ttu-id="46806-210">Vous ne pouvez pas utiliser une règle pour activer un `ItemHasKnownEntity` add-in pour les éléments du dossier Éléments envoyés.</span><span class="sxs-lookup"><span data-stu-id="46806-210">You cannot use an `ItemHasKnownEntity` rule to activate an add-in for items in the Sent Items folder.</span></span>
    

## <a name="see-also"></a><span data-ttu-id="46806-211">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="46806-211">See also</span></span>

- [<span data-ttu-id="46806-212">Créer des compléments Outlook pour des formulaires de lecture</span><span class="sxs-lookup"><span data-stu-id="46806-212">Create Outlook add-ins for read forms</span></span>](read-scenario.md)
- [<span data-ttu-id="46806-213">Extraire des chaînes d’entité d’un élément Outlook</span><span class="sxs-lookup"><span data-stu-id="46806-213">Extract entity strings from an Outlook item</span></span>](extract-entity-strings-from-an-item.md)
- [<span data-ttu-id="46806-214">Règles d’activation pour les compléments Outlook</span><span class="sxs-lookup"><span data-stu-id="46806-214">Activation rules for Outlook add-ins</span></span>](activation-rules.md)
- [<span data-ttu-id="46806-215">Utiliser des règles d’activation d’expression régulière pour afficher un complément Outlook</span><span class="sxs-lookup"><span data-stu-id="46806-215">Use regular expression activation rules to show an Outlook add-in</span></span>](use-regular-expressions-to-show-an-outlook-add-in.md)
- [<span data-ttu-id="46806-216">Présentation des autorisations de complément Outlook</span><span class="sxs-lookup"><span data-stu-id="46806-216">Understanding Outlook add-in permissions</span></span>](understanding-outlook-add-in-permissions.md)
