---
title: Authentifier un utilisateur avec un jeton à authentification unique
description: Découvrez comment utiliser le jeton d’authentification unique fourni par un complément Outlook pour implémenter l’authentification unique (SSO) sur votre service.
ms.date: 07/30/2020
localization_priority: Normal
ms.openlocfilehash: 79768147fc91a137a363a071beff46cec60ee819
ms.sourcegitcommit: 8fdd7369bfd97a273e222a0404e337ba2b8807b0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/05/2020
ms.locfileid: "46573139"
---
# <a name="authenticate-a-user-with-a-single-sign-on-token-in-an-outlook-add-in"></a><span data-ttu-id="78eac-103">Authentifier un utilisateur avec un jeton d’authentification unique dans un complément Outlook</span><span class="sxs-lookup"><span data-stu-id="78eac-103">Authenticate a user with a single-sign-on token in an Outlook add-in</span></span>

<span data-ttu-id="78eac-104">L’authentification unique (SSO) permet à votre complément d’authentifier les utilisateurs en toute transparence (et éventuellement d’obtenir des jetons d’accès pour appeler l’[API Microsoft Graph](/graph/overview)).</span><span class="sxs-lookup"><span data-stu-id="78eac-104">Single sign-on (SSO) provides a seamless way for your add-in to authenticate users (and optionally to obtain access tokens to call the [Microsoft Graph API](/graph/overview)).</span></span>

<span data-ttu-id="78eac-105">Grâce à cette méthode, votre complément peut obtenir un jeton d’accès inclus dans l’API principale de votre serveur.</span><span class="sxs-lookup"><span data-stu-id="78eac-105">Using this method, your add-in can obtain an access token scoped to your server back-end API.</span></span> <span data-ttu-id="78eac-106">Le complément l’utilise comme un jeton du porteur dans l’en-tête `Authorization` pour authentifier un rappel de votre API.</span><span class="sxs-lookup"><span data-stu-id="78eac-106">The add-in uses this as a bearer token in the `Authorization` header to authenticate a call back to your API.</span></span> <span data-ttu-id="78eac-107">Si vous le souhaitez, vous pouvez également obtenir votre code côté serveur. Pour ce faire, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="78eac-107">Optionally, you can also have your server-side code:</span></span>

- <span data-ttu-id="78eac-108">renseigner le flux De la part de pour obtenir un jeton d’accès inclus dans l’API Microsoft Graph ;</span><span class="sxs-lookup"><span data-stu-id="78eac-108">Complete the On-Behalf-Of flow to obtain an access token scoped to the Microsoft Graph API</span></span>
- <span data-ttu-id="78eac-109">utiliser les informations d’identité dans le jeton pour établir l’identité de l’utilisateur et s’authentifier à vos services principaux.</span><span class="sxs-lookup"><span data-stu-id="78eac-109">Use the identity information in the token to establish the user's identity and authenticate to your own back-end services</span></span>

<span data-ttu-id="78eac-110">Pour une vue d’ensemble de l’authentification unique dans les compléments Office, reportez-vous à [Activer l’authentification unique pour des compléments Office ](../develop/sso-in-office-add-ins.md) et [Autorisation de l’accès à Microsoft Graph dans votre complément Office](../develop/authorize-to-microsoft-graph.md).</span><span class="sxs-lookup"><span data-stu-id="78eac-110">For an overview of SSO in Office Add-ins, see [Enable single sign-on for Office Add-ins](../develop/sso-in-office-add-ins.md) and [Authorize to Microsoft Graph in your Office Add-in](../develop/authorize-to-microsoft-graph.md).</span></span>

## <a name="enable-modern-authentication-in-your-microsoft-365-tenancy"></a><span data-ttu-id="78eac-111">Activer l’authentification moderne dans votre location Microsoft 365</span><span class="sxs-lookup"><span data-stu-id="78eac-111">Enable modern authentication in your Microsoft 365 tenancy</span></span>

<span data-ttu-id="78eac-112">Pour utiliser l’authentification unique (SSO) avec un complément Outlook, vous devez activer l’authentification moderne pour la location Microsoft 365.</span><span class="sxs-lookup"><span data-stu-id="78eac-112">To use SSO with an Outlook add-in, you must enable Modern Authentication for the Microsoft 365 tenancy.</span></span> <span data-ttu-id="78eac-113">Pour plus d’informations sur la manière de procéder, consultez la rubrique [Exchange Online : Activation de votre client pour l’authentification moderne](https://social.technet.microsoft.com/wiki/contents/articles/32711.exchange-online-how-to-enable-your-tenant-for-modern-authentication.aspx).</span><span class="sxs-lookup"><span data-stu-id="78eac-113">For information about how to do this, see [Exchange Online: How to enable your tenant for modern authentication](https://social.technet.microsoft.com/wiki/contents/articles/32711.exchange-online-how-to-enable-your-tenant-for-modern-authentication.aspx).</span></span>

## <a name="register-your-add-in"></a><span data-ttu-id="78eac-114">Inscription de votre complément</span><span class="sxs-lookup"><span data-stu-id="78eac-114">Register your add-in</span></span>

<span data-ttu-id="78eac-115">Pour utiliser l’authentification unique, votre complément Outlook devra avoir une API web côté serveur enregistrée auprès d’Azure Active Directory (AAD) v2.0.</span><span class="sxs-lookup"><span data-stu-id="78eac-115">To use SSO, your Outlook add-in will need to have a server-side web API that is registered with Azure Active Directory (AAD) v2.0.</span></span> <span data-ttu-id="78eac-116">Pour obtenir plus d’informations, reportez-vous à [Enregistrer un complément Office qui utilise l’authentification unique auprès du point de terminaison Azure AD v2.0](../develop/register-sso-add-in-aad-v2.md).</span><span class="sxs-lookup"><span data-stu-id="78eac-116">For more information, see [Register an Office Add-in that uses SSO with the Azure AD v2.0 endpoint](../develop/register-sso-add-in-aad-v2.md).</span></span>

### <a name="provide-consent-when-sideloading-an-add-in"></a><span data-ttu-id="78eac-117">Consentement fourni pendant le chargement indépendant d’un complément</span><span class="sxs-lookup"><span data-stu-id="78eac-117">Provide consent when sideloading an add-in</span></span>

<span data-ttu-id="78eac-118">Lorsque vous développez un complément, vous devez fournir un consentement à l’avance.</span><span class="sxs-lookup"><span data-stu-id="78eac-118">When you are developing an add-in, you will have to provide consent in advance.</span></span> <span data-ttu-id="78eac-119">Pour plus d’informations, consultez [la rubrique accorder le consentement de l’administrateur au complément](../develop/grant-admin-consent-to-an-add-in.md).</span><span class="sxs-lookup"><span data-stu-id="78eac-119">For more information, see [Grant administrator consent to the add-in](../develop/grant-admin-consent-to-an-add-in.md).</span></span>

## <a name="update-the-add-in-manifest"></a><span data-ttu-id="78eac-120">Mise à jour du manifeste de complément</span><span class="sxs-lookup"><span data-stu-id="78eac-120">Update the add-in manifest</span></span>

<span data-ttu-id="78eac-121">Pour activer l’authentification unique dans le complément, vous devez ensuite ajouter un élément `WebApplicationInfo` à la fin de l’élément `VersionOverridesV1_1` [VersionOverrides](../reference/manifest/versionoverrides.md).</span><span class="sxs-lookup"><span data-stu-id="78eac-121">The next step to enable SSO in the add-in is to add a `WebApplicationInfo` element at the end of the `VersionOverridesV1_1` [VersionOverrides](../reference/manifest/versionoverrides.md) element.</span></span> <span data-ttu-id="78eac-122">Pour plus d’informations, reportez-vous à [Configurer le complément](../develop/sso-in-office-add-ins.md#configure-the-add-in).</span><span class="sxs-lookup"><span data-stu-id="78eac-122">For more information, see [Configure the add-in](../develop/sso-in-office-add-ins.md#configure-the-add-in).</span></span>

## <a name="get-the-sso-token"></a><span data-ttu-id="78eac-123">Obtention du jeton SSO</span><span class="sxs-lookup"><span data-stu-id="78eac-123">Get the SSO token</span></span>

<span data-ttu-id="78eac-124">Le complément obtient un jeton SSO avec le script côté client.</span><span class="sxs-lookup"><span data-stu-id="78eac-124">The add-in gets an SSO token with client-side script.</span></span> <span data-ttu-id="78eac-125">Pour plus d’informations, reportez-vous à [Ajouter du code côté client](../develop/sso-in-office-add-ins.md#add-client-side-code).</span><span class="sxs-lookup"><span data-stu-id="78eac-125">For more information, see [Add client-side code](../develop/sso-in-office-add-ins.md#add-client-side-code).</span></span>

## <a name="use-the-sso-token-at-the-back-end"></a><span data-ttu-id="78eac-126">Utilisation du jeton SSO dans le back-end</span><span class="sxs-lookup"><span data-stu-id="78eac-126">Use the SSO token at the back-end</span></span>

<span data-ttu-id="78eac-127">Dans la plupart des scénarios, il n’est pas vraiment utile d’obtenir le jeton d’accès si votre complément ne le transmet pas côté serveur et ne l’utilise pas à cet emplacement.</span><span class="sxs-lookup"><span data-stu-id="78eac-127">In most scenarios, there would be little point to obtaining the access token, if your add-in does not pass it on to a server-side and use it there.</span></span> <span data-ttu-id="78eac-128">Pour plus d’informations sur ce que votre côté serveur peut et doit faire, reportez-vous à la section [Ajouter du code côté serveur](../develop/sso-in-office-add-ins.md#add-server-side-code).</span><span class="sxs-lookup"><span data-stu-id="78eac-128">For details on what your server-side could and should do, see [Add server-side code](../develop/sso-in-office-add-ins.md#add-server-side-code).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="78eac-129">Quand vous utilisez le jeton SSO sous forme d’identité dans le complément *Outlook*, nous vous recommandons d’[utiliser le jeton d’identité Exchange](authenticate-a-user-with-an-identity-token.md) comme identité alternative.</span><span class="sxs-lookup"><span data-stu-id="78eac-129">When using the SSO token as an identity in an *Outlook* add-in, we recommend that you also [use the Exchange identity token](authenticate-a-user-with-an-identity-token.md) as an alternate identity.</span></span> <span data-ttu-id="78eac-130">Les utilisateurs de votre complément peuvent utiliser plusieurs clients, dont certains ne fourniront peut-être pas de jeton SSO.</span><span class="sxs-lookup"><span data-stu-id="78eac-130">Users of your add-in may use multiple clients, and some may not support providing an SSO token.</span></span> <span data-ttu-id="78eac-131">En utilisant le jeton d’identité Exchange comme alternative, vous pouvez éviter d’inviter les utilisateurs à entrer leurs informations d’identification plusieurs fois.</span><span class="sxs-lookup"><span data-stu-id="78eac-131">By using the Exchange identity token as an alternate, you can avoid having to prompt these users for credentials multiple times.</span></span> <span data-ttu-id="78eac-132">Pour plus d’informations, voir[Scénario : Implémenter l’authentification unique sur votre service dans un complément Outlook](implement-sso-in-outlook-add-in.md).</span><span class="sxs-lookup"><span data-stu-id="78eac-132">For more information, see [Scenario: Implement single sign-on to your service in an Outlook add-in](implement-sso-in-outlook-add-in.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="78eac-133">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="78eac-133">See also</span></span>

- <span data-ttu-id="78eac-134">Pour consulter un exemple de complément Outlook qui utilise le jeton SSO pour accéder à l’API Microsoft Graph, consultez la rubrique relative à l’[exemple de complément AttachmentsDemo](https://github.com/OfficeDev/outlook-add-in-attachments-demo).</span><span class="sxs-lookup"><span data-stu-id="78eac-134">For a sample Outlook add-in that uses the SSO token to access the Microsoft Graph API, see [AttachmentsDemo Sample Add-in](https://github.com/OfficeDev/outlook-add-in-attachments-demo).</span></span>
- [<span data-ttu-id="78eac-135">Référence d’API SSO</span><span class="sxs-lookup"><span data-stu-id="78eac-135">SSO API reference</span></span>](../develop/sso-in-office-add-ins.md#sso-api-reference)
- [<span data-ttu-id="78eac-136">Ensemble d’exigences IdentityAPI</span><span class="sxs-lookup"><span data-stu-id="78eac-136">IdentityAPI requirement set</span></span>](../reference/requirement-sets/identity-api-requirement-sets.md)
