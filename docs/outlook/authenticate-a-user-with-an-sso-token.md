---
title: Authentifier un utilisateur avec un jeton à authentification unique
description: Découvrez comment utiliser le jeton d’authentification unique fourni par un complément Outlook pour implémenter l’authentification unique (SSO) sur votre service.
ms.date: 04/28/2020
localization_priority: Normal
ms.openlocfilehash: d53e75faa2d0471b43957cfa71ff6f6a50a0da4f
ms.sourcegitcommit: 7ef14753dce598a5804dad8802df7aaafe046da7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/10/2020
ms.locfileid: "45093979"
---
# <a name="authenticate-a-user-with-a-single-sign-on-token-in-an-outlook-add-in-preview"></a><span data-ttu-id="98e03-103">Authentification d’un utilisateur avec un jeton d’authentification unique dans un complément Outlook (préversion)</span><span class="sxs-lookup"><span data-stu-id="98e03-103">Authenticate a user with a single-sign-on token in an Outlook add-in (preview)</span></span>

<span data-ttu-id="98e03-104">L’authentification unique (SSO) permet à votre complément d’authentifier les utilisateurs en toute transparence (et éventuellement d’obtenir des jetons d’accès pour appeler l’[API Microsoft Graph](/graph/overview)).</span><span class="sxs-lookup"><span data-stu-id="98e03-104">Single sign-on (SSO) provides a seamless way for your add-in to authenticate users (and optionally to obtain access tokens to call the [Microsoft Graph API](/graph/overview)).</span></span>

<span data-ttu-id="98e03-105">Grâce à cette méthode, votre complément peut obtenir un jeton d’accès inclus dans l’API principale de votre serveur.</span><span class="sxs-lookup"><span data-stu-id="98e03-105">Using this method, your add-in can obtain an access token scoped to your server back-end API.</span></span> <span data-ttu-id="98e03-106">Le complément l’utilise comme un jeton du porteur dans l’en-tête `Authorization` pour authentifier un rappel de votre API.</span><span class="sxs-lookup"><span data-stu-id="98e03-106">The add-in uses this as a bearer token in the `Authorization` header to authenticate a call back to your API.</span></span> <span data-ttu-id="98e03-107">Si vous le souhaitez, vous pouvez également obtenir votre code côté serveur. Pour ce faire, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="98e03-107">Optionally, you can also have your server-side code:</span></span>

- <span data-ttu-id="98e03-108">renseigner le flux De la part de pour obtenir un jeton d’accès inclus dans l’API Microsoft Graph ;</span><span class="sxs-lookup"><span data-stu-id="98e03-108">Complete the On-Behalf-Of flow to obtain an access token scoped to the Microsoft Graph API</span></span>
- <span data-ttu-id="98e03-109">utiliser les informations d’identité dans le jeton pour établir l’identité de l’utilisateur et s’authentifier à vos services principaux.</span><span class="sxs-lookup"><span data-stu-id="98e03-109">Use the identity information in the token to establish the user's identity and authenticate to your own back-end services</span></span>

<span data-ttu-id="98e03-110">Pour une vue d’ensemble de l’authentification unique dans les compléments Office, reportez-vous à [Activer l’authentification unique pour des compléments Office ](../develop/sso-in-office-add-ins.md) et [Autorisation de l’accès à Microsoft Graph dans votre complément Office](../develop/authorize-to-microsoft-graph.md).</span><span class="sxs-lookup"><span data-stu-id="98e03-110">For an overview of SSO in Office Add-ins, see [Enable single sign-on for Office Add-ins](../develop/sso-in-office-add-ins.md) and [Authorize to Microsoft Graph in your Office Add-in](../develop/authorize-to-microsoft-graph.md).</span></span>

> [!NOTE]
> <span data-ttu-id="98e03-111">Pour utiliser l’authentification unique SSO, vous devez télécharger la version bêta de la bibliothèque JavaScript d’Office à partir de https://appsforoffice.microsoft.com/lib/beta/hosted/office.js dans la page de démarrage HTML du complément.</span><span class="sxs-lookup"><span data-stu-id="98e03-111">To use SSO, you must load the beta version of the Office JavaScript Library from https://appsforoffice.microsoft.com/lib/beta/hosted/office.js in the startup HTML page of the add-in.</span></span> <span data-ttu-id="98e03-112">Toutefois, vous ne devez **pas** utiliser les API bêta dans les compléments de production.</span><span class="sxs-lookup"><span data-stu-id="98e03-112">However, you should **not** use beta APIs in production add-ins.</span></span>

## <a name="enable-modern-authentication-in-your-microsoft-365-tenancy"></a><span data-ttu-id="98e03-113">Activer l’authentification moderne dans votre location Microsoft 365</span><span class="sxs-lookup"><span data-stu-id="98e03-113">Enable modern authentication in your Microsoft 365 tenancy</span></span>

<span data-ttu-id="98e03-114">Pour utiliser l’authentification unique (SSO) avec un complément Outlook, vous devez activer l’authentification moderne pour la location Microsoft 365.</span><span class="sxs-lookup"><span data-stu-id="98e03-114">To use SSO with an Outlook add-in, you must enable Modern Authentication for the Microsoft 365 tenancy.</span></span> <span data-ttu-id="98e03-115">Pour plus d’informations sur la manière de procéder, consultez la rubrique [Exchange Online : Activation de votre client pour l’authentification moderne](https://social.technet.microsoft.com/wiki/contents/articles/32711.exchange-online-how-to-enable-your-tenant-for-modern-authentication.aspx).</span><span class="sxs-lookup"><span data-stu-id="98e03-115">For information about how to do this, see [Exchange Online: How to enable your tenant for modern authentication](https://social.technet.microsoft.com/wiki/contents/articles/32711.exchange-online-how-to-enable-your-tenant-for-modern-authentication.aspx).</span></span>

## <a name="register-your-add-in"></a><span data-ttu-id="98e03-116">Inscription de votre complément</span><span class="sxs-lookup"><span data-stu-id="98e03-116">Register your add-in</span></span>

<span data-ttu-id="98e03-117">Pour utiliser l’authentification unique, votre complément Outlook devra avoir une API web côté serveur enregistrée auprès d’Azure Active Directory (AAD) v2.0.</span><span class="sxs-lookup"><span data-stu-id="98e03-117">To use SSO, your Outlook add-in will need to have a server-side web API that is registered with Azure Active Directory (AAD) v2.0.</span></span> <span data-ttu-id="98e03-118">Pour obtenir plus d’informations, reportez-vous à [Enregistrer un complément Office qui utilise l’authentification unique auprès du point de terminaison Azure AD v2.0](../develop/register-sso-add-in-aad-v2.md).</span><span class="sxs-lookup"><span data-stu-id="98e03-118">For more information, see [Register an Office Add-in that uses SSO with the Azure AD v2.0 endpoint](../develop/register-sso-add-in-aad-v2.md).</span></span>

### <a name="provide-consent-when-sideloading-an-add-in"></a><span data-ttu-id="98e03-119">Consentement fourni pendant le chargement indépendant d’un complément</span><span class="sxs-lookup"><span data-stu-id="98e03-119">Provide consent when sideloading an add-in</span></span>

<span data-ttu-id="98e03-120">Quand un complément qui utilise l’authentification unique est acquis sur l’AppSource, l’interface utilisateur Store invite l’utilisateur à accepter les demandes d’autorisation Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="98e03-120">When an add-in that uses SSO is acquired from AppSource, the store UI handles prompting the user for consent to the requested Graph permissions.</span></span> <span data-ttu-id="98e03-121">Par contre, quand vous développez un complément, vous devez fournir le consentement à l’avance.</span><span class="sxs-lookup"><span data-stu-id="98e03-121">However, when you are developing an add-in, you have to provide consent in advance.</span></span> <span data-ttu-id="98e03-122">Pour plus d’informations, reportez-vous à [Accorder le consentement de l’administrateur au complément](../develop/grant-admin-consent-to-an-add-in.md).</span><span class="sxs-lookup"><span data-stu-id="98e03-122">For more information, see [Grant administrator consent to the add-in](../develop/grant-admin-consent-to-an-add-in.md)</span></span>

## <a name="update-the-add-in-manifest"></a><span data-ttu-id="98e03-123">Mise à jour du manifeste de complément</span><span class="sxs-lookup"><span data-stu-id="98e03-123">Update the add-in manifest</span></span>

<span data-ttu-id="98e03-124">Pour activer l’authentification unique dans le complément, vous devez ensuite ajouter un élément `WebApplicationInfo` à la fin de l’élément `VersionOverridesV1_1` [VersionOverrides](../reference/manifest/versionoverrides.md).</span><span class="sxs-lookup"><span data-stu-id="98e03-124">The next step to enable SSO in the add-in is to add a `WebApplicationInfo` element at the end of the `VersionOverridesV1_1` [VersionOverrides](../reference/manifest/versionoverrides.md) element.</span></span> <span data-ttu-id="98e03-125">Pour plus d’informations, reportez-vous à [Configurer le complément](../develop/sso-in-office-add-ins.md#configure-the-add-in).</span><span class="sxs-lookup"><span data-stu-id="98e03-125">For more information, see [Configure the add-in](../develop/sso-in-office-add-ins.md#configure-the-add-in).</span></span>

## <a name="get-the-sso-token"></a><span data-ttu-id="98e03-126">Obtention du jeton SSO</span><span class="sxs-lookup"><span data-stu-id="98e03-126">Get the SSO token</span></span>

<span data-ttu-id="98e03-127">Le complément obtient un jeton SSO avec le script côté client.</span><span class="sxs-lookup"><span data-stu-id="98e03-127">The add-in gets an SSO token with client-side script.</span></span> <span data-ttu-id="98e03-128">Pour plus d’informations, reportez-vous à [Ajouter du code côté client](../develop/sso-in-office-add-ins.md#add-client-side-code).</span><span class="sxs-lookup"><span data-stu-id="98e03-128">For more information, see [Add client-side code](../develop/sso-in-office-add-ins.md#add-client-side-code).</span></span>

## <a name="use-the-sso-token-at-the-back-end"></a><span data-ttu-id="98e03-129">Utilisation du jeton SSO dans le back-end</span><span class="sxs-lookup"><span data-stu-id="98e03-129">Use the SSO token at the back-end</span></span>

<span data-ttu-id="98e03-130">Dans la plupart des scénarios, il n’est pas vraiment utile d’obtenir le jeton d’accès si votre complément ne le transmet pas côté serveur et ne l’utilise pas à cet emplacement.</span><span class="sxs-lookup"><span data-stu-id="98e03-130">In most scenarios, there would be little point to obtaining the access token, if your add-in does not pass it on to a server-side and use it there.</span></span> <span data-ttu-id="98e03-131">Pour plus d’informations sur ce que votre côté serveur peut et doit faire, reportez-vous à la section [Ajouter du code côté serveur](../develop/sso-in-office-add-ins.md#add-server-side-code).</span><span class="sxs-lookup"><span data-stu-id="98e03-131">For details on what your server-side could and should do, see [Add server-side code](../develop/sso-in-office-add-ins.md#add-server-side-code).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="98e03-132">Quand vous utilisez le jeton SSO sous forme d’identité dans le complément *Outlook*, nous vous recommandons d’[utiliser le jeton d’identité Exchange](authenticate-a-user-with-an-identity-token.md) comme identité alternative.</span><span class="sxs-lookup"><span data-stu-id="98e03-132">When using the SSO token as an identity in an *Outlook* add-in, we recommend that you also [use the Exchange identity token](authenticate-a-user-with-an-identity-token.md) as an alternate identity.</span></span> <span data-ttu-id="98e03-133">Les utilisateurs de votre complément peuvent utiliser plusieurs clients, dont certains ne fourniront peut-être pas de jeton SSO.</span><span class="sxs-lookup"><span data-stu-id="98e03-133">Users of your add-in may use multiple clients, and some may not support providing an SSO token.</span></span> <span data-ttu-id="98e03-134">En utilisant le jeton d’identité Exchange comme alternative, vous pouvez éviter d’inviter les utilisateurs à entrer leurs informations d’identification plusieurs fois.</span><span class="sxs-lookup"><span data-stu-id="98e03-134">By using the Exchange identity token as an alternate, you can avoid having to prompt these users for credentials multiple times.</span></span> <span data-ttu-id="98e03-135">Pour plus d’informations, voir[Scénario : Implémenter l’authentification unique sur votre service dans un complément Outlook](implement-sso-in-outlook-add-in.md).</span><span class="sxs-lookup"><span data-stu-id="98e03-135">For more information, see [Scenario: Implement single sign-on to your service in an Outlook add-in](implement-sso-in-outlook-add-in.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="98e03-136">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="98e03-136">See also</span></span>

- <span data-ttu-id="98e03-137">Pour consulter un exemple de complément Outlook qui utilise le jeton SSO pour accéder à l’API Microsoft Graph, consultez la rubrique relative à l’[exemple de complément AttachmentsDemo](https://github.com/OfficeDev/outlook-add-in-attachments-demo).</span><span class="sxs-lookup"><span data-stu-id="98e03-137">For a sample Outlook add-in that uses the SSO token to access the Microsoft Graph API, see [AttachmentsDemo Sample Add-in](https://github.com/OfficeDev/outlook-add-in-attachments-demo).</span></span>
- [<span data-ttu-id="98e03-138">Référence d’API SSO</span><span class="sxs-lookup"><span data-stu-id="98e03-138">SSO API reference</span></span>](../develop/sso-in-office-add-ins.md#sso-api-reference)
- [<span data-ttu-id="98e03-139">Ensemble d’exigences IdentityAPI</span><span class="sxs-lookup"><span data-stu-id="98e03-139">IdentityAPI requirement set</span></span>](../reference/requirement-sets/identity-api-requirement-sets.md)
