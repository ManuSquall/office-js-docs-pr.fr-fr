---
title: Options d’authentification dans les compléments Outlook
description: Les compléments Outlook offrent différentes méthodes qui permettent de s’authentifier en fonction de votre scénario.
ms.date: 11/10/2020
localization_priority: Priority
ms.openlocfilehash: 54584483b7d4fd75e3f2d6c3188465333e9f58d5
ms.sourcegitcommit: ca66ff7462bfdf4ed7ae04f43d1388c24de63bf9
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/11/2020
ms.locfileid: "48996395"
---
# <a name="authentication-options-in-outlook-add-ins"></a><span data-ttu-id="9178e-103">Options d’authentification dans les compléments Outlook</span><span class="sxs-lookup"><span data-stu-id="9178e-103">Authentication options in Outlook add-ins</span></span>

<span data-ttu-id="9178e-104">Votre complément Outlook peut accéder à des informations à partir de n’importe quel emplacement sur Internet, qu’il s’agisse du serveur qui héberge le complément, de votre réseau interne ou du cloud.</span><span class="sxs-lookup"><span data-stu-id="9178e-104">Your Outlook add-in can access information from anywhere on the Internet, whether from the server that hosts the add-in, from your internal network, or from somewhere else in the cloud.</span></span> <span data-ttu-id="9178e-105">Si ces informations sont protégées, votre complément doit trouver un moyen d’authentifier votre utilisateur.</span><span class="sxs-lookup"><span data-stu-id="9178e-105">If that information is protected, your add-in needs a way to authenticate your user.</span></span> <span data-ttu-id="9178e-106">Les compléments Outlook offrent différentes méthodes qui permettent de s’authentifier en fonction de votre scénario.</span><span class="sxs-lookup"><span data-stu-id="9178e-106">Outlook add-ins provide a number of different methods to authenticate, depending on your specific scenario.</span></span>

## <a name="single-sign-on-access-token"></a><span data-ttu-id="9178e-107">Jeton d’accès à authentification unique</span><span class="sxs-lookup"><span data-stu-id="9178e-107">Single sign-on access token</span></span>

<span data-ttu-id="9178e-108">Les jetons d’accès à authentification unique permettent à votre complément de s’authentifier en toute transparence et d’obtenir des jetons d’accès pour appeler l’[API Microsoft Graph](/graph/overview).</span><span class="sxs-lookup"><span data-stu-id="9178e-108">Single sign-on access tokens provide a seamless way for your add-in to authenticate and obtain access tokens to call the [Microsoft Graph API](/graph/overview).</span></span> <span data-ttu-id="9178e-109">Cette fonctionnalité réduit la friction étant donné que l’utilisateur n’a pas besoin de saisir ses informations d’identification.</span><span class="sxs-lookup"><span data-stu-id="9178e-109">This capability reduces friction since the user is not required to enter their credentials.</span></span>

> [!NOTE]
> <span data-ttu-id="9178e-110">La connexion unique sur API est actuellement prise en charge pour Word, Excel et PowerPoint.</span><span class="sxs-lookup"><span data-stu-id="9178e-110">The Single Sign-on API is currently supported for Word, Excel, Outlook, and PowerPoint.</span></span> <span data-ttu-id="9178e-111">Pour plus d’informations sur l’endroit où l’API d’authentification unique est actuellement prise en charge, consultez la rubrique [Ensembles de conditions requises de l’API d’identité](../reference/requirement-sets/identity-api-requirement-sets.md).</span><span class="sxs-lookup"><span data-stu-id="9178e-111">For more information about where the Single Sign-on API is currently supported, see [IdentityAPI requirement sets](../reference/requirement-sets/identity-api-requirement-sets.md).</span></span>
> <span data-ttu-id="9178e-112">Si vous utilisez un complément Outlook, veillez à activer l’authentification moderne pour la location d’Office 365.</span><span class="sxs-lookup"><span data-stu-id="9178e-112">If you are working with an Outlook add-in, be sure to enable Modern Authentication for the Office 365 tenancy.</span></span> <span data-ttu-id="9178e-113">Pour plus d’informations sur la manière de procéder, voir [Exchange Online : Activation de votre client pour l’authentification moderne](https://social.technet.microsoft.com/wiki/contents/articles/32711.exchange-online-how-to-enable-your-tenant-for-modern-authentication.aspx).</span><span class="sxs-lookup"><span data-stu-id="9178e-113">For information about how to do this, see [Exchange Online: How to enable your tenant for modern authentication](https://social.technet.microsoft.com/wiki/contents/articles/32711.exchange-online-how-to-enable-your-tenant-for-modern-authentication.aspx).</span></span>

<span data-ttu-id="9178e-114">Vous pouvez utiliser des jetons d’accès d’authentification unique si votre complément :</span><span class="sxs-lookup"><span data-stu-id="9178e-114">Consider using SSO access tokens if your add-in:</span></span>

- <span data-ttu-id="9178e-115">Est principalement utilisé par les utilisateurs de Microsoft 365</span><span class="sxs-lookup"><span data-stu-id="9178e-115">Is used primarily by Microsoft 365 users</span></span>
- <span data-ttu-id="9178e-116">doit accéder à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="9178e-116">Needs access to:</span></span>
  - <span data-ttu-id="9178e-117">Services Microsoft exposés dans le cadre de Microsoft Graph ;</span><span class="sxs-lookup"><span data-stu-id="9178e-117">Microsoft services that are exposed as part of Microsoft Graph</span></span>
  - <span data-ttu-id="9178e-118">Service non-Microsoft que vous contrôlez.</span><span class="sxs-lookup"><span data-stu-id="9178e-118">A non-Microsoft service that you control</span></span>

<span data-ttu-id="9178e-119">La méthode d’authentification unique utilise le flux [OAuth2 De la part de fourni par Azure Active Directory](/azure/active-directory/develop/active-directory-v2-protocols-oauth-on-behalf-of).</span><span class="sxs-lookup"><span data-stu-id="9178e-119">The SSO authentication method uses the [OAuth2 On-Behalf-Of flow provided by Azure Active Directory](/azure/active-directory/develop/active-directory-v2-protocols-oauth-on-behalf-of).</span></span> <span data-ttu-id="9178e-120">Cela nécessite l’enregistrement du complément dans le [portail d’inscription des applications](https://apps.dev.microsoft.com/) et la spécification de toute étendue Microsoft Graph requise dans son manifeste.</span><span class="sxs-lookup"><span data-stu-id="9178e-120">It requires that the add-in register in the [Application Registration Portal](https://apps.dev.microsoft.com/) and specify any required Microsoft Graph scopes in its manifest.</span></span>

<span data-ttu-id="9178e-121">Grâce à cette méthode, votre complément peut obtenir un jeton d’accès inclus dans l’API principale de votre serveur.</span><span class="sxs-lookup"><span data-stu-id="9178e-121">Using this method, your add-in can obtain an access token scoped to your server back-end API.</span></span> <span data-ttu-id="9178e-122">Le complément l’utilise comme un jeton du porteur dans l’en-tête `Authorization` pour authentifier un rappel de votre API.</span><span class="sxs-lookup"><span data-stu-id="9178e-122">The add-in uses this as a bearer token in the `Authorization` header to authenticate a call back to your API.</span></span> <span data-ttu-id="9178e-123">À ce stade, votre serveur peut :</span><span class="sxs-lookup"><span data-stu-id="9178e-123">At that point your server can:</span></span>

- <span data-ttu-id="9178e-124">renseigner le flux De la part de pour obtenir un jeton d’accès inclus dans l’API Microsoft Graph ;</span><span class="sxs-lookup"><span data-stu-id="9178e-124">Complete the On-Behalf-Of flow to obtain an access token scoped to the Microsoft Graph API</span></span>
- <span data-ttu-id="9178e-125">utiliser les informations d’identité dans le jeton pour établir l’identité de l’utilisateur et s’authentifier à vos propres services principaux.</span><span class="sxs-lookup"><span data-stu-id="9178e-125">Use the identity information in the token to establish the user's identity and authenticate to your own back-end services</span></span>

<span data-ttu-id="9178e-126">Pour obtenir un aperçu plus détaillé, consultez la [présentation complète de la méthode d’authentification unique](../develop/sso-in-office-add-ins.md).</span><span class="sxs-lookup"><span data-stu-id="9178e-126">For a more detailed overview, see the [full overview of the SSO authentication method](../develop/sso-in-office-add-ins.md).</span></span>

<span data-ttu-id="9178e-127">Pour plus d’informations sur l’utilisation du jeton à authentification unique dans un complément Outlook, consultez la section [Authentifier un utilisateur avec un jeton à authentification unique dans un complément Outlook](authenticate-a-user-with-an-sso-token.md).</span><span class="sxs-lookup"><span data-stu-id="9178e-127">For details on using the SSO token in an Outlook add-in, see [Authenticate a user with an single-sign-on token in an Outlook add-in](authenticate-a-user-with-an-sso-token.md).</span></span>

<span data-ttu-id="9178e-128">Pour un complément échantillon qui utilise le jeton à authentification unique, consultez [Authentification unique d’un complément Outlook](https://github.com/OfficeDev/Outlook-Add-in-SSO).</span><span class="sxs-lookup"><span data-stu-id="9178e-128">For a sample add-in that uses the SSO token, see [Outlook Add-in SSO](https://github.com/OfficeDev/Outlook-Add-in-SSO).</span></span>

## <a name="exchange-user-identity-token"></a><span data-ttu-id="9178e-129">Jeton d’identité d’utilisateur Exchange</span><span class="sxs-lookup"><span data-stu-id="9178e-129">Exchange user identity token</span></span>

<span data-ttu-id="9178e-130">Les jetons d’identité d’utilisateur Exchange permettent à votre complément d’établir l’identité de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="9178e-130">Exchange user identity tokens provide a way for your add-in to establish the identity of the user.</span></span> <span data-ttu-id="9178e-131">En vérifiant l’identité de l’utilisateur, vous pouvez ensuite effectuer une authentification unique dans votre système principal, puis accepter le jeton d’identité d’utilisateur comme une autorisation pour les demandes futures.</span><span class="sxs-lookup"><span data-stu-id="9178e-131">By verifying the user's identity, you can then perform a one-time authentication into your back-end system, then accept the user identity token as an authorization for future requests.</span></span> <span data-ttu-id="9178e-132">Utilisez le jeton d’identité d’utilisateur Exchange :</span><span class="sxs-lookup"><span data-stu-id="9178e-132">Use the Exchange user identity token:</span></span>

- <span data-ttu-id="9178e-133">quand le complément est utilisé principalement par des utilisateurs locaux Exchange ;</span><span class="sxs-lookup"><span data-stu-id="9178e-133">When the add-in is used primarily by Exchange on-premises users.</span></span>
- <span data-ttu-id="9178e-134">quand le complément doit accéder à un service non-Microsoft que vous contrôlez ;</span><span class="sxs-lookup"><span data-stu-id="9178e-134">When the add-in needs access to a non-Microsoft service that you control.</span></span>
- <span data-ttu-id="9178e-135">en tant qu’authentification de secours (et d’autorisation à Microsoft Graph) quand le complément est exécuté sur une version d’Office qui ne prend pas en charge SSO.</span><span class="sxs-lookup"><span data-stu-id="9178e-135">As a fallback authentication (and authorization to Microsoft Graph) when the add-in is running on a version of Office that doesn't support SSO.</span></span>

<span data-ttu-id="9178e-136">Votre complément peut appeler la méthode [getUserIdentityTokenAsync](/javascript/api/outlook/office.mailbox#getuseridentitytokenasync-callback--usercontext-) pour obtenir des jetons d’identité d’utilisateur Exchange.</span><span class="sxs-lookup"><span data-stu-id="9178e-136">Your add-in can call [getUserIdentityTokenAsync](/javascript/api/outlook/office.mailbox#getuseridentitytokenasync-callback--usercontext-) to get Exchange user identity tokens.</span></span> <span data-ttu-id="9178e-137">Pour plus d’informations sur l’utilisation de ces jetons, voir [Authentifier un utilisateur avec un jeton d’identité pour Exchange](authenticate-a-user-with-an-identity-token.md).</span><span class="sxs-lookup"><span data-stu-id="9178e-137">For details on using these tokens, see [Authenticate a user with an identity token for Exchange](authenticate-a-user-with-an-identity-token.md).</span></span>

## <a name="access-tokens-obtained-via-oauth2-flows"></a><span data-ttu-id="9178e-138">Jetons d’accès obtenus via les flux OAuth2</span><span class="sxs-lookup"><span data-stu-id="9178e-138">Access tokens obtained via OAuth2 flows</span></span>

<span data-ttu-id="9178e-139">Les compléments peuvent également accéder à des services tiers qui prennent en charge les flux OAuth2 pour l’autorisation.</span><span class="sxs-lookup"><span data-stu-id="9178e-139">Add-ins can also access third-party services that support OAuth2 for authorization.</span></span> <span data-ttu-id="9178e-140">Vous pouvez utiliser les jetons OAuth2 si votre complément :</span><span class="sxs-lookup"><span data-stu-id="9178e-140">Consider using OAuth2 tokens if your add-in:</span></span>

- <span data-ttu-id="9178e-141">doit accéder à un service tiers en dehors de votre contrôle.</span><span class="sxs-lookup"><span data-stu-id="9178e-141">Needs access to a third-party service outside of your control</span></span>

<span data-ttu-id="9178e-142">Grâce à cette méthode, votre complément invite l’utilisateur à se connecter au service à l’aide de la méthode [displayDialogAsync](/javascript/api/office/office.ui#displaydialogasync-startaddress--options--callback-) pour initialiser le flux OAuth2 ou à l’aide de la bibliothèque [office-js-helpers](https://github.com/OfficeDev/office-js-helpers) pour le flux implicite OAuth2.</span><span class="sxs-lookup"><span data-stu-id="9178e-142">Using this method, your add-in prompts the user to sign-in to the service either by using the [displayDialogAsync](/javascript/api/office/office.ui#displaydialogasync-startaddress--options--callback-) method to initialize the OAuth2 flow, or by using the [office-js-helpers library](https://github.com/OfficeDev/office-js-helpers) to the OAuth2 Implicit flow.</span></span>

## <a name="callback-tokens"></a><span data-ttu-id="9178e-143">Jetons de rappel</span><span class="sxs-lookup"><span data-stu-id="9178e-143">Callback tokens</span></span>

<span data-ttu-id="9178e-144">Les jetons de rappel permettent d’accéder à la boîte aux lettres de l’utilisateur à partir de votre serveur principal à l’aide d’[Exchange Web Services (EWS)](/exchange/client-developer/exchange-web-services/explore-the-ews-managed-api-ews-and-web-services-in-exchange) ou de l’[API REST Outlook](/previous-versions/office/office-365-api/api/version-2.0/use-outlook-rest-api).</span><span class="sxs-lookup"><span data-stu-id="9178e-144">Callback tokens provide access to the user's mailbox from your server back-end, either using [Exchange Web Services (EWS)](/exchange/client-developer/exchange-web-services/explore-the-ews-managed-api-ews-and-web-services-in-exchange), or the [Outlook REST API](/previous-versions/office/office-365-api/api/version-2.0/use-outlook-rest-api).</span></span> <span data-ttu-id="9178e-145">Vous pouvez utiliser les jetons de rappel si votre complément :</span><span class="sxs-lookup"><span data-stu-id="9178e-145">Consider using callback tokens if your add-in:</span></span>

- <span data-ttu-id="9178e-146">Doit accéder à la boîte aux lettres de l’utilisateur à partir de votre serveur principal.</span><span class="sxs-lookup"><span data-stu-id="9178e-146">Needs access to the user's mailbox from your server back-end.</span></span>

<span data-ttu-id="9178e-147">Les compléments obtiennent des jetons de rappel à l’aide d’une méthode [getCallbackTokenAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods).</span><span class="sxs-lookup"><span data-stu-id="9178e-147">Add-ins obtain callback tokens using one of the [getCallbackTokenAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods) methods.</span></span> <span data-ttu-id="9178e-148">Le niveau d’accès est contrôlé par les autorisations spécifiées dans le manifeste du complément.</span><span class="sxs-lookup"><span data-stu-id="9178e-148">The level of access is controlled by the permissions specified in the add-in manifest.</span></span>
