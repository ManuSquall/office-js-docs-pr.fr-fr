---
title: Options d’authentification dans les compléments Outlook
description: Les compléments Outlook offrent différentes méthodes qui permettent de s’authentifier en fonction de votre scénario.
ms.date: 11/05/2019
localization_priority: Priority
ms.openlocfilehash: 2913f770b1f0335aae4634d95b8492b204d1e577
ms.sourcegitcommit: a0262ea40cd23f221e69bcb0223110f011265d13
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/17/2020
ms.locfileid: "42688964"
---
# <a name="authentication-options-in-outlook-add-ins"></a><span data-ttu-id="acd51-103">Options d’authentification dans les compléments Outlook</span><span class="sxs-lookup"><span data-stu-id="acd51-103">Authentication options in Outlook add-ins</span></span>

<span data-ttu-id="acd51-104">Votre complément Outlook peut accéder à des informations à partir de n’importe quel emplacement sur Internet, qu’il s’agisse du serveur qui héberge le complément, de votre réseau interne ou du cloud.</span><span class="sxs-lookup"><span data-stu-id="acd51-104">Your Outlook add-in can access information from anywhere on the Internet, whether from the server that hosts the add-in, from your internal network, or from somewhere else in the cloud.</span></span> <span data-ttu-id="acd51-105">Si ces informations sont protégées, votre complément doit trouver un moyen d’authentifier votre utilisateur.</span><span class="sxs-lookup"><span data-stu-id="acd51-105">If that information is protected, your add-in needs a way to authenticate your user.</span></span> <span data-ttu-id="acd51-106">Les compléments Outlook offrent différentes méthodes qui permettent de s’authentifier en fonction de votre scénario.</span><span class="sxs-lookup"><span data-stu-id="acd51-106">Outlook add-ins provide a number of different methods to authenticate, depending on your specific scenario.</span></span>

## <a name="single-sign-on-access-token"></a><span data-ttu-id="acd51-107">Jeton d’accès à authentification unique</span><span class="sxs-lookup"><span data-stu-id="acd51-107">Single sign-on access token</span></span>

<span data-ttu-id="acd51-108">Les jetons d’accès à authentification unique permettent à votre complément de s’authentifier en toute transparence et d’obtenir des jetons d’accès pour appeler l’[API Microsoft Graph](/graph/overview).</span><span class="sxs-lookup"><span data-stu-id="acd51-108">Single sign-on access tokens provide a seamless way for your add-in to authenticate and obtain access tokens to call the [Microsoft Graph API](/graph/overview).</span></span> <span data-ttu-id="acd51-109">Cette fonctionnalité réduit la friction étant donné que l’utilisateur n’a pas besoin de saisir ses informations d’identification.</span><span class="sxs-lookup"><span data-stu-id="acd51-109">This capability reduces friction since the user is not required to enter their credentials.</span></span>

> [!NOTE]
> <span data-ttu-id="acd51-110">L’API d’authentification unique est actuellement prise en charge en préversion pour Word, Excel, Outlook et PowerPoint.</span><span class="sxs-lookup"><span data-stu-id="acd51-110">The Single Sign-on API is currently supported in preview for Word, Excel, Outlook, and PowerPoint.</span></span> <span data-ttu-id="acd51-111">Pour savoir où l’API d’authentification unique est actuellement prise en charge, voir [Ensembles de conditions requises de l’API d’identité](../reference/requirement-sets/identity-api-requirement-sets.md).</span><span class="sxs-lookup"><span data-stu-id="acd51-111">For more information about where the Single Sign-on API is currently supported, see [IdentityAPI requirement sets](../reference/requirement-sets/identity-api-requirement-sets.md).</span></span>
> <span data-ttu-id="acd51-112">Pour utiliser l’authentification unique (SSO), vous devez télécharger la version bêta de la bibliothèque JavaScript d’Office à partir de https://appsforoffice.microsoft.com/lib/beta/hosted/office.js dans la page de démarrage HTML du complément.</span><span class="sxs-lookup"><span data-stu-id="acd51-112">To use SSO, you must load the beta version of the Office JavaScript Library from https://appsforoffice.microsoft.com/lib/beta/hosted/office.js in the startup HTML page of the add-in.</span></span>
> <span data-ttu-id="acd51-113">Si vous utilisez un complément Outlook, veillez à activer l’authentification moderne pour la location d’Office 365.</span><span class="sxs-lookup"><span data-stu-id="acd51-113">If you are working with an Outlook add-in, be sure to enable Modern Authentication for the Office 365 tenancy.</span></span> <span data-ttu-id="acd51-114">Pour plus d’informations sur la manière de procéder, voir [Exchange Online : Activation de votre client pour l’authentification moderne](https://social.technet.microsoft.com/wiki/contents/articles/32711.exchange-online-how-to-enable-your-tenant-for-modern-authentication.aspx).</span><span class="sxs-lookup"><span data-stu-id="acd51-114">For information about how to do this, see [Exchange Online: How to enable your tenant for modern authentication](https://social.technet.microsoft.com/wiki/contents/articles/32711.exchange-online-how-to-enable-your-tenant-for-modern-authentication.aspx).</span></span>

<span data-ttu-id="acd51-115">Vous pouvez utiliser des jetons d’accès d’authentification unique si votre complément :</span><span class="sxs-lookup"><span data-stu-id="acd51-115">Consider using SSO access tokens if your add-in:</span></span>

- <span data-ttu-id="acd51-116">est principalement utilisé par les utilisateurs d’Office 365 ;</span><span class="sxs-lookup"><span data-stu-id="acd51-116">Is used primarily by Office 365 users</span></span>
- <span data-ttu-id="acd51-117">doit accéder à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="acd51-117">Needs access to:</span></span>
    - <span data-ttu-id="acd51-118">Services Microsoft exposés dans le cadre de Microsoft Graph ;</span><span class="sxs-lookup"><span data-stu-id="acd51-118">Microsoft services that are exposed as part of Microsoft Graph</span></span>
    - <span data-ttu-id="acd51-119">Service non-Microsoft que vous contrôlez.</span><span class="sxs-lookup"><span data-stu-id="acd51-119">A non-Microsoft service that you control</span></span>

<span data-ttu-id="acd51-120">La méthode d’authentification unique utilise le flux [OAuth2 De la part de fourni par Azure Active Directory](/azure/active-directory/develop/active-directory-v2-protocols-oauth-on-behalf-of).</span><span class="sxs-lookup"><span data-stu-id="acd51-120">The SSO authentication method uses the [OAuth2 On-Behalf-Of flow provided by Azure Active Directory](/azure/active-directory/develop/active-directory-v2-protocols-oauth-on-behalf-of).</span></span> <span data-ttu-id="acd51-121">Cela nécessite l’enregistrement du complément dans le [portail d’inscription des applications](https://apps.dev.microsoft.com/) et la spécification de toute étendue Microsoft Graph requise dans son manifeste.</span><span class="sxs-lookup"><span data-stu-id="acd51-121">It requires that the add-in register in the [Application Registration Portal](https://apps.dev.microsoft.com/) and specify any required Microsoft Graph scopes in its manifest.</span></span>

<span data-ttu-id="acd51-122">Grâce à cette méthode, votre complément peut obtenir un jeton d’accès inclus dans l’API principale de votre serveur.</span><span class="sxs-lookup"><span data-stu-id="acd51-122">Using this method, your add-in can obtain an access token scoped to your server back-end API.</span></span> <span data-ttu-id="acd51-123">Le complément l’utilise comme un jeton du porteur dans l’en-tête `Authorization` pour authentifier un rappel de votre API.</span><span class="sxs-lookup"><span data-stu-id="acd51-123">The add-in uses this as a bearer token in the `Authorization` header to authenticate a call back to your API.</span></span> <span data-ttu-id="acd51-124">À ce stade, votre serveur peut :</span><span class="sxs-lookup"><span data-stu-id="acd51-124">At that point your server can:</span></span>

- <span data-ttu-id="acd51-125">renseigner le flux De la part de pour obtenir un jeton d’accès inclus dans l’API Microsoft Graph ;</span><span class="sxs-lookup"><span data-stu-id="acd51-125">Complete the On-Behalf-Of flow to obtain an access token scoped to the Microsoft Graph API</span></span>
- <span data-ttu-id="acd51-126">utiliser les informations d’identité dans le jeton pour établir l’identité de l’utilisateur et s’authentifier à vos propres services principaux.</span><span class="sxs-lookup"><span data-stu-id="acd51-126">Use the identity information in the token to establish the user's identity and authenticate to your own back-end services</span></span>

<span data-ttu-id="acd51-127">Pour obtenir un aperçu plus détaillé, consultez la [présentation complète de la méthode d’authentification unique](../develop/sso-in-office-add-ins.md).</span><span class="sxs-lookup"><span data-stu-id="acd51-127">For a more detailed overview, see the [full overview of the SSO authentication method](../develop/sso-in-office-add-ins.md).</span></span>

<span data-ttu-id="acd51-128">Pour plus d’informations sur l’utilisation du jeton à authentification unique dans un complément Outlook, consultez la section [Authentifier un utilisateur avec un jeton à authentification unique dans un complément Outlook](authenticate-a-user-with-an-sso-token.md).</span><span class="sxs-lookup"><span data-stu-id="acd51-128">For details on using the SSO token in an Outlook add-in, see [Authenticate a user with an single-sign-on token in an Outlook add-in](authenticate-a-user-with-an-sso-token.md).</span></span>

<span data-ttu-id="acd51-129">Pour un exemple de complément qui utilise le jeton à authentification unique, consultez la section [Exemple de complément AttachmentsDemo](https://github.com/OfficeDev/outlook-add-in-attachments-demo).</span><span class="sxs-lookup"><span data-stu-id="acd51-129">For a sample add-in that uses the SSO token, see [AttachmentsDemo Sample Add-in](https://github.com/OfficeDev/outlook-add-in-attachments-demo).</span></span>

## <a name="exchange-user-identity-token"></a><span data-ttu-id="acd51-130">Jeton d’identité d’utilisateur Exchange</span><span class="sxs-lookup"><span data-stu-id="acd51-130">Exchange user identity token</span></span>

<span data-ttu-id="acd51-131">Les jetons d’identité d’utilisateur Exchange permettent à votre complément d’établir l’identité de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="acd51-131">Exchange user identity tokens provide a way for your add-in to establish the identity of the user.</span></span> <span data-ttu-id="acd51-132">En vérifiant l’identité de l’utilisateur, vous pouvez ensuite effectuer une authentification unique dans votre système principal, puis accepter le jeton d’identité d’utilisateur comme une autorisation pour les demandes futures.</span><span class="sxs-lookup"><span data-stu-id="acd51-132">By verifying the user's identity, you can then perform a one-time authentication into your back-end system, then accept the user identity token as an authorization for future requests.</span></span> <span data-ttu-id="acd51-133">Utilisez le jeton d’identité d’utilisateur Exchange :</span><span class="sxs-lookup"><span data-stu-id="acd51-133">Use the Exchange user identity token:</span></span>

- <span data-ttu-id="acd51-134">quand le complément est utilisé principalement par des utilisateurs locaux Exchange ;</span><span class="sxs-lookup"><span data-stu-id="acd51-134">When the add-in is used primarily by Exchange on-premises users.</span></span>
- <span data-ttu-id="acd51-135">quand le complément doit accéder à un service non-Microsoft que vous contrôlez ;</span><span class="sxs-lookup"><span data-stu-id="acd51-135">When the add-in needs access to a non-Microsoft service that you control.</span></span>
- <span data-ttu-id="acd51-136">en tant qu’authentification de secours (et d’autorisation à Microsoft Graph) quand le complément est exécuté sur une version d’Office qui ne prend pas en charge SSO.</span><span class="sxs-lookup"><span data-stu-id="acd51-136">As a fallback authentication (and authorization to Microsoft Graph) when the add-in is running on a version of Office that doesn't support SSO.</span></span>

<span data-ttu-id="acd51-137">Votre complément peut appeler la méthode [getUserIdentityTokenAsync](/javascript/api/outlook/office.mailbox#getuseridentitytokenasync-callback--usercontext-) pour obtenir des jetons d’identité d’utilisateur Exchange.</span><span class="sxs-lookup"><span data-stu-id="acd51-137">Your add-in can call [getUserIdentityTokenAsync](/javascript/api/outlook/office.mailbox#getuseridentitytokenasync-callback--usercontext-) to get Exchange user identity tokens.</span></span> <span data-ttu-id="acd51-138">Pour plus d’informations sur l’utilisation de ces jetons, voir [Authentifier un utilisateur avec un jeton d’identité pour Exchange](authenticate-a-user-with-an-identity-token.md).</span><span class="sxs-lookup"><span data-stu-id="acd51-138">For details on using these tokens, see [Authenticate a user with an identity token for Exchange](authenticate-a-user-with-an-identity-token.md).</span></span>

## <a name="access-tokens-obtained-via-oauth2-flows"></a><span data-ttu-id="acd51-139">Jetons d’accès obtenus via les flux OAuth2</span><span class="sxs-lookup"><span data-stu-id="acd51-139">Access tokens obtained via OAuth2 flows</span></span>

<span data-ttu-id="acd51-140">Les compléments peuvent également accéder à des services tiers qui prennent en charge les flux OAuth2 pour l’autorisation.</span><span class="sxs-lookup"><span data-stu-id="acd51-140">Add-ins can also access third-party services that support OAuth2 for authorization.</span></span> <span data-ttu-id="acd51-141">Vous pouvez utiliser les jetons OAuth2 si votre complément :</span><span class="sxs-lookup"><span data-stu-id="acd51-141">Consider using OAuth2 tokens if your add-in:</span></span>

- <span data-ttu-id="acd51-142">doit accéder à un service tiers en dehors de votre contrôle.</span><span class="sxs-lookup"><span data-stu-id="acd51-142">Needs access to a third-party service outside of your control</span></span>

<span data-ttu-id="acd51-143">Grâce à cette méthode, votre complément invite l’utilisateur à se connecter au service à l’aide de la méthode [displayDialogAsync](/javascript/api/office/office.ui#displaydialogasync-startaddress--options--callback-) pour initialiser le flux OAuth2 ou à l’aide de la bibliothèque [office-js-helpers](https://github.com/OfficeDev/office-js-helpers) pour le flux implicite OAuth2.</span><span class="sxs-lookup"><span data-stu-id="acd51-143">Using this method, your add-in prompts the user to sign-in to the service either by using the [displayDialogAsync](/javascript/api/office/office.ui#displaydialogasync-startaddress--options--callback-) method to initialize the OAuth2 flow, or by using the [office-js-helpers library](https://github.com/OfficeDev/office-js-helpers) to the OAuth2 Implicit flow.</span></span>

## <a name="callback-tokens"></a><span data-ttu-id="acd51-144">Jetons de rappel</span><span class="sxs-lookup"><span data-stu-id="acd51-144">Callback tokens</span></span>

<span data-ttu-id="acd51-145">Les jetons de rappel permettent d’accéder à la boîte aux lettres de l’utilisateur à partir de votre serveur principal à l’aide d’[Exchange Web Services (EWS)](/exchange/client-developer/exchange-web-services/explore-the-ews-managed-api-ews-and-web-services-in-exchange) ou de l’[API REST Outlook](/previous-versions/office/office-365-api/api/version-2.0/use-outlook-rest-api).</span><span class="sxs-lookup"><span data-stu-id="acd51-145">Callback tokens provide access to the user's mailbox from your server back-end, either using [Exchange Web Services (EWS)](/exchange/client-developer/exchange-web-services/explore-the-ews-managed-api-ews-and-web-services-in-exchange), or the [Outlook REST API](/previous-versions/office/office-365-api/api/version-2.0/use-outlook-rest-api).</span></span> <span data-ttu-id="acd51-146">Vous pouvez utiliser les jetons de rappel si votre complément :</span><span class="sxs-lookup"><span data-stu-id="acd51-146">Consider using callback tokens if your add-in:</span></span>

- <span data-ttu-id="acd51-147">Doit accéder à la boîte aux lettres de l’utilisateur à partir de votre serveur principal.</span><span class="sxs-lookup"><span data-stu-id="acd51-147">Needs access to the user's mailbox from your server back-end.</span></span>

<span data-ttu-id="acd51-148">Les compléments obtiennent des jetons de rappel à l’aide d’une méthode [getCallbackTokenAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods).</span><span class="sxs-lookup"><span data-stu-id="acd51-148">Add-ins obtain callback tokens using one of the [getCallbackTokenAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods) methods.</span></span> <span data-ttu-id="acd51-149">Le niveau d’accès est contrôlé par les autorisations spécifiées dans le manifeste du complément.</span><span class="sxs-lookup"><span data-stu-id="acd51-149">The level of access is controlled by the permissions specified in the add-in manifest.</span></span>
