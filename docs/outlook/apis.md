---
title: API de complément Outlook
description: Découvrez comment faire référence aux API de complément Outlook et déclarer des autorisations dans votre complément Outlook.
ms.date: 02/21/2021
localization_priority: Normal
ms.openlocfilehash: 0e38747f484eabac26e2e9e846e562ec54510326
ms.sourcegitcommit: e7009c565b18c607fe0868db2e26e250ad308dce
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/05/2021
ms.locfileid: "50505492"
---
# <a name="outlook-add-in-apis"></a><span data-ttu-id="ab75f-103">API de complément Outlook</span><span class="sxs-lookup"><span data-stu-id="ab75f-103">Outlook add-in APIs</span></span>

<span data-ttu-id="ab75f-104">Pour utiliser des API dans votre complément Outlook, vous devez spécifier l’emplacement de la bibliothèque Office.js, l’ensemble des conditions requises, le schéma et les autorisations.</span><span class="sxs-lookup"><span data-stu-id="ab75f-104">To use APIs in your Outlook add-in, you must specify the location of the Office.js library, the requirement set, the schema, and the permissions.</span></span> <span data-ttu-id="ab75f-105">Vous utiliserez principalement les API JavaScript Office exposées via l’objet [Mailbox.](#mailbox-object)</span><span class="sxs-lookup"><span data-stu-id="ab75f-105">You'll primarily use the Office JavaScript APIs exposed through the [Mailbox](#mailbox-object) object.</span></span>

## <a name="officejs-library"></a><span data-ttu-id="ab75f-106">Bibliothèque Office.js</span><span class="sxs-lookup"><span data-stu-id="ab75f-106">Office.js library</span></span>

<span data-ttu-id="ab75f-107">Pour interagir avec l’API du complément Outlook, vous devez utiliser les API JavaScript dans Office.js.</span><span class="sxs-lookup"><span data-stu-id="ab75f-107">To interact with the Outlook add-in API, you need to use the JavaScript APIs in Office.js.</span></span> <span data-ttu-id="ab75f-108">Le CDN de la bibliothèque est `https://appsforoffice.microsoft.com/lib/1/hosted/Office.js`.</span><span class="sxs-lookup"><span data-stu-id="ab75f-108">The CDN for the library is `https://appsforoffice.microsoft.com/lib/1/hosted/Office.js`.</span></span> <span data-ttu-id="ab75f-109">Les compléments soumis à AppSource doivent faire référence à Office.js par le biais de ce CDN et ne peuvent pas utiliser de référence locale.</span><span class="sxs-lookup"><span data-stu-id="ab75f-109">Add-ins submitted to AppSource must reference Office.js by this CDN; they can't use a local reference.</span></span>

<span data-ttu-id="ab75f-110">Référencez le CDN dans une `<script>`balise`<head>` de la page web (fichier .html, .aspx ou .php) qui implémente l’interface utilisateur de votre complément.</span><span class="sxs-lookup"><span data-stu-id="ab75f-110">Reference the CDN in a `<script>` tag in the `<head>` tag of the web page (.html, .aspx, or .php file) that implements the UI of your add-in.</span></span>

```HTML
<script src="https://appsforoffice.microsoft.com/lib/1/hosted/Office.js" type="text/javascript"></script>
```
<span data-ttu-id="ab75f-p103">L’ajout de nouvelles API ne modifie pas l’URL vers Office.js. La version de l’URL sera modifiée uniquement si un comportement d’API existant est interrompu.</span><span class="sxs-lookup"><span data-stu-id="ab75f-p103">As we add new APIs, the URL to Office.js will stay the same. We will change the version in the URL only if we break an existing API behavior.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="ab75f-113">Lorsque vous développez un add-in pour une application cliente Office, référencez l’API JavaScript Office à partir de l’intérieur de `<head>` la section de la page.</span><span class="sxs-lookup"><span data-stu-id="ab75f-113">When developing an add-in for any Office client application, reference the Office JavaScript API from inside the `<head>` section of the page.</span></span> <span data-ttu-id="ab75f-114">Ainsi, l’API est entièrement initialisée avant les éléments Body.</span><span class="sxs-lookup"><span data-stu-id="ab75f-114">This ensures that the API is fully initialized prior to any body elements.</span></span>

## <a name="requirement-sets"></a><span data-ttu-id="ab75f-115">Ensembles de conditions requises</span><span class="sxs-lookup"><span data-stu-id="ab75f-115">Requirement sets</span></span>

<span data-ttu-id="ab75f-116">Toutes les API Outlook appartiennent à l’ensemble de conditions requises `Mailbox`.</span><span class="sxs-lookup"><span data-stu-id="ab75f-116">All Outlook APIs belong to the `Mailbox` requirement set.</span></span> <span data-ttu-id="ab75f-117">L’ensemble de conditions requises `Mailbox` possède plusieurs versions, et chaque nouvel ensemble d’API publié appartient à une version supérieure de l’ensemble.</span><span class="sxs-lookup"><span data-stu-id="ab75f-117">The `Mailbox` requirement set has versions, and each new set of APIs that are released belongs to a higher version of the set.</span></span> <span data-ttu-id="ab75f-118">Tous les clients Outlook ne prendront pas en charge l’ensemble d’API le plus récent lors de sa publication, mais si un client Outlook prend en charge un ensemble de conditions requises, toutes les API comprises dans cet ensemble seront également prises en charge.</span><span class="sxs-lookup"><span data-stu-id="ab75f-118">Not all Outlook clients will support the newest set of APIs when they are released, but if an Outlook client declares support for a requirement set, it will support all the APIs in that requirement set.</span></span>

<span data-ttu-id="ab75f-p106">Pour savoir dans quels clients Outlook le complément s’affiche, indiquez la version de l’ensemble de conditions requises dans le manifeste. Par exemple, si vous indiquez la version 1.3 de l’ensemble de conditions requises, le complément n’apparaîtra pas dans les clients Outlook qui ne prennent pas en charge la version minimale 1.3.</span><span class="sxs-lookup"><span data-stu-id="ab75f-p106">To control which Outlook clients the add-in appears in, specify a minimum requirement set version in the manifest. For example, if you specify requirement set version 1.3, the add-in will not show up in any Outlook client that doesn't support a minimum version of 1.3.</span></span>

<span data-ttu-id="ab75f-p107">Le fait de spécifier un ensemble de conditions requises ne limite pas votre complément aux API de cette version. Si le complément spécifie l’ensemble de conditions requises version 1.1, mais est exécuté dans un client Outlook prenant en charge la version 1.3, le complément peut toujours utiliser les API v1.3. L’ensemble de conditions requises contrôle uniquement les clients Outlook dans lesquels le complément apparaît.</span><span class="sxs-lookup"><span data-stu-id="ab75f-p107">Specifying a requirement set doesn't limit your add-in to the APIs in that version. If the add-in specifies requirement set v1.1 but is running in an Outlook client that supports v1.3, the add-in can still use v1.3 APIs. The requirement set only controls which Outlook clients the add-in appears in.</span></span>

<span data-ttu-id="ab75f-124">Pour vérifier la disponibilité des API à partir d’un ensemble de conditions requises de version supérieure à celle spécifiée dans le manifeste, vous pouvez utiliser l’API JavaScript standard :</span><span class="sxs-lookup"><span data-stu-id="ab75f-124">To check the availability of any APIs from a requirement set greater than the one specified in the manifest, you can use standard JavaScript:</span></span>

```js
if (item.somePropertyOrFunction) {
   item.somePropertyOrFunction...  
}
```

> [!NOTE]
> <span data-ttu-id="ab75f-125">Ces vérifications ne sont pas nécessaires pour les API appartenant à l’ensemble de conditions requises dont la version est la même que celle spécifiée dans le manifeste.</span><span class="sxs-lookup"><span data-stu-id="ab75f-125">These checks are not needed for any APIs that are in the requirement set version specified in the manifest.</span></span>

<span data-ttu-id="ab75f-126">Spécifiez l’ensemble de conditions requises minimal prenant en charge l’ensemble d’API critique pour votre scénario, sans lequel les fonctionnalités de votre complément ne fonctionneront pas.</span><span class="sxs-lookup"><span data-stu-id="ab75f-126">Specify the minimum requirement set that supports the critical set of APIs for your scenario, without which features of your add-in won't work.</span></span> <span data-ttu-id="ab75f-127">Spécifiez l’ensemble de conditions requises dans le manifeste dans l’élément `<Requirements>`.</span><span class="sxs-lookup"><span data-stu-id="ab75f-127">You specify the requirement set in the manifest in the `<Requirements>` element.</span></span> <span data-ttu-id="ab75f-128">Pour plus d’informations, consultez les rubriques [Manifestes des compléments Outlook](manifests.md) et [Présentation de l’ensemble de conditions requises pour les API Outlook](../reference/requirement-sets/outlook-api-requirement-sets.md).</span><span class="sxs-lookup"><span data-stu-id="ab75f-128">For more information, see [Outlook add-in manifests](manifests.md) and [Understanding Outlook API requirement sets](../reference/requirement-sets/outlook-api-requirement-sets.md).</span></span>

<span data-ttu-id="ab75f-129">L’élément `<Methods>` ne s’applique pas aux compléments Outlook. Vous ne pouvez donc pas déclarer la prise en charge de méthodes spécifiques.</span><span class="sxs-lookup"><span data-stu-id="ab75f-129">The `<Methods>` element doesn't apply to Outlook add-ins, so you can't declare support for specific methods.</span></span>

## <a name="permissions"></a><span data-ttu-id="ab75f-130">Autorisations</span><span class="sxs-lookup"><span data-stu-id="ab75f-130">Permissions</span></span>

<span data-ttu-id="ab75f-p109">Votre complément requiert les autorisations appropriées pour utiliser les API dont il a besoin. Il existe quatre niveaux d’autorisations possibles. Pour plus de détails, voir [Présentation des autorisations du complément Outlook](understanding-outlook-add-in-permissions.md).</span><span class="sxs-lookup"><span data-stu-id="ab75f-p109">Your add-in requires the appropriate permissions to use the APIs that it needs. There are four levels of permissions. For more details, see [Understanding Outlook add-in permissions](understanding-outlook-add-in-permissions.md).</span></span>

<br/>

|<span data-ttu-id="ab75f-134">Niveau d’autorisation</span><span class="sxs-lookup"><span data-stu-id="ab75f-134">Permission level</span></span>|<span data-ttu-id="ab75f-135">Description</span><span class="sxs-lookup"><span data-stu-id="ab75f-135">Description</span></span>|
|:-----|:-----|
| <span data-ttu-id="ab75f-136">**Restricted**</span><span class="sxs-lookup"><span data-stu-id="ab75f-136">**Restricted**</span></span> | <span data-ttu-id="ab75f-137">Permet l’utilisation d’entités, mais pas d’expressions régulières.</span><span class="sxs-lookup"><span data-stu-id="ab75f-137">Allows use of entities but not regular expressions.</span></span> |
| <span data-ttu-id="ab75f-138">**Lire l’élément**</span><span class="sxs-lookup"><span data-stu-id="ab75f-138">**Read item**</span></span> | <span data-ttu-id="ab75f-139">En plus des autorisations indiquées dans **Restricted**, il autorise :</span><span class="sxs-lookup"><span data-stu-id="ab75f-139">In addition to what is allowed in **Restricted**, it allows:</span></span><ul><li><span data-ttu-id="ab75f-140">expressions régulières</span><span class="sxs-lookup"><span data-stu-id="ab75f-140">regular expressions</span></span></li><li><span data-ttu-id="ab75f-141">l’accès en lecture de l’API du complément Outlook</span><span class="sxs-lookup"><span data-stu-id="ab75f-141">Outlook add-in API read access</span></span></li><li><span data-ttu-id="ab75f-142">l’obtention des propriétés de l’élément et du jeton de rappel</span><span class="sxs-lookup"><span data-stu-id="ab75f-142">getting the item properties and the callback token</span></span></li></ul> |
| <span data-ttu-id="ab75f-143">**Lecture/Écriture**</span><span class="sxs-lookup"><span data-stu-id="ab75f-143">**Read/write**</span></span> | <span data-ttu-id="ab75f-144">En plus des autorisations indiquées dans **Read item**, il autorise :</span><span class="sxs-lookup"><span data-stu-id="ab75f-144">In addition to what is allowed in **Read item**, it allows:</span></span><ul><li><span data-ttu-id="ab75f-145">l’accès total à l’API du complément Outlook, à l’exception de `makeEwsRequestAsync`</span><span class="sxs-lookup"><span data-stu-id="ab75f-145">full Outlook add-in API access except `makeEwsRequestAsync`</span></span></li><li><span data-ttu-id="ab75f-146">la définition des propriétés de l’élément</span><span class="sxs-lookup"><span data-stu-id="ab75f-146">setting the item properties</span></span></li></ul> |
| <span data-ttu-id="ab75f-147">**Lire/écrire dans la boîte aux lettres**</span><span class="sxs-lookup"><span data-stu-id="ab75f-147">**Read/write mailbox**</span></span> | <span data-ttu-id="ab75f-148">En plus des autorisations indiquées dans **Read/write**, il autorise :</span><span class="sxs-lookup"><span data-stu-id="ab75f-148">In addition to what is allowed in **Read/write**, it allows:</span></span><ul><li><span data-ttu-id="ab75f-149">la création, la lecture, l’écriture d’éléments et de dossiers</span><span class="sxs-lookup"><span data-stu-id="ab75f-149">creating, reading, writing items and folders</span></span></li><li><span data-ttu-id="ab75f-150">l’envoi d’éléments</span><span class="sxs-lookup"><span data-stu-id="ab75f-150">sending items</span></span></li><li><span data-ttu-id="ab75f-151">l’appel de [makeEwsRequestAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods)</span><span class="sxs-lookup"><span data-stu-id="ab75f-151">calling [makeEwsRequestAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods)</span></span></li></ul> |

<span data-ttu-id="ab75f-152">En général, vous devez spécifier l’autorisation minimum nécessaire pour votre complément.</span><span class="sxs-lookup"><span data-stu-id="ab75f-152">In general, you should specify the minimum permission needed for your add-in.</span></span> <span data-ttu-id="ab75f-153">Les autorisations sont déclarées dans l’élément `<Permissions>` dans le manifeste.</span><span class="sxs-lookup"><span data-stu-id="ab75f-153">Permissions are declared in the `<Permissions>` element in the manifest.</span></span> <span data-ttu-id="ab75f-154">Pour plus d’informations, consultez la rubrique [Manifestes des compléments Outlook](manifests.md).</span><span class="sxs-lookup"><span data-stu-id="ab75f-154">For more information, see [Outlook add-in manifests](manifests.md).</span></span> <span data-ttu-id="ab75f-155">Pour plus d’informations sur les problèmes de sécurité, voir Confidentialité et sécurité pour [les add-ins Office.](../concepts/privacy-and-security.md)</span><span class="sxs-lookup"><span data-stu-id="ab75f-155">For information about security issues, see [Privacy and security for Office Add-ins](../concepts/privacy-and-security.md).</span></span>

## <a name="mailbox-object"></a><span data-ttu-id="ab75f-156">Objet Mailbox</span><span class="sxs-lookup"><span data-stu-id="ab75f-156">Mailbox object</span></span>

[!include[information about Mailbox object](../includes/mailbox-object-desc.md)]

## <a name="see-also"></a><span data-ttu-id="ab75f-157">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="ab75f-157">See also</span></span>

- [<span data-ttu-id="ab75f-158">Manifestes de complément Outlook</span><span class="sxs-lookup"><span data-stu-id="ab75f-158">Outlook add-in manifests</span></span>](manifests.md)
- [<span data-ttu-id="ab75f-159">Présentation de l’ensemble de conditions requises pour les API Outlook</span><span class="sxs-lookup"><span data-stu-id="ab75f-159">Understanding Outlook API requirement sets</span></span>](../reference/requirement-sets/outlook-api-requirement-sets.md)
- [<span data-ttu-id="ab75f-160">Confidentialité et sécurité pour les compléments Office</span><span class="sxs-lookup"><span data-stu-id="ab75f-160">Privacy and security for Office Add-ins</span></span>](../concepts/privacy-and-security.md)
