---
title: Commandes de complément Outlook
description: Les commandes de complément Outlook permettent de lancer des actions de complément spécifiques à partir du ruban en ajoutant des boutons ou des menus déroulants.
ms.date: 07/07/2020
localization_priority: Priority
ms.openlocfilehash: 1f4d8faf1ee691f515b47d712812e0ae7cabdf5c
ms.sourcegitcommit: ee9e92a968e4ad23f1e371f00d4888e4203ab772
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/23/2021
ms.locfileid: "53076804"
---
# <a name="add-in-commands-for-outlook"></a><span data-ttu-id="e1be2-103">Commandes de complément pour Outlook</span><span class="sxs-lookup"><span data-stu-id="e1be2-103">Add-in commands for Outlook</span></span>

<span data-ttu-id="e1be2-p101">Les commandes de complément Outlook permettent d’initier des actions de complément spécifiques à partir du ruban en ajoutant des boutons ou des menus déroulants. Les utilisateurs peuvent ainsi accéder aux compléments d’une manière simple, intuitive et discrète. Parce qu’elles offrent des fonctionnalités optimales en toute transparence, les commandes de complément vous permettent de créer des solutions plus attrayantes.</span><span class="sxs-lookup"><span data-stu-id="e1be2-p101">Outlook add-in commands provide ways to initiate specific add-in actions from the ribbon by adding buttons or drop-down menus. This lets users access add-ins in a simple, intuitive, and unobtrusive way. Because they offer increased functionality in a seamless manner, you can use add-in commands to create more engaging solutions.</span></span>

> [!NOTE]
> <span data-ttu-id="e1be2-107">Les commandes complémentaires sont disponibles uniquement dans Outlook 2013 ou plus récent sur Windows, Outlook 2016 ou plus récent sur Mac, Outlook sur iOS, Outlook sur Android, Outlook sur le web pour Exchange 2016 ou plus récent, et Outlook sur le web pour Microsoft 365 et Outlook.com.</span><span class="sxs-lookup"><span data-stu-id="e1be2-107">Add-in commands are available only in Outlook 2013 or later on Windows, Outlook 2016 or later on Mac, Outlook on iOS, Outlook on Android, Outlook on the web for Exchange 2016 or later, and Outlook on the web for Microsoft 365 and Outlook.com.</span></span>
>
> <span data-ttu-id="e1be2-108">Pour qu’Outlook 2013 prenne en charge les commandes de complément, trois mises à jour doivent être installées :</span><span class="sxs-lookup"><span data-stu-id="e1be2-108">Support for add-in commands in Outlook 2013 requires three updates:</span></span>
> - [<span data-ttu-id="e1be2-109">Mise à jour de sécurité pour Outlook du 8 mars 2016</span><span class="sxs-lookup"><span data-stu-id="e1be2-109">March 8, 2016 security update for Outlook</span></span>](https://support.microsoft.com/kb/3114829)
> - [<span data-ttu-id="e1be2-110">Mise à jour de sécurité pour Office du 8 mars 2016 (KB3114816)</span><span class="sxs-lookup"><span data-stu-id="e1be2-110">March 8, 2016 security update for Office (KB3114816)</span></span>](https://support.microsoft.com/help/3114816/march-8,-2016,-update-for-office-2013-kb3114816)
> - [<span data-ttu-id="e1be2-111">Mise à jour de sécurité pour Office du 8 mars 2016 (KB3114828)</span><span class="sxs-lookup"><span data-stu-id="e1be2-111">March 8, 2016 security update for Office (KB3114828)</span></span>](https://support.microsoft.com/help/3114828/march-8,-2016,-update-for-office-2013-kb3114828)
>
> <span data-ttu-id="e1be2-112">La prise en charge des commandes de complément dans Exchange 2016 nécessite la [mise à jour cumulative 5](https://support.microsoft.com/help/4012106/cumulative-update-5-for-exchange-server-2016).</span><span class="sxs-lookup"><span data-stu-id="e1be2-112">Support for add-in commands in Exchange 2016 requires [Cumulative Update 5](https://support.microsoft.com/help/4012106/cumulative-update-5-for-exchange-server-2016).</span></span>

<span data-ttu-id="e1be2-p102">Les commandes de complément sont uniquement disponibles pour les compléments qui n’utilisent pas les règles [ItemHasAttachment, ItemHasKnownEntity ou ItemHasRegularExpressionMatch](activation-rules.md) pour limiter les types d’éléments sur lesquels elles s’activent. Toutefois, les [compléments contextuels](contextual-outlook-add-ins.md) peuvent présenter diverses commandes selon que l’élément actuellement sélectionné est un message ou un rendez-vous, et peuvent apparaître dans des scénarios de lecture ou de composition. L’utilisation des commandes de complément constitue une [meilleure pratique](../concepts/add-in-development-best-practices.md).</span><span class="sxs-lookup"><span data-stu-id="e1be2-p102">Add-in commands are only available for add-ins that do not use [ItemHasAttachment, ItemHasKnownEntity, or ItemHasRegularExpressionMatch rules](activation-rules.md) to limit the types of items they activate on. However, [contextual add-ins](contextual-outlook-add-ins.md) can present different commands depending on whether the currently selected item is a message or appointment, and can choose to appear in read or compose scenarios. Using add-in commands if possible is a [best practice](../concepts/add-in-development-best-practices.md).</span></span>

## <a name="creating-the-add-in-command"></a><span data-ttu-id="e1be2-116">Création d’une commande de complément</span><span class="sxs-lookup"><span data-stu-id="e1be2-116">Creating the add-in command</span></span>

<span data-ttu-id="e1be2-p103">Les commandes de complément sont déclarées dans le manifeste de complément dans l’[élément VersionOverrides](../reference/manifest/versionoverrides.md). Cet élément est un ajout au schéma de manifeste version 1.1 qui assure la compatibilité descendante. Dans un client qui ne prend pas en charge `VersionOverrides`, les compléments existants continuent à fonctionner comme ils le feraient sans commande de complément.</span><span class="sxs-lookup"><span data-stu-id="e1be2-p103">Add-in commands are declared in the add-in manifest in the [VersionOverrides element](../reference/manifest/versionoverrides.md). This element is an addition to the manifest schema v1.1 that ensures backward compatibility. In a client that doesn't support `VersionOverrides`, existing add-ins will continue to function as they did without add-in commands.</span></span>

<span data-ttu-id="e1be2-120">Les entrées de manifeste `VersionOverrides` spécifient plusieurs éléments pour le complément, notamment l’application, les types de contrôles à ajouter au ruban, le texte, les icônes et toutes les fonctions associées.</span><span class="sxs-lookup"><span data-stu-id="e1be2-120">The `VersionOverrides` manifest entries specify many things for the add-in, such as the application, types of controls to add to the ribbon, the text, the icons, and any associated functions.</span></span>

<span data-ttu-id="e1be2-p104">Lorsqu’un complément doit fournir des mises à jour d’état, telles que des indicateurs de progression ou des messages d’erreur, il doit le faire via les [API de notification](/javascript/api/outlook/office.notificationmessages). Le traitement pour les notifications doit également être défini dans un fichier HTML distinct qui est spécifié dans le nœud `FunctionFile` du manifeste.</span><span class="sxs-lookup"><span data-stu-id="e1be2-p104">When an add-in needs to provide status updates, such as progress indicators or error messages, it must do so through the [notification APIs](/javascript/api/outlook/office.notificationmessages). The processing for the notifications must also be defined in a separate HTML file that is specified in the `FunctionFile` node of the manifest.</span></span>

<span data-ttu-id="e1be2-p105">Les développeurs doivent définir des icônes pour toutes les tailles requises afin que les commandes de complément s’ajustent parfaitement avec le ruban. Les tailles d’icône requises sont 80 x 80 pixels, 32 x 32 pixels, 16 x 16 pixels pour les versions de bureau et 48 x 48 pixels, 32 x 32 pixels et 25 x 25 pixels pour les versions mobiles.</span><span class="sxs-lookup"><span data-stu-id="e1be2-p105">Developers should define icons for all required sizes so that the add-in commands will adjust smoothly along with the ribbon. The required icon sizes are 80 x 80 pixels, 32 x 32 pixels, and 16 x 16 pixels for desktop, and 48 x 48 pixels, 32 x 32 pixels, and 25 x 25 pixels for mobile.</span></span>

## <a name="how-do-add-in-commands-appear"></a><span data-ttu-id="e1be2-125">Comment les commandes de complément apparaissent-elles ?</span><span class="sxs-lookup"><span data-stu-id="e1be2-125">How do add-in commands appear?</span></span>

<span data-ttu-id="e1be2-p106">Une commande de complément apparaît dans le ruban, comme un bouton. Lorsqu’un utilisateur installe un complément, ses commandes apparaissent dans l’interface utilisateur sous la forme d’un groupe de boutons. Le groupe peut apparaître dans l’onglet par défaut du ruban ou dans un onglet personnalisé. Pour les messages, il apparaît par défaut dans l’onglet **Accueil** ou **Message**. Pour le calendrier, il apparaît par défaut dans l’onglet **Réunion**, **Occurrence de réunion**, **Série de réunions** ou **Rendez-vous**. Pour les extensions de module, il apparaît par défaut dans un onglet personnalisé. Dans l’onglet par défaut, chaque complément peut avoir un groupe Ruban incluant 6 commandes maximum. Dans les onglets personnalisés, le complément peut avoir jusqu’à 10 groupes, avec 6 commandes chacun. Les compléments sont limités à un seul onglet personnalisé.</span><span class="sxs-lookup"><span data-stu-id="e1be2-p106">An add-in command appears on the ribbon as a button. When a user installs an add-in, its commands appear in the UI as a group of buttons. This can either be on the ribbon's default tab or on a custom tab. For messages, the default is either the **Home** or **Message** tab. For the calendar, the default is the **Meeting**, **Meeting Occurrence**, **Meeting Series**, or **Appointment** tab. For module extensions, the default is a custom tab. On the default tab, each add-in can have one ribbon group with up to 6 commands. On custom tabs, the add-in can have up to 10 groups, each with 6 commands. Add-ins are limited to only one custom tab.</span></span>

<span data-ttu-id="e1be2-131">Au fur et à mesure du ruban, les commandes de complément s’affichent dans le menu de dépassement de capacité.</span><span class="sxs-lookup"><span data-stu-id="e1be2-131">As the ribbon gets more crowded, add-in commands will be displayed in the overflow menu.</span></span> <span data-ttu-id="e1be2-132">Les commandes de complément pour un complément sont généralement regroupées.</span><span class="sxs-lookup"><span data-stu-id="e1be2-132">The add-in commands for an add-in are usually grouped together.</span></span>

![Boutons de commande des modules complémentaires sur le ruban.](../images/commands-normal.png)

![Boutons de commande des modules complémentaires sur le ruban et dans le menu déroulant.](../images/commands-collapsed.png)

<span data-ttu-id="e1be2-p108">Lorsqu’une commande de complément est ajoutée à un complément, le nom du complément est supprimé de la barre d’application. Seul le bouton de commande du complément dans le ruban est conservé.</span><span class="sxs-lookup"><span data-stu-id="e1be2-p108">When an add-in command is added to an add-in, the add-in name is removed from the app bar. Only the add-in command button on the ribbon remains.</span></span>

### <a name="modern-outlook-on-the-web"></a><span data-ttu-id="e1be2-137">Outlook moderne sur le web</span><span class="sxs-lookup"><span data-stu-id="e1be2-137">Modern Outlook on the web</span></span>

<span data-ttu-id="e1be2-138">Dans Outlook sur le web, le nom du complément s’affiche dans un menu de dépassement de capacité.</span><span class="sxs-lookup"><span data-stu-id="e1be2-138">In Outlook on the web, the add-in name is displayed in an overflow menu.</span></span> <span data-ttu-id="e1be2-139">Si le complément inclut plusieurs commandes de complément, vous pouvez développer le menu du complément pour afficher le groupe de boutons portant le nom du complément.</span><span class="sxs-lookup"><span data-stu-id="e1be2-139">If the add-in has multiple add-in commands, you can expand the add-in menu to see the group of buttons labeled with the add-in name.</span></span>

![Menu de débordement où se trouvent les boutons de commande du module d'extension.](../images/commands-overflow-menu-web.png)

![Menu de débordement affichant les boutons de commande des modules complémentaires.](../images/commands-overflow-menu-expand-web.png)

## <a name="what-ux-shapes-exist-for-add-in-commands"></a><span data-ttu-id="e1be2-142">Quelles formes d’expérience utilisateur existent pour les commandes de complément ?</span><span class="sxs-lookup"><span data-stu-id="e1be2-142">What UX shapes exist for add-in commands?</span></span>

<span data-ttu-id="e1be2-p110">La forme d’expérience utilisateur d’une commande de complément inclut un onglet de ruban dans l’application Office qui contient des boutons permettant d’effectuer diverses actions. Actuellement, trois formes d’expérience utilisateur sont prises en charge :</span><span class="sxs-lookup"><span data-stu-id="e1be2-p110">The UX shape for an add-in command consists of a ribbon tab in the Office application that contains buttons that can perform various functions. Currently, three UI shapes are supported:</span></span>

- <span data-ttu-id="e1be2-145">Un bouton qui exécute une fonction JavaScript</span><span class="sxs-lookup"><span data-stu-id="e1be2-145">A button that executes a JavaScript function</span></span>
- <span data-ttu-id="e1be2-146">Un bouton qui lance un volet Office</span><span class="sxs-lookup"><span data-stu-id="e1be2-146">A button that launches a task pane</span></span>
- <span data-ttu-id="e1be2-147">Un bouton qui affiche un menu déroulant avec un ou plusieurs boutons des deux autres types</span><span class="sxs-lookup"><span data-stu-id="e1be2-147">A button that shows a drop-down menu with one or more buttons of the other two types</span></span>

### <a name="executing-a-javascript-function"></a><span data-ttu-id="e1be2-148">Exécuter une fonction JavaScript</span><span class="sxs-lookup"><span data-stu-id="e1be2-148">Executing a JavaScript function</span></span>

<span data-ttu-id="e1be2-p111">Utilisez un bouton de commande de complément qui exécute une fonction JavaScript pour les scénarios dans lesquels l’utilisateur n’a pas besoin d’effectuer de sélections supplémentaires pour lancer l’action. Cela peut être utile, entre autres, pour les actions de suivi, de rappel, d’impression ou de scénario quand l’utilisateur souhaite obtenir des informations supplémentaires d’un service.</span><span class="sxs-lookup"><span data-stu-id="e1be2-p111">Use an add-in command button that executes a JavaScript function for scenarios where the user doesn't need to make any additional selections to initiate the action. This can be for actions such as track, remind me, or print, or scenarios when the user wants more in-depth information from a service.</span></span>

<span data-ttu-id="e1be2-151">Dans les extensions de module, le bouton de commande de complément peut exécuter les fonctions JavaScript qui interagissent avec le contenu de l’interface utilisateur principale.</span><span class="sxs-lookup"><span data-stu-id="e1be2-151">In module extensions, the add-in command button can execute JavaScript functions that interact with the content in the main user interface.</span></span>

![Bouton exécutant une fonction sur le ruban Outlook.](../images/commands-uiless-button-1.png)

### <a name="launching-a-task-pane"></a><span data-ttu-id="e1be2-153">Lancement d’un volet Office</span><span class="sxs-lookup"><span data-stu-id="e1be2-153">Launching a task pane</span></span>

<span data-ttu-id="e1be2-p112">Utilisez un bouton de commande de complément pour lancer un volet Office pour les scénarios dans lesquels l’utilisateur doit interagir avec un complément pour une durée plus longue. Par exemple, le complément nécessite des modifications de paramètres ou la saisie de données dans de nombreux champs.</span><span class="sxs-lookup"><span data-stu-id="e1be2-p112">Use an add-in command button to launch a task pane for scenarios where a user needs to interact with an add-in for a longer period of time. For example, the add-in requires changes to settings or the completion of many fields.</span></span>

<span data-ttu-id="e1be2-p113">La largeur par défaut du volet de tâche vertical est de 320 px. Celui-ci peut être redimensionné à la fois dans l’explorateur Outlook et dans l’inspecteur. Le volet peut redimensionner le volet de tâche et l’affichage Liste de façon identique.</span><span class="sxs-lookup"><span data-stu-id="e1be2-p113">The default width of the vertical task pane is 320 px. The vertical task pane can be resized in both the Outlook Explorer and inspector. The pane can be resized in the same way the to-do pane and list view resize.</span></span>

![Bouton permettant d’ouvrir un volet Office sur le ruban Outlook.](../images/commands-task-pane-button-1.png)

<br/>

<span data-ttu-id="e1be2-p114">Cette capture d’écran montre un exemple de volet Office vertical. Le volet s’ouvre avec le nom de la commande du complément dans le coin supérieur gauche. Les utilisateurs peuvent utiliser le bouton **X** situé dans le coin supérieur droit du volet pour fermer le complément lorsqu’ils ont terminé de l’utiliser. Par défaut, ce volet n’est pas conservé sur plusieurs messages. Les compléments peuvent [prendre en charge l’épinglage](pinnable-taskpane.md) pour le volet Office et recevoir des événements lorsqu’un nouveau message est sélectionné. Tous les éléments d’interface utilisateur affichés dans le volet Office, mis à part le nom et le bouton Fermer, sont fournis par le complément.</span><span class="sxs-lookup"><span data-stu-id="e1be2-p114">This screenshot shows an example of a vertical task pane. The pane opens with the name of the add-in command in the top left corner. Users can use the **X** button in the upper-right corner of the pane to close the add-in when they are finished using it. By default, this pane will not persist across messages. Add-ins can [support pinning](pinnable-taskpane.md) for the task pane and receive events when a new message is selected. All UI elements rendered in the task pane, aside from the add-in name and the close button, are provided by the add-in.</span></span>

<span data-ttu-id="e1be2-p115">Si l’utilisateur sélectionne une autre commande de complément qui ouvre un volet Office, le volet est remplacé par la commande qui vient d’être utilisée. Si l’utilisateur sélectionne un bouton de commande de complément qui exécute une fonction ou sur un menu déroulant alors que le volet Office est ouvert, l’action est exécutée et le volet Office reste ouvert.</span><span class="sxs-lookup"><span data-stu-id="e1be2-p115">If a user chooses another add-in command that opens a task pane, the task pane is replaced with the recently used command. If a user chooses an add-in command button that executes a function, or drop-down menu while the task pane is open, the action will be completed and the task pane will remain open.</span></span>

### <a name="drop-down-menu"></a><span data-ttu-id="e1be2-168">Menu déroulant</span><span class="sxs-lookup"><span data-stu-id="e1be2-168">Drop-down menu</span></span>

<span data-ttu-id="e1be2-p116">Une commande de complément de menu déroulant définit une liste statique de boutons. Les boutons dans le menu peuvent correspondre à n’importe quelle combinaison de boutons qui exécutent une fonction ou qui ouvrent un volet Office. Les sous-menus ne sont pas pris en charge.</span><span class="sxs-lookup"><span data-stu-id="e1be2-p116">A drop-down menu add-in command defines a static list of buttons. The buttons within the menu can be any mix of buttons that execute a function or buttons that open a task pane. Submenus are not supported.</span></span>

![Bouton permettant de développer un menu sur le ruban Outlook.](../images/commands-menu-button-1.png)

## <a name="where-do-add-in-commands-appear-in-the-ui"></a><span data-ttu-id="e1be2-173">Où les commandes de complément apparaissent-elles dans l’interface utilisateur ?</span><span class="sxs-lookup"><span data-stu-id="e1be2-173">Where do add-in commands appear in the UI?</span></span>

<span data-ttu-id="e1be2-174">Les commandes de complément sont prises en charge pour quatre scénarios :</span><span class="sxs-lookup"><span data-stu-id="e1be2-174">Add-in commands are supported for four scenarios:</span></span>

### <a name="reading-a-message"></a><span data-ttu-id="e1be2-175">Lecture d’un message</span><span class="sxs-lookup"><span data-stu-id="e1be2-175">Reading a message</span></span>

<span data-ttu-id="e1be2-176">Lorsque l’utilisateur lit un message dans le volet de lecture ou dans l’onglet **Message** pour un formulaire de lecture contextuel, les commandes de complément ajoutées à l’onglet par défaut apparaissent dans l’onglet **Accueil**.</span><span class="sxs-lookup"><span data-stu-id="e1be2-176">When the user is reading a message in the reading pane or in the **Message** tab for a pop-out read form, add-in commands added to the default tab appear on the **Home** tab.</span></span>

### <a name="composing-a-message"></a><span data-ttu-id="e1be2-177">Composition d’un message</span><span class="sxs-lookup"><span data-stu-id="e1be2-177">Composing a message</span></span>

<span data-ttu-id="e1be2-178">Lorsque l’utilisateur crée un message, les commandes de complément ajoutées à l’onglet par défaut apparaissent dans l’onglet **Message**.</span><span class="sxs-lookup"><span data-stu-id="e1be2-178">When the user is composing a message, add-in commands added to the default tab appear on the **Message** tab.</span></span>

### <a name="creating-or-viewing-an-appointment-or-meeting-as-the-organizer"></a><span data-ttu-id="e1be2-179">Création ou affichage d’un rendez-vous ou d’une réunion en tant qu’organisateur</span><span class="sxs-lookup"><span data-stu-id="e1be2-179">Creating or viewing an appointment or meeting as the organizer</span></span>

<span data-ttu-id="e1be2-p117">Lorsque vous créez ou visualisez un rendez-vous ou une réunion en tant qu’organisateur, les commandes de complément ajoutées à l’onglet par défaut apparaissent dans les onglets **Réunion**, **Occurrence de réunion**, **Série de réunions** ou **Rendez-vous** des formulaires contextuels. Toutefois, si l’utilisateur sélectionne un élément dans le calendrier sans ouvrir la fenêtre contextuelle, le groupe Ruban du complément n’apparaît pas sur le ruban.</span><span class="sxs-lookup"><span data-stu-id="e1be2-p117">When creating or viewing an appointment or meeting as the organizer, add-in commands added to the default tab appear on the **Meeting**, **Meeting Occurrence**, **Meeting Series**, or **Appointment** tabs on pop-out forms. However, if the user selects an item in the calendar but doesn't open the pop-out, the add-in's ribbon group won't be visible in the ribbon.</span></span>

### <a name="viewing-a-meeting-as-an-attendee"></a><span data-ttu-id="e1be2-182">Affichage d’une réunion en tant que participant</span><span class="sxs-lookup"><span data-stu-id="e1be2-182">Viewing a meeting as an attendee</span></span>

<span data-ttu-id="e1be2-p118">Lorsque vous visualisez une réunion en tant que participant, les commandes de complément ajoutées à l’onglet par défaut apparaissent dans les onglets **Réunion**, **Occurrence de réunion** ou **Série de réunions** des formulaires contextuels. Toutefois, si l’utilisateur sélectionne un élément dans le calendrier sans ouvrir la fenêtre contextuelle, le groupe Ruban du complément n’apparaît pas sur le ruban.</span><span class="sxs-lookup"><span data-stu-id="e1be2-p118">When viewing a meeting as an attendee, add-in commands added to the default tab appear on the **Meeting**, **Meeting Occurrence**, or **Meeting Series** tabs on pop-out forms. However, if a user selects an item in the calendar but doesn't open the pop-out, the add-in's ribbon group won't be visible in the ribbon</span></span>

### <a name="using-a-module-extension"></a><span data-ttu-id="e1be2-185">Utilisation d’une extension de module</span><span class="sxs-lookup"><span data-stu-id="e1be2-185">Using a module extension</span></span>

<span data-ttu-id="e1be2-186">Quand vous utilisez une extension de module, les commandes de complément apparaissent dans l’onglet personnalisé de l’extension.</span><span class="sxs-lookup"><span data-stu-id="e1be2-186">When using a module extension, add-in commands appear on the extension's custom tab.</span></span>

## <a name="see-also"></a><span data-ttu-id="e1be2-187">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="e1be2-187">See also</span></span>

- [<span data-ttu-id="e1be2-188">Démonstration de la commande de l'add-in Add-in Outlook</span><span class="sxs-lookup"><span data-stu-id="e1be2-188">Add-in command demo Outlook add-in</span></span>](https://github.com/officedev/outlook-add-in-command-demo)
- [<span data-ttu-id="e1be2-189">Créer des commandes complémentaires dans votre formulaire pour Excel, PowerPoint et Word</span><span class="sxs-lookup"><span data-stu-id="e1be2-189">Create add-in commands in your manifest for Excel, PowerPoint, and Word</span></span>](../develop/create-addin-commands.md)
