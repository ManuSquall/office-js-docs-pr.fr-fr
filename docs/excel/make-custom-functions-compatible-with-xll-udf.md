---
title: Étendre des fonctions personnalisées avec des fonctions XLL définies par l’utilisateur
description: Activer la compatibilité avec Excel fonctions XLL définies par l’utilisateur qui ont des fonctionnalités équivalentes à vos fonctions personnalisées
ms.date: 03/09/2021
localization_priority: Normal
ms.openlocfilehash: 33c7ee9309196d627520b37a02d5a1bca44cb767
ms.sourcegitcommit: 883f71d395b19ccfc6874a0d5942a7016eb49e2c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/09/2021
ms.locfileid: "53349391"
---
# <a name="extend-custom-functions-with-xll-user-defined-functions"></a><span data-ttu-id="06065-103">Étendre des fonctions personnalisées avec des fonctions XLL définies par l’utilisateur</span><span class="sxs-lookup"><span data-stu-id="06065-103">Extend custom functions with XLL user-defined functions</span></span>

<span data-ttu-id="06065-104">Si vous avez des XL Excel existantes, vous pouvez créer des fonctions personnalisées équivalentes dans un add-in Excel pour étendre les fonctionnalités de votre solution à d’autres plateformes telles que en ligne ou sur un Mac.</span><span class="sxs-lookup"><span data-stu-id="06065-104">If you have existing Excel XLLs, you can build equivalent custom functions in an Excel add-in to extend your solution features to other platforms such as online or on a Mac.</span></span> <span data-ttu-id="06065-105">Toutefois, les Excel ne disposent pas de toutes les fonctionnalités disponibles dans les XL.</span><span class="sxs-lookup"><span data-stu-id="06065-105">However, Excel add-ins don't have all of the functionality available in XLLs.</span></span> <span data-ttu-id="06065-106">Selon les fonctionnalités que votre solution utilise, la XLL peut offrir une meilleure expérience que les fonctions personnalisées du Excel dans Excel sur Windows.</span><span class="sxs-lookup"><span data-stu-id="06065-106">Depending on the functionality your solution uses, the XLL may provide a better experience than the Excel add-in custom functions in Excel on Windows.</span></span>

> [!NOTE]
> <span data-ttu-id="06065-107">La compatibilité des modules UDF et du Microsoft 365 COM est prise en charge par les plateformes suivantes.</span><span class="sxs-lookup"><span data-stu-id="06065-107">COM add-in and XLL UDF compatibility is supported by the following platforms, when connected to a Microsoft 365 subscription.</span></span>
>
> - <span data-ttu-id="06065-108">Excel sur le web</span><span class="sxs-lookup"><span data-stu-id="06065-108">Excel on the web</span></span>
> - <span data-ttu-id="06065-109">Excel sur Windows (version 1904 ou ultérieure)</span><span class="sxs-lookup"><span data-stu-id="06065-109">Excel on Windows (version 1904 or later)</span></span>
> - <span data-ttu-id="06065-110">Excel sur Mac (version 13.329 ou ultérieure)</span><span class="sxs-lookup"><span data-stu-id="06065-110">Excel on Mac (version 13.329 or later)</span></span>
>
> <span data-ttu-id="06065-111">Pour utiliser la compatibilité des UDF et du Excel sur le Web COM, connectez-vous à l’aide de votre abonnement Microsoft 365 ou [d’un compte Microsoft.](https://account.microsoft.com/account)</span><span class="sxs-lookup"><span data-stu-id="06065-111">To use COM add-in and XLL UDF compatibility within Excel on the web, login by using either your Microsoft 365 subscription or a [Microsoft account](https://account.microsoft.com/account).</span></span> <span data-ttu-id="06065-112">Si vous n’avez pas encore d’abonnement Microsoft 365, vous pouvez obtenir un abonnement Microsoft 365 de 90 jours renouvelable gratuit en rejoignant le programme Microsoft 365 [développeur.](https://developer.microsoft.com/office/dev-program)</span><span class="sxs-lookup"><span data-stu-id="06065-112">If you don't already have a Microsoft 365 subscription, you can a free, 90-day renewable Microsoft 365 subscription by joining the [Microsoft 365 developer program](https://developer.microsoft.com/office/dev-program).</span></span>

## <a name="specify-equivalent-xll-in-the-manifest"></a><span data-ttu-id="06065-113">Spécifier un XLL équivalent dans le manifeste</span><span class="sxs-lookup"><span data-stu-id="06065-113">Specify equivalent XLL in the manifest</span></span>

<span data-ttu-id="06065-114">Pour activer la compatibilité avec un XLL existant, identifiez le XLL équivalent dans le manifeste de votre Excel de données.</span><span class="sxs-lookup"><span data-stu-id="06065-114">To enable compatibility with an existing XLL, identify the equivalent XLL in the manifest of your Excel add-in.</span></span> <span data-ttu-id="06065-115">Excel utilisera ensuite les fonctions XLL au lieu de vos fonctions personnalisées de Excel lors de l’exécution sur Windows.</span><span class="sxs-lookup"><span data-stu-id="06065-115">Excel will then use the XLL's functions instead of your Excel add-in custom functions when running on Windows.</span></span>

<span data-ttu-id="06065-116">Pour définir le XLL équivalent pour vos fonctions personnalisées, spécifiez le `FileName` XLL.</span><span class="sxs-lookup"><span data-stu-id="06065-116">To set the equivalent XLL for your custom functions, specify the `FileName` of the XLL.</span></span> <span data-ttu-id="06065-117">Lorsque l’utilisateur ouvre un workbook avec des fonctions du XLL, Excel convertit les fonctions en fonctions compatibles.</span><span class="sxs-lookup"><span data-stu-id="06065-117">When the user opens a workbook with functions from the XLL, Excel converts the functions to compatible functions.</span></span> <span data-ttu-id="06065-118">Le workbook utilise ensuite le XLL lorsqu’il est ouvert dans Excel sur Windows et utilise des fonctions personnalisées à partir de votre macro Excel lorsqu’il est ouvert en ligne ou sur un Mac.</span><span class="sxs-lookup"><span data-stu-id="06065-118">The workbook then uses the XLL when opened in Excel on Windows, and it will use custom functions from your Excel add-in when opened online or on a Mac.</span></span>

<span data-ttu-id="06065-119">L’exemple suivant montre comment spécifier un add-in COM et un XLL comme équivalent.</span><span class="sxs-lookup"><span data-stu-id="06065-119">The following example shows how to specify both a COM add-in and an XLL as equivalent.</span></span> <span data-ttu-id="06065-120">Souvent, vous spécifiez les deux.</span><span class="sxs-lookup"><span data-stu-id="06065-120">Often you will specify both.</span></span> <span data-ttu-id="06065-121">Pour plus d’complétance, cet exemple montre les deux en contexte.</span><span class="sxs-lookup"><span data-stu-id="06065-121">For completeness, this example shows both in context.</span></span> <span data-ttu-id="06065-122">Ils sont identifiés par `ProgId` leur `FileName` et, respectivement.</span><span class="sxs-lookup"><span data-stu-id="06065-122">They are identified by their `ProgId` and `FileName` respectively.</span></span> <span data-ttu-id="06065-123">`EquivalentAddins`L’élément doit être placé immédiatement avant la balise de `VersionOverrides` fermeture.</span><span class="sxs-lookup"><span data-stu-id="06065-123">The `EquivalentAddins` element must be positioned immediately before the closing `VersionOverrides` tag.</span></span> <span data-ttu-id="06065-124">Pour plus d’informations sur la compatibilité des applications COM, voir Rendre votre Office compatible avec un compl?ment [COM existant.](../develop/make-office-add-in-compatible-with-existing-com-add-in.md)</span><span class="sxs-lookup"><span data-stu-id="06065-124">For more information on COM add-in compatibility, see [Make your Office Add-in compatible with an existing COM add-in](../develop/make-office-add-in-compatible-with-existing-com-add-in.md).</span></span>

```xml
<VersionOverrides>
  ...
  <EquivalentAddins>
    <EquivalentAddin>
      <ProgId>ContosoCOMAddin</ProgId>
      <Type>COM</Type>
    </EquivalentAddin>

    <EquivalentAddin>
      <FileName>contosofunctions.xll</FileName>
      <Type>XLL</Type>
    </EquivalentAddin>
  </EquivalentAddins>
</VersionOverrides>
```

> [!NOTE]
> <span data-ttu-id="06065-125">Si un add-in déclare que ses fonctions personnalisées sont compatibles avec XLL, la modification ultérieure du manifeste peut rompre le classez d’un utilisateur, car il modifiera le format de fichier.</span><span class="sxs-lookup"><span data-stu-id="06065-125">If an add-in declares its custom functions to be XLL compatible, changing the manifest at a later time could break a user's workbook because it will change the file format.</span></span>

## <a name="custom-function-behavior-for-xll-compatible-functions"></a><span data-ttu-id="06065-126">Comportement des fonctions personnalisées pour les fonctions compatibles XLL</span><span class="sxs-lookup"><span data-stu-id="06065-126">Custom function behavior for XLL compatible functions</span></span>

<span data-ttu-id="06065-127">Les fonctions XLL d’un add-in sont converties en fonctions personnalisées compatibles avec XLL lorsqu’une feuille de calcul est ouverte et qu’un module équivalent est disponible.</span><span class="sxs-lookup"><span data-stu-id="06065-127">An add-in's XLL functions are converted to XLL compatible custom functions when a spreadsheet is opened and there is an equivalent add-in available.</span></span> <span data-ttu-id="06065-128">Lors de l’enregistrer suivant, les fonctions XLL sont écrites dans le fichier dans un mode compatible afin qu’elles fonctionnent avec les fonctions personnalisées de la XLL et du Excel (sur d’autres plateformes).</span><span class="sxs-lookup"><span data-stu-id="06065-128">On the next save, the XLL functions are written to the file in a compatible mode so that they work with both the XLL and Excel add-in custom functions (when on other platforms).</span></span>

<span data-ttu-id="06065-129">Le tableau suivant compare les fonctionnalités entre les fonctions XLL définies par l’utilisateur, les fonctions personnalisées compatibles XLL et Excel fonctions personnalisées de modules.</span><span class="sxs-lookup"><span data-stu-id="06065-129">The following table compares features across XLL user-defined functions, XLL compatible custom functions, and Excel add-in custom functions.</span></span>

|         |<span data-ttu-id="06065-130">Fonction XLL définie par l’utilisateur</span><span class="sxs-lookup"><span data-stu-id="06065-130">XLL user-defined function</span></span> |<span data-ttu-id="06065-131">Fonctions personnalisées compatibles XLL</span><span class="sxs-lookup"><span data-stu-id="06065-131">XLL compatible custom functions</span></span> |<span data-ttu-id="06065-132">Excel fonction personnalisée de add-in</span><span class="sxs-lookup"><span data-stu-id="06065-132">Excel add-in custom function</span></span> |
|---------|---------|---------|---------|
| <span data-ttu-id="06065-133">**Plateformes prises en charge**</span><span class="sxs-lookup"><span data-stu-id="06065-133">**Supported platforms**</span></span> | <span data-ttu-id="06065-134">Windows</span><span class="sxs-lookup"><span data-stu-id="06065-134">Windows</span></span> | <span data-ttu-id="06065-135">Windows, macOS, navigateur web</span><span class="sxs-lookup"><span data-stu-id="06065-135">Windows, macOS, web browser</span></span> | <span data-ttu-id="06065-136">Windows, macOS, navigateur web</span><span class="sxs-lookup"><span data-stu-id="06065-136">Windows, macOS, web browser</span></span> |
| <span data-ttu-id="06065-137">**Formats de fichiers pris en charge**</span><span class="sxs-lookup"><span data-stu-id="06065-137">**Supported file formats**</span></span> | <span data-ttu-id="06065-138">XLSX, XLSB, XLSM, XLS</span><span class="sxs-lookup"><span data-stu-id="06065-138">XLSX, XLSB, XLSM, XLS</span></span> | <span data-ttu-id="06065-139">XLSX, XLSB, XLSM</span><span class="sxs-lookup"><span data-stu-id="06065-139">XLSX, XLSB, XLSM</span></span> | <span data-ttu-id="06065-140">XLSX, XLSB, XLSM</span><span class="sxs-lookup"><span data-stu-id="06065-140">XLSX, XLSB, XLSM</span></span> |
| <span data-ttu-id="06065-141">**Autocomplete de formule**</span><span class="sxs-lookup"><span data-stu-id="06065-141">**Formula autocomplete**</span></span> | <span data-ttu-id="06065-142">Non</span><span class="sxs-lookup"><span data-stu-id="06065-142">No</span></span> | <span data-ttu-id="06065-143">Oui</span><span class="sxs-lookup"><span data-stu-id="06065-143">Yes</span></span> | <span data-ttu-id="06065-144">Oui</span><span class="sxs-lookup"><span data-stu-id="06065-144">Yes</span></span> |
| <span data-ttu-id="06065-145">**Diffusion en continu**</span><span class="sxs-lookup"><span data-stu-id="06065-145">**Streaming**</span></span> | <span data-ttu-id="06065-146">Possible via le rappel xlfRTD et XLL.</span><span class="sxs-lookup"><span data-stu-id="06065-146">Possible via xlfRTD and XLL callback.</span></span> | <span data-ttu-id="06065-147">Oui</span><span class="sxs-lookup"><span data-stu-id="06065-147">Yes</span></span> | <span data-ttu-id="06065-148">Oui</span><span class="sxs-lookup"><span data-stu-id="06065-148">Yes</span></span> |
| <span data-ttu-id="06065-149">**Localisation des fonctions**</span><span class="sxs-lookup"><span data-stu-id="06065-149">**Localization of functions**</span></span> | <span data-ttu-id="06065-150">Non</span><span class="sxs-lookup"><span data-stu-id="06065-150">No</span></span> | <span data-ttu-id="06065-151">Non.</span><span class="sxs-lookup"><span data-stu-id="06065-151">No.</span></span> <span data-ttu-id="06065-152">Le nom et l’ID doivent correspondre aux fonctions XLL existantes.</span><span class="sxs-lookup"><span data-stu-id="06065-152">The Name and ID must match the existing XLL's functions.</span></span> | <span data-ttu-id="06065-153">Oui</span><span class="sxs-lookup"><span data-stu-id="06065-153">Yes</span></span> |
| <span data-ttu-id="06065-154">**Fonctions volatiles**</span><span class="sxs-lookup"><span data-stu-id="06065-154">**Volatile functions**</span></span> | <span data-ttu-id="06065-155">Oui</span><span class="sxs-lookup"><span data-stu-id="06065-155">Yes</span></span> | <span data-ttu-id="06065-156">Oui</span><span class="sxs-lookup"><span data-stu-id="06065-156">Yes</span></span> | <span data-ttu-id="06065-157">Oui</span><span class="sxs-lookup"><span data-stu-id="06065-157">Yes</span></span> |
| <span data-ttu-id="06065-158">**Prise en charge du recalcul multi-thread**</span><span class="sxs-lookup"><span data-stu-id="06065-158">**Multi-threaded recalculation support**</span></span> | <span data-ttu-id="06065-159">Oui</span><span class="sxs-lookup"><span data-stu-id="06065-159">Yes</span></span> | <span data-ttu-id="06065-160">Oui</span><span class="sxs-lookup"><span data-stu-id="06065-160">Yes</span></span> | <span data-ttu-id="06065-161">Oui</span><span class="sxs-lookup"><span data-stu-id="06065-161">Yes</span></span> |
| <span data-ttu-id="06065-162">**Comportement du calcul**</span><span class="sxs-lookup"><span data-stu-id="06065-162">**Calculation behavior**</span></span> | <span data-ttu-id="06065-163">Aucune interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="06065-163">No UI.</span></span> <span data-ttu-id="06065-164">Excel ne répond pas pendant le calcul.</span><span class="sxs-lookup"><span data-stu-id="06065-164">Excel can be unresponsive during calculation.</span></span> | <span data-ttu-id="06065-165">Les utilisateurs voient #BUSY !</span><span class="sxs-lookup"><span data-stu-id="06065-165">Users will see #BUSY!</span></span> <span data-ttu-id="06065-166">jusqu’à ce qu’un résultat soit renvoyé.</span><span class="sxs-lookup"><span data-stu-id="06065-166">until a result is returned.</span></span> | <span data-ttu-id="06065-167">Les utilisateurs voient #BUSY !</span><span class="sxs-lookup"><span data-stu-id="06065-167">Users will see #BUSY!</span></span> <span data-ttu-id="06065-168">jusqu’à ce qu’un résultat soit renvoyé.</span><span class="sxs-lookup"><span data-stu-id="06065-168">until a result is returned.</span></span> |
| <span data-ttu-id="06065-169">**Ensembles de conditions requises**</span><span class="sxs-lookup"><span data-stu-id="06065-169">**Requirement sets**</span></span> | <span data-ttu-id="06065-170">S/O</span><span class="sxs-lookup"><span data-stu-id="06065-170">N/A</span></span> | <span data-ttu-id="06065-171">CustomFunctions 1.1 et les ultérieures</span><span class="sxs-lookup"><span data-stu-id="06065-171">CustomFunctions 1.1 and later</span></span> | <span data-ttu-id="06065-172">CustomFunctions 1.1 et les ultérieures</span><span class="sxs-lookup"><span data-stu-id="06065-172">CustomFunctions 1.1 and later</span></span> |

## <a name="see-also"></a><span data-ttu-id="06065-173">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="06065-173">See also</span></span>

- [<span data-ttu-id="06065-174">Rendre votre complément Office compatible avec un complément COM existant</span><span class="sxs-lookup"><span data-stu-id="06065-174">Make your Office Add-in compatible with an existing COM add-in</span></span>](../develop/make-office-add-in-compatible-with-existing-com-add-in.md)
- [<span data-ttu-id="06065-175">Didacticiel de fonctions personnalisées Excel</span><span class="sxs-lookup"><span data-stu-id="06065-175">Excel custom functions tutorial</span></span>](../tutorials/excel-tutorial-create-custom-functions.md)
