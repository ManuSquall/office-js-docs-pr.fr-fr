---
title: Étendre des fonctions personnalisées avec des fonctions XLL définies par l’utilisateur
description: Activer la compatibilité avec les fonctions Excel XLL définies par l’utilisateur qui offrent une fonctionnalité équivalente à vos fonctions personnalisées
ms.date: 07/31/2019
localization_priority: Normal
ms.openlocfilehash: 8c83ea8a5b97cd4f23a9e25fddabe3d178b1e482
ms.sourcegitcommit: fa4e81fcf41b1c39d5516edf078f3ffdbd4a3997
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/17/2020
ms.locfileid: "42717039"
---
# <a name="extend-custom-functions-with-xll-user-defined-functions"></a><span data-ttu-id="2b993-103">Étendre des fonctions personnalisées avec des fonctions XLL définies par l’utilisateur</span><span class="sxs-lookup"><span data-stu-id="2b993-103">Extend custom functions with XLL user-defined functions</span></span>

<span data-ttu-id="2b993-104">Si vous avez des XLL Excel existantes, vous pouvez créer des fonctions personnalisées équivalentes dans un complément Excel pour étendre les fonctionnalités de votre solution à d’autres plateformes, comme Online ou macOS.</span><span class="sxs-lookup"><span data-stu-id="2b993-104">If you have existing Excel XLLs, you can build equivalent custom functions in an Excel add-in to extend your solution features to other platforms such as online or macOS.</span></span> <span data-ttu-id="2b993-105">Toutefois, les compléments Excel ne disposent pas de toutes les fonctionnalités disponibles dans les XLL.</span><span class="sxs-lookup"><span data-stu-id="2b993-105">However, Excel add-ins don't have all of the functionality available in XLLs.</span></span> <span data-ttu-id="2b993-106">En fonction de la fonctionnalité utilisée par votre solution, le XLL peut offrir une meilleure expérience que les fonctions personnalisées de complément Excel dans Excel sur Windows.</span><span class="sxs-lookup"><span data-stu-id="2b993-106">Depending on the functionality your solution uses, the XLL may provide a better experience than the Excel add-in custom functions in Excel on Windows.</span></span>

> [!NOTE]
> <span data-ttu-id="2b993-107">Le complément COM et la compatibilité UDF XLL sont pris en charge par les plateformes suivantes, lorsqu’ils sont connectés à un abonnement Office 365 :</span><span class="sxs-lookup"><span data-stu-id="2b993-107">COM add-in and XLL UDF compatibility is supported by the following platforms, when connected to an Office 365 subscription:</span></span>
> - <span data-ttu-id="2b993-108">Excel sur le web</span><span class="sxs-lookup"><span data-stu-id="2b993-108">Excel on the web</span></span>
> - <span data-ttu-id="2b993-109">Excel sur Windows (version 1904 ou ultérieure)</span><span class="sxs-lookup"><span data-stu-id="2b993-109">Excel on Windows (version 1904 or later)</span></span>
> - <span data-ttu-id="2b993-110">Excel sur Mac (version 13,329 ou ultérieure)</span><span class="sxs-lookup"><span data-stu-id="2b993-110">Excel on Mac (version 13.329 or later)</span></span>
> 
> <span data-ttu-id="2b993-111">Pour utiliser le complément COM et la compatibilité des FDU XLL dans Excel sur le Web, connectez-vous à l’aide de votre abonnement Office 365 ou d’un [compte Microsoft](https://account.microsoft.com/account).</span><span class="sxs-lookup"><span data-stu-id="2b993-111">To use COM add-in and XLL UDF compatibility within Excel on the web, login by using either your Office 365 subscription or a [Microsoft account](https://account.microsoft.com/account).</span></span> <span data-ttu-id="2b993-112">Si vous ne disposez pas déjà d’un abonnement Office 365, vous pouvez obtenir gratuitement un abonnement Office 365 renouvelable 90 jours en joignant le [programme de développement office 365](https://developer.microsoft.com/office/dev-program).</span><span class="sxs-lookup"><span data-stu-id="2b993-112">If you don't already have an Office 365 subscription, you can a free, 90-day renewable Office 365 subscription by joining the [Office 365 Developer Program](https://developer.microsoft.com/office/dev-program).</span></span>

## <a name="specify-equivalent-xll-in-the-manifest"></a><span data-ttu-id="2b993-113">Spécifier le XLL équivalent dans le manifeste</span><span class="sxs-lookup"><span data-stu-id="2b993-113">Specify equivalent XLL in the manifest</span></span>

<span data-ttu-id="2b993-114">Pour activer la compatibilité avec un XLL existant, identifiez le XLL équivalent dans le manifeste de votre complément Excel.</span><span class="sxs-lookup"><span data-stu-id="2b993-114">To enable compatibility with an existing XLL, identify the equivalent XLL in the manifest of your Excel add-in.</span></span> <span data-ttu-id="2b993-115">Ensuite, Excel utilise les fonctions de la XLL au lieu de vos fonctions personnalisées de complément Excel lors de l’exécution de Windows.</span><span class="sxs-lookup"><span data-stu-id="2b993-115">Then Excel will use the XLL's functions instead of your Excel add-in custom functions when running on Windows.</span></span>

<span data-ttu-id="2b993-116">Pour définir le XLL équivalent pour vos fonctions personnalisées, spécifiez l' `FileName` élément XLL.</span><span class="sxs-lookup"><span data-stu-id="2b993-116">To set the equivalent XLL for your custom functions, specify the `FileName` of the XLL.</span></span> <span data-ttu-id="2b993-117">Lorsque l’utilisateur ouvre un classeur avec des fonctions à partir de la XLL, Excel convertit les fonctions en fonctions compatibles.</span><span class="sxs-lookup"><span data-stu-id="2b993-117">When the user opens a workbook with functions from the XLL, Excel converts the functions to compatible functions.</span></span> <span data-ttu-id="2b993-118">Le classeur utilise ensuite le XLL lorsqu’il est ouvert dans Excel sur Windows et utilise des fonctions personnalisées à partir de votre complément Excel lorsqu’il est ouvert en ligne ou sur macOS.</span><span class="sxs-lookup"><span data-stu-id="2b993-118">The workbook then uses the XLL when opened in Excel on Windows, and it will use custom functions from your Excel add-in when opened online or on macOS.</span></span>

<span data-ttu-id="2b993-119">L’exemple suivant montre comment spécifier un complément COM et un XLL comme équivalent.</span><span class="sxs-lookup"><span data-stu-id="2b993-119">The following example shows how to specify both a COM add-in and an XLL as equivalent.</span></span> <span data-ttu-id="2b993-120">Souvent, vous spécifierez à la fois de manière à ce que cet exemple montre les deux dans le contexte.</span><span class="sxs-lookup"><span data-stu-id="2b993-120">Often you will specify both so for completeness this example shows both in context.</span></span> <span data-ttu-id="2b993-121">Ils sont identifiés par leur `ProgId` et `FileName` respectivement.</span><span class="sxs-lookup"><span data-stu-id="2b993-121">They are identified by their `ProgId` and `FileName` respectively.</span></span> <span data-ttu-id="2b993-122">L' `EquivalentAddins` élément doit être placé immédiatement avant la balise de fermeture `VersionOverrides` .</span><span class="sxs-lookup"><span data-stu-id="2b993-122">The `EquivalentAddins` element must be positioned immediately before the closing `VersionOverrides` tag.</span></span> <span data-ttu-id="2b993-123">Pour plus d’informations sur la compatibilité des compléments COM, consultez [la rubrique faire en sorte que votre complément Excel soit compatible avec un complément COM existant](../develop/make-office-add-in-compatible-with-existing-com-add-in.md).</span><span class="sxs-lookup"><span data-stu-id="2b993-123">For more information on COM add-in compatibility, see [Make your Excel add-in compatible with an existing COM add-in](../develop/make-office-add-in-compatible-with-existing-com-add-in.md).</span></span>

```xml
<VersionOverrides>
  ...
  <EquivalentAddins>
    <EquivalentAddin>
      <ProgId>ContosoCOMAddin</ProgId>
      <Type>COM</Type>
    </EquivalentAddin>

    <EquivalentAddin>
      <FileName>contosofunctions.xll</FileName>
      <Type>XLL</Type>
    </EquivalentAddin>
  <EquivalentAddins>
</VersionOverrides>
```

> [!NOTE]
> <span data-ttu-id="2b993-124">Si un complément déclare ses fonctions personnalisées comme étant compatibles XLL, la modification du manifeste ultérieurement pourrait entraîner la rupture du classeur d’un utilisateur, car il modifiera le format de fichier.</span><span class="sxs-lookup"><span data-stu-id="2b993-124">If an add-in declares its custom functions to be XLL compatible, changing the manifest at a later time could break a user's workbook because it will change the file format.</span></span>

## <a name="custom-function-behavior-for-xll-compatible-functions"></a><span data-ttu-id="2b993-125">Comportement des fonctions personnalisées pour les fonctions compatibles XLL</span><span class="sxs-lookup"><span data-stu-id="2b993-125">Custom function behavior for XLL compatible functions</span></span>

<span data-ttu-id="2b993-126">Lors de l’ouverture d’une feuille de calcul qui contient des fonctions XLL pour lesquelles il existe également un complément équivalent, les fonctions de la XLL sont converties en fonctions personnalisées compatibles XLL.</span><span class="sxs-lookup"><span data-stu-id="2b993-126">When a spreadsheet is opened that contains XLL functions for which there is also an equivalent add-in, the XLL's functions are converted to XLL compatible custom functions.</span></span> <span data-ttu-id="2b993-127">Lors du prochain enregistrement, les utilisateurs sont écrits dans le fichier dans un mode compatible afin qu’ils fonctionnent avec les fonctions personnalisées XLL et complément Excel (sur d’autres plateformes).</span><span class="sxs-lookup"><span data-stu-id="2b993-127">On the next save, they are written to the file in a compatible mode so that they work with both the XLL and Excel add-in custom functions (when on other platforms).</span></span>

<span data-ttu-id="2b993-128">Le tableau suivant compare les fonctionnalités des fonctions définies par l’utilisateur XLL, des fonctions personnalisées de XLL et des fonctions personnalisées de complément Excel.</span><span class="sxs-lookup"><span data-stu-id="2b993-128">The following table compares features across XLL user-defined functions, XLL compatible custom functions, and Excel add-in custom functions.</span></span>

|         |<span data-ttu-id="2b993-129">Fonction XLL définie par l’utilisateur</span><span class="sxs-lookup"><span data-stu-id="2b993-129">XLL user-defined function</span></span> |<span data-ttu-id="2b993-130">Fonctions personnalisées compatibles XLL</span><span class="sxs-lookup"><span data-stu-id="2b993-130">XLL compatible custom functions</span></span> |<span data-ttu-id="2b993-131">Fonction personnalisée de complément Excel</span><span class="sxs-lookup"><span data-stu-id="2b993-131">Excel add-in custom function</span></span> |
|---------|---------|---------|---------|
| <span data-ttu-id="2b993-132">Plateformes prises en charge</span><span class="sxs-lookup"><span data-stu-id="2b993-132">Supported platforms</span></span> | <span data-ttu-id="2b993-133">Windows</span><span class="sxs-lookup"><span data-stu-id="2b993-133">Windows</span></span> | <span data-ttu-id="2b993-134">Windows, macOS, navigateur Web</span><span class="sxs-lookup"><span data-stu-id="2b993-134">Windows, macOS, web browser</span></span> | <span data-ttu-id="2b993-135">Windows, macOS, navigateur Web</span><span class="sxs-lookup"><span data-stu-id="2b993-135">Windows, macOS, web browser</span></span> |
| <span data-ttu-id="2b993-136">Formats de fichiers pris en charge</span><span class="sxs-lookup"><span data-stu-id="2b993-136">Supported file formats</span></span> | <span data-ttu-id="2b993-137">XLSX, XLSB, XLSM, XLS</span><span class="sxs-lookup"><span data-stu-id="2b993-137">XLSX, XLSB, XLSM, XLS</span></span> | <span data-ttu-id="2b993-138">XLSX, XLSB, XLSM</span><span class="sxs-lookup"><span data-stu-id="2b993-138">XLSX, XLSB, XLSM</span></span> | <span data-ttu-id="2b993-139">XLSX, XLSB, XLSM</span><span class="sxs-lookup"><span data-stu-id="2b993-139">XLSX, XLSB, XLSM</span></span> |
| <span data-ttu-id="2b993-140">Saisie semi-automatique de formule</span><span class="sxs-lookup"><span data-stu-id="2b993-140">Formula autocomplete</span></span> | <span data-ttu-id="2b993-141">Non</span><span class="sxs-lookup"><span data-stu-id="2b993-141">No</span></span> | <span data-ttu-id="2b993-142">Oui</span><span class="sxs-lookup"><span data-stu-id="2b993-142">Yes</span></span> | <span data-ttu-id="2b993-143">Oui</span><span class="sxs-lookup"><span data-stu-id="2b993-143">Yes</span></span> |
| <span data-ttu-id="2b993-144">Diffusion en continu</span><span class="sxs-lookup"><span data-stu-id="2b993-144">Streaming</span></span> | <span data-ttu-id="2b993-145">Possible via xlfRTD et le rappel XLL.</span><span class="sxs-lookup"><span data-stu-id="2b993-145">Possible via xlfRTD and XLL callback.</span></span> | <span data-ttu-id="2b993-146">Non</span><span class="sxs-lookup"><span data-stu-id="2b993-146">No</span></span> | <span data-ttu-id="2b993-147">Oui</span><span class="sxs-lookup"><span data-stu-id="2b993-147">Yes</span></span> |
| <span data-ttu-id="2b993-148">Localisation des fonctions</span><span class="sxs-lookup"><span data-stu-id="2b993-148">Localization of functions</span></span> | <span data-ttu-id="2b993-149">Non</span><span class="sxs-lookup"><span data-stu-id="2b993-149">No</span></span> | <span data-ttu-id="2b993-150">Non.</span><span class="sxs-lookup"><span data-stu-id="2b993-150">No.</span></span> <span data-ttu-id="2b993-151">Le nom et l’ID doivent correspondre aux fonctions de la XLL existante.</span><span class="sxs-lookup"><span data-stu-id="2b993-151">The Name and ID must match the existing XLL's functions.</span></span> | <span data-ttu-id="2b993-152">Oui</span><span class="sxs-lookup"><span data-stu-id="2b993-152">Yes</span></span> |
| <span data-ttu-id="2b993-153">Fonctions volatiles</span><span class="sxs-lookup"><span data-stu-id="2b993-153">Volatile functions</span></span> | <span data-ttu-id="2b993-154">Oui</span><span class="sxs-lookup"><span data-stu-id="2b993-154">Yes</span></span> | <span data-ttu-id="2b993-155">Oui</span><span class="sxs-lookup"><span data-stu-id="2b993-155">Yes</span></span> | <span data-ttu-id="2b993-156">Oui</span><span class="sxs-lookup"><span data-stu-id="2b993-156">Yes</span></span> |
| <span data-ttu-id="2b993-157">Prise en charge du recalcul multi-thread</span><span class="sxs-lookup"><span data-stu-id="2b993-157">Multi-threaded recalculation support</span></span> | <span data-ttu-id="2b993-158">Oui</span><span class="sxs-lookup"><span data-stu-id="2b993-158">Yes</span></span> | <span data-ttu-id="2b993-159">Oui</span><span class="sxs-lookup"><span data-stu-id="2b993-159">Yes</span></span> | <span data-ttu-id="2b993-160">Oui</span><span class="sxs-lookup"><span data-stu-id="2b993-160">Yes</span></span> |
| <span data-ttu-id="2b993-161">Comportement du calcul</span><span class="sxs-lookup"><span data-stu-id="2b993-161">Calculation behavior</span></span> | <span data-ttu-id="2b993-162">Aucune interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="2b993-162">No UI.</span></span> <span data-ttu-id="2b993-163">Excel peut ne pas répondre pendant le calcul.</span><span class="sxs-lookup"><span data-stu-id="2b993-163">Excel can be unresponsive during calculation.</span></span> | <span data-ttu-id="2b993-164">Les utilisateurs verront #BUSY !</span><span class="sxs-lookup"><span data-stu-id="2b993-164">Users will see #BUSY!</span></span> <span data-ttu-id="2b993-165">jusqu’à ce qu’un résultat soit renvoyé.</span><span class="sxs-lookup"><span data-stu-id="2b993-165">until a result is returned.</span></span> | <span data-ttu-id="2b993-166">Les utilisateurs verront #BUSY !</span><span class="sxs-lookup"><span data-stu-id="2b993-166">Users will see #BUSY!</span></span> <span data-ttu-id="2b993-167">jusqu’à ce qu’un résultat soit renvoyé.</span><span class="sxs-lookup"><span data-stu-id="2b993-167">until a result is returned.</span></span> |
| <span data-ttu-id="2b993-168">Ensembles de conditions requises</span><span class="sxs-lookup"><span data-stu-id="2b993-168">Requirement sets</span></span> | <span data-ttu-id="2b993-169">N/A</span><span class="sxs-lookup"><span data-stu-id="2b993-169">N/A</span></span> | <span data-ttu-id="2b993-170">CustomFunctions 1,1 et versions ultérieures</span><span class="sxs-lookup"><span data-stu-id="2b993-170">CustomFunctions 1.1 and later</span></span> | <span data-ttu-id="2b993-171">CustomFunctions 1,1 et versions ultérieures</span><span class="sxs-lookup"><span data-stu-id="2b993-171">CustomFunctions 1.1 and later</span></span> |

## <a name="see-also"></a><span data-ttu-id="2b993-172">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="2b993-172">See also</span></span>

- [<span data-ttu-id="2b993-173">Faire en sorte que votre complément Excel soit compatible avec un complément COM existant</span><span class="sxs-lookup"><span data-stu-id="2b993-173">Make your Excel add-in compatible with an existing COM add-in</span></span>](../develop/make-office-add-in-compatible-with-existing-com-add-in.md)
- [<span data-ttu-id="2b993-174">Didacticiel de fonctions personnalisées Excel</span><span class="sxs-lookup"><span data-stu-id="2b993-174">Excel custom functions tutorial</span></span>](../tutorials/excel-tutorial-create-custom-functions.md)
