---
title: Étendre des fonctions personnalisées avec des fonctions XLL définies par l’utilisateur
description: Activer la compatibilité avec les fonctions Excel XLL définies par l’utilisateur qui offrent une fonctionnalité équivalente à vos fonctions personnalisées (aperçu)
ms.date: 05/08/2019
localization_priority: Normal
ms.openlocfilehash: 3e1782c5df227d3e173f4291ba88f2057200b1c5
ms.sourcegitcommit: a99be9c4771c45f3e07e781646e0e649aa47213f
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/11/2019
ms.locfileid: "33951885"
---
# <a name="extend-custom-functions-with-xll-user-defined-functions-preview"></a><span data-ttu-id="f1d08-103">Étendre les fonctions personnalisées avec les fonctions XLL définies par l’utilisateur (aperçu)</span><span class="sxs-lookup"><span data-stu-id="f1d08-103">Extend custom functions with XLL user-defined functions (preview)</span></span>

<span data-ttu-id="f1d08-104">Si vous avez des XLL Excel existantes, vous pouvez créer des fonctions personnalisées équivalentes dans un complément Excel pour étendre les fonctionnalités de votre solution à d’autres plateformes, comme Online ou macOS.</span><span class="sxs-lookup"><span data-stu-id="f1d08-104">If you have existing Excel XLLs, you can build equivalent custom functions in an Excel add-in to extend your solution features to other platforms such as online or macOS.</span></span> <span data-ttu-id="f1d08-105">Toutefois, les compléments Excel ne disposent pas de toutes les fonctionnalités disponibles dans les XLL.</span><span class="sxs-lookup"><span data-stu-id="f1d08-105">However, Excel add-ins don't have all of the functionality available in XLLs.</span></span> <span data-ttu-id="f1d08-106">En fonction de la fonctionnalité utilisée par votre solution, le XLL peut offrir une meilleure expérience que les fonctions personnalisées de complément Excel dans Excel sur Windows.</span><span class="sxs-lookup"><span data-stu-id="f1d08-106">Depending on the functionality your solution uses, the XLL may provide a better experience than the Excel add-in custom functions in Excel on Windows.</span></span>

[!include[COM add-in and XLL UDF compatibility note](../includes/xll-compatibility-note.md)]

## <a name="specify-equivalent-xll-in-the-manifest"></a><span data-ttu-id="f1d08-107">Spécifier le XLL équivalent dans le manifeste</span><span class="sxs-lookup"><span data-stu-id="f1d08-107">Specify equivalent XLL in the manifest</span></span>

<span data-ttu-id="f1d08-108">Pour activer la compatibilité avec un XLL existant, identifiez le XLL équivalent dans le manifeste de votre complément Excel.</span><span class="sxs-lookup"><span data-stu-id="f1d08-108">To enable compatibility with an existing XLL, identify the equivalent XLL in the manifest of your Excel add-in.</span></span> <span data-ttu-id="f1d08-109">Ensuite, Excel utilise les fonctions de la XLL au lieu de vos fonctions personnalisées de complément Excel lors de l’exécution de Windows.</span><span class="sxs-lookup"><span data-stu-id="f1d08-109">Then Excel will use the XLL's functions instead of your Excel add-in custom functions when running on Windows.</span></span>

<span data-ttu-id="f1d08-110">Pour définir le XLL équivalent pour vos fonctions personnalisées, spécifiez l' `FileName` élément XLL.</span><span class="sxs-lookup"><span data-stu-id="f1d08-110">To set the equivalent XLL for your custom functions, specify the `FileName` of the XLL.</span></span> <span data-ttu-id="f1d08-111">Lorsque l’utilisateur ouvre un classeur avec des fonctions à partir de la XLL, Excel convertit les fonctions en fonctions compatibles.</span><span class="sxs-lookup"><span data-stu-id="f1d08-111">When the user opens a workbook with functions from the XLL, Excel converts the functions to compatible functions.</span></span> <span data-ttu-id="f1d08-112">Le classeur utilise ensuite le XLL lorsqu’il est ouvert dans Excel sur Windows et utilise des fonctions personnalisées à partir de votre complément Excel lorsqu’il est ouvert en ligne ou sur macOS.</span><span class="sxs-lookup"><span data-stu-id="f1d08-112">The workbook then uses the XLL when opened in Excel on Windows, and it will use custom functions from your Excel add-in when opened online or on macOS.</span></span>

<span data-ttu-id="f1d08-113">L’exemple suivant montre comment spécifier un complément COM et un XLL comme équivalent.</span><span class="sxs-lookup"><span data-stu-id="f1d08-113">The following example shows how to specify both a COM add-in and an XLL as equivalent.</span></span> <span data-ttu-id="f1d08-114">Souvent, vous spécifierez à la fois de manière à ce que cet exemple montre les deux dans le contexte.</span><span class="sxs-lookup"><span data-stu-id="f1d08-114">Often you will specify both so for completeness this example shows both in context.</span></span> <span data-ttu-id="f1d08-115">Ils sont identifiés par leur `ProgID` et `FileName` respectivement.</span><span class="sxs-lookup"><span data-stu-id="f1d08-115">They are identified by their `ProgID` and `FileName` respectively.</span></span> <span data-ttu-id="f1d08-116">Pour plus d’informations sur la compatibilité des compléments COM, consultez [la rubrique faire en sorte que votre complément Excel soit compatible avec un complément COM existant](../develop/make-office-add-in-compatible-with-existing-com-add-in.md).</span><span class="sxs-lookup"><span data-stu-id="f1d08-116">For more information on COM add-in compatibility, see [Make your Excel add-in compatible with an existing COM add-in](../develop/make-office-add-in-compatible-with-existing-com-add-in.md).</span></span>

```xml
<VersionOverrides>
...
<EquivalentAddins>
  <EquivalentAddin>
    <ProgID>ContosoCOMAddin</ProgID>
    <Type>COM</Type>
  </EquivalentAddin>

  <EquivalentAddin>
    <FileName>contosofunctions.xll</FileName>
    <Type>XLL</Type>
  </EquivalentAddin>
<EquivalentAddins>
...
</VersionOverrides>
```

> [!NOTE]
> <span data-ttu-id="f1d08-117">Si un complément déclare ses fonctions personnalisées comme étant compatibles XLL, la modification du manifeste ultérieurement pourrait entraîner la rupture du classeur d’un utilisateur, car il modifiera le format de fichier.</span><span class="sxs-lookup"><span data-stu-id="f1d08-117">If an add-in declares its custom functions to be XLL compatible, changing the manifest at a later time could break a user’s workbook because it will change the file format.</span></span>

## <a name="excel-add-in-updates"></a><span data-ttu-id="f1d08-118">Mises à jour des compléments Excel</span><span class="sxs-lookup"><span data-stu-id="f1d08-118">Excel add-in updates</span></span>

<span data-ttu-id="f1d08-119">Une fois que vous avez spécifié une XLL équivalente pour votre complément Excel, Excel cesse de traiter les mises à jour pour votre complément Excel.</span><span class="sxs-lookup"><span data-stu-id="f1d08-119">Once you specify an equivalent XLL for your Excel add-in, Excel stops processing updates for your Excel add-in.</span></span> <span data-ttu-id="f1d08-120">L’utilisateur doit désinstaller le XLL afin d’obtenir les dernières mises à jour pour le complément Excel.</span><span class="sxs-lookup"><span data-stu-id="f1d08-120">The user must uninstall the XLL in order to get the latest updates for the Excel add-in.</span></span>

## <a name="custom-function-behavior-for-xll-compatible-functions"></a><span data-ttu-id="f1d08-121">Comportement des fonctions personnalisées pour les fonctions compatibles XLL</span><span class="sxs-lookup"><span data-stu-id="f1d08-121">Custom function behavior for XLL compatible functions</span></span>

<span data-ttu-id="f1d08-122">Lors de l’ouverture d’une feuille de calcul qui contient des fonctions XLL pour lesquelles il existe également un complément équivalent, les fonctions de la XLL sont converties en fonctions personnalisées compatibles XLL.</span><span class="sxs-lookup"><span data-stu-id="f1d08-122">When a spreadsheet is opened that contains XLL functions for which there is also an equivalent add-in, the XLL's functions are converted to XLL compatible custom functions.</span></span> <span data-ttu-id="f1d08-123">Lors du prochain enregistrement, les utilisateurs sont écrits dans le fichier dans un mode compatible afin qu’ils fonctionnent avec les fonctions personnalisées XLL et complément Excel (sur d’autres plateformes).</span><span class="sxs-lookup"><span data-stu-id="f1d08-123">On the next save, they are written to the file in a compatible mode so that they work with both the XLL and Excel add-in custom functions (when on other platforms).</span></span>

<span data-ttu-id="f1d08-124">Le tableau suivant compare les fonctionnalités des fonctions définies par l’utilisateur XLL, des fonctions personnalisées de XLL et des fonctions personnalisées de complément Excel.</span><span class="sxs-lookup"><span data-stu-id="f1d08-124">The following table compares features across XLL user-defined functions, XLL compatible custom functions, and Excel add-in custom functions.</span></span>

|         |<span data-ttu-id="f1d08-125">Fonction XLL définie par l’utilisateur</span><span class="sxs-lookup"><span data-stu-id="f1d08-125">XLL user-defined function</span></span> |<span data-ttu-id="f1d08-126">Fonctions personnalisées compatibles XLL</span><span class="sxs-lookup"><span data-stu-id="f1d08-126">XLL compatible custom functions</span></span> |<span data-ttu-id="f1d08-127">Fonction personnalisée de complément Excel</span><span class="sxs-lookup"><span data-stu-id="f1d08-127">Excel add-in custom function</span></span> |
|---------|---------|---------|---------|
| <span data-ttu-id="f1d08-128">Plateformes prises en charge</span><span class="sxs-lookup"><span data-stu-id="f1d08-128">Supported platforms</span></span> | <span data-ttu-id="f1d08-129">Windows</span><span class="sxs-lookup"><span data-stu-id="f1d08-129">Windows</span></span> | <span data-ttu-id="f1d08-130">Windows, macOS, Excel Online</span><span class="sxs-lookup"><span data-stu-id="f1d08-130">Windows, macOS, Excel online</span></span> | <span data-ttu-id="f1d08-131">Windows, macOS, Excel Online</span><span class="sxs-lookup"><span data-stu-id="f1d08-131">Windows, macOS, Excel online</span></span> |
| <span data-ttu-id="f1d08-132">Formats de fichiers pris en charge</span><span class="sxs-lookup"><span data-stu-id="f1d08-132">Supported file formats</span></span> | <span data-ttu-id="f1d08-133">XLSX, XLSB, XLSM, XLS</span><span class="sxs-lookup"><span data-stu-id="f1d08-133">XLSX, XLSB, XLSM, XLS</span></span> | <span data-ttu-id="f1d08-134">XLSX, XLSB, XLSM</span><span class="sxs-lookup"><span data-stu-id="f1d08-134">XLSX, XLSB, XLSM</span></span> | <span data-ttu-id="f1d08-135">XLSX, XLSB, XLSM</span><span class="sxs-lookup"><span data-stu-id="f1d08-135">XLSX, XLSB, XLSM</span></span> |
| <span data-ttu-id="f1d08-136">Saisie semi-automatique de formule</span><span class="sxs-lookup"><span data-stu-id="f1d08-136">Formula autocomplete</span></span> | <span data-ttu-id="f1d08-137">Non</span><span class="sxs-lookup"><span data-stu-id="f1d08-137">No</span></span> | <span data-ttu-id="f1d08-138">Oui</span><span class="sxs-lookup"><span data-stu-id="f1d08-138">Yes</span></span> | <span data-ttu-id="f1d08-139">Oui</span><span class="sxs-lookup"><span data-stu-id="f1d08-139">Yes</span></span> |
| <span data-ttu-id="f1d08-140">Diffusion en continu</span><span class="sxs-lookup"><span data-stu-id="f1d08-140">Streaming</span></span> | <span data-ttu-id="f1d08-141">Possible via xlfRTD et le rappel XLL.</span><span class="sxs-lookup"><span data-stu-id="f1d08-141">Possible via xlfRTD and XLL callback.</span></span> | <span data-ttu-id="f1d08-142">Non</span><span class="sxs-lookup"><span data-stu-id="f1d08-142">No</span></span> | <span data-ttu-id="f1d08-143">Oui</span><span class="sxs-lookup"><span data-stu-id="f1d08-143">Yes</span></span> |
| <span data-ttu-id="f1d08-144">Localisation des fonctions</span><span class="sxs-lookup"><span data-stu-id="f1d08-144">Localization of functions</span></span> | <span data-ttu-id="f1d08-145">Non</span><span class="sxs-lookup"><span data-stu-id="f1d08-145">No</span></span> | <span data-ttu-id="f1d08-146">Non.</span><span class="sxs-lookup"><span data-stu-id="f1d08-146">No.</span></span> <span data-ttu-id="f1d08-147">Le nom et l’ID doivent correspondre aux fonctions de la XLL existante.</span><span class="sxs-lookup"><span data-stu-id="f1d08-147">The Name and ID must match the existing XLL's functions.</span></span> | <span data-ttu-id="f1d08-148">Oui</span><span class="sxs-lookup"><span data-stu-id="f1d08-148">Yes</span></span> |
| <span data-ttu-id="f1d08-149">Fonctions volatiles</span><span class="sxs-lookup"><span data-stu-id="f1d08-149">Volatile functions</span></span> | <span data-ttu-id="f1d08-150">Oui</span><span class="sxs-lookup"><span data-stu-id="f1d08-150">Yes</span></span> | <span data-ttu-id="f1d08-151">Oui</span><span class="sxs-lookup"><span data-stu-id="f1d08-151">Yes</span></span> | <span data-ttu-id="f1d08-152">Oui</span><span class="sxs-lookup"><span data-stu-id="f1d08-152">Yes</span></span> |
| <span data-ttu-id="f1d08-153">Prise en charge du recalcul multi-thread</span><span class="sxs-lookup"><span data-stu-id="f1d08-153">Multi-threaded recalculation support</span></span> | <span data-ttu-id="f1d08-154">Oui</span><span class="sxs-lookup"><span data-stu-id="f1d08-154">Yes</span></span> | <span data-ttu-id="f1d08-155">Oui</span><span class="sxs-lookup"><span data-stu-id="f1d08-155">Yes</span></span> | <span data-ttu-id="f1d08-156">Oui</span><span class="sxs-lookup"><span data-stu-id="f1d08-156">Yes</span></span> |
| <span data-ttu-id="f1d08-157">Comportement du calcul</span><span class="sxs-lookup"><span data-stu-id="f1d08-157">Calculation behavior</span></span> | <span data-ttu-id="f1d08-158">Aucune interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="f1d08-158">No UI.</span></span> <span data-ttu-id="f1d08-159">Excel peut ne pas répondre pendant le calcul.</span><span class="sxs-lookup"><span data-stu-id="f1d08-159">Excel can be unresponsive during calculation.</span></span> | <span data-ttu-id="f1d08-160">Les utilisateurs verront #BUSY!</span><span class="sxs-lookup"><span data-stu-id="f1d08-160">Users will see #BUSY!</span></span> <span data-ttu-id="f1d08-161">jusqu’à ce qu’un résultat soit renvoyé.</span><span class="sxs-lookup"><span data-stu-id="f1d08-161">until a result is returned.</span></span> | <span data-ttu-id="f1d08-162">Les utilisateurs verront #BUSY!</span><span class="sxs-lookup"><span data-stu-id="f1d08-162">Users will see #BUSY!</span></span> <span data-ttu-id="f1d08-163">jusqu’à ce qu’un résultat soit renvoyé.</span><span class="sxs-lookup"><span data-stu-id="f1d08-163">until a result is returned.</span></span> |
| <span data-ttu-id="f1d08-164">Ensembles de conditions requises</span><span class="sxs-lookup"><span data-stu-id="f1d08-164">Requirement sets</span></span> | <span data-ttu-id="f1d08-165">S/O</span><span class="sxs-lookup"><span data-stu-id="f1d08-165">N/A</span></span> | <span data-ttu-id="f1d08-166">CustomFunctions 1,1 et versions ultérieures</span><span class="sxs-lookup"><span data-stu-id="f1d08-166">CustomFunctions 1.1 and later</span></span> | <span data-ttu-id="f1d08-167">CustomFunctions 1,1 et versions ultérieures</span><span class="sxs-lookup"><span data-stu-id="f1d08-167">CustomFunctions 1.1 and later</span></span> |

## <a name="see-also"></a><span data-ttu-id="f1d08-168">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="f1d08-168">See also</span></span>

- [<span data-ttu-id="f1d08-169">Faire en sorte que votre complément Excel soit compatible avec un complément COM existant</span><span class="sxs-lookup"><span data-stu-id="f1d08-169">Make your Excel add-in compatible with an existing COM add-in</span></span>](../develop/make-office-add-in-compatible-with-existing-com-add-in.md)
- [<span data-ttu-id="f1d08-170">Meilleures pratiques de fonctions personnalisées</span><span class="sxs-lookup"><span data-stu-id="f1d08-170">Custom functions best practices</span></span>](custom-functions-best-practices.md)
- [<span data-ttu-id="f1d08-171">Didacticiel de fonctions personnalisées Excel</span><span class="sxs-lookup"><span data-stu-id="f1d08-171">Excel custom functions tutorial</span></span>](../tutorials/excel-tutorial-create-custom-functions.md)
