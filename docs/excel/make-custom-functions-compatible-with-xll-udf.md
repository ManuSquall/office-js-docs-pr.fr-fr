---
title: Faire en sorte que vos fonctions personnalisées soient compatibles avec les fonctions XLL définies par l'utilisateur
description: Activer la compatibilité avec les fonctions Excel XLL définies par l'utilisateur qui offrent une fonctionnalité équivalente à vos fonctions personnalisées
ms.date: 04/22/2019
localization_priority: Normal
ms.openlocfilehash: 09914e040c1721dd8b9e91952e5814e7a6b914e5
ms.sourcegitcommit: 7462409209264dc7f8f89f3808a7a6249fcd739e
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/26/2019
ms.locfileid: "33356865"
---
# <a name="make-your-custom-functions-compatible-with-xll-user-defined-functions"></a><span data-ttu-id="be7b4-103">Faire en sorte que vos fonctions personnalisées soient compatibles avec les fonctions XLL définies par l'utilisateur</span><span class="sxs-lookup"><span data-stu-id="be7b4-103">Make your custom functions compatible with XLL user-defined functions</span></span>

<span data-ttu-id="be7b4-104">Si vous avez des XLL Excel existantes, vous pouvez créer des fonctions personnalisées équivalentes dans un complément Office pour étendre les fonctionnalités de votre solution à d'autres plateformes, comme Online ou macOS.</span><span class="sxs-lookup"><span data-stu-id="be7b4-104">If you have existing Excel XLLs, you can build equivalent custom functions in an Office Add-in to extend your solution features to other platforms such as online or macOS.</span></span> <span data-ttu-id="be7b4-105">Toutefois, les compléments Office ne disposent pas de toutes les fonctionnalités disponibles dans les XLL.</span><span class="sxs-lookup"><span data-stu-id="be7b4-105">However, Office Add-ins don't have all of the functionality available in XLLs.</span></span> <span data-ttu-id="be7b4-106">En fonction de la fonctionnalité utilisée par votre solution, le XLL peut offrir une meilleure expérience que les fonctions personnalisées de complément Office sur Excel pour Windows.</span><span class="sxs-lookup"><span data-stu-id="be7b4-106">Depending on the functionality your solution uses, the XLL may provide a better experience than the Office Add-in custom functions on Excel for Windows.</span></span>

<span data-ttu-id="be7b4-107">Vous pouvez configurer votre complément Office de sorte que, lorsqu'un XLL équivalent est déjà installé sur l'ordinateur de l'utilisateur, Excel exécute le XLL à la place de vos fonctions personnalisées de complément Office.</span><span class="sxs-lookup"><span data-stu-id="be7b4-107">You can configure your Office Add-in so that when an equivalent XLL is already installed on the user's computer, Excel runs the XLL instead of your Office Add-in custom functions.</span></span> <span data-ttu-id="be7b4-108">La XLL est appelée équivalente, car Excel effectuera une transition transparente entre les fonctions personnalisées XLL et complément Office en fonction de ce qui est installé sur Windows.</span><span class="sxs-lookup"><span data-stu-id="be7b4-108">The XLL is called equivalent because Excel will seamlessly transition between the XLL and the Office Add-in custom functions depending on which is installed on Windows.</span></span>

[!include[Excel custom functions note](../includes/excel-custom-functions-note.md)]

## <a name="specify-equivalent-xll-in-the-manifest"></a><span data-ttu-id="be7b4-109">Spécifier le XLL équivalent dans le manifeste</span><span class="sxs-lookup"><span data-stu-id="be7b4-109">Specify equivalent XLL in the manifest</span></span>

<span data-ttu-id="be7b4-110">Pour activer la compatibilité avec un XLL existant, identifiez le XLL équivalent dans le manifeste de votre complément Office.</span><span class="sxs-lookup"><span data-stu-id="be7b4-110">To enable compatibility with an existing XLL, identify the equivalent XLL in the manifest of your Office Add-in.</span></span> <span data-ttu-id="be7b4-111">Ensuite, Excel utilise les fonctions de la XLL au lieu des fonctions personnalisées de votre complément Office lors de l'exécution de Windows.</span><span class="sxs-lookup"><span data-stu-id="be7b4-111">Then Excel will use the XLL's functions instead of your Office Add-in custom functions when running on Windows.</span></span>

<span data-ttu-id="be7b4-112">Pour définir le XLL équivalent pour vos fonctions personnalisées, spécifiez l' `FileName` élément XLL.</span><span class="sxs-lookup"><span data-stu-id="be7b4-112">To set the equivalent XLL for your custom functions, specify the `FileName` of the XLL.</span></span> <span data-ttu-id="be7b4-113">Lorsque l'utilisateur ouvre un classeur avec des fonctions à partir de la XLL, Excel convertit les fonctions en fonctions compatibles.</span><span class="sxs-lookup"><span data-stu-id="be7b4-113">When the user opens a workbook with functions from the XLL, Excel converts the functions to compatible functions.</span></span> <span data-ttu-id="be7b4-114">Le classeur utilise ensuite le XLL lorsqu'il est ouvert dans Excel sur Windows et utilise des fonctions personnalisées à partir de votre complément Office lorsqu'il est ouvert en ligne ou sur macOS.</span><span class="sxs-lookup"><span data-stu-id="be7b4-114">The workbook then uses the XLL when opened in Excel on Windows, and it will use custom functions from your Office Add-in when opened online or on macOS.</span></span>

<span data-ttu-id="be7b4-115">L'exemple suivant montre comment spécifier un complément COM et un XLL comme équivalent.</span><span class="sxs-lookup"><span data-stu-id="be7b4-115">The following example shows how to specify both a COM add-in and an XLL as equivalent.</span></span> <span data-ttu-id="be7b4-116">Souvent, vous spécifierez à la fois de manière à ce que cet exemple montre les deux dans le contexte.</span><span class="sxs-lookup"><span data-stu-id="be7b4-116">Often you will specify both so for completeness this example shows both in context.</span></span> <span data-ttu-id="be7b4-117">Ils sont identifiés par leur `ProgID` et `FileName` respectivement.</span><span class="sxs-lookup"><span data-stu-id="be7b4-117">They are identified by their `ProgID` and `FileName` respectively.</span></span> <span data-ttu-id="be7b4-118">Pour plus d'informations sur la compatibilité des compléments COM, consultez [la rubrique faire en sorte que votre complément Office soit compatible avec un complément COM existant](../develop/make-office-add-in-compatible-with-existing-com-add-in.md).</span><span class="sxs-lookup"><span data-stu-id="be7b4-118">For more information on COM add-in compatibility, see [Make your Office Add-in compatible with an existing COM add-in](../develop/make-office-add-in-compatible-with-existing-com-add-in.md).</span></span>

```xml
<VersionOverrides>
...
<EquivalentAddins>
  <EquivalentAddin>
    <ProgID>ContosoCOMAddin</ProgID>
    <Type>COM</Type>
  </EquivalentAddin>

  <EquivalentAddin>
    <FileName>contosofunctions.xll</FileName>
    <Type>XLL</Type>
  </EquivalentAddin>
<EquivalentAddins>
...
</VersionOverrides>
```

> [!NOTE]
> <span data-ttu-id="be7b4-119">Si un complément déclare ses fonctions personnalisées comme étant compatibles XLL, la modification du manifeste ultérieurement pourrait entraîner la rupture du classeur d'un utilisateur, car il modifiera le format de fichier.</span><span class="sxs-lookup"><span data-stu-id="be7b4-119">If an add-in declares its custom functions to be XLL compatible, changing the manifest at a later time could break a user’s workbook because it will change the file format.</span></span>

## <a name="office-add-in-updates"></a><span data-ttu-id="be7b4-120">Mises à jour des compléments Office</span><span class="sxs-lookup"><span data-stu-id="be7b4-120">Office Add-in updates</span></span>

<span data-ttu-id="be7b4-121">Une fois que vous avez spécifié une XLL équivalente pour votre complément Office, Excel cesse de traiter les mises à jour pour votre complément Office.</span><span class="sxs-lookup"><span data-stu-id="be7b4-121">Once you specify an equivalent XLL for your Office Add-in, Excel stops processing updates for your Office Add-in.</span></span> <span data-ttu-id="be7b4-122">L'utilisateur doit désinstaller le XLL afin d'obtenir les dernières mises à jour pour le complément Office.</span><span class="sxs-lookup"><span data-stu-id="be7b4-122">The user must uninstall the XLL in order to get the latest updates for the Office Add-in.</span></span>

## <a name="custom-function-behavior-for-xll-compatible-functions"></a><span data-ttu-id="be7b4-123">Comportement des fonctions personnalisées pour les fonctions compatibles XLL</span><span class="sxs-lookup"><span data-stu-id="be7b4-123">Custom function behavior for XLL compatible functions</span></span>

<span data-ttu-id="be7b4-124">Lors de l'ouverture d'une feuille de calcul qui contient des fonctions XLL pour lesquelles il existe également un complément équivalent, les fonctions de la XLL sont converties en fonctions personnalisées compatibles XLL.</span><span class="sxs-lookup"><span data-stu-id="be7b4-124">When a spreadsheet is opened that contains XLL functions for which there is also an equivalent add-in, the XLL's functions are converted to XLL compatible custom functions.</span></span> <span data-ttu-id="be7b4-125">Lors du prochain enregistrement, les utilisateurs sont écrits dans le fichier dans un mode compatible afin qu'ils fonctionnent avec les fonctions personnalisées XLL et complément Office (sur d'autres plateformes).</span><span class="sxs-lookup"><span data-stu-id="be7b4-125">On the next save, they are written to the file in a compatible mode so that they work with both the XLL and Office Add-in custom functions (when on other platforms).</span></span>

<span data-ttu-id="be7b4-126">Le tableau suivant compare les fonctionnalités des fonctions définies par l'utilisateur XLL, des fonctions personnalisées de XLL et des fonctions personnalisées de complément Office.</span><span class="sxs-lookup"><span data-stu-id="be7b4-126">The following table compares features across XLL user-defined functions, XLL compatible custom functions, and Office Add-in custom functions.</span></span>

|         |<span data-ttu-id="be7b4-127">Fonction XLL définie par l'utilisateur</span><span class="sxs-lookup"><span data-stu-id="be7b4-127">XLL user-defined function</span></span> |<span data-ttu-id="be7b4-128">Fonctions personnalisées compatibles XLL</span><span class="sxs-lookup"><span data-stu-id="be7b4-128">XLL compatible custom functions</span></span> |<span data-ttu-id="be7b4-129">Fonction personnalisée de complément Office</span><span class="sxs-lookup"><span data-stu-id="be7b4-129">Office Add-in custom function</span></span> |
|---------|---------|---------|---------|
| <span data-ttu-id="be7b4-130">Plateformes prises en charge</span><span class="sxs-lookup"><span data-stu-id="be7b4-130">Supported platforms</span></span> | <span data-ttu-id="be7b4-131">Windows</span><span class="sxs-lookup"><span data-stu-id="be7b4-131">Windows</span></span> | <span data-ttu-id="be7b4-132">Windows, macOS, Excel Online</span><span class="sxs-lookup"><span data-stu-id="be7b4-132">Windows, macOS, Excel online</span></span> | <span data-ttu-id="be7b4-133">Windows, macOS, Excel Online</span><span class="sxs-lookup"><span data-stu-id="be7b4-133">Windows, macOS, Excel online</span></span> |
| <span data-ttu-id="be7b4-134">Formats de fichiers pris en charge</span><span class="sxs-lookup"><span data-stu-id="be7b4-134">Supported file formats</span></span> | <span data-ttu-id="be7b4-135">XLSX, XLSB, XLSM, XLS</span><span class="sxs-lookup"><span data-stu-id="be7b4-135">XLSX, XLSB, XLSM, XLS</span></span> | <span data-ttu-id="be7b4-136">XLSX, XLSB, XLSM</span><span class="sxs-lookup"><span data-stu-id="be7b4-136">XLSX, XLSB, XLSM</span></span> | <span data-ttu-id="be7b4-137">XLSX, XLSB, XLSM</span><span class="sxs-lookup"><span data-stu-id="be7b4-137">XLSX, XLSB, XLSM</span></span> |
| <span data-ttu-id="be7b4-138">Saisie semi-automatique de formule</span><span class="sxs-lookup"><span data-stu-id="be7b4-138">Formula autocomplete</span></span> | <span data-ttu-id="be7b4-139">Non</span><span class="sxs-lookup"><span data-stu-id="be7b4-139">No</span></span> | <span data-ttu-id="be7b4-140">Oui</span><span class="sxs-lookup"><span data-stu-id="be7b4-140">Yes</span></span> | <span data-ttu-id="be7b4-141">Oui</span><span class="sxs-lookup"><span data-stu-id="be7b4-141">Yes</span></span> |
| <span data-ttu-id="be7b4-142">Diffusion en continu</span><span class="sxs-lookup"><span data-stu-id="be7b4-142">Streaming</span></span> | <span data-ttu-id="be7b4-143">Possible via xlfRTD et le rappel XLL.</span><span class="sxs-lookup"><span data-stu-id="be7b4-143">Possible via xlfRTD and XLL callback.</span></span> | <span data-ttu-id="be7b4-144">Oui</span><span class="sxs-lookup"><span data-stu-id="be7b4-144">Yes</span></span> | <span data-ttu-id="be7b4-145">Oui</span><span class="sxs-lookup"><span data-stu-id="be7b4-145">Yes</span></span> |
| <span data-ttu-id="be7b4-146">Localisation des fonctions</span><span class="sxs-lookup"><span data-stu-id="be7b4-146">Localization of functions</span></span> | <span data-ttu-id="be7b4-147">Non</span><span class="sxs-lookup"><span data-stu-id="be7b4-147">No</span></span> | <span data-ttu-id="be7b4-148">Non.</span><span class="sxs-lookup"><span data-stu-id="be7b4-148">No.</span></span> <span data-ttu-id="be7b4-149">Le nom et l'ID doivent correspondre aux fonctions de la XLL existante.</span><span class="sxs-lookup"><span data-stu-id="be7b4-149">The Name and ID must match the existing XLL's functions.</span></span> | <span data-ttu-id="be7b4-150">Oui</span><span class="sxs-lookup"><span data-stu-id="be7b4-150">Yes</span></span> |
| <span data-ttu-id="be7b4-151">Fonctions volatiles</span><span class="sxs-lookup"><span data-stu-id="be7b4-151">Volatile functions</span></span> | <span data-ttu-id="be7b4-152">Oui</span><span class="sxs-lookup"><span data-stu-id="be7b4-152">Yes</span></span> | <span data-ttu-id="be7b4-153">Oui</span><span class="sxs-lookup"><span data-stu-id="be7b4-153">Yes</span></span> | <span data-ttu-id="be7b4-154">Oui</span><span class="sxs-lookup"><span data-stu-id="be7b4-154">Yes</span></span> |
| <span data-ttu-id="be7b4-155">Prise en charge du recalcul multi-thread</span><span class="sxs-lookup"><span data-stu-id="be7b4-155">Multi-threaded recalculation support</span></span> | <span data-ttu-id="be7b4-156">Oui</span><span class="sxs-lookup"><span data-stu-id="be7b4-156">Yes</span></span> | <span data-ttu-id="be7b4-157">Oui</span><span class="sxs-lookup"><span data-stu-id="be7b4-157">Yes</span></span> | <span data-ttu-id="be7b4-158">Oui</span><span class="sxs-lookup"><span data-stu-id="be7b4-158">Yes</span></span> |
| <span data-ttu-id="be7b4-159">Comportement du calcul</span><span class="sxs-lookup"><span data-stu-id="be7b4-159">Calculation behavior</span></span> | <span data-ttu-id="be7b4-160">Aucune interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="be7b4-160">No UI.</span></span> <span data-ttu-id="be7b4-161">Excel peut ne pas répondre pendant le calcul.</span><span class="sxs-lookup"><span data-stu-id="be7b4-161">Excel can be unresponsive during calculation.</span></span> | <span data-ttu-id="be7b4-162">Les utilisateurs verront #BUSY!</span><span class="sxs-lookup"><span data-stu-id="be7b4-162">Users will see #BUSY!</span></span> <span data-ttu-id="be7b4-163">jusqu'à ce qu'un résultat soit renvoyé.</span><span class="sxs-lookup"><span data-stu-id="be7b4-163">until a result is returned.</span></span> | <span data-ttu-id="be7b4-164">Les utilisateurs verront #BUSY!</span><span class="sxs-lookup"><span data-stu-id="be7b4-164">Users will see #BUSY!</span></span> <span data-ttu-id="be7b4-165">jusqu'à ce qu'un résultat soit renvoyé.</span><span class="sxs-lookup"><span data-stu-id="be7b4-165">until a result is returned.</span></span> |
| <span data-ttu-id="be7b4-166">Ensembles de conditions requises</span><span class="sxs-lookup"><span data-stu-id="be7b4-166">Requirement sets</span></span> | <span data-ttu-id="be7b4-167">S/O</span><span class="sxs-lookup"><span data-stu-id="be7b4-167">N/A</span></span> | <span data-ttu-id="be7b4-168">CustomFunctions 1,1 uniquement</span><span class="sxs-lookup"><span data-stu-id="be7b4-168">CustomFunctions 1.1 only</span></span> | <span data-ttu-id="be7b4-169">CustomFunctions 1,1 et versions ultérieures</span><span class="sxs-lookup"><span data-stu-id="be7b4-169">CustomFunctions 1.1 and later</span></span> |

## <a name="see-also"></a><span data-ttu-id="be7b4-170">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="be7b4-170">See also</span></span>

- [<span data-ttu-id="be7b4-171">Faire en sorte que votre complément Office soit compatible avec un complément COM existant</span><span class="sxs-lookup"><span data-stu-id="be7b4-171">Make your Office Add-in compatible with an existing COM add-in</span></span>](../develop/make-office-add-in-compatible-with-existing-com-add-in.md)
- [<span data-ttu-id="be7b4-172">Meilleures pratiques de fonctions personnalisées</span><span class="sxs-lookup"><span data-stu-id="be7b4-172">Custom functions best practices</span></span>](custom-functions-best-practices.md)
- [<span data-ttu-id="be7b4-173">Fonctions personnalisées changelog</span><span class="sxs-lookup"><span data-stu-id="be7b4-173">Custom functions changelog</span></span>](custom-functions-changelog.md)
- [<span data-ttu-id="be7b4-174">Didacticiel de fonctions personnalisées Excel</span><span class="sxs-lookup"><span data-stu-id="be7b4-174">Excel custom functions tutorial</span></span>](../tutorials/excel-tutorial-create-custom-functions.md)