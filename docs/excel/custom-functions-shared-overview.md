---
ms.date: 02/13/2020
description: Découvrez l'exécution de fonctions personnalisées, les boutons du ruban et le code du volet des tâches dans un runtime JavaScript identique pour coordonner des scénarios dans votre complément.
title: Exécutez votre code de complément dans un runtime JavaScript partagé (préversion)
localization_priority: Priority
ms.openlocfilehash: d9d73a5ae2ff1da09d1a5fd7d02514cb28be0e2d
ms.sourcegitcommit: dd6d00202f6466c27418247dad7bd136555a6036
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 02/26/2020
ms.locfileid: "42284112"
---
# <a name="overview-run-your-add-in-code-in-a-shared-javascript-runtime-preview"></a><span data-ttu-id="6a19c-103">Vue d’ensemble : exécutez votre code de complément dans un runtime JavaScript partagé (préversion)</span><span class="sxs-lookup"><span data-stu-id="6a19c-103">Overview: Run your add-in code in a shared JavaScript runtime (preview)</span></span>

[!include[Running custom functions in shared JavaScript runtime note](../includes/excel-shared-runtime-preview-note.md)]

<span data-ttu-id="6a19c-104">Lors de l’exécution d’Excel sur Windows ou Mac, votre complément exécute le code des boutons du ruban, des fonctions personnalisées et du volet des tâches dans des environnements runtime JavaScript distincts.</span><span class="sxs-lookup"><span data-stu-id="6a19c-104">When running Excel on Windows or Mac, your add-in will run code for ribbon buttons, custom functions, and the task pane in separate JavaScript runtime environments.</span></span> <span data-ttu-id="6a19c-105">Cela permet de créer des limitations, telles que l'impossibilité de partager aisément des données globales ou de pouvoir accéder à l'ensemble des fonctionnalités CORS à partir d’une fonction personnalisée.</span><span class="sxs-lookup"><span data-stu-id="6a19c-105">This creates limitations such as not being able to easily share global data, and not being able to access all CORS functionality from a custom function.</span></span>

<span data-ttu-id="6a19c-106">Vous pouvez toutefois configurer votre complément Excel pour partager un code dans le même runtime JavaScript (également appelé runtime partagé).</span><span class="sxs-lookup"><span data-stu-id="6a19c-106">However, you can configure your Excel add-in to share code in the same JavaScript runtime (also referred to as a shared runtime).</span></span> <span data-ttu-id="6a19c-107">Vous pouvez ainsi améliorer la coordination dans votre complément et accéder au volet des tâches DOM et CORS à partir de toutes les parties de votre complément.</span><span class="sxs-lookup"><span data-stu-id="6a19c-107">This enables better coordination across your add-in and access to the task pane DOM and CORS from all parts of your add-in.</span></span>

<span data-ttu-id="6a19c-108">La configuration d’un runtime partagé permet les scénarios suivants :</span><span class="sxs-lookup"><span data-stu-id="6a19c-108">Configuring a shared runtime enables the following scenarios:</span></span>

- <span data-ttu-id="6a19c-109">Votre complément dispose d'un DOM partagé auquel le ruban, le volet des tâches et les fonctions personnalisées peuvent accéder.</span><span class="sxs-lookup"><span data-stu-id="6a19c-109">Your add-in will have a shared DOM that the ribbon, task pane, and custom functions can all access.</span></span>
- <span data-ttu-id="6a19c-110">Vos fonctions personnalisées bénéficieront d'une prise en charge complète de CORS.</span><span class="sxs-lookup"><span data-stu-id="6a19c-110">Your custom functions will have full CORS support.</span></span>
- <span data-ttu-id="6a19c-111">Vos fonctions personnalisées peuvent appeler les API Office.js pour lire les données d’un document feuille de calcul.</span><span class="sxs-lookup"><span data-stu-id="6a19c-111">Your custom functions can call Office.js APIs to read spreadsheet document data.</span></span>
- <span data-ttu-id="6a19c-112">Votre complément peut exécuter un code dès que le document est ouvert.</span><span class="sxs-lookup"><span data-stu-id="6a19c-112">Your add-in can run code as soon as the document is opened.</span></span>
- <span data-ttu-id="6a19c-113">Votre complément peut continuer à exécuter un code lorsque le volet des tâches est fermé.</span><span class="sxs-lookup"><span data-stu-id="6a19c-113">Your add-in can continue running code after the task pane is closed.</span></span>

<span data-ttu-id="6a19c-114">Lorsque vous exécutez des fonctions personnalisées dans un runtime partagé avec le volet des tâches, celui-ci s’exécute dans une instance de navigateur sur différentes plateformes, tel qu'expliqué dans [Navigateurs utilisés par les compléments Office](../concepts/browsers-used-by-office-web-add-ins.md). En outre, les boutons affichés sur le ruban par votre complément Excel s’exécutent dans le même runtime partagé.</span><span class="sxs-lookup"><span data-stu-id="6a19c-114">When you run custom functions in a shared runtime with the task pane, it will run in a browser instance on different platforms as explained in [Browsers used by Office Add-ins](../concepts/browsers-used-by-office-web-add-ins.md). Additionally, any buttons that your Excel add-in displays on the ribbon will run in the same shared runtime.</span></span> <span data-ttu-id="6a19c-115">L’image ci-après présente l'exécution des fonctions personnalisées, de interface utilisateur du ruban et du code du volet des tâches dans le même runtime JavaScript.</span><span class="sxs-lookup"><span data-stu-id="6a19c-115">The following image shows how custom functions, the ribbon UI, and the task pane code will all run in the same JavaScript runtime.</span></span>

![Fonctions personnalisées s'exécutant dans le runtime partagé avec les boutons du ruban et le volet des tâches dans Excel](../images/custom-functions-in-browser-runtime.png)

## <a name="differences-when-running-custom-functions-in-a-shared-runtime"></a><span data-ttu-id="6a19c-117">Différences lors de l’exécution de fonctions personnalisées dans un runtime partagé</span><span class="sxs-lookup"><span data-stu-id="6a19c-117">Differences when running custom functions in a shared runtime</span></span>

<span data-ttu-id="6a19c-118">Lorsque vous configurez votre projet de complément Excel pour l’exécution de fonctions personnalisées dans un runtime partagé, il existe quelques différences dans l’utilisation de la fonction runtime personnalisée.</span><span class="sxs-lookup"><span data-stu-id="6a19c-118">When you configure your Excel add-in project to run custom functions in a shared runtime, there are a few differences from using the custom function runtime.</span></span>

### <a name="storage"></a><span data-ttu-id="6a19c-119">Stockage</span><span class="sxs-lookup"><span data-stu-id="6a19c-119">Storage</span></span>

<span data-ttu-id="6a19c-120">Vous n’avez plus besoin d’utiliser l’API de **Stockage** pour partager des données entre le volet des tâches, les fonctions personnalisées ou l’interface utilisateur du ruban.</span><span class="sxs-lookup"><span data-stu-id="6a19c-120">You no longer need to use the **Storage** API to share data between the task pane, custom functions or ribbon UI.</span></span> <span data-ttu-id="6a19c-121">Vous pouvez placer des variables globales dans l'objet de la **fenêtre**, ou utiliser votre propre approche de gestion d'état préférée.</span><span class="sxs-lookup"><span data-stu-id="6a19c-121">You can put global variables in the **window** object, or use your own preferred state management approach.</span></span>

### <a name="authentication"></a><span data-ttu-id="6a19c-122">Authentification</span><span class="sxs-lookup"><span data-stu-id="6a19c-122">Authentication</span></span>

<span data-ttu-id="6a19c-123">Lorsque vous recevez des jetons dans le cadre de l’authentification, vous n’avez pas besoin d’utiliser l’API de **stockage** pour les partager avec le volet des tâches, les fonctions personnalisées et l’interface utilisateur du ruban.</span><span class="sxs-lookup"><span data-stu-id="6a19c-123">When you receive tokens as part of authentication, you don't need to use the **Storage** API to share them between the task pane, custom functions and ribbon UI.</span></span> <span data-ttu-id="6a19c-124">Vous pouvez utiliser votre propre technique de stockage préférée par défaut et un emplacement de stockage pour les partager, tel que `localStorage`.</span><span class="sxs-lookup"><span data-stu-id="6a19c-124">You can use your own preferred storage technique and storage location to share them, such as `localStorage`.</span></span>

### <a name="dialog-api"></a><span data-ttu-id="6a19c-125">API de boîte de dialogue</span><span class="sxs-lookup"><span data-stu-id="6a19c-125">Dialog API</span></span>

<span data-ttu-id="6a19c-126">Vous n’avez plus besoin d’utiliser l'API **OfficeRuntime.Dialog** pour afficher une boîte de dialogue à partir d’une fonction personnalisée.</span><span class="sxs-lookup"><span data-stu-id="6a19c-126">You no longer need to use the **OfficeRuntime.Dialog** API to display a dialog from a custom function.</span></span> <span data-ttu-id="6a19c-127">Vous pouvez utiliser la même API [boîte de dialogue](../develop/dialog-api-in-office-add-ins.md) pour les fonctions personnalisées, les boutons du ruban et le volet des tâches.</span><span class="sxs-lookup"><span data-stu-id="6a19c-127">You can use the same [Dialog API](../develop/dialog-api-in-office-add-ins.md) for custom functions, ribbon buttons, and the task pane.</span></span>

### <a name="debugging"></a><span data-ttu-id="6a19c-128">Débogage</span><span class="sxs-lookup"><span data-stu-id="6a19c-128">Debugging</span></span>

<span data-ttu-id="6a19c-129">Lors de l’utilisation d’un runtime partagé, vous ne pouvez pas utiliser Visual Studio Code pour déboguer des fonctions personnalisées dans Excel sur Windows à cette date.</span><span class="sxs-lookup"><span data-stu-id="6a19c-129">When using a shared runtime, you can't use Visual Studio Code to debug custom functions in Excel on Windows at this time.</span></span> <span data-ttu-id="6a19c-130">Des outils de développeur sont nécessaires.</span><span class="sxs-lookup"><span data-stu-id="6a19c-130">You'll need to use developer tools.</span></span> <span data-ttu-id="6a19c-131">Pour plus d'informations, voir le [Débogage des compléments avec les outils de développement sur Windows 10](../testing/debug-add-ins-using-f12-developer-tools-on-windows-10.md).</span><span class="sxs-lookup"><span data-stu-id="6a19c-131">For more information, see [Debug add-ins using developer tools on Windows 10](../testing/debug-add-ins-using-f12-developer-tools-on-windows-10.md).</span></span>

## <a name="get-started"></a><span data-ttu-id="6a19c-132">Prise en main</span><span class="sxs-lookup"><span data-stu-id="6a19c-132">Get Started</span></span>

<span data-ttu-id="6a19c-133">Pour configurer votre projet de complément Excel pour l’exécution de fonctions personnalisées dans un runtime partagé, voir [Configurer votre complément Excel pour utiliser un runtime JavaScript partagé (préversion)](configure-your-add-in-to-use-a-shared-runtime.md).</span><span class="sxs-lookup"><span data-stu-id="6a19c-133">To configure your Excel add-in project to run custom functions in a shared runtime, see [Configure your Excel add-in to use a shared JavaScript runtime (preview)](configure-your-add-in-to-use-a-shared-runtime.md).</span></span>

## <a name="give-us-feedback"></a><span data-ttu-id="6a19c-134">Faites nous part de vos commentaires</span><span class="sxs-lookup"><span data-stu-id="6a19c-134">Give us feedback</span></span>

<span data-ttu-id="6a19c-135">Nous aimerions connaître votre avis concernant cette fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="6a19c-135">We'd love to hear your feedback on this feature.</span></span> <span data-ttu-id="6a19c-136">Si vous trouvez des bogues, des problèmes ou si vous avez des questions relatives à cette fonctionnalité, faites-le nous savoir en créant un problème GitHub dans le [référentiel Office-js](https://github.com/OfficeDev/office-js).</span><span class="sxs-lookup"><span data-stu-id="6a19c-136">If you find any bugs, issues, or have requests on this feature, please let us know by creating a GitHub issue in the [office-js repo](https://github.com/OfficeDev/office-js).</span></span>

## <a name="see-also"></a><span data-ttu-id="6a19c-137">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="6a19c-137">See also</span></span>

<span data-ttu-id="6a19c-138">Listes des articles associés relatif au runtime partagé</span><span class="sxs-lookup"><span data-stu-id="6a19c-138">List of related articles for shared runtime</span></span>
- [<span data-ttu-id="6a19c-139">Tutoriel : Partager des données et des événements entre des fonctions personnalisées Excel et le volet Office (préversion)</span><span class="sxs-lookup"><span data-stu-id="6a19c-139">Tutorial: Share data and events between Excel custom functions and the task pane (preview)</span></span>](../tutorials/share-data-and-events-between-custom-functions-and-the-task-pane-tutorial.md)
- [<span data-ttu-id="6a19c-140">Appeler des API Excel à partir de votre fonction personnalisée (préversion)</span><span class="sxs-lookup"><span data-stu-id="6a19c-140">Call Excel APIs from your custom function (preview)</span></span>](call-excel-apis-from-custom-function.md)