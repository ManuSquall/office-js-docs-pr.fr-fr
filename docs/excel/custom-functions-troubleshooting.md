---
ms.date: 03/06/2019
description: Résoudre des problèmes courants dans les fonctions personnalisées d’Excel.
title: Résoudre des problèmes de fonctions personnalisées (préversion)
localization_priority: Priority
ms.openlocfilehash: ada60fb4184095f194ff425823b04456a7bf0e76
ms.sourcegitcommit: c5daedf017c6dd5ab0c13607589208c3f3627354
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/20/2019
ms.locfileid: "30693757"
---
# <a name="troubleshoot-custom-functions"></a><span data-ttu-id="13c70-103">Résoudre des problèmes de fonctions personnalisées</span><span class="sxs-lookup"><span data-stu-id="13c70-103">Troubleshoot custom functions</span></span>

<span data-ttu-id="13c70-104">Dans le cadre du développement de fonctions personnalisées, vous pouvez rencontrer des erreurs dans le produit lors de la création et des tests de vos fonctions.</span><span class="sxs-lookup"><span data-stu-id="13c70-104">When developing custom functions, you may encounter errors in the product while creating and testing your functions.</span></span>

<span data-ttu-id="13c70-105">Pour résoudre des problèmes, vous pouvez [activer la journalisation du runtime pour capturer les erreurs](#enable-runtime-logging) et vous référer aux [messages d’erreur natifs d’Excel](#check-for-excel-error-messages).</span><span class="sxs-lookup"><span data-stu-id="13c70-105">To resolve issues, you can [enable runtime logging to capture errors](#enable-runtime-logging) and refer to [Excel's native error messages](#check-for-excel-error-messages).</span></span> <span data-ttu-id="13c70-106">Recherchez également des erreurs courantes telles qu’une [vérification des certificats SSL](#verify-ssl-certificates) incorrecte, l’[abandon de promesses non résolues](#ensure-promises-return) et l’oubli d’[associer votre fonctions](#associate-your-functions).</span><span class="sxs-lookup"><span data-stu-id="13c70-106">Also, check for common mistakes such as not [verifying ssl certificates](#verify-ssl-certificates) properly, [leaving promises unresolved](#ensure-promises-return), and forgetting to [associate your functions](#associate-your-functions).</span></span>

## <a name="enable-runtime-logging"></a><span data-ttu-id="13c70-107">Activer la journalisation du runtime</span><span class="sxs-lookup"><span data-stu-id="13c70-107">Enable runtime logging</span></span>

<span data-ttu-id="13c70-108">Si vous testez votre complément dans Office sur Windows, vous devez [activer la journalisation du runtime](https://docs.microsoft.com/fr-FR/office/dev/add-ins/testing/troubleshoot-manifest#use-runtime-logging-to-debug-your-add-in).</span><span class="sxs-lookup"><span data-stu-id="13c70-108">If you are testing your add-in in Office on Windows, you should enable [runtime logging](https://docs.microsoft.com/fr-FR/office/dev/add-ins/testing/troubleshoot-manifest#use-runtime-logging-to-debug-your-add-in) to troubleshoot issues with your add-in's XML manifest file, as well as several installation and runtime conditions.</span></span> <span data-ttu-id="13c70-109">La journalisation du runtime fournit des instructions `console.log` dans un fichier journal distinct que vous créez pour vous aider à découvrir des problèmes.</span><span class="sxs-lookup"><span data-stu-id="13c70-109">Runtime logging writes `console.log` statements to a log file to help you uncover issues.</span></span> <span data-ttu-id="13c70-110">Les instructions couvrent diverses erreurs, dont des erreurs liées au fichier manifeste XML de votre complément, aux conditions d’exécution ou à l’installation de vos fonctions personnalisées.</span><span class="sxs-lookup"><span data-stu-id="13c70-110">The statements cover a variety of errors, including errors pertaining to your add-in's XML manifest file, runtime conditions, or installation of your custom functions.</span></span>  <span data-ttu-id="13c70-111">Pour plus d’informations sur la journalisation du runtime, voir [Utilisation de la journalisation du runtime pour déboguer votre complément](https://docs.microsoft.com/fr-FR/office/dev/add-ins/testing/troubleshoot-manifest#use-runtime-logging-to-debug-your-add-in).</span><span class="sxs-lookup"><span data-stu-id="13c70-111">For more information about runtime logging, see [Use runtime logging to debug your add-in](https://docs.microsoft.com/fr-FR/office/dev/add-ins/testing/troubleshoot-manifest#use-runtime-logging-to-debug-your-add-in).</span></span>  

### <a name="check-for-excel-error-messages"></a><span data-ttu-id="13c70-112">Rechercher les messages d’erreur Excel</span><span class="sxs-lookup"><span data-stu-id="13c70-112">Check for Excel error messages</span></span>

<span data-ttu-id="13c70-113">Excel dispose d’un certain nombre de messages d’erreur intégrés qui sont renvoyés à une cellule en cas d’erreur de calcul.</span><span class="sxs-lookup"><span data-stu-id="13c70-113">Excel has a number of built-in error messages which are returned to a cell if there is calculation error.</span></span> <span data-ttu-id="13c70-114">Les fonctions personnalisées utilisent uniquement les messages d’erreur suivants : `#NULL!`, `#DIV/0!`, `#VALUE!`, `#REF!`, `#NAME?`, `#NUM!`, `#N/A` et `#GETTING_DATA`.</span><span class="sxs-lookup"><span data-stu-id="13c70-114">Custom functions only use the following error messages: `#NULL!`, `#DIV/0!`, `#VALUE!`, `#REF!`, `#NAME?`, `#NUM!`, `#N/A`, and `#GETTING_DATA`.</span></span>

## <a name="common-issues"></a><span data-ttu-id="13c70-115">Problèmes courants</span><span class="sxs-lookup"><span data-stu-id="13c70-115">Common issues</span></span>

### <a name="my-add-in-wont-load-verify-certifications"></a><span data-ttu-id="13c70-116">Mon complément ne se charge pas : vérifiez les certifications</span><span class="sxs-lookup"><span data-stu-id="13c70-116">My add-in won't load: verify certifications</span></span>

<span data-ttu-id="13c70-117">Si l’installation de votre complément échoue, vérifiez que les certificats SSL sont correctement configurés pour le serveur web hébergeant votre complément.</span><span class="sxs-lookup"><span data-stu-id="13c70-117">If your add-in fails to register, verify that SSL certificates are correctly configured for the web server that's hosting your add-in application.</span></span> <span data-ttu-id="13c70-118">Généralement, en cas de problème avec des certificats SSL, un message d’erreur dans Excel vous avertit que votre complément n’a pas pu être installé correctement.</span><span class="sxs-lookup"><span data-stu-id="13c70-118">Typically if there is a problem with SSL certificates, you will see an error message in Excel warning you that your add-in could not be installed properly.</span></span> <span data-ttu-id="13c70-119">Pour plus d’informations, voir la rubrique relative à l’[ajout de certificats auto-signés en tant que certificats racine approuvés](https://github.com/OfficeDev/generator-office/blob/master/src/docs/ssl.md).</span><span class="sxs-lookup"><span data-stu-id="13c70-119">For more information, see [Adding Self-Signed Certificates as Trusted Root Certificate](https://github.com/OfficeDev/generator-office/blob/master/src/docs/ssl.md).</span></span>

### <a name="my-functions-wont-load-associate-functions"></a><span data-ttu-id="13c70-120">Mon fonctions ne se chargent pas : associez les fonctions</span><span class="sxs-lookup"><span data-stu-id="13c70-120">My functions won't load: associate functions</span></span>

<span data-ttu-id="13c70-121">Dans le fichier de script de vos fonctions personnalisées, vous devez associer chacune de celles-ci à son ID spécifié dans le [fichier de métadonnées JSON](custom-functions-json.md).</span><span class="sxs-lookup"><span data-stu-id="13c70-121">In your custom functions' script file, you need to associate each custom function with its ID specified in the [JSON metadata file](custom-functions-json.md).</span></span> <span data-ttu-id="13c70-122">Cette opération est effectuée à l’aide de la méthode `CustomFunctions.associate()`.</span><span class="sxs-lookup"><span data-stu-id="13c70-122">This is done  by using the syntax @{Replace=$provider}.</span></span> <span data-ttu-id="13c70-123">Cette méthode est généralement appelée après chaque fonction ou à la fin du fichier de script.</span><span class="sxs-lookup"><span data-stu-id="13c70-123">Typically this method call is made after each function or at the end of the script file.</span></span> <span data-ttu-id="13c70-124">Si une fonction personnalisée n’est pas associée, elle ne fonctionne pas.</span><span class="sxs-lookup"><span data-stu-id="13c70-124">If a custom function is not associated, it will not work.</span></span>

<span data-ttu-id="13c70-125">L’exemple suivant présente une fonction d’ajout, suivie du nom de la fonction `add` associé à l’id JSON correspondant `ADD`.</span><span class="sxs-lookup"><span data-stu-id="13c70-125">The following example shows an add function, followed by the function's name `add` being associated with the corresponding JSON id `ADD`.</span></span>

```js
function add(first, second){
  return first + second;
}

CustomFunctions.associate("ADD", add);
```

<span data-ttu-id="13c70-126">Pour plus d’informations sur ce processus, voir [Mappage des noms de fonction aux métadonnées JSON](https://docs.microsoft.com/fr-FR/office/dev/add-ins/excel/custom-functions-best-practices#associating-function-names-with-json-metadata).</span><span class="sxs-lookup"><span data-stu-id="13c70-126">For more information on this process, see [Associating function names with json metadata](https://docs.microsoft.com/fr-FR/office/dev/add-ins/excel/custom-functions-best-practices#associating-function-names-with-json-metadata).</span></span>

### <a name="ensure-promises-return"></a><span data-ttu-id="13c70-127">Veiller au renvoi de promesses</span><span class="sxs-lookup"><span data-stu-id="13c70-127">Ensure promises return</span></span>

<span data-ttu-id="13c70-128">Quand Excel attend la fin de l’exécution d’une fonction personnalisée, il affiche #CHARGEMENT_DONNEES dans la cellule.</span><span class="sxs-lookup"><span data-stu-id="13c70-128">When Excel is waiting for a custom function to complete, it displays #GETTING_DATA in the cell.</span></span> <span data-ttu-id="13c70-129">Si votre code de fonction personnalisée renvoie une promesse sans que celle-ci renvoie de résultat, Excel continue d’afficher #CHARGEMENT_DONNEES.</span><span class="sxs-lookup"><span data-stu-id="13c70-129">If your custom function code returns a promise, but the promise does not return a result, Excel will continue showing #GETTING_DATA.</span></span> <span data-ttu-id="13c70-130">Vérifiez vos fonctions pour vous assurer que les promesses renvoient correctement un résultat à une cellule.</span><span class="sxs-lookup"><span data-stu-id="13c70-130">Check your functions to make sure that any promises are properly returning a result to a cell.</span></span>

## <a name="reporting-feedback"></a><span data-ttu-id="13c70-131">Formulation de commentaires</span><span class="sxs-lookup"><span data-stu-id="13c70-131">Reporting Feedback</span></span>

<span data-ttu-id="13c70-132">Si vous rencontrez des problèmes non abordés ici, faites-le nous savoir.</span><span class="sxs-lookup"><span data-stu-id="13c70-132">If you are encountering issues that aren't documented here, let us know.</span></span> <span data-ttu-id="13c70-133">Il existe deux méthodes pour signaler des problèmes.</span><span class="sxs-lookup"><span data-stu-id="13c70-133">There are two ways to report issues.</span></span>

### <a name="in-excel-on-windows-or-mac"></a><span data-ttu-id="13c70-134">Dans Excel sur Windows ou Mac</span><span class="sxs-lookup"><span data-stu-id="13c70-134">In Excel on Windows or Mac</span></span>

<span data-ttu-id="13c70-135">Si vous utilisez Excel pour Windows ou Mac, vous pouvez adresser un commentaire à l’équipe chargée de l’extensibilité d’Office directement à partir d’Excel.</span><span class="sxs-lookup"><span data-stu-id="13c70-135">If using Excel for Windows or Mac, you can report feedback to the Office extensibility team directly from Excel.</span></span> <span data-ttu-id="13c70-136">Pour ce faire, sélectionnez **Fichier -> Commentaires -> Envoyer un smiley mécontent**.</span><span class="sxs-lookup"><span data-stu-id="13c70-136">To do this, select **File | Feedback | Send a Frown**.</span></span> <span data-ttu-id="13c70-137">Envoyer un smiley mécontent fournira les journaux nécessaires pour comprendre le problème que vous rencontrez.</span><span class="sxs-lookup"><span data-stu-id="13c70-137">Sending a frown will provide the necessary logs to understand the issue you are hitting.</span></span>

### <a name="in-github"></a><span data-ttu-id="13c70-138">Dans Github</span><span class="sxs-lookup"><span data-stu-id="13c70-138">In Github</span></span>

<span data-ttu-id="13c70-139">N’hésitez pas à signaler un problème rencontré via la fonctionnalité « Commentaires sur le contenu » accessible au bas de chaque page de documentation, ou en [déclarant un nouveau problème directement dans le référentiel de fonctions personnalisées](https://github.com/OfficeDev/Excel-Custom-Functions/issues).</span><span class="sxs-lookup"><span data-stu-id="13c70-139">Feel free to submit an issue you encounter either through the "Content feedback" feature at the bottom of any documentation page, or by [filing a new issue directly to the custom functions repository](https://github.com/OfficeDev/Excel-Custom-Functions/issues).</span></span>

## <a name="see-also"></a><span data-ttu-id="13c70-140">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="13c70-140">See also</span></span>

* [<span data-ttu-id="13c70-141">Métadonnées fonctions personnalisées</span><span class="sxs-lookup"><span data-stu-id="13c70-141">Custom functions metadata</span></span>](custom-functions-json.md)
* [<span data-ttu-id="13c70-142">Exécution de fonctions personnalisées Excel</span><span class="sxs-lookup"><span data-stu-id="13c70-142">Runtime for Excel custom functions</span></span>](custom-functions-runtime.md)
* [<span data-ttu-id="13c70-143">Meilleures pratiques de fonctions personnalisées</span><span class="sxs-lookup"><span data-stu-id="13c70-143">Custom functions best practices</span></span>](custom-functions-best-practices.md)
* [<span data-ttu-id="13c70-144">Fonctions personnalisées changelog</span><span class="sxs-lookup"><span data-stu-id="13c70-144">Custom functions changelog</span></span>](custom-functions-changelog.md)
* [<span data-ttu-id="13c70-145">Didacticiel de fonctions personnalisées Excel</span><span class="sxs-lookup"><span data-stu-id="13c70-145">Excel custom functions tutorial</span></span>](../tutorials/excel-tutorial-create-custom-functions.md)
