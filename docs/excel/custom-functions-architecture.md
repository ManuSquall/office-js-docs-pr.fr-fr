---
ms.date: 07/10/2019
description: Découvrez comment exécuter les fonctions personnalisées dans Excel.
title: Architecture de fonctions personnalisées
localization_priority: Priority
ms.openlocfilehash: abe4f847069b3bb9d3813b4520bf8eb078a40c18
ms.sourcegitcommit: bb44c9694f88cde32ffbb642689130db44456964
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/17/2019
ms.locfileid: "35771462"
---
# <a name="custom-functions-architecture"></a><span data-ttu-id="a3eba-103">Architecture de fonctions</span><span class="sxs-lookup"><span data-stu-id="a3eba-103">Custom functions architecture</span></span>

 <span data-ttu-id="a3eba-104">Les fonctions personnalisées sont avec leur propre runtime unique qui privilégie l’exécution de calculs.</span><span class="sxs-lookup"><span data-stu-id="a3eba-104">Custom functions are with their own unique runtime that prioritizes execution of calculations.</span></span> <span data-ttu-id="a3eba-105">Cet article traitera les différences entre le runtime de fonctions personnalisées et le moteur JavaScript basés sur navigateur qui alimente la plupart des autres parties de votre complément.</span><span class="sxs-lookup"><span data-stu-id="a3eba-105">This article will cover the differences between the custom functions runtime and the browser-based JavaScript engine which powers most other parts of your add-in.</span></span>

[!include[Excel custom functions note](../includes/excel-custom-functions-note.md)]

## <a name="custom-functions-runtime"></a><span data-ttu-id="a3eba-106">Runtime des fonctions personnalisées</span><span class="sxs-lookup"><span data-stu-id="a3eba-106">Custom functions runtime</span></span>

<span data-ttu-id="a3eba-107">Un complément Web Office peut interagir avec l’utilisateur en tant que volet Office ou volet de contenu et peut inclure des commandes et fonctions personnalisées.</span><span class="sxs-lookup"><span data-stu-id="a3eba-107">An Office Web Add-in can interact with the user as a task pane, or a content pane, and can include commands and custom functions.</span></span> <span data-ttu-id="a3eba-108">Toutes ces parties s’exécutent dans un moteur de navigateur d’exécution à l’exception des fonctions personnalisées.</span><span class="sxs-lookup"><span data-stu-id="a3eba-108">All of these parts run in a browser engine runtime except for custom functions.</span></span> <span data-ttu-id="a3eba-109">Les fonctions personnalisées s’exécutent dans un runtime de fonctions personnalisées distincte pour optimiser la vitesse de calcul.</span><span class="sxs-lookup"><span data-stu-id="a3eba-109">Custom functions run in a separate custom functions runtime to optimize for calculation speed.</span></span>

<span data-ttu-id="a3eba-110">Notez que si vous utilisez le [Générateur Yeoman de compléments Office](https://www.npmjs.com/package/generator-office) pour générer votre projet, le runtime de fonctions personnalisées est chargé via le fichier de script personnalisé fonctions.js référencé dans le fichier **fonctions.html**.</span><span class="sxs-lookup"><span data-stu-id="a3eba-110">Note that if you're using the [Yeoman generator for Office Add-ins](https://www.npmjs.com/package/generator-office) to generate your project, the custom functions runtime will load through the custom-functions.js script file referenced in the functions.html file.</span></span> <span data-ttu-id="a3eba-111">La **fonctions.html** sert uniquement à charger le runtime et ne doit pas être utilisé comme le volet Office pour votre complément.</span><span class="sxs-lookup"><span data-stu-id="a3eba-111">The functions.html serves only to load the runtime and shouldn't be used as the task pane for your add-in.</span></span>

<span data-ttu-id="a3eba-112">Le tableau suivant met en évidence les différences entre l’exécution de fonctions personnalisées et l’exécution du moteur navigateur:</span><span class="sxs-lookup"><span data-stu-id="a3eba-112">The following table highlights the differences between the custom functions runtime and the browser engine runtime:</span></span>

| <span data-ttu-id="a3eba-113">Exécution des fonctions personnalisées</span><span class="sxs-lookup"><span data-stu-id="a3eba-113">Custom functions runtime</span></span>  | <span data-ttu-id="a3eba-114">Exécution du moteur navigateur</span><span class="sxs-lookup"><span data-stu-id="a3eba-114">Browser engine runtime</span></span>    |
|------------------------------------------------------------------ |-------------------------------------------------------------------------------------------------------------- |
| <span data-ttu-id="a3eba-115">Prend en charge le renvoi d’une valeur d’une cellule</span><span class="sxs-lookup"><span data-stu-id="a3eba-115">Supports returning a value from a cell</span></span>    | <span data-ttu-id="a3eba-116">Prend en charge les éléments Office.js APIs et éléments d’Interface Utilisateurs</span><span class="sxs-lookup"><span data-stu-id="a3eba-116">Supports Office.js APIs and UI elements</span></span>   |
| <span data-ttu-id="a3eba-117">N’a pas l’objet `localStorage`, utilise à la place l’objet `OfficeRuntime.storage`.</span><span class="sxs-lookup"><span data-stu-id="a3eba-117">Does not have `localStorage` object, instead uses `OfficeRuntime.storage`</span></span>     | <span data-ttu-id="a3eba-118">A l’objet `localStorage`, peut éventuellement utiliser l’objet `OfficeRuntime.storage`.</span><span class="sxs-lookup"><span data-stu-id="a3eba-118">Has `localStorage` object, can optionally use `OfficeRuntime.storage` object</span></span>     |
| <span data-ttu-id="a3eba-119">Ne prend pas en charge interaction avec le DOM ou le chargement des bibliothèques qui dépendent de DOM par exemple, jQuery.</span><span class="sxs-lookup"><span data-stu-id="a3eba-119">Does not support interacting with the DOM, or loading libraries that depend on the DOM such as jQuery.</span></span>    | <span data-ttu-id="a3eba-120">Ne prend pas en charge l’interaction avec le DOM ou le chargement des bibliothèques qui dépendent de DOM.</span><span class="sxs-lookup"><span data-stu-id="a3eba-120">Supports interacting with the DOM and loading libraries that depend on the DOM.</span></span> |

## <a name="browser-engine-runtime"></a><span data-ttu-id="a3eba-121">Exécution du moteur navigateur</span><span class="sxs-lookup"><span data-stu-id="a3eba-121">Browser engine runtime</span></span>

<span data-ttu-id="a3eba-122">Le volet de tâche, complément de contenu et les commandes s’exécutent dans une navigateur d’exécution du moteur.</span><span class="sxs-lookup"><span data-stu-id="a3eba-122">The task pane, content add-in, and commands run in a browser engine runtime.</span></span>

<span data-ttu-id="a3eba-123">L’exécution du moteur navigateur prend en charge les APIs Office.js.</span><span class="sxs-lookup"><span data-stu-id="a3eba-123">The browser engine runtime supports the Office.js APIs.</span></span> <span data-ttu-id="a3eba-124">N’oubliez pas que les API Excel, telles que des API qui vous permettent de manipuler des tableaux Excel, exécutent sur le runtime moteur de navigateur, mais ne sont pas accessibles directement à partir de l’exécution de fonctions personnalisées.</span><span class="sxs-lookup"><span data-stu-id="a3eba-124">Keep in mind that any of the Excel APIs, such as APIs which allow you to manipulate Excel tables, run on the browser engine runtime, but aren't directly accessible from the custom functions runtime.</span></span>

## <a name="communicate-between-runtimes"></a><span data-ttu-id="a3eba-125">Communiquer entre les exécutions</span><span class="sxs-lookup"><span data-stu-id="a3eba-125">Communicate between runtimes</span></span>

<span data-ttu-id="a3eba-126">Votre code de fonctions personnalisées ne peut pas interagir directement avec le code d’autres parties de votre complément web, par exemple, le volet de tâche, car elles se trouvent dans différentes exécutions.</span><span class="sxs-lookup"><span data-stu-id="a3eba-126">Your custom functions code cannot directly interact with code in other parts of your web add-in, like the task pane because they are in different runtimes.</span></span> <span data-ttu-id="a3eba-127">Mais dans certains cas, vous devrez partager des données, par exemple, en passant un jeton.</span><span class="sxs-lookup"><span data-stu-id="a3eba-127">But in some scenarios you may need to share data, such as passing a token.</span></span>

<span data-ttu-id="a3eba-128">L’objet `OfficeRuntime.storage` permet de stocker des données à partir de vos fonctions personnalisées et d’obtenir des données à partir de votre code de volet de tâches.</span><span class="sxs-lookup"><span data-stu-id="a3eba-128">`OfficeRuntime.storage` can be used to store data from your custom functions and get data from your task pane code.</span></span> <span data-ttu-id="a3eba-129">Pour plus d’informations sur le stockage et partage de données, voir [Enregistrer et partager l’état](custom-functions-save-state.md).</span><span class="sxs-lookup"><span data-stu-id="a3eba-129">For more information about storing and sharing data, see [Saving and sharing state](custom-functions-save-state.md).</span></span>

<span data-ttu-id="a3eba-130">Vous pouvez voir un exemple de code à l’aide de l’objet `storage` dans ce [référentiel Github](https://github.com/OfficeDev/PnP-OfficeAddins/tree/master/Excel-custom-functions/AsyncStorage) dédié aux pratiques et modèles.</span><span class="sxs-lookup"><span data-stu-id="a3eba-130">You can see a code sample using `storage` in this [Github repository](https://github.com/OfficeDev/PnP-OfficeAddins/tree/master/Excel-custom-functions/AsyncStorage) dedicated to patterns and practices.</span></span>
<span data-ttu-id="a3eba-131">Pour des informations plus générales sur `storage`, voir [Runtime de Fonctions personnalisées](./custom-functions-runtime.md).</span><span class="sxs-lookup"><span data-stu-id="a3eba-131">For more general information about `storage`, see [Custom functions runtime](./custom-functions-runtime.md).</span></span>

<span data-ttu-id="a3eba-132">L’objet `storage` peut également être utile pour l’authentification.</span><span class="sxs-lookup"><span data-stu-id="a3eba-132">`storage` can also be useful for authentication.</span></span> <span data-ttu-id="a3eba-133">Pour plus d’informations, voir[Authentification des fonctions personnalisées](custom-functions-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="a3eba-133">For more information, see [Custom functions authentication](custom-functions-authentication.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="a3eba-134">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="a3eba-134">Next steps</span></span>
<span data-ttu-id="a3eba-135">En savoir plus sur l' [utilisation de runtime des fonctions personnalisées](custom-functions-runtime.md).</span><span class="sxs-lookup"><span data-stu-id="a3eba-135">Learn more about how to [use the custom functions runtime](custom-functions-runtime.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="a3eba-136">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="a3eba-136">See also</span></span>

* [<span data-ttu-id="a3eba-137">Exécution de fonctions personnalisées Excel</span><span class="sxs-lookup"><span data-stu-id="a3eba-137">Runtime for Excel custom functions</span></span>](custom-functions-runtime.md)
* [<span data-ttu-id="a3eba-138">Recevoir et gérer des données à l’aide de fonctions personnalisées</span><span class="sxs-lookup"><span data-stu-id="a3eba-138">Receive and handle data with custom functions</span></span>](custom-functions-web-reqs.md)
* [<span data-ttu-id="a3eba-139">Métadonnées de fonctions personnalisées</span><span class="sxs-lookup"><span data-stu-id="a3eba-139">Custom functions metadata</span></span>](custom-functions-json.md)
* [<span data-ttu-id="a3eba-140">Didacticiel de fonctions personnalisées Excel</span><span class="sxs-lookup"><span data-stu-id="a3eba-140">Excel custom functions tutorial</span></span>](../tutorials/excel-tutorial-create-custom-functions.md)
