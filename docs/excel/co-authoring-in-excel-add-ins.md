---
title: Co-création dans des macros complémentaires Excel
description: Apprenez à co-auteur d’un classeur Excel stocké dans OneDrive, OneDrive entreprise ou SharePoint Online.
ms.date: 07/23/2020
localization_priority: Normal
ms.openlocfilehash: 34ef6fbc32c686e49b9720c5249d5046d26a2952
ms.sourcegitcommit: 7d5407d3900d2ad1feae79a4bc038afe50568be0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/30/2020
ms.locfileid: "46530442"
---
# <a name="coauthoring-in-excel-add-ins"></a><span data-ttu-id="1ca0f-103">Co-création dans des macros complémentaires Excel</span><span class="sxs-lookup"><span data-stu-id="1ca0f-103">Coauthoring in Excel add-ins</span></span>  

<span data-ttu-id="1ca0f-p101">Avec la [co-création](https://support.office.com/article/Collaborate-on-Excel-workbooks-at-the-same-time-with-co-authoring-7152aa8b-b791-414c-a3bb-3024e46fb104), plusieurs personnes peuvent travailler ensemble et modifier simultanément le même classeur Excel. Tous les co-auteurs d’un classeur peuvent voir les modifications d’un autre co-auteur dès que ce co-auteur enregistre le classeur. Pour co-créer un classeur Excel, le classeur doit être enregistré dans OneDrive, OneDrive Entreprise ou SharePoint Online.</span><span class="sxs-lookup"><span data-stu-id="1ca0f-p101">With [coauthoring](https://support.office.com/article/Collaborate-on-Excel-workbooks-at-the-same-time-with-co-authoring-7152aa8b-b791-414c-a3bb-3024e46fb104), multiple people can work together and edit the same Excel workbook simultaneously. All coauthors of a workbook can see another coauthor's changes as soon as that coauthor saves the workbook. To coauthor an Excel workbook, the workbook must be stored in OneDrive, OneDrive for Business, or SharePoint Online.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="1ca0f-107">Dans Excel pour Microsoft 365, vous remarquerez l’enregistrement automatique dans le coin supérieur gauche.</span><span class="sxs-lookup"><span data-stu-id="1ca0f-107">In Excel for Microsoft 365, you will notice AutoSave in the upper-left corner.</span></span> <span data-ttu-id="1ca0f-108">Lorsque l’enregistrement automatique est activé, les co-auteurs visualisent vos modifications en temps réel.</span><span class="sxs-lookup"><span data-stu-id="1ca0f-108">When AutoSave is turned on, coauthors see your changes in real time.</span></span> <span data-ttu-id="1ca0f-109">Prenez en considération l’impact de ce comportement sur la conception de votre complément Excel.</span><span class="sxs-lookup"><span data-stu-id="1ca0f-109">Consider the impact of this behavior on the design of your Excel add-in.</span></span> <span data-ttu-id="1ca0f-110">Les utilisateurs peuvent désactiver l’enregistrement automatique via le commutateur dans le coin supérieur gauche de la fenêtre Excel.</span><span class="sxs-lookup"><span data-stu-id="1ca0f-110">Users can turn off AutoSave via the switch in the upper left of the Excel window.</span></span>

## <a name="coauthoring-overview"></a><span data-ttu-id="1ca0f-111">Vue d’ensemble de la co-création</span><span class="sxs-lookup"><span data-stu-id="1ca0f-111">Coauthoring overview</span></span>

<span data-ttu-id="1ca0f-112">Lorsque vous modifiez le contenu d’un classeur, Excel synchronise automatiquement ces modifications avec tous les co-auteurs.</span><span class="sxs-lookup"><span data-stu-id="1ca0f-112">When you change a workbook's content, Excel automatically synchronizes those changes across all coauthors.</span></span> <span data-ttu-id="1ca0f-113">Les co-auteurs peuvent modifier le contenu d’un classeur, mais peuvent également exécuter du code dans un complément Excel.</span><span class="sxs-lookup"><span data-stu-id="1ca0f-113">Coauthors can change the content of a workbook, but so can code running within an Excel add-in.</span></span> <span data-ttu-id="1ca0f-114">Par exemple, lorsque le code JavaScript suivant s’exécute dans un complément Office, la valeur de la plage est définie sur Contoso:</span><span class="sxs-lookup"><span data-stu-id="1ca0f-114">For example, when the following JavaScript code runs in an Office Add-in, the value of a range is set to Contoso:</span></span>

```js
range.values = [['Contoso']];
```

<span data-ttu-id="1ca0f-115">Après la synchronisation de « Contoso » avec tous les co-auteurs, tout utilisateur ou complément en cours d’exécution dans le même classeur visualisera la nouvelle valeur de la plage.</span><span class="sxs-lookup"><span data-stu-id="1ca0f-115">After 'Contoso' synchronizes across all coauthors, any user or add-in running in the same workbook will see the new value of the range.</span></span>

<span data-ttu-id="1ca0f-p104">La co-création permet uniquement la synchronisation du contenu dans le classeur partagé. Les valeurs copiées du classeur vers les variables JavaScript dans un complément Excel ne sont pas synchronisées. Par exemple, si votre complément enregistre la valeur d’une cellule (par exemple, « Contoso ») dans une variable JavaScript et qu’un co-auteur modifie ensuite la valeur de la cellule sur « Exemple », après la synchronisation, tous les co-auteurs verront « Exemple » dans la cellule. Toutefois, la valeur de la variable JavaScript sera toujours définie sur « Contoso ». En outre, lorsque plusieurs co-auteurs utilisent le même complément, chaque co-auteur possède sa propre copie de la variable, qui n’est pas synchronisée. Lorsque vous utilisez des variables qui utilisent le contenu du classeur, veillez à bien rechercher les valeurs mises à jour dans le classeur avant d’utiliser la variable.</span><span class="sxs-lookup"><span data-stu-id="1ca0f-p104">Coauthoring only synchronizes the content within the shared workbook. Values copied from the workbook to JavaScript variables in an Excel add-in are not synchronized. For example, if your add-in stores the value of a cell (such as 'Contoso') in a JavaScript variable, and then a coauthor changes the value of the cell to 'Example', after synchronization all coauthors see 'Example' in the cell. However, the value of the JavaScript variable is still set to 'Contoso'. Furthermore, when multiple coauthors use the same add-in, each coauthor has their own copy of the variable, which is not synchronized. When you use variables that use workbook content, be sure you check for updated values in the workbook before you use the variable.</span></span>

## <a name="use-events-to-manage-the-in-memory-state-of-your-add-in"></a><span data-ttu-id="1ca0f-122">Utiliser des événements pour gérer l’état de la mémoire de votre complément</span><span class="sxs-lookup"><span data-stu-id="1ca0f-122">Use events to manage the in-memory state of your add-in</span></span>

<span data-ttu-id="1ca0f-p105">Les compléments Excel peuvent lire le contenu du classeur (à partir de feuilles de calcul masquées et d’un objet de paramètres), puis l’enregistrer dans des structures de données comme des variables. Une fois que les valeurs d’origine sont copiées dans l’une de ces structures de données, les co-auteurs peuvent mettre à jour le contenu du classeur d’origine. Cela signifie que les valeurs copiées dans les structures de données ne sont plus synchronisées avec le contenu du classeur. Lorsque vous générez vos compléments, pensez à prendre en compte cette séparation de contenu du classeur et les valeurs enregistrées dans les structures de données.</span><span class="sxs-lookup"><span data-stu-id="1ca0f-p105">Excel add-ins can read workbook content (from hidden worksheets and a setting object), and then store it in data structures such as variables. After the original values are copied into any of these data structures, coauthors can update the original workbook content. This means that the copied values in the data structures are now out of sync with the workbook content. When you build your add-ins, be sure to account for this separation of workbook content and values stored in data structures.</span></span>

<span data-ttu-id="1ca0f-p106">Par exemple, vous pouvez créer un complément de contenu qui affiche des visualisations personnalisées. L’état de vos visualisations personnalisées peut être enregistré dans une feuille de calcul masquée. Lorsque les co-auteurs utilisent le même classeur, le scénario suivant peut se produire :</span><span class="sxs-lookup"><span data-stu-id="1ca0f-p106">For example, you might build a content add-in that displays custom visualizations. The state of your custom visualizations might be saved in a hidden worksheet. When coauthors use the same workbook, the following scenario can occur:</span></span>

- <span data-ttu-id="1ca0f-p107">L’utilisateur A ouvre le document et les visualisations personnalisées sont affichées dans le classeur. Les visualisations personnalisées lisent les données d’une feuille de calcul masquée (par exemple, la couleur des visualisations est définie sur bleu).</span><span class="sxs-lookup"><span data-stu-id="1ca0f-p107">User A opens the document and the custom visualizations are shown in the workbook. The custom visualizations read data from a hidden worksheet (for example, the color of the visualizations is set to blue).</span></span>
- <span data-ttu-id="1ca0f-p108">L’utilisateur B ouvre le même document et commence à modifier les visualisations personnalisées. L’utilisateur B définit la couleur des visualisations personnalisées sur orange. La valeur Orange est enregistrée dans la feuille de calcul masquée.</span><span class="sxs-lookup"><span data-stu-id="1ca0f-p108">User B opens the same document, and starts modifying the custom visualizations. User B sets the color of the custom visualizations to orange. Orange is saved to the hidden worksheet.</span></span>
- <span data-ttu-id="1ca0f-135">La feuille de calcul masquée de l’utilisateur A est mise à jour avec la nouvelle valeur Orange.</span><span class="sxs-lookup"><span data-stu-id="1ca0f-135">User A's hidden worksheet is updated with the new value of orange.</span></span>
- <span data-ttu-id="1ca0f-136">Les visualisations personnalisées de l’utilisateur A sont toujours bleues.</span><span class="sxs-lookup"><span data-stu-id="1ca0f-136">User A's custom visualizations are still blue.</span></span>

<span data-ttu-id="1ca0f-p109">Si vous souhaitez que les visualisations personnalisées de l’utilisateur A répondent aux modifications apportées par les co-auteurs sur la feuille de calcul masquée, utilisez l’événement [BindingDataChanged](/javascript/api/office/office.bindingdatachangedeventargs). Cela garantit que les modifications apportées au contenu du classeur par les co-auteurs sont répercutées à l’état de votre complément.</span><span class="sxs-lookup"><span data-stu-id="1ca0f-p109">If you want User A's custom visualizations to respond to changes made by coauthors on the hidden worksheet, use the [BindingDataChanged](/javascript/api/office/office.bindingdatachangedeventargs) event. This ensures that changes to workbook content made by coauthors is reflected in the state of your add-in.</span></span>

## <a name="caveats-to-using-events-with-coauthoring"></a><span data-ttu-id="1ca0f-139">Restrictions à l’utilisation des événements dans le cadre de la co-création</span><span class="sxs-lookup"><span data-stu-id="1ca0f-139">Caveats to using events with coauthoring</span></span>

<span data-ttu-id="1ca0f-p110">Comme indiqué précédemment, dans certains scénarios, le déclenchement d’événements pour tous les co-auteurs permet d’améliorer l’expérience utilisateur. Toutefois, sachez que, dans certains scénarios, ce comportement peut entraîner des expériences utilisateur médiocres.</span><span class="sxs-lookup"><span data-stu-id="1ca0f-p110">As described earlier, in some scenarios, triggering events for all coauthors provides an improved user experience. However, be aware that in some scenarios this behavior can produce poor user experiences.</span></span>

<span data-ttu-id="1ca0f-142">Par exemple, dans les scénarios de validation de données, il est fréquent d’afficher l’interface utilisateur en réponse aux événements.</span><span class="sxs-lookup"><span data-stu-id="1ca0f-142">For example, in data validation scenarios, it is common to display UI in response to events.</span></span> <span data-ttu-id="1ca0f-143">L’événement [BindingDataChanged](/javascript/api/office/office.bindingdatachangedeventargs) décrit dans la section précédente s’exécute lorsqu’un utilisateur local ou un co-auteur modifie (à distance) le contenu du classeur dans la liaison.</span><span class="sxs-lookup"><span data-stu-id="1ca0f-143">The [BindingDataChanged](/javascript/api/office/office.bindingdatachangedeventargs) event described in the previous section runs when either a local user or coauthor (remote) changes the workbook content within the binding.</span></span> <span data-ttu-id="1ca0f-144">Si le gestionnaire d’événements de l' `BindingDataChanged` événement affiche l’interface utilisateur, les utilisateurs voient l’interface utilisateur qui n’est pas liée aux modifications sur lesquelles ils travaillaient dans le classeur, ce qui entraîne une expérience utilisateur médiocre.</span><span class="sxs-lookup"><span data-stu-id="1ca0f-144">If the event handler of the `BindingDataChanged` event displays UI, users will see UI that is unrelated to changes they were working on in the workbook, leading to a poor user experience.</span></span> <span data-ttu-id="1ca0f-145">Évitez d’afficher l’interface utilisateur lorsque vous utilisez des événements dans votre complément.</span><span class="sxs-lookup"><span data-stu-id="1ca0f-145">Avoid displaying UI when using events in your add-in.</span></span>

## <a name="avoiding-table-row-coauthoring-conflicts"></a><span data-ttu-id="1ca0f-146">Éviter les conflits de cocréation de lignes de tableau</span><span class="sxs-lookup"><span data-stu-id="1ca0f-146">Avoiding table row coauthoring conflicts</span></span>

<span data-ttu-id="1ca0f-147">Il s’agit d’un problème connu que les appels à l' [`TableRowCollection.add`](/javascript/api/excel/excel.tablerowcollection#add-index--values-) API peuvent entraîner des conflits de co-création.</span><span class="sxs-lookup"><span data-stu-id="1ca0f-147">It is a known issue that calls to the [`TableRowCollection.add`](/javascript/api/excel/excel.tablerowcollection#add-index--values-) API can cause coauthoring conflicts.</span></span> <span data-ttu-id="1ca0f-148">Nous vous déconseillons d’utiliser cette API si vous envisagez d’exécuter votre complément alors que d’autres utilisateurs modifient le classeur du complément (en particulier, s’ils modifient la table ou une plage située sous le tableau).</span><span class="sxs-lookup"><span data-stu-id="1ca0f-148">We do not recommend using that API if you anticipate your add-in will be run while other users are editing the add-in's workbook (specifically, if they are editing the table or any range under the table).</span></span> <span data-ttu-id="1ca0f-149">Les conseils suivants devraient vous aider à éviter les problèmes liés à la `TableRowCollection.add` méthode (et à éviter de déclencher les émissions Excel de barres jaunes qui demandent aux utilisateurs d’actualiser) :</span><span class="sxs-lookup"><span data-stu-id="1ca0f-149">The following guidance should help you avoid issues with the `TableRowCollection.add` method (and avoid triggering the yellow bar Excel shows that asks users to refresh):</span></span>

1. <span data-ttu-id="1ca0f-150">Utilisez à la [`Range.values`](/javascript/api/excel/excel.range#values) place de [`TableRowCollection.add`](/javascript/api/excel/excel.tablerowcollection#add-index--values-) .</span><span class="sxs-lookup"><span data-stu-id="1ca0f-150">Use [`Range.values`](/javascript/api/excel/excel.range#values) instead of [`TableRowCollection.add`](/javascript/api/excel/excel.tablerowcollection#add-index--values-).</span></span> <span data-ttu-id="1ca0f-151">La définition des `Range` valeurs directement sous le tableau développe automatiquement le tableau.</span><span class="sxs-lookup"><span data-stu-id="1ca0f-151">Setting the `Range` values directly below the table automatically expands the table.</span></span> <span data-ttu-id="1ca0f-152">Dans le cas contraire, l’ajout de lignes de table via l' `Table` API entraîne des conflits de fusion pour les utilisateurs de la coauthentification.</span><span class="sxs-lookup"><span data-stu-id="1ca0f-152">Otherwise, adding table rows through the `Table` APIs results in merge conflicts for coauth users.</span></span>
1. <span data-ttu-id="1ca0f-153">Aucune [règle de validation des données](https://support.microsoft.com/office/apply-data-validation-to-cells-29fecbcc-d1b9-42c1-9d76-eff3ce5f7249) ne doit être appliquée aux cellules situées en-dessous du tableau, sauf si la validation des données est appliquée à la colonne entière.</span><span class="sxs-lookup"><span data-stu-id="1ca0f-153">There should be no [data validation rules](https://support.microsoft.com/office/apply-data-validation-to-cells-29fecbcc-d1b9-42c1-9d76-eff3ce5f7249) applied to cells below the table, unless the data validation is applied to the entire column.</span></span>
1. <span data-ttu-id="1ca0f-154">S’il y a des données dans la table, le complément doit gérer ce paramètre avant de définir la valeur de la plage.</span><span class="sxs-lookup"><span data-stu-id="1ca0f-154">If there is data under the table, the add-in needs to handle that before setting the range value.</span></span> <span data-ttu-id="1ca0f-155">L’utilisation [`Range.insert`](/javascript/api/excel/excel.range##insert-shift-) de pour insérer une ligne vide déplace les données et permet de libérer de l’espace pour le tableau en expansion.</span><span class="sxs-lookup"><span data-stu-id="1ca0f-155">Using [`Range.insert`](/javascript/api/excel/excel.range##insert-shift-) to insert an empty row will move the data and make space for the expanding table.</span></span> <span data-ttu-id="1ca0f-156">Dans le cas contraire, vous risquez de remplacer les cellules en dessous du tableau.</span><span class="sxs-lookup"><span data-stu-id="1ca0f-156">Otherwise, you risk overwriting cells below the table.</span></span>
1. <span data-ttu-id="1ca0f-157">Vous ne pouvez pas ajouter une ligne vide à une table avec `Range.values` .</span><span class="sxs-lookup"><span data-stu-id="1ca0f-157">You cannot add an empty row to a table with `Range.values`.</span></span> <span data-ttu-id="1ca0f-158">Le tableau s’étend automatiquement uniquement si les données sont présentes dans les cellules situées directement sous le tableau.</span><span class="sxs-lookup"><span data-stu-id="1ca0f-158">The table only automatically expands if data is present in the cells directly below the table.</span></span> <span data-ttu-id="1ca0f-159">Utilisez des données temporaires ou des colonnes masquées pour ajouter une ligne de tableau vide.</span><span class="sxs-lookup"><span data-stu-id="1ca0f-159">Use either temporary data or hidden columns as a workaround to add an empty table row.</span></span>

## <a name="see-also"></a><span data-ttu-id="1ca0f-160">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="1ca0f-160">See also</span></span>

- [<span data-ttu-id="1ca0f-161">À propos de la co-création dans Excel (VBA)</span><span class="sxs-lookup"><span data-stu-id="1ca0f-161">About coauthoring in Excel (VBA)</span></span>](/office/vba/excel/concepts/about-coauthoring-in-excel)
- [<span data-ttu-id="1ca0f-162">Impact de l’enregistrement automatique sur les compléments et les macros (VBA)</span><span class="sxs-lookup"><span data-stu-id="1ca0f-162">How AutoSave impacts add-ins and macros (VBA)</span></span>](/office/vba/library-reference/concepts/how-autosave-impacts-addins-and-macros)
