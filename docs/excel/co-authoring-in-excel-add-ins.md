---
title: Co-création dans des macros complémentaires Excel
description: ''
ms.date: 12/04/2017
ms.openlocfilehash: 47482ba74ef298add4cdb553d66904381123289d
ms.sourcegitcommit: 30435939ab8b8504c3dbfc62fd29ec6b0f1a7d22
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/12/2018
ms.locfileid: "23945728"
---
# <a name="coauthoring-in-excel-add-ins"></a><span data-ttu-id="d293a-102">Co-création dans des macros complémentaires Excel</span><span class="sxs-lookup"><span data-stu-id="d293a-102">Coauthoring in Excel add-ins</span></span>  

<span data-ttu-id="d293a-103">Avec la [co-création](https://support.office.com/article/Collaborate-on-Excel-workbooks-at-the-same-time-with-co-authoring-7152aa8b-b791-414c-a3bb-3024e46fb104), plusieurs personnes peuvent travailler ensemble et modifier simultanément le même classeur Excel.</span><span class="sxs-lookup"><span data-stu-id="d293a-103">With [coauthoring](https://support.office.com/article/Collaborate-on-Excel-workbooks-at-the-same-time-with-co-authoring-7152aa8b-b791-414c-a3bb-3024e46fb104), multiple people can work together and edit the same Excel workbook simultaneously.</span></span> <span data-ttu-id="d293a-104">Tous les co-auteurs d’un classeur peuvent voir les modifications d’un autre co-auteur dès que ce co-auteur enregistre le classeur.</span><span class="sxs-lookup"><span data-stu-id="d293a-104">All coauthors of a workbook can see another coauthor's changes as soon as that coauthor saves the workbook.</span></span> <span data-ttu-id="d293a-105">Pour co-créer un classeur Excel, le classeur doit être enregistré dans OneDrive, OneDrive Entreprise ou SharePoint Online.</span><span class="sxs-lookup"><span data-stu-id="d293a-105">To coauthor an Excel workbook, the workbook must be stored in OneDrive, OneDrive for Business, or SharePoint Online.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d293a-p102">Dans Excel pour Office 365, vous remarquerez AutoSave dans le coin supérieur gauche. Lorsque AutoSave est activé, les coauteurs voient vos modifications en temps réel. Considérez l'impact de ce comportement sur la conception de votre complément Excel. Les utilisateurs peuvent désactiver AutoSave via le commutateur en haut, à gauche de la fenêtre Excel.</span><span class="sxs-lookup"><span data-stu-id="d293a-p102">In Excel 2016 for Office 365, you will notice AutoSave in the upper-left corner. When AutoSave is turned on, coauthors see your changes in real time. Consider the impact of this behavior on the design of your Excel add-in. Users can turn off AutoSave via the switch in the upper left of the Excel window.</span></span>

<span data-ttu-id="d293a-110">La co-création est disponible sur les plateformes suivantes :</span><span class="sxs-lookup"><span data-stu-id="d293a-110">Coauthoring is available on the following platforms:</span></span>

- <span data-ttu-id="d293a-111">Excel Online</span><span class="sxs-lookup"><span data-stu-id="d293a-111">Excel Online</span></span>
- <span data-ttu-id="d293a-112">Excel pour Android</span><span class="sxs-lookup"><span data-stu-id="d293a-112">Excel for Android</span></span>
- <span data-ttu-id="d293a-113">Excel pour iOS</span><span class="sxs-lookup"><span data-stu-id="d293a-113">Excel for iOS</span></span>
- <span data-ttu-id="d293a-114">Excel Mobile pour Windows 10</span><span class="sxs-lookup"><span data-stu-id="d293a-114">Excel Mobile for Windows 10</span></span>
- <span data-ttu-id="d293a-115">Excel pour bureau Windows pour les clients Office 365 (bureau Windows version 16.0.8326.2076 ou ultérieure, disponible pour les clients à compter d’août 2017)</span><span class="sxs-lookup"><span data-stu-id="d293a-115">Excel for Windows Desktop for Office 365 customers (Windows desktop build 16.0.8326.2076 or later, which is available to current channel customers effective August 2017)</span></span>

## <a name="coauthoring-overview"></a><span data-ttu-id="d293a-116">Vue d’ensemble de la co-création</span><span class="sxs-lookup"><span data-stu-id="d293a-116">Coauthoring overview</span></span>
 
<span data-ttu-id="d293a-p103">Lorsque vous modifiez le contenu d'un classeur, Excel synchronise automatiquement ces modifications entre tous les coauteurs. Les coauteurs peuvent modifier le contenu d'un classeur, mais peuvent aussi exécuter du code dans un complément Excel. Par exemple, lorsque le code JavaScript suivant s'exécute dans un complément Office, la valeur d'une plage est définie sur Contoso :</span><span class="sxs-lookup"><span data-stu-id="d293a-p103">When you change a workbook's content, Excel automatically synchronizes those changes across all coauthors. Coauthors can change the content of a workbook, but so can code running within an Excel add-in. For example, when the following JavaScript code runs in an Office add-in, the value of a range is set to Contoso:</span></span>

```js
range.values = [['Contoso']];
```
<span data-ttu-id="d293a-120">Après la synchronisation de « Contoso » avec tous les co-auteurs, tout utilisateur ou complément en cours d’exécution dans le même classeur visualisera la nouvelle valeur de la plage.</span><span class="sxs-lookup"><span data-stu-id="d293a-120">After 'Contoso' synchronizes across all coauthors, any user or add-in running in the same workbook will see the new value of the range.</span></span> 

<span data-ttu-id="d293a-121">La co-création permet uniquement la synchronisation du contenu dans le classeur partagé.</span><span class="sxs-lookup"><span data-stu-id="d293a-121">Coauthoring only synchronizes the content within the shared workbook.</span></span> <span data-ttu-id="d293a-122">Les valeurs copiées du classeur vers les variables JavaScript dans un complément Excel ne sont pas synchronisées.</span><span class="sxs-lookup"><span data-stu-id="d293a-122">Values copied from the workbook to JavaScript variables in an Excel add-in are not synchronized.</span></span> <span data-ttu-id="d293a-123">Par exemple, si votre complément enregistre la valeur d’une cellule (par exemple, « Contoso ») dans une variable JavaScript et qu’un co-auteur modifie ensuite la valeur de la cellule sur « Exemple », après la synchronisation, tous les co-auteurs verront « Exemple » dans la cellule.</span><span class="sxs-lookup"><span data-stu-id="d293a-123">For example, if your add-in stores the value of a cell (such as 'Contoso') in a JavaScript variable, and then a coauthor changes the value of the cell to 'Example', after synchronization all coauthors see 'Example' in the cell.</span></span> <span data-ttu-id="d293a-124">Toutefois, la valeur de la variable JavaScript sera toujours définie sur « Contoso ».</span><span class="sxs-lookup"><span data-stu-id="d293a-124">However, the value of the JavaScript variable is still set to 'Contoso'.</span></span> <span data-ttu-id="d293a-125">En outre, lorsque plusieurs co-auteurs utilisent le même complément, chaque co-auteur possède sa propre copie de la variable, qui n’est pas synchronisée.</span><span class="sxs-lookup"><span data-stu-id="d293a-125">Furthermore, when multiple coauthors use the same add-in, each coauthor has their own copy of the variable, which is not synchronized.</span></span> <span data-ttu-id="d293a-126">Lorsque vous utilisez des variables qui utilisent le contenu du classeur, veillez à bien rechercher les valeurs mises à jour dans le classeur avant d’utiliser la variable.</span><span class="sxs-lookup"><span data-stu-id="d293a-126">When you use variables that use workbook content, be sure you check for updated values in the workbook before you use the variable.</span></span> 

## <a name="use-events-to-manage-the-in-memory-state-of-your-add-in"></a><span data-ttu-id="d293a-127">Utiliser des événements pour gérer l’état de la mémoire de votre complément</span><span class="sxs-lookup"><span data-stu-id="d293a-127">Use events to manage the in-memory state of your add-in</span></span>
 
<span data-ttu-id="d293a-128">Les compléments Excel peuvent lire le contenu du classeur (à partir de feuilles de calcul masquées et d’un objet de paramètres), puis l’enregistrer dans des structures de données comme des variables.</span><span class="sxs-lookup"><span data-stu-id="d293a-128">Excel add-ins can read workbook content (from hidden worksheets and a setting object), and then store it in data structures such as variables.</span></span> <span data-ttu-id="d293a-129">Une fois que les valeurs d’origine sont copiées dans l’une de ces structures de données, les co-auteurs peuvent mettre à jour le contenu du classeur d’origine.</span><span class="sxs-lookup"><span data-stu-id="d293a-129">After the original values are copied into any of these data structures, coauthors can update the original workbook content.</span></span> <span data-ttu-id="d293a-130">Cela signifie que les valeurs copiées dans les structures de données ne sont plus synchronisées avec le contenu du classeur.</span><span class="sxs-lookup"><span data-stu-id="d293a-130">This means that the copied values in the data structures are now out of sync with the workbook content.</span></span> <span data-ttu-id="d293a-131">Lorsque vous générez vos compléments, pensez à prendre en compte cette séparation de contenu du classeur et les valeurs enregistrées dans les structures de données.</span><span class="sxs-lookup"><span data-stu-id="d293a-131">When you build your add-ins, be sure to account for this separation of workbook content and values stored in data structures.</span></span>

<span data-ttu-id="d293a-132">Par exemple, vous pouvez créer un complément de contenu qui affiche des visualisations personnalisées.</span><span class="sxs-lookup"><span data-stu-id="d293a-132">For example, you might build a content add-in that displays custom visualizations.</span></span> <span data-ttu-id="d293a-133">L’état de vos visualisations personnalisées peut être enregistré dans une feuille de calcul masquée.</span><span class="sxs-lookup"><span data-stu-id="d293a-133">The state of your custom visualizations might be saved in a hidden worksheet.</span></span> <span data-ttu-id="d293a-134">Lorsque les co-auteurs utilisent le même classeur, le scénario suivant peut se produire :</span><span class="sxs-lookup"><span data-stu-id="d293a-134">When coauthors use the same workbook, the following scenario can occur:</span></span>

- <span data-ttu-id="d293a-135">L’utilisateur A ouvre le document et les visualisations personnalisées sont affichées dans le classeur.</span><span class="sxs-lookup"><span data-stu-id="d293a-135">User A opens the document and the custom visualizations are shown in the workbook.</span></span> <span data-ttu-id="d293a-136">Les visualisations personnalisées lisent les données d’une feuille de calcul masquée (par exemple, la couleur des visualisations est définie sur bleu).</span><span class="sxs-lookup"><span data-stu-id="d293a-136">The custom visualizations read data from a hidden worksheet (for example, the color of the visualizations is set to blue).</span></span>
- <span data-ttu-id="d293a-137">L’utilisateur B ouvre le même document et commence à modifier les visualisations personnalisées.</span><span class="sxs-lookup"><span data-stu-id="d293a-137">User B opens the same document, and starts modifying the custom visualizations.</span></span> <span data-ttu-id="d293a-138">L’utilisateur B définit la couleur des visualisations personnalisées sur orange.</span><span class="sxs-lookup"><span data-stu-id="d293a-138">User B sets the color of the custom visualizations to orange.</span></span> <span data-ttu-id="d293a-139">La valeur Orange est enregistrée dans la feuille de calcul masquée.</span><span class="sxs-lookup"><span data-stu-id="d293a-139">Orange is saved to the hidden worksheet.</span></span>
- <span data-ttu-id="d293a-140">La feuille de calcul masquée de l’utilisateur A est mise à jour avec la nouvelle valeur Orange.</span><span class="sxs-lookup"><span data-stu-id="d293a-140">User A's hidden worksheet is updated with the new value of orange.</span></span>
- <span data-ttu-id="d293a-141">Les visualisations personnalisées de l’utilisateur A sont toujours bleues.</span><span class="sxs-lookup"><span data-stu-id="d293a-141">User A's custom visualizations are still blue.</span></span> 

<span data-ttu-id="d293a-142">Si vous souhaitez que les visualisations personnalisées de l’utilisateur A répondent aux modifications apportées par les co-auteurs sur la feuille de calcul masquée, utilisez l’événement [BindingDataChanged](https://docs.microsoft.com/javascript/api/office/office.bindingdatachangedeventargs?view=office-js).</span><span class="sxs-lookup"><span data-stu-id="d293a-142">If you want User A's custom visualizations to respond to changes made by coauthors on the hidden worksheet, use the [BindingDataChanged](https://docs.microsoft.com/javascript/api/office/office.bindingdatachangedeventargs?view=office-js) event.</span></span> <span data-ttu-id="d293a-143">Cela garantit que les modifications apportées au contenu du classeur par les co-auteurs sont répercutées à l’état de votre complément.</span><span class="sxs-lookup"><span data-stu-id="d293a-143">This ensures that changes to workbook content made by coauthors is reflected in the state of your add-in.</span></span>

## <a name="caveats-to-using-events-with-coauthoring"></a><span data-ttu-id="d293a-144">Restrictions à l’utilisation des événements dans le cadre de la co-création</span><span class="sxs-lookup"><span data-stu-id="d293a-144">Caveats to using events with coauthoring</span></span> 

<span data-ttu-id="d293a-145">Comme indiqué précédemment, dans certains scénarios, le déclenchement d’événements pour tous les co-auteurs permet d’améliorer l’expérience utilisateur.</span><span class="sxs-lookup"><span data-stu-id="d293a-145">As described earlier, in some scenarios, triggering events for all coauthors provides an improved user experience.</span></span> <span data-ttu-id="d293a-146">Toutefois, sachez que, dans certains scénarios, ce comportement peut entraîner des expériences utilisateur médiocres.</span><span class="sxs-lookup"><span data-stu-id="d293a-146">However, be aware that in some scenarios this behavior can produce poor user experiences.</span></span> 

<span data-ttu-id="d293a-147">Par exemple, dans les scénarios de validation de données, il est fréquent d’afficher l’interface utilisateur en réponse aux événements.</span><span class="sxs-lookup"><span data-stu-id="d293a-147">For example, in data validation scenarios, it is common to display UI in response to events.</span></span> <span data-ttu-id="d293a-148">L’événement [BindingDataChanged](https://docs.microsoft.com/javascript/api/office/office.bindingdatachangedeventargs?view=office-js) décrit dans la section précédente s’exécute lorsqu’un utilisateur local ou un co-auteur modifie (à distance) le contenu du classeur dans la liaison.</span><span class="sxs-lookup"><span data-stu-id="d293a-148">The [BindingDataChanged](https://docs.microsoft.com/javascript/api/office/office.bindingdatachangedeventargs?view=office-js) event described in the previous section runs when either a local user or coauthor (remote) changes the workbook content within the binding.</span></span> <span data-ttu-id="d293a-149">Si le gestionnaire d’événements de l’événement **BindingDataChanged** affiche l’interface utilisateur, les utilisateurs verront une interface utilisateur qui n’est pas liée aux modifications sur lesquelles ils travaillaient dans le classeur, entraînant ainsi une expérience utilisateur médiocre.</span><span class="sxs-lookup"><span data-stu-id="d293a-149">If the event handler of the **BindingDataChanged** event displays UI, users will see UI that is unrelated to changes they were working on in the workbook, leading to a poor user experience.</span></span> <span data-ttu-id="d293a-150">Évitez d’afficher l’interface utilisateur lorsque vous utilisez des événements dans votre complément.</span><span class="sxs-lookup"><span data-stu-id="d293a-150">Avoid displaying UI when using events in your add-in.</span></span>

## <a name="see-also"></a><span data-ttu-id="d293a-151">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="d293a-151">See also</span></span> 

- [<span data-ttu-id="d293a-152">À propos de la co-création dans Excel (VBA)</span><span class="sxs-lookup"><span data-stu-id="d293a-152">About coauthoring in Excel (VBA)</span></span>](https://docs.microsoft.com/office/vba/excel/concepts/about-coauthoring-in-excel) 
- [<span data-ttu-id="d293a-153">Impact de l’enregistrement automatique sur les compléments et les macros (VBA)</span><span class="sxs-lookup"><span data-stu-id="d293a-153">How AutoSave impacts add-ins and macros (VBA)</span></span>](https://docs.microsoft.com/office/vba/library-reference/concepts/how-autosave-impacts-addins-and-macros) 
