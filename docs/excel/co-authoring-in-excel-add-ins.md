---
title: Co-création dans des macros complémentaires Excel
description: Apprenez à co-auteur d’un classeur Excel stocké dans OneDrive, OneDrive entreprise ou SharePoint Online.
ms.date: 06/20/2019
localization_priority: Normal
ms.openlocfilehash: 4414bf64f05c29328c63d0857a6e498495712ff1
ms.sourcegitcommit: 7ef14753dce598a5804dad8802df7aaafe046da7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/10/2020
ms.locfileid: "45093475"
---
# <a name="coauthoring-in-excel-add-ins"></a><span data-ttu-id="f396f-103">Co-création dans des macros complémentaires Excel</span><span class="sxs-lookup"><span data-stu-id="f396f-103">Coauthoring in Excel add-ins</span></span>  

<span data-ttu-id="f396f-104">With [coauthoring](https://support.office.com/article/Collaborate-on-Excel-workbooks-at-the-same-time-with-co-authoring-7152aa8b-b791-414c-a3bb-3024e46fb104), multiple people can work together and edit the same Excel workbook simultaneously.</span><span class="sxs-lookup"><span data-stu-id="f396f-104">With [coauthoring](https://support.office.com/article/Collaborate-on-Excel-workbooks-at-the-same-time-with-co-authoring-7152aa8b-b791-414c-a3bb-3024e46fb104), multiple people can work together and edit the same Excel workbook simultaneously.</span></span> <span data-ttu-id="f396f-105">All coauthors of a workbook can see another coauthor's changes as soon as that coauthor saves the workbook.</span><span class="sxs-lookup"><span data-stu-id="f396f-105">All coauthors of a workbook can see another coauthor's changes as soon as that coauthor saves the workbook.</span></span> <span data-ttu-id="f396f-106">To coauthor an Excel workbook, the workbook must be stored in OneDrive, OneDrive for Business, or SharePoint Online.</span><span class="sxs-lookup"><span data-stu-id="f396f-106">To coauthor an Excel workbook, the workbook must be stored in OneDrive, OneDrive for Business, or SharePoint Online.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="f396f-107">Dans Excel pour Microsoft 365, vous remarquerez l’enregistrement automatique dans le coin supérieur gauche.</span><span class="sxs-lookup"><span data-stu-id="f396f-107">In Excel for Microsoft 365, you will notice AutoSave in the upper-left corner.</span></span> <span data-ttu-id="f396f-108">Lorsque l’enregistrement automatique est activé, les co-auteurs visualisent vos modifications en temps réel.</span><span class="sxs-lookup"><span data-stu-id="f396f-108">When AutoSave is turned on, coauthors see your changes in real time.</span></span> <span data-ttu-id="f396f-109">Prenez en considération l’impact de ce comportement sur la conception de votre complément Excel.</span><span class="sxs-lookup"><span data-stu-id="f396f-109">Consider the impact of this behavior on the design of your Excel add-in.</span></span> <span data-ttu-id="f396f-110">Les utilisateurs peuvent désactiver l’enregistrement automatique via le commutateur dans le coin supérieur gauche de la fenêtre Excel.</span><span class="sxs-lookup"><span data-stu-id="f396f-110">Users can turn off AutoSave via the switch in the upper left of the Excel window.</span></span>

## <a name="coauthoring-overview"></a><span data-ttu-id="f396f-111">Vue d’ensemble de la co-création</span><span class="sxs-lookup"><span data-stu-id="f396f-111">Coauthoring overview</span></span>

<span data-ttu-id="f396f-112">Lorsque vous modifiez le contenu d’un classeur, Excel synchronise automatiquement ces modifications avec tous les co-auteurs.</span><span class="sxs-lookup"><span data-stu-id="f396f-112">When you change a workbook's content, Excel automatically synchronizes those changes across all coauthors.</span></span> <span data-ttu-id="f396f-113">Les co-auteurs peuvent modifier le contenu d’un classeur, mais peuvent également exécuter du code dans un complément Excel.</span><span class="sxs-lookup"><span data-stu-id="f396f-113">Coauthors can change the content of a workbook, but so can code running within an Excel add-in.</span></span> <span data-ttu-id="f396f-114">Par exemple, lorsque le code JavaScript suivant s’exécute dans un complément Office, la valeur de la plage est définie sur Contoso:</span><span class="sxs-lookup"><span data-stu-id="f396f-114">For example, when the following JavaScript code runs in an Office Add-in, the value of a range is set to Contoso:</span></span>

```js
range.values = [['Contoso']];
```
<span data-ttu-id="f396f-115">Après la synchronisation de « Contoso » avec tous les co-auteurs, tout utilisateur ou complément en cours d’exécution dans le même classeur visualisera la nouvelle valeur de la plage.</span><span class="sxs-lookup"><span data-stu-id="f396f-115">After 'Contoso' synchronizes across all coauthors, any user or add-in running in the same workbook will see the new value of the range.</span></span>

<span data-ttu-id="f396f-116">Coauthoring only synchronizes the content within the shared workbook.</span><span class="sxs-lookup"><span data-stu-id="f396f-116">Coauthoring only synchronizes the content within the shared workbook.</span></span> <span data-ttu-id="f396f-117">Values copied from the workbook to JavaScript variables in an Excel add-in are not synchronized.</span><span class="sxs-lookup"><span data-stu-id="f396f-117">Values copied from the workbook to JavaScript variables in an Excel add-in are not synchronized.</span></span> <span data-ttu-id="f396f-118">For example, if your add-in stores the value of a cell (such as 'Contoso') in a JavaScript variable, and then a coauthor changes the value of the cell to 'Example', after synchronization all coauthors see 'Example' in the cell.</span><span class="sxs-lookup"><span data-stu-id="f396f-118">For example, if your add-in stores the value of a cell (such as 'Contoso') in a JavaScript variable, and then a coauthor changes the value of the cell to 'Example', after synchronization all coauthors see 'Example' in the cell.</span></span> <span data-ttu-id="f396f-119">However, the value of the JavaScript variable is still set to 'Contoso'.</span><span class="sxs-lookup"><span data-stu-id="f396f-119">However, the value of the JavaScript variable is still set to 'Contoso'.</span></span> <span data-ttu-id="f396f-120">Furthermore, when multiple coauthors use the same add-in, each coauthor has their own copy of the variable, which is not synchronized.</span><span class="sxs-lookup"><span data-stu-id="f396f-120">Furthermore, when multiple coauthors use the same add-in, each coauthor has their own copy of the variable, which is not synchronized.</span></span> <span data-ttu-id="f396f-121">When you use variables that use workbook content, be sure you check for updated values in the workbook before you use the variable.</span><span class="sxs-lookup"><span data-stu-id="f396f-121">When you use variables that use workbook content, be sure you check for updated values in the workbook before you use the variable.</span></span>

## <a name="use-events-to-manage-the-in-memory-state-of-your-add-in"></a><span data-ttu-id="f396f-122">Utiliser des événements pour gérer l’état de la mémoire de votre complément</span><span class="sxs-lookup"><span data-stu-id="f396f-122">Use events to manage the in-memory state of your add-in</span></span>

<span data-ttu-id="f396f-123">Excel add-ins can read workbook content (from hidden worksheets and a setting object), and then store it in data structures such as variables.</span><span class="sxs-lookup"><span data-stu-id="f396f-123">Excel add-ins can read workbook content (from hidden worksheets and a setting object), and then store it in data structures such as variables.</span></span> <span data-ttu-id="f396f-124">After the original values are copied into any of these data structures, coauthors can update the original workbook content.</span><span class="sxs-lookup"><span data-stu-id="f396f-124">After the original values are copied into any of these data structures, coauthors can update the original workbook content.</span></span> <span data-ttu-id="f396f-125">This means that the copied values in the data structures are now out of sync with the workbook content.</span><span class="sxs-lookup"><span data-stu-id="f396f-125">This means that the copied values in the data structures are now out of sync with the workbook content.</span></span> <span data-ttu-id="f396f-126">When you build your add-ins, be sure to account for this separation of workbook content and values stored in data structures.</span><span class="sxs-lookup"><span data-stu-id="f396f-126">When you build your add-ins, be sure to account for this separation of workbook content and values stored in data structures.</span></span>

<span data-ttu-id="f396f-127">For example, you might build a content add-in that displays custom visualizations.</span><span class="sxs-lookup"><span data-stu-id="f396f-127">For example, you might build a content add-in that displays custom visualizations.</span></span> <span data-ttu-id="f396f-128">The state of your custom visualizations might be saved in a hidden worksheet.</span><span class="sxs-lookup"><span data-stu-id="f396f-128">The state of your custom visualizations might be saved in a hidden worksheet.</span></span> <span data-ttu-id="f396f-129">When coauthors use the same workbook, the following scenario can occur:</span><span class="sxs-lookup"><span data-stu-id="f396f-129">When coauthors use the same workbook, the following scenario can occur:</span></span>

- <span data-ttu-id="f396f-130">User A opens the document and the custom visualizations are shown in the workbook.</span><span class="sxs-lookup"><span data-stu-id="f396f-130">User A opens the document and the custom visualizations are shown in the workbook.</span></span> <span data-ttu-id="f396f-131">The custom visualizations read data from a hidden worksheet (for example, the color of the visualizations is set to blue).</span><span class="sxs-lookup"><span data-stu-id="f396f-131">The custom visualizations read data from a hidden worksheet (for example, the color of the visualizations is set to blue).</span></span>
- <span data-ttu-id="f396f-132">User B opens the same document, and starts modifying the custom visualizations.</span><span class="sxs-lookup"><span data-stu-id="f396f-132">User B opens the same document, and starts modifying the custom visualizations.</span></span> <span data-ttu-id="f396f-133">User B sets the color of the custom visualizations to orange.</span><span class="sxs-lookup"><span data-stu-id="f396f-133">User B sets the color of the custom visualizations to orange.</span></span> <span data-ttu-id="f396f-134">Orange is saved to the hidden worksheet.</span><span class="sxs-lookup"><span data-stu-id="f396f-134">Orange is saved to the hidden worksheet.</span></span>
- <span data-ttu-id="f396f-135">La feuille de calcul masquée de l’utilisateur A est mise à jour avec la nouvelle valeur Orange.</span><span class="sxs-lookup"><span data-stu-id="f396f-135">User A's hidden worksheet is updated with the new value of orange.</span></span>
- <span data-ttu-id="f396f-136">Les visualisations personnalisées de l’utilisateur A sont toujours bleues.</span><span class="sxs-lookup"><span data-stu-id="f396f-136">User A's custom visualizations are still blue.</span></span>

<span data-ttu-id="f396f-137">If you want User A's custom visualizations to respond to changes made by coauthors on the hidden worksheet, use the [BindingDataChanged](/javascript/api/office/office.bindingdatachangedeventargs) event.</span><span class="sxs-lookup"><span data-stu-id="f396f-137">If you want User A's custom visualizations to respond to changes made by coauthors on the hidden worksheet, use the [BindingDataChanged](/javascript/api/office/office.bindingdatachangedeventargs) event.</span></span> <span data-ttu-id="f396f-138">This ensures that changes to workbook content made by coauthors is reflected in the state of your add-in.</span><span class="sxs-lookup"><span data-stu-id="f396f-138">This ensures that changes to workbook content made by coauthors is reflected in the state of your add-in.</span></span>

## <a name="caveats-to-using-events-with-coauthoring"></a><span data-ttu-id="f396f-139">Restrictions à l’utilisation des événements dans le cadre de la co-création</span><span class="sxs-lookup"><span data-stu-id="f396f-139">Caveats to using events with coauthoring</span></span>

<span data-ttu-id="f396f-140">As described earlier, in some scenarios, triggering events for all coauthors provides an improved user experience.</span><span class="sxs-lookup"><span data-stu-id="f396f-140">As described earlier, in some scenarios, triggering events for all coauthors provides an improved user experience.</span></span> <span data-ttu-id="f396f-141">However, be aware that in some scenarios this behavior can produce poor user experiences.</span><span class="sxs-lookup"><span data-stu-id="f396f-141">However, be aware that in some scenarios this behavior can produce poor user experiences.</span></span> 

<span data-ttu-id="f396f-142">Par exemple, dans les scénarios de validation de données, il est fréquent d’afficher l’interface utilisateur en réponse aux événements.</span><span class="sxs-lookup"><span data-stu-id="f396f-142">For example, in data validation scenarios, it is common to display UI in response to events.</span></span> <span data-ttu-id="f396f-143">L’événement [BindingDataChanged](/javascript/api/office/office.bindingdatachangedeventargs) décrit dans la section précédente s’exécute lorsqu’un utilisateur local ou un co-auteur modifie (à distance) le contenu du classeur dans la liaison.</span><span class="sxs-lookup"><span data-stu-id="f396f-143">The [BindingDataChanged](/javascript/api/office/office.bindingdatachangedeventargs) event described in the previous section runs when either a local user or coauthor (remote) changes the workbook content within the binding.</span></span> <span data-ttu-id="f396f-144">Si le gestionnaire d’événements de l' `BindingDataChanged` événement affiche l’interface utilisateur, les utilisateurs voient l’interface utilisateur qui n’est pas liée aux modifications sur lesquelles ils travaillaient dans le classeur, ce qui entraîne une expérience utilisateur médiocre.</span><span class="sxs-lookup"><span data-stu-id="f396f-144">If the event handler of the `BindingDataChanged` event displays UI, users will see UI that is unrelated to changes they were working on in the workbook, leading to a poor user experience.</span></span> <span data-ttu-id="f396f-145">Évitez d’afficher l’interface utilisateur lorsque vous utilisez des événements dans votre complément.</span><span class="sxs-lookup"><span data-stu-id="f396f-145">Avoid displaying UI when using events in your add-in.</span></span>

## <a name="see-also"></a><span data-ttu-id="f396f-146">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="f396f-146">See also</span></span>

- [<span data-ttu-id="f396f-147">À propos de la co-création dans Excel (VBA)</span><span class="sxs-lookup"><span data-stu-id="f396f-147">About coauthoring in Excel (VBA)</span></span>](/office/vba/excel/concepts/about-coauthoring-in-excel)
- [<span data-ttu-id="f396f-148">Impact de l’enregistrement automatique sur les compléments et les macros (VBA)</span><span class="sxs-lookup"><span data-stu-id="f396f-148">How AutoSave impacts add-ins and macros (VBA)</span></span>](/office/vba/library-reference/concepts/how-autosave-impacts-addins-and-macros)
