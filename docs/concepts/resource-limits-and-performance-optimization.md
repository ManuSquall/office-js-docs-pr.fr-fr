---
title: Limites des ressources et optimisation des performances pour les compléments Office
description: Découvrez les limites de ressources de la plateforme de complément Office, y compris le processeur et la mémoire.
ms.date: 07/29/2020
localization_priority: Normal
ms.openlocfilehash: 8c64e5a836d6b998ccd7022e71f595bb331bba8c
ms.sourcegitcommit: 9609bd5b4982cdaa2ea7637709a78a45835ffb19
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/28/2020
ms.locfileid: "47293330"
---
# <a name="resource-limits-and-performance-optimization-for-office-add-ins"></a><span data-ttu-id="b782c-103">Limites des ressources et optimisation des performances pour les compléments Office</span><span class="sxs-lookup"><span data-stu-id="b782c-103">Resource limits and performance optimization for Office Add-ins</span></span>

<span data-ttu-id="b782c-p101">Afin d’offrir la meilleure expérience utilisateur, assurez-vous que votre complément Office fonctionne dans les limites prévues en matière d’utilisation du cœur du processeur et de la mémoire, ainsi qu’en matière de fiabilité et, pour les compléments Outlook, de temps de réponse lors de l’évaluation des expressions régulières. Ces limites propres à l’utilisation des ressources d’exécution s’appliquent aux compléments exécutés sur des clients Office sous Windows et OS X mais pas sur des applications mobiles, ni dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="b782c-p101">To create the best experience for your users, ensure that your Office Add-in performs within specific limits for CPU core and memory usage, reliability, and, for Outlook add-ins, the response time for evaluating regular expressions. These run-time resource usage limits apply to add-ins running in Office clients on Windows and OS X, but not on mobile apps or in a browser.</span></span>

<span data-ttu-id="b782c-106">Par ailleurs, cette rubrique suggère des techniques de conception et d’implémentation de complément qui permettent de mieux contrôler les performances des compléments sur ordinateurs de bureau et périphériques mobiles.</span><span class="sxs-lookup"><span data-stu-id="b782c-106">You can also optimize the performance of your add-ins on desktop and mobile devices by optimizing the use of resources in your add-in design and implementation.</span></span>

## <a name="resource-usage-limits-for-add-ins"></a><span data-ttu-id="b782c-107">Limites d’utilisation des ressources pour les compléments</span><span class="sxs-lookup"><span data-stu-id="b782c-107">Resource usage limits for add-ins</span></span>

<span data-ttu-id="b782c-108">Les limites d’utilisation des ressources d’exécution s’appliquent à tous les types de compléments Office. Ces limites contribuent à garantir les performances pour vos utilisateurs et à limiter les attaques par déni de service.</span><span class="sxs-lookup"><span data-stu-id="b782c-108">Run-time resource usage limits apply to all types of Office Add-ins. These limits help ensure performance for your users and mitigate denial-of-service attacks.</span></span> <span data-ttu-id="b782c-109">Veillez à tester votre complément Office sur votre application Office cible à l’aide d’une plage de données possibles et mesurer ses performances par rapport aux limites d’utilisation au moment de l’exécution suivantes :</span><span class="sxs-lookup"><span data-stu-id="b782c-109">Be sure to test your Office Add-in on your target Office application by using a range of possible data, and measure its performance against the following run-time usage limits:</span></span>

- <span data-ttu-id="b782c-110">**Utilisation du cœur du processeur** - Seuil d’utilisation d’un seul cœur de processeur de 90 %, observé à trois reprises dans des intervalles par défaut de 5 secondes.</span><span class="sxs-lookup"><span data-stu-id="b782c-110">**CPU core usage** - A single CPU core usage threshold of 90%, observed three times in default 5-second intervals.</span></span>

   <span data-ttu-id="b782c-111">L’intervalle par défaut d’un client Office pour vérifier l’utilisation de l’UC est toutes les 5 secondes.</span><span class="sxs-lookup"><span data-stu-id="b782c-111">The default interval for an Office client to check CPU core usage is every 5 seconds.</span></span> <span data-ttu-id="b782c-112">Si le client Office détecte que l’utilisation de l’UC d’un complément est supérieure à la valeur de seuil, il affiche un message qui demande à l’utilisateur s’il souhaite continuer à exécuter le complément.</span><span class="sxs-lookup"><span data-stu-id="b782c-112">If the Office client detects the CPU core usage of an add-in is above the threshold value, it displays a message asking if the user wants to continue running the add-in.</span></span> <span data-ttu-id="b782c-113">Si l’utilisateur choisit de continuer, le client Office ne demande pas de nouveau à l’utilisateur pendant la session de modification.</span><span class="sxs-lookup"><span data-stu-id="b782c-113">If the user chooses to continue, the Office client does not ask the user again during that edit session.</span></span> <span data-ttu-id="b782c-114">Les administrateurs peuvent souhaiter utiliser la clé de registre **AlertInterval** pour augmenter le seuil et réduire l’affichage de ce message d’avertissement si les utilisateurs exécutent des compléments faisant appel au processeur de manière intensive.</span><span class="sxs-lookup"><span data-stu-id="b782c-114">Administrators might want to use the **AlertInterval** registry key to raise the threshold to reduce the display of this warning message if users run CPU-intensive add-ins.</span></span>

- <span data-ttu-id="b782c-115">**Utilisation de la mémoire** - Seuil d’utilisation de mémoire par défaut, qui est déterminé de manière dynamique en fonction de la mémoire physique disponible de l’appareil.</span><span class="sxs-lookup"><span data-stu-id="b782c-115">**Memory usage** - A default memory usage threshold that is dynamically determined based on the available physical memory of the device.</span></span>

   <span data-ttu-id="b782c-116">Par défaut, lorsqu’un client Office détecte que l’utilisation de la mémoire physique sur un appareil dépasse 80% de la mémoire disponible, le client commence à surveiller l’utilisation de la mémoire du complément, au niveau du document pour les compléments de contenu et du volet Office, et au niveau de la boîte aux lettres pour les compléments Outlook. À un intervalle de 5 secondes par défaut, le client avertit l’utilisateur si l’utilisation de la mémoire physique pour un ensemble de compléments au niveau du document ou de la boîte aux lettres dépasse 50%.</span><span class="sxs-lookup"><span data-stu-id="b782c-116">By default, when a Office client detects that physical memory usage on a device exceeds 80% of the available memory, the client starts monitoring the add-in's memory usage, at a document level for content and task pane add-ins, and at a mailbox level for Outlook add-ins. At a default interval of 5 seconds, the client warns the user if physical memory usage for a set of add-ins at the document or mailbox level exceeds 50%.</span></span> <span data-ttu-id="b782c-117">Cette limite d’utilisation de la mémoire est basée sur la mémoire physique plutôt que sur la mémoire virtuelle afin de garantir de bonnes performances sur les appareils disposant d’une mémoire vive (RAM) limitée, par exemple les tablettes.</span><span class="sxs-lookup"><span data-stu-id="b782c-117">This memory usage limit uses physical rather than virtual memory to ensure performance on devices with limited RAM, such as tablets.</span></span> <span data-ttu-id="b782c-118">Les administrateurs peuvent remplacer ce paramètre dynamique par une limite explicite à l’aide de la clé de Registre Windows **MemoryAlertThreshold** en tant que paramètre global, IR régler l’intervalle d’alerte en utilisant la clé **AlertInterval** comme paramètre global.</span><span class="sxs-lookup"><span data-stu-id="b782c-118">Administrators can override this dynamic setting with an explicit limit by using the **MemoryAlertThreshold** Windows registry key as a global setting, ir adjust the alert interval by using the **AlertInterval** key as a global setting.</span></span>

- <span data-ttu-id="b782c-119">**Tolérance d’incident** - Limite par défaut de 4 incidents pour un complément.</span><span class="sxs-lookup"><span data-stu-id="b782c-119">**Crash tolerance** - A default limit of four crashes for an add-in.</span></span>

   <span data-ttu-id="b782c-120">Les administrateurs peuvent ajuster le seuil relatif aux incidents en utilisant la clé de registre **RestartManagerRetryLimit**.</span><span class="sxs-lookup"><span data-stu-id="b782c-120">Administrators can adjust the threshold for crashes by using the **RestartManagerRetryLimit** registry key.</span></span>

- <span data-ttu-id="b782c-121">**Blocage d’application** - Limitation à 5 secondes du seuil de blocage prolongé d’un complément.</span><span class="sxs-lookup"><span data-stu-id="b782c-121">**Application blocking** - Prolonged unresponsiveness threshold of 5 seconds for an add-in.</span></span>

   <span data-ttu-id="b782c-122">Cela a une incidence sur les expériences utilisateur du complément et de l’application Office.</span><span class="sxs-lookup"><span data-stu-id="b782c-122">This affects the user's experiences of the add-in and the Office application.</span></span> <span data-ttu-id="b782c-123">Lorsque cela se produit, l’application Office redémarre automatiquement tous les compléments actifs pour un document ou une boîte aux lettres (le cas échéant), et avertit l’utilisateur de l’absence de réponse du complément.</span><span class="sxs-lookup"><span data-stu-id="b782c-123">When this occurs, the Office application automatically restarts all the active add-ins for a document or mailbox (where applicable), and warns the user as to which add-in became unresponsive.</span></span> <span data-ttu-id="b782c-124">Les compléments peuvent atteindre ce seuil lorsqu’ils ne cèdent pas régulièrement le traitement lors de l’exécution de tâches longues.</span><span class="sxs-lookup"><span data-stu-id="b782c-124">Add-ins can reach this threshold when they do not regularly yield processing while performing long-running tasks.</span></span> <span data-ttu-id="b782c-125">Il existe des techniques permettant de garantir qu’aucun blocage ne se produira.</span><span class="sxs-lookup"><span data-stu-id="b782c-125">There are techniques to ensure that blocking does not occur.</span></span> <span data-ttu-id="b782c-126">Les administrateurs ne peuvent pas remplacer ce seuil.</span><span class="sxs-lookup"><span data-stu-id="b782c-126">Administrators cannot override this threshold.</span></span>

### <a name="outlook-add-ins"></a><span data-ttu-id="b782c-127">Compléments Outlook</span><span class="sxs-lookup"><span data-stu-id="b782c-127">Outlook add-ins</span></span>

<span data-ttu-id="b782c-p106">§LTA Si un complément Outlook dépasse les seuils précédents en matière d’utilisation du cœur du processeur ou de la mémoire, ou en matière de tolérance d’incident, Outlook désactive le complément. Le Centre d’administration Exchange indique que l’état de l’application est désactivé.</span><span class="sxs-lookup"><span data-stu-id="b782c-p106">If any Outlook add-in exceeds the preceding thresholds for CPU core or memory usage, or tolerance limit for crashes, Outlook disables the add-in. The Exchange Admin Center displays the disabled status of the app.</span></span>

> [!NOTE]
> <span data-ttu-id="b782c-130">Même si seuls les clients enrichis Outlook et non les clients non-Outlook sur le web ou les appareils mobiles contrôlent l’utilisation des ressources, si un client enrichi désactive un complément Outlook, ce complément est également désactivé pour une utilisation dans Outlook sur le web et les appareils mobiles.</span><span class="sxs-lookup"><span data-stu-id="b782c-130">Even though only the Outlook rich clients and not Outlook on the web or mobile devices monitor resource usage, if a rich client disables an Outlook add-in, that add-in is also disabled for use in Outlook on the web and mobile devices.</span></span>

<span data-ttu-id="b782c-131">En plus du cœur du processeur, de la mémoire et des règles de fiabilité, les compléments Outlook doivent respecter les règles suivantes lors de l’activation :</span><span class="sxs-lookup"><span data-stu-id="b782c-131">In addition to the CPU core, memory, and reliability rules, Outlook add-ins should observe the following rules on activation:</span></span>

- <span data-ttu-id="b782c-p107">**Temps de réponse des expressions régulières** - Seuil par défaut de 1 000 millisecondes pour Outlook afin d’évaluer toutes les expressions régulières contenues dans le manifeste d’un complément Outlook. Le dépassement du seuil oblige Outlook à retenter l’évaluation un peu plus tard.</span><span class="sxs-lookup"><span data-stu-id="b782c-p107">**Regular expressions response time** - A default threshold of 1,000 milliseconds for Outlook to evaluate all regular expressions in the manifest of an Outlook add-in. Exceeding the threshold causes Outlook to retry evaluation at a later time.</span></span>

    <span data-ttu-id="b782c-134">À l’aide d’une stratégie de groupe ou d’un paramètre spécifique de l’application dans le Registre Windows, les administrateurs peuvent ajuster cette valeur seuil par défaut de 1 000 millisecondes dans le paramètre **OutlookActivationAlertThreshold**.</span><span class="sxs-lookup"><span data-stu-id="b782c-134">Using a group policy or application-specific setting in the Windows registry, administrators can adjust this default threshold value of 1,000 milliseconds in the **OutlookActivationAlertThreshold** setting.</span></span>

- <span data-ttu-id="b782c-135">**Réévaluation des expressions régulières** -une limite par défaut de trois fois pour qu’Outlook réévalue toutes les expressions régulières dans un manifeste.</span><span class="sxs-lookup"><span data-stu-id="b782c-135">**Regular expressions re-evaluation** - A default limit of three times for Outlook to reevaluate all the regular expressions in a manifest.</span></span> <span data-ttu-id="b782c-136">Si l’évaluation échoue toutes les trois fois en dépassant le seuil applicable (soit la valeur par défaut de 1 000 millisecondes, soit une valeur spécifiée par **OutlookActivationAlertThreshold**, si ce paramètre existe dans le Registre Windows), Outlook désactive le complément Outlook.</span><span class="sxs-lookup"><span data-stu-id="b782c-136">If evaluation fails all three times by exceeding the applicable threshold (which is either the default of 1,000 milliseconds or a value specified by **OutlookActivationAlertThreshold**, if that setting exists in the Windows registry), Outlook disables the Outlook add-in.</span></span> <span data-ttu-id="b782c-137">Le centre d’administration Exchange affiche l’état désactivé et le complément est désactivé pour une utilisation dans les clients riches Outlook, et Outlook sur le Web et les appareils mobiles.</span><span class="sxs-lookup"><span data-stu-id="b782c-137">The Exchange Admin Center displays the disabled status, and the add-in is disabled for use in the Outlook rich clients, and Outlook on the web and mobile devices.</span></span>

    <span data-ttu-id="b782c-138">À l’aide d’une stratégie de groupe ou d’un paramètre spécifique de l’application dans le Registre Windows, les administrateurs peuvent ajuster ce nombre de tentatives d’évaluation dans le paramètre **OutlookActivationManagerRetryLimit**.</span><span class="sxs-lookup"><span data-stu-id="b782c-138">Using a group policy or application-specific setting in the Windows registry, administrators can adjust this number of times to retry evaluation in the **OutlookActivationManagerRetryLimit** setting.</span></span>

### <a name="excel-add-ins"></a><span data-ttu-id="b782c-139">Compléments Excel</span><span class="sxs-lookup"><span data-stu-id="b782c-139">Excel add-ins</span></span>

<span data-ttu-id="b782c-140">Si vous créez un complément Excel, tenez compte des limitations de taille suivantes lors de l’interaction avec le classeur :</span><span class="sxs-lookup"><span data-stu-id="b782c-140">If you're building an Excel add-in, be aware of the following size limitations when interacting with the workbook:</span></span>

- <span data-ttu-id="b782c-141">Excel sur le web a une limite de taille de charge utile de 5 Mo pour les demandes et les réponses.</span><span class="sxs-lookup"><span data-stu-id="b782c-141">Excel on the web has a payload size limit for requests and responses of 5MB.</span></span> <span data-ttu-id="b782c-142">L’erreur `RichAPI.Error` est déclenchée en cas de dépassement de cette limite.</span><span class="sxs-lookup"><span data-stu-id="b782c-142">`RichAPI.Error` will be thrown if that limit is exceeded.</span></span>
- <span data-ttu-id="b782c-143">Une plage est limitée à 5 millions cellules pour les opérations Get.</span><span class="sxs-lookup"><span data-stu-id="b782c-143">A range is limited to five million cells for get operations.</span></span>

<span data-ttu-id="b782c-144">Si vous prévoyez que l’entrée de l’utilisateur dépasse ces limites, veillez à vérifier les données avant d’appeler `context.sync()` .</span><span class="sxs-lookup"><span data-stu-id="b782c-144">If you expect user input to exceed these limits, be sure to check the data before calling `context.sync()`.</span></span> <span data-ttu-id="b782c-145">Fractionnez l’opération en plusieurs parties si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="b782c-145">Split the operation into smaller pieces as needed.</span></span> <span data-ttu-id="b782c-146">Veillez à appeler `context.sync()` pour chaque sous-opération afin d’éviter que ces opérations soient regroupées par lots.</span><span class="sxs-lookup"><span data-stu-id="b782c-146">Be sure to call `context.sync()` for each sub-operation to avoid those operations getting batched together again.</span></span>

<span data-ttu-id="b782c-147">Ces limitations sont généralement dépassées par les grandes plages.</span><span class="sxs-lookup"><span data-stu-id="b782c-147">These limitations are typically exceeded by large ranges.</span></span> <span data-ttu-id="b782c-148">Votre complément peut utiliser [RangeAreas](/javascript/api/excel/excel.rangeareas) pour mettre à jour les cellules dans une plage plus grande de manière stratégique.</span><span class="sxs-lookup"><span data-stu-id="b782c-148">Your add-in might be able to use [RangeAreas](/javascript/api/excel/excel.rangeareas) to strategically update cells within a larger range.</span></span> <span data-ttu-id="b782c-149">Pour plus d’informations, consultez [travailler simultanément avec plusieurs plages dans des compléments Excel](../excel/excel-add-ins-multiple-ranges.md) .</span><span class="sxs-lookup"><span data-stu-id="b782c-149">See [Work with multiple ranges simultaneously in Excel add-ins](../excel/excel-add-ins-multiple-ranges.md) for more information.</span></span>

### <a name="task-pane-and-content-add-ins"></a><span data-ttu-id="b782c-150">Compléments de volet Office et de contenu</span><span class="sxs-lookup"><span data-stu-id="b782c-150">Task pane and content add-ins</span></span>

<span data-ttu-id="b782c-151">Si un complément de contenu ou de volet de tâches dépasse les seuils précédents sur le cœur de l’UC ou l’utilisation de la mémoire, ou la limite de tolérance pour les incidents, l’application Office correspondante affiche un avertissement pour l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="b782c-151">If any content or task pane add-in exceeds the preceding thresholds on CPU core or memory usage, or tolerance limit for crashes, the corresponding Office application displays a warning for the user.</span></span> <span data-ttu-id="b782c-152">À ce stade, l’utilisateur peut effectuer l’une des actions suivantes :</span><span class="sxs-lookup"><span data-stu-id="b782c-152">At this point, the user can do one of the following:</span></span>

- <span data-ttu-id="b782c-153">Redémarrer le complément.</span><span class="sxs-lookup"><span data-stu-id="b782c-153">Restart the add-in.</span></span>
- <span data-ttu-id="b782c-p113">Annuler les alertes supplémentaires de dépassement de seuil. Dans l’idéal, l’utilisateur devrait supprimer le complément du document. La poursuite de l’exécution du complément risquerait d’entraîner des problèmes supplémentaires au niveau des performances et de la stabilité.</span><span class="sxs-lookup"><span data-stu-id="b782c-p113">Cancel further alerts about exceeding that threshold. Ideally, the user should then delete the add-in from the document; continuing the add-in would risk further performance and stability issues.</span></span>  

## <a name="verifying-resource-usage-issues-in-the-telemetry-log"></a><span data-ttu-id="b782c-156">Vérification des problèmes d’utilisation des ressources dans le journal de télémétrie</span><span class="sxs-lookup"><span data-stu-id="b782c-156">Verifying resource usage issues in the Telemetry Log</span></span>

<span data-ttu-id="b782c-p114">Office propose un journal de télémétrie qui tient à jour un enregistrement de certains événements (chargement, ouverture, fermeture et erreurs) des solutions Office qui s’exécutent sur l’ordinateur local, notamment les problèmes d’utilisation des ressources dans une Complément Office. Si le journal de télémétrie est configuré, vous pouvez utiliser Excel pour l’ouvrir à partir de l’emplacement par défaut suivant sur votre disque local :</span><span class="sxs-lookup"><span data-stu-id="b782c-p114">Office provides a Telemetry Log that maintains a record of certain events (loading, opening, closing, and errors) of Office solutions running on the local computer, including resource usage issues in an Office Add-in. If you have the Telemetry Log set up, you can use Excel to open the Telemetry Log in the following default location on your local drive:</span></span>

`%Users%\<Current user>\AppData\Local\Microsoft\Office\15.0\Telemetry`

<span data-ttu-id="b782c-p115">Le journal de télémétrie comprend pour chaque événement suivi pour un complément, les date/heure de l’occurrence, l’ID d’événement, la gravité et une courte description de l’événement, le nom convivial et l’ID unique du complément, ainsi que l’application qui a enregistré l’événement. Vous pouvez actualiser le journal de télémétrie pour afficher les événements suivis. Le tableau suivant répertorie des exemples de compléments Outlook qui ont été suivis dans le journal de télémétrie.</span><span class="sxs-lookup"><span data-stu-id="b782c-p115">For each event that the Telemetry Log tracks for an add-in, there is a date/time of the occurrence, event ID, severity, and short descriptive title for the event, the friendly name and unique ID of the add-in, and the application that logged the event. You can refresh the Telemetry Log to see the current tracked events. The following table shows examples of Outlook add-ins that were tracked in the Telemetry log.</span></span>

|<span data-ttu-id="b782c-162">**Date/Heure**</span><span class="sxs-lookup"><span data-stu-id="b782c-162">**Date/Time**</span></span>|<span data-ttu-id="b782c-163">**ID d’évènement**</span><span class="sxs-lookup"><span data-stu-id="b782c-163">**Event ID**</span></span>|<span data-ttu-id="b782c-164">**Gravité**</span><span class="sxs-lookup"><span data-stu-id="b782c-164">**Severity**</span></span>|<span data-ttu-id="b782c-165">**Titre**</span><span class="sxs-lookup"><span data-stu-id="b782c-165">**Title**</span></span>|<span data-ttu-id="b782c-166">**Fichier**</span><span class="sxs-lookup"><span data-stu-id="b782c-166">**File**</span></span>|<span data-ttu-id="b782c-167">**ID**</span><span class="sxs-lookup"><span data-stu-id="b782c-167">**ID**</span></span>|<span data-ttu-id="b782c-168">**Application**</span><span class="sxs-lookup"><span data-stu-id="b782c-168">**Application**</span></span>|
|:-----|:-----|:-----|:-----|:-----|:-----|:-----|
|<span data-ttu-id="b782c-169">08/10/2012 17:57:10</span><span class="sxs-lookup"><span data-stu-id="b782c-169">10/8/2012 5:57:10 PM</span></span>|<span data-ttu-id="b782c-170">7 </span><span class="sxs-lookup"><span data-stu-id="b782c-170">7</span></span>||<span data-ttu-id="b782c-171">Le manifeste du complément a été correctement téléchargé</span><span class="sxs-lookup"><span data-stu-id="b782c-171">add-in manifest downloaded successfully</span></span>|<span data-ttu-id="b782c-172">Who’s Who</span><span class="sxs-lookup"><span data-stu-id="b782c-172">Who's Who</span></span>|<span data-ttu-id="b782c-173">69cc567c-6737-4c49-88dd-123334943a22</span><span class="sxs-lookup"><span data-stu-id="b782c-173">69cc567c-6737-4c49-88dd-123334943a22</span></span>|<span data-ttu-id="b782c-174">Outlook</span><span class="sxs-lookup"><span data-stu-id="b782c-174">Outlook</span></span>|
|<span data-ttu-id="b782c-175">08/10/2012 17:57:01</span><span class="sxs-lookup"><span data-stu-id="b782c-175">10/8/2012 5:57:01 PM</span></span>|<span data-ttu-id="b782c-176">7 </span><span class="sxs-lookup"><span data-stu-id="b782c-176">7</span></span>||<span data-ttu-id="b782c-177">Le manifeste du complément a été correctement téléchargé</span><span class="sxs-lookup"><span data-stu-id="b782c-177">add-in manifest downloaded successfully</span></span>|<span data-ttu-id="b782c-178">LinkedIn</span><span class="sxs-lookup"><span data-stu-id="b782c-178">LinkedIn</span></span>|<span data-ttu-id="b782c-179">333bf46d-7dad-4f2b-8cf4-c19ddc78b723</span><span class="sxs-lookup"><span data-stu-id="b782c-179">333bf46d-7dad-4f2b-8cf4-c19ddc78b723</span></span>|<span data-ttu-id="b782c-180">Outlook</span><span class="sxs-lookup"><span data-stu-id="b782c-180">Outlook</span></span>|

<span data-ttu-id="b782c-181">Le tableau suivant répertorie les événements que le journal de télémétrie suit pour les Compléments Office en général.</span><span class="sxs-lookup"><span data-stu-id="b782c-181">The following table lists the events that the Telemetry Log tracks for Office Add-ins in general.</span></span>

|<span data-ttu-id="b782c-182">**ID d’évènement**</span><span class="sxs-lookup"><span data-stu-id="b782c-182">**Event ID**</span></span>|<span data-ttu-id="b782c-183">**Titre**</span><span class="sxs-lookup"><span data-stu-id="b782c-183">**Title**</span></span>|<span data-ttu-id="b782c-184">**Gravité**</span><span class="sxs-lookup"><span data-stu-id="b782c-184">**Severity**</span></span>|<span data-ttu-id="b782c-185">**Description**</span><span class="sxs-lookup"><span data-stu-id="b782c-185">**Description**</span></span>|
|:-----|:-----|:-----|:-----|
|<span data-ttu-id="b782c-186">7 </span><span class="sxs-lookup"><span data-stu-id="b782c-186">7</span></span>|<span data-ttu-id="b782c-187">Le manifeste du complément a été correctement téléchargé</span><span class="sxs-lookup"><span data-stu-id="b782c-187">Add-in manifest downloaded successfully</span></span>||<span data-ttu-id="b782c-188">Le manifeste du complément Office a été chargé et lu avec succès par l’application Office.</span><span class="sxs-lookup"><span data-stu-id="b782c-188">The manifest of the Office Add-in was successfully loaded and read by the Office application.</span></span>|
|<span data-ttu-id="b782c-189">8 </span><span class="sxs-lookup"><span data-stu-id="b782c-189">8</span></span>|<span data-ttu-id="b782c-190">Échec du téléchargement du manifeste du complément</span><span class="sxs-lookup"><span data-stu-id="b782c-190">Add-in manifest did not download</span></span>|<span data-ttu-id="b782c-191">Critique</span><span class="sxs-lookup"><span data-stu-id="b782c-191">Critical</span></span>|<span data-ttu-id="b782c-192">L’application Office n’a pas pu charger le fichier manifeste pour le complément Office à partir du catalogue SharePoint, du catalogue d’entreprise ou de AppSource.</span><span class="sxs-lookup"><span data-stu-id="b782c-192">The Office application was unable to load the manifest file for the Office Add-in from the SharePoint catalog, corporate catalog, or AppSource.</span></span>|
|<span data-ttu-id="b782c-193">9 </span><span class="sxs-lookup"><span data-stu-id="b782c-193">9</span></span>|<span data-ttu-id="b782c-194">Impossible d’analyser le balisage du complément</span><span class="sxs-lookup"><span data-stu-id="b782c-194">Add-in markup could not be parsed</span></span>|<span data-ttu-id="b782c-195">Critique</span><span class="sxs-lookup"><span data-stu-id="b782c-195">Critical</span></span>|<span data-ttu-id="b782c-196">L’application Office a chargé le manifeste du complément Office, mais n’a pas pu lire le balisage HTML de l’application.</span><span class="sxs-lookup"><span data-stu-id="b782c-196">The Office application loaded the Office Add-in manifest, but could not read the HTML markup of the app.</span></span>|
|<span data-ttu-id="b782c-197">10 </span><span class="sxs-lookup"><span data-stu-id="b782c-197">10</span></span>|<span data-ttu-id="b782c-198">Le complément a trop sollicité le processeur</span><span class="sxs-lookup"><span data-stu-id="b782c-198">Add-in used too much CPU</span></span>|<span data-ttu-id="b782c-199">Critique</span><span class="sxs-lookup"><span data-stu-id="b782c-199">Critical</span></span>|<span data-ttu-id="b782c-200">L’Complément Office a utilisé plus de 90 % des ressources du processeur sur une période de temps définie.</span><span class="sxs-lookup"><span data-stu-id="b782c-200">The Office Add-in used more than 90% of the CPU resources over a finite period of time.</span></span>|
|<span data-ttu-id="b782c-201">15 </span><span class="sxs-lookup"><span data-stu-id="b782c-201">15</span></span>|<span data-ttu-id="b782c-202">Le complément a été désactivé en raison de l’expiration de la recherche de chaîne</span><span class="sxs-lookup"><span data-stu-id="b782c-202">Add-in disabled due to string search time-out</span></span>||<span data-ttu-id="b782c-p116">§LTA Les compléments Outlook recherchent la ligne d’objet et le corps du message d’un courrier électronique pour déterminer s’ils doivent être affichés avec une expression régulière. Le complément Outlook répertorié dans la colonne **Fichier** a été désactivé par Outlook, car il a expiré à plusieurs reprises lors d’une tentative de mise en correspondance d’une expression régulière.</span><span class="sxs-lookup"><span data-stu-id="b782c-p116">Outlook add-ins search the subject line and message of an e-mail to determine whether they should be displayed by using a regular expression. The Outlook add-in listed in the **File** column was disabled by Outlook because it timed out repeatedly while trying to match a regular expression.</span></span>|
|<span data-ttu-id="b782c-205">18 </span><span class="sxs-lookup"><span data-stu-id="b782c-205">18</span></span>|<span data-ttu-id="b782c-206">Le complément a été fermé</span><span class="sxs-lookup"><span data-stu-id="b782c-206">Add-in closed successfully</span></span>||<span data-ttu-id="b782c-207">L’application Office a pu fermer le complément Office.</span><span class="sxs-lookup"><span data-stu-id="b782c-207">The Office application was able to close the Office Add-in successfully.</span></span>|
|<span data-ttu-id="b782c-208">neuf</span><span class="sxs-lookup"><span data-stu-id="b782c-208">19</span></span>|<span data-ttu-id="b782c-209">Le complément a rencontré une erreur d’exécution</span><span class="sxs-lookup"><span data-stu-id="b782c-209">Add-in encountered runtime error</span></span>|<span data-ttu-id="b782c-210">Critique</span><span class="sxs-lookup"><span data-stu-id="b782c-210">Critical</span></span>|<span data-ttu-id="b782c-211">L'Complément Office a rencontré un problème qui l'a empêchée de s'exécuter.</span><span class="sxs-lookup"><span data-stu-id="b782c-211">The Office Add-in had a problem that caused it to fail.</span></span> <span data-ttu-id="b782c-212">Pour plus de détails, consultez le journal **Alertes Microsoft Office** à l’aide de l’Observateur d’événements Windows sur l’ordinateur sur lequel l’erreur s’est produite.</span><span class="sxs-lookup"><span data-stu-id="b782c-212">For more details, look at the **Microsoft Office Alerts** log using the Windows Event Viewer on the computer that encountered the error.</span></span>|
|<span data-ttu-id="b782c-213">vingtaine</span><span class="sxs-lookup"><span data-stu-id="b782c-213">20</span></span>|<span data-ttu-id="b782c-214">Le complément n’a pas pu vérifier la licence</span><span class="sxs-lookup"><span data-stu-id="b782c-214">Add-in failed to verify licensing</span></span>|<span data-ttu-id="b782c-215">Critique</span><span class="sxs-lookup"><span data-stu-id="b782c-215">Critical</span></span>|<span data-ttu-id="b782c-216">Les informations de licence de l'Complément Office n'ont pas pu être vérifiées et la licence a peut-être expiré.</span><span class="sxs-lookup"><span data-stu-id="b782c-216">The licensing information for the Office Add-in could not be verified and may have expired.</span></span> <span data-ttu-id="b782c-217">Pour plus de détails, consultez le journal **Alertes Microsoft Office** à l’aide de l’Observateur d’événements Windows sur l’ordinateur sur lequel l’erreur s’est produite.</span><span class="sxs-lookup"><span data-stu-id="b782c-217">For more details, look at the **Microsoft Office Alerts** log using the Windows Event Viewer on the computer that encountered the error.</span></span>|

<span data-ttu-id="b782c-218">Pour plus d’informations, consultez [Déployer le Tableau de bord de télémétrie](/previous-versions/office/office-2013-resource-kit/jj219431(v=office.15)) et [Dépannage des fichiers et des solutions personnalisées d’Office avec le journal de télémétrie](/office/client-developer/shared/troubleshooting-office-files-and-custom-solutions-with-the-telemetry-log)</span><span class="sxs-lookup"><span data-stu-id="b782c-218">For more information, see [Deploying Telemetry Dashboard](/previous-versions/office/office-2013-resource-kit/jj219431(v=office.15)) and [Troubleshooting Office files and custom solutions with the telemetry log](/office/client-developer/shared/troubleshooting-office-files-and-custom-solutions-with-the-telemetry-log).</span></span>

## <a name="design-and-implementation-techniques"></a><span data-ttu-id="b782c-219">Techniques de conception et d’implémentation</span><span class="sxs-lookup"><span data-stu-id="b782c-219">Design and implementation techniques</span></span>

<span data-ttu-id="b782c-220">Bien que les limites en matière d’utilisation des ressources de l’UC et de la mémoire, de tolérance d’incident et de réactivité de l’interface utilisateur s’appliquent aux Compléments Office qui s’exécutent uniquement sur les clients enrichis, l’optimisation de l’utilisation de ces ressources et de la batterie doit constituer une priorité si vous voulez que votre complément s’exécute de manière satisfaisante sur tous les clients et appareils de prise en charge.</span><span class="sxs-lookup"><span data-stu-id="b782c-220">While the resources limits on CPU and memory usage, crash tolerance, UI responsiveness apply to Office Add-ins running only on the rich clients, optimizing the usage of these resources and battery should be a priority if you want your add-in to perform satisfactorily on all supporting clients and devices.</span></span> <span data-ttu-id="b782c-221">L’optimisation est particulièrement importante si votre complément effectue des opérations de longue durée ou manipule de grands jeux de données.</span><span class="sxs-lookup"><span data-stu-id="b782c-221">Optimization is particularly important if your add-in carries out long-running operations or handles large data sets.</span></span> <span data-ttu-id="b782c-222">La liste suivante suggère certaines techniques permettant de fractionner les opérations gourmandes en ressources de l’UC en segments plus petits de sorte que votre complément puisse éviter une consommation excessive de ressources et que l’application Office puisse rester réactive :</span><span class="sxs-lookup"><span data-stu-id="b782c-222">The following list suggests some techniques to break up CPU-intensive or data-intensive operations into smaller chunks so that your add-in can avoid excessive resource consumption and the Office application can remain responsive:</span></span>

- <span data-ttu-id="b782c-223">Dans un scénario où votre complément a besoin de lire un important volume de données à partir d’un jeu de données illimité, vous pouvez appliquer la pagination lors de la lecture des données dans une table ou réduire la taille des données à chaque opération de lecture raccourcie, plutôt que de tenter de terminer la lecture en une seule opération.</span><span class="sxs-lookup"><span data-stu-id="b782c-223">In a scenario where your add-in needs to read a large volume of data from an unbounded dataset, you can apply paging when reading the data from a table, or reduce the size of data in each shorter read operation, rather than attempting to complete the read in one single operation.</span></span> <span data-ttu-id="b782c-224">Pour limiter la durée de l’entrée et de la sortie, vous pouvez utiliser la méthode [setTimeout](https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout) de l’objet global.</span><span class="sxs-lookup"><span data-stu-id="b782c-224">You can do this through the [setTimeout](https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout) method of the global object to limit the duration of input and output.</span></span> <span data-ttu-id="b782c-225">It also handles the data in defined chunks instead of randomly unbounded data.</span><span class="sxs-lookup"><span data-stu-id="b782c-225">It also handles the data in defined chunks instead of randomly unbounded data.</span></span> <span data-ttu-id="b782c-226">Une autre option consiste à utiliser [Async](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/async_function) pour gérer vos promesses.</span><span class="sxs-lookup"><span data-stu-id="b782c-226">Another option is to use [async](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/async_function) to handle your Promises.</span></span>

- <span data-ttu-id="b782c-p121">Si votre complément utilise un algorithme qui sollicite l’UC de manière intensive pour traiter un important volume de données, vous pouvez recourir aux API Web Worker afin d’effectuer une tâche de longue durée en arrière-plan pendant qu’un script distinct s’exécute au premier plan (par exemple, l’affichage de la progression d’une opération dans l’interface utilisateur). Les API Web Worker ne bloquent pas les activités des utilisateurs. En outre, elles permettent à la page HTML de rester réactive. Pour obtenir un exemple d’API Web Worker, voir les [bases des API Web Worker](https://www.html5rocks.com/tutorials/workers/basics/). Pour plus d’informations sur l’API Web Worker, voir [API Web Worker](https://developer.mozilla.org/docs/Web/API/Web_Workers_API).</span><span class="sxs-lookup"><span data-stu-id="b782c-p121">If your add-in uses a CPU-intensive algorithm to process a large volume of data, you can use web workers to perform the long-running task in the background while running a separate script in the foreground, such as displaying progress in the user interface. Web workers do not block user activities and allow the HTML page to remain responsive. For an example of web workers, see [The Basics of Web Workers](https://www.html5rocks.com/tutorials/workers/basics/). See [Web Workers](https://developer.mozilla.org/docs/Web/API/Web_Workers_API) for more information about the Web Workers API.</span></span>

- <span data-ttu-id="b782c-231">Si votre complément utilise un algorithme qui sollicite l’UC de manière intensive et si vous pouvez décomposer les entrées ou sorties de données en jeux de données de plus petite taille, créez un service web afin de lui passer les données et d’alléger la charge de l’UC, puis attendez un rappel asynchrone.</span><span class="sxs-lookup"><span data-stu-id="b782c-231">If your add-in uses a CPU-intensive algorithm but you can divide the data input or output into smaller sets, consider creating a web service, passing the data to the web service to off-load the CPU, and wait for an asynchronous callback.</span></span>

- <span data-ttu-id="b782c-232">Veillez à tester votre complément par rapport au volume de données le plus important possible, puis limitez votre complément pour lui permettre d’atteindre cette limite.</span><span class="sxs-lookup"><span data-stu-id="b782c-232">Test your add-in against the highest volume of data you expect, and restrict your add-in to process up to that limit.</span></span>

### <a name="performance-improvements-with-the-application-specific-apis"></a><span data-ttu-id="b782c-233">Améliorations des performances avec les API spécifiques de l’application</span><span class="sxs-lookup"><span data-stu-id="b782c-233">Performance improvements with the application-specific APIs</span></span>

<span data-ttu-id="b782c-234">Les conseils en matière de performances de l' [utilisation du modèle d’API propres aux applications](../develop/application-specific-api-model.md) fournissent des instructions sur l’utilisation des API propres aux applications pour Excel, OneNote, Visio et Word.</span><span class="sxs-lookup"><span data-stu-id="b782c-234">The performance tips in [Using the application-specific API model](../develop/application-specific-api-model.md) provide guidance when using the application-specific APIs for Excel, OneNote, Visio, and Word.</span></span> <span data-ttu-id="b782c-235">En résumé, vous devez :</span><span class="sxs-lookup"><span data-stu-id="b782c-235">In summary, you should:</span></span>

- <span data-ttu-id="b782c-236">[Chargez uniquement les propriétés nécessaires](../develop/application-specific-api-model.md#calling-load-without-parameters-not-recommended).</span><span class="sxs-lookup"><span data-stu-id="b782c-236">[Only load necessary properties](../develop/application-specific-api-model.md#calling-load-without-parameters-not-recommended).</span></span>
- <span data-ttu-id="b782c-237">[Réduisez le nombre d’appels de synchronisation ()](../develop/application-specific-api-model.md#performance-tip-minimize-the-number-of-sync-calls).</span><span class="sxs-lookup"><span data-stu-id="b782c-237">[Minimize the number of sync() calls](../develop/application-specific-api-model.md#performance-tip-minimize-the-number-of-sync-calls).</span></span> <span data-ttu-id="b782c-238">Pour plus d’informations sur la gestion des appels dans votre code, lisez [la rubrique Évitez d’utiliser la méthode Context. Sync dans des boucles](correlated-objects-pattern.md) `sync` .</span><span class="sxs-lookup"><span data-stu-id="b782c-238">Read [Avoid using the context.sync method in loops](correlated-objects-pattern.md) for further information on how to manage `sync` calls in your code.</span></span>
- <span data-ttu-id="b782c-239">[Réduisez le nombre d’objets proxy créés](../develop/application-specific-api-model.md#performance-tip-minimize-the-number-of-proxy-objects-created).</span><span class="sxs-lookup"><span data-stu-id="b782c-239">[Minimize the number of proxy objects created](../develop/application-specific-api-model.md#performance-tip-minimize-the-number-of-proxy-objects-created).</span></span> <span data-ttu-id="b782c-240">Vous pouvez également déseffectuer le suivi des objets proxy, comme décrit dans la section suivante.</span><span class="sxs-lookup"><span data-stu-id="b782c-240">You can also untrack proxy objects, as described in the next section.</span></span>

#### <a name="untrack-unneeded-proxy-objects"></a><span data-ttu-id="b782c-241">Non-suivi des objets proxy inutiles</span><span class="sxs-lookup"><span data-stu-id="b782c-241">Untrack unneeded proxy objects</span></span>

<span data-ttu-id="b782c-242">Les [objets proxy](../develop/application-specific-api-model.md#proxy-objects) persistent dans la mémoire jusqu’à ce qu' `RequestContext.sync()` il soit appelé.</span><span class="sxs-lookup"><span data-stu-id="b782c-242">[Proxy objects](../develop/application-specific-api-model.md#proxy-objects) persist in memory until `RequestContext.sync()` is called.</span></span> <span data-ttu-id="b782c-243">Les opérations par lots volumineux peuvent générer un grand nombre d’objets proxy qui sont uniquement utiles une fois pour le complément et peuvent être publiés à partir de la mémoire avant l’exécution du lot.</span><span class="sxs-lookup"><span data-stu-id="b782c-243">Large batch operations may generate a lot of proxy objects that are only needed once by the add-in and can be released from memory before the batch executes.</span></span>

<span data-ttu-id="b782c-244">La `untrack()` méthode libère l’objet de la mémoire.</span><span class="sxs-lookup"><span data-stu-id="b782c-244">The `untrack()` method releases the object from memory.</span></span> <span data-ttu-id="b782c-245">Cette méthode est implémentée sur un grand nombre d’objets de proxy d’API propres à l’application.</span><span class="sxs-lookup"><span data-stu-id="b782c-245">This method is implemented on many application-specific API proxy objects.</span></span> <span data-ttu-id="b782c-246">`untrack()`L’appel une fois votre complément effectué avec l’objet doit produire un gain de performances notable lors de l’utilisation d’un grand nombre d’objets proxy.</span><span class="sxs-lookup"><span data-stu-id="b782c-246">Calling `untrack()` after your add-in is done with the object should yield a noticeable performance benefit when using large numbers of proxy objects.</span></span>

> [!NOTE]
> <span data-ttu-id="b782c-247">`Range.untrack()` est un raccourci pour [ClientRequestContext.trackedObjects.remove(thisRange)](/javascript/api/office/officeextension.trackedobjects#remove-object-).</span><span class="sxs-lookup"><span data-stu-id="b782c-247">`Range.untrack()` is a shortcut for [ClientRequestContext.trackedObjects.remove(thisRange)](/javascript/api/office/officeextension.trackedobjects#remove-object-).</span></span> <span data-ttu-id="b782c-248">N’importe quel objet proxy peut être non suivi en le supprimant de la liste d’objets suivis dans le contexte.</span><span class="sxs-lookup"><span data-stu-id="b782c-248">Any proxy object can be untracked by removing it from the tracked objects list in the context.</span></span>

<span data-ttu-id="b782c-249">L’exemple de code Excel suivant remplit une plage sélectionnée avec des données, une cellule à la fois.</span><span class="sxs-lookup"><span data-stu-id="b782c-249">The following Excel code sample fills a selected range with data, one cell at a time.</span></span> <span data-ttu-id="b782c-250">Une fois que la valeur est ajoutée à la cellule, la plage représentant cette cellule est non suivie.</span><span class="sxs-lookup"><span data-stu-id="b782c-250">After the value is added to the cell, the range representing that cell is untracked.</span></span> <span data-ttu-id="b782c-251">Exécuter tout d’abord ce code avec une plage sélectionnée de 10 000 à 20 000 cellules, avec la `cell.untrack()` ligne et puis sans.</span><span class="sxs-lookup"><span data-stu-id="b782c-251">Run this code with a selected range of 10,000 to 20,000 cells, first with the `cell.untrack()` line, and then without it.</span></span> <span data-ttu-id="b782c-252">Vous devez remarquer que le code est exécuté plus rapidement avec la `cell.untrack()` ligne que sans elle.</span><span class="sxs-lookup"><span data-stu-id="b782c-252">You should notice the code runs faster with the `cell.untrack()` line than without it.</span></span> <span data-ttu-id="b782c-253">Vous pouvez également remarquer un temps de réponse plus rapide par la suite, étant donné que l’étape de nettoyage prend moins de temps.</span><span class="sxs-lookup"><span data-stu-id="b782c-253">You may also notice a quicker response time afterwards, since the cleanup step takes less time.</span></span>

```js
Excel.run(async (context) => {
    var largeRange = context.workbook.getSelectedRange();
    largeRange.load(["rowCount", "columnCount"]);
    await context.sync();

    for (var i = 0; i < largeRange.rowCount; i++) {
        for (var j = 0; j < largeRange.columnCount; j++) {
            var cell = largeRange.getCell(i, j);
            cell.values = [[i *j]];

            // Call untrack() to release the range from memory.
            cell.untrack();
        }
    }

    await context.sync();
});
```

<span data-ttu-id="b782c-254">Notez que le fait de ne pas suivre les objets ne devient important que lorsque vous avez affaire à des milliers d’entre eux.</span><span class="sxs-lookup"><span data-stu-id="b782c-254">Note that needing to untrack objects only becomes important when you're dealing with thousands of them.</span></span> <span data-ttu-id="b782c-255">La plupart des compléments n’ont pas besoin de gérer le suivi de l’objet proxy.</span><span class="sxs-lookup"><span data-stu-id="b782c-255">Most add-ins will not need to manage proxy object tracking.</span></span>

## <a name="see-also"></a><span data-ttu-id="b782c-256">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="b782c-256">See also</span></span>

- [<span data-ttu-id="b782c-257">Confidentialité et sécurité pour les compléments Office</span><span class="sxs-lookup"><span data-stu-id="b782c-257">Privacy and security for Office Add-ins</span></span>](../concepts/privacy-and-security.md)
- [<span data-ttu-id="b782c-258">Limites pour l’activation et l’API JavaScript pour les compléments Outlook</span><span class="sxs-lookup"><span data-stu-id="b782c-258">Limits for activation and JavaScript API for Outlook add-ins</span></span>](../outlook/limits-for-activation-and-javascript-api-for-outlook-add-ins.md)
- [<span data-ttu-id="b782c-259">Optimisation des performances à l’aide de l’API JavaScript d’Excel</span><span class="sxs-lookup"><span data-stu-id="b782c-259">Performance optimization using the Excel JavaScript API</span></span>](../excel/performance.md)
