---
title: Limites des ressources et optimisation des performances pour les compléments Office
description: ''
ms.date: 09/09/2019
localization_priority: Normal
ms.openlocfilehash: 5263abdafb6655325a22754ab22f36b99ca32cbe
ms.sourcegitcommit: 5d29801180f6939ec10efb778d2311be67d8b9f1
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 02/27/2020
ms.locfileid: "42323888"
---
# <a name="resource-limits-and-performance-optimization-for-office-add-ins"></a><span data-ttu-id="7dbd2-102">Limites des ressources et optimisation des performances pour les compléments Office</span><span class="sxs-lookup"><span data-stu-id="7dbd2-102">Resource limits and performance optimization for Office Add-ins</span></span>

<span data-ttu-id="7dbd2-p101">Afin d’offrir la meilleure expérience utilisateur, assurez-vous que votre complément Office fonctionne dans les limites prévues en matière d’utilisation du cœur du processeur et de la mémoire, ainsi qu’en matière de fiabilité et, pour les compléments Outlook, de temps de réponse lors de l’évaluation des expressions régulières. Ces limites propres à l’utilisation des ressources d’exécution s’appliquent aux compléments exécutés sur des clients Office sous Windows et OS X mais pas sur des applications mobiles, ni dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="7dbd2-p101">To create the best experience for your users, ensure that your Office Add-in performs within specific limits for CPU core and memory usage, reliability, and, for Outlook add-ins, the response time for evaluating regular expressions. These run-time resource usage limits apply to add-ins running in Office clients on Windows and OS X, but not on mobile apps or in a browser.</span></span>

<span data-ttu-id="7dbd2-105">Par ailleurs, cette rubrique suggère des techniques de conception et d’implémentation de complément qui permettent de mieux contrôler les performances des compléments sur ordinateurs de bureau et périphériques mobiles.</span><span class="sxs-lookup"><span data-stu-id="7dbd2-105">You can also optimize the performance of your add-ins on desktop and mobile devices by optimizing the use of resources in your add-in design and implementation.</span></span>

## <a name="resource-usage-limits-for-add-ins"></a><span data-ttu-id="7dbd2-106">Limites d’utilisation des ressources pour les compléments</span><span class="sxs-lookup"><span data-stu-id="7dbd2-106">Resource usage limits for add-ins</span></span>

<span data-ttu-id="7dbd2-p102">Les limites d’utilisation des ressources d’exécution s’appliquent à tous les compléments Office. Elles permettent à l’utilisateur de bénéficier de bonnes performances et contribuent également à atténuer les attaques par déni de service. Vous devez suffisamment tester votre complément Office sur l’application hôte cible à l’aide d’un large éventail de données possibles et mesurer ses performances par rapport aux limites ci-après :</span><span class="sxs-lookup"><span data-stu-id="7dbd2-p102">Run-time resource usage limits apply to all types of Office Add-ins. These limits help ensure performance for your users and mitigate denial-of-service attacks. Be sure to test your Office Add-in on your target host application by using a range of possible data, and measure its performance against the following run-time usage limits:</span></span>

- <span data-ttu-id="7dbd2-109">**Utilisation du cœur du processeur** - Seuil d’utilisation d’un seul cœur de processeur de 90 %, observé à trois reprises dans des intervalles par défaut de 5 secondes.</span><span class="sxs-lookup"><span data-stu-id="7dbd2-109">**CPU core usage** - A single CPU core usage threshold of 90%, observed three times in default 5-second intervals.</span></span>

   <span data-ttu-id="7dbd2-p103">L’intervalle par défaut de vérification de l’utilisation du cœur du processeur par un client enrichi de l’hôte est de 5 secondes. Si le client de l’hôte détecte que l’utilisation du cœur du processeur d’un complément dépasse la valeur du seuil, il affiche un message demandant à l’utilisateur s’il souhaite continuer à exécuter le complément. Si l’utilisateur choisit de continuer, le client de l’hôte ne redemande pas à l’utilisateur s’il souhaite continuer au cours de cette session de modification. Les administrateurs peuvent souhaiter utiliser la clé de registre **AlertInterval** pour augmenter le seuil et réduire l’affichage de ce message d’avertissement si les utilisateurs exécutent des compléments faisant appel au processeur de manière intensive.</span><span class="sxs-lookup"><span data-stu-id="7dbd2-p103">The default interval for a host rich client to check CPU core usage is every 5 seconds. If the host client detects the CPU core usage of an add-in is above the threshold value, it displays a message asking if the user wants to continue running the add-in. If the user chooses to continue, the host client does not ask the user again during that edit session. Administrators might want to use the **AlertInterval** registry key to raise the threshold to reduce the display of this warning message if users run CPU-intensive add-ins.</span></span>

- <span data-ttu-id="7dbd2-114">**Utilisation de la mémoire** - Seuil d’utilisation de mémoire par défaut, qui est déterminé de manière dynamique en fonction de la mémoire physique disponible de l’appareil.</span><span class="sxs-lookup"><span data-stu-id="7dbd2-114">**Memory usage** - A default memory usage threshold that is dynamically determined based on the available physical memory of the device.</span></span>

   <span data-ttu-id="7dbd2-p104">Par défaut, lorsqu’un client riche hôte détecte que l’utilisation de la mémoire physique sur un appareil dépasse 80% de la mémoire disponible, le client démarre la surveillance de l’utilisation de la mémoire du complément, au niveau du document pour les compléments de contenu et du volet Office, et au niveau des boîtes aux lettres pour les compléments Outlook. À un intervalle de 5 secondes par défaut, le client avertit l’utilisateur si l’utilisation de la mémoire physique pour un ensemble de compléments au niveau du document ou de la boîte aux lettres dépasse 50%. Cette limite d’utilisation de la mémoire utilise des mémoires physiques plutôt que des mémoires virtuelles pour garantir des performances sur les appareils avec une RAM limitée, comme les tablettes. Les administrateurs peuvent remplacer ce paramètre dynamique par une limite explicite à l’aide de la clé de Registre Windows **MemoryAlertThreshold** en tant que paramètre global, IR régler l’intervalle d’alerte en utilisant la clé **AlertInterval** comme paramètre global.</span><span class="sxs-lookup"><span data-stu-id="7dbd2-p104">By default, when a host rich client detects that physical memory usage on a device exceeds 80% of the available memory, the client starts monitoring the add-in's memory usage, at a document level for content and task pane add-ins, and at a mailbox level for Outlook add-ins. At a default interval of 5 seconds, the client warns the user if physical memory usage for a set of add-ins at the document or mailbox level exceeds 50%. This memory usage limit uses physical rather than virtual memory to ensure performance on devices with limited RAM, such as tablets. Administrators can override this dynamic setting with an explicit limit by using the **MemoryAlertThreshold** Windows registry key as a global setting, ir adjust the alert interval by using the **AlertInterval** key as a global setting.</span></span>

- <span data-ttu-id="7dbd2-118">**Tolérance d’incident** - Limite par défaut de 4 incidents pour un complément.</span><span class="sxs-lookup"><span data-stu-id="7dbd2-118">**Crash tolerance** - A default limit of four crashes for an add-in.</span></span>

   <span data-ttu-id="7dbd2-119">Les administrateurs peuvent ajuster le seuil relatif aux incidents en utilisant la clé de registre **RestartManagerRetryLimit**.</span><span class="sxs-lookup"><span data-stu-id="7dbd2-119">Administrators can adjust the threshold for crashes by using the **RestartManagerRetryLimit** registry key.</span></span>

- <span data-ttu-id="7dbd2-120">**Blocage d’application** - Limitation à 5 secondes du seuil de blocage prolongé d’un complément.</span><span class="sxs-lookup"><span data-stu-id="7dbd2-120">**Application blocking** - Prolonged unresponsiveness threshold of 5 seconds for an add-in.</span></span>

   <span data-ttu-id="7dbd2-p105">Cette option affecte l’expérience utilisateur relative au complément et à l’application hôte. Dans ce cas, l’application hôte redémarre automatiquement tous les compléments actifs d’un document ou d’une boîte aux lettres (le cas échéant), et indique à l’utilisateur le complément qui ne répond pas. Les compléments peuvent atteindre ce seuil lorsqu’ils ne cèdent pas régulièrement le traitement lors de l’exécution de tâches longues. Il existe des techniques permettant de garantir qu’aucun blocage ne se produira. Les administrateurs ne peuvent pas remplacer ce seuil.</span><span class="sxs-lookup"><span data-stu-id="7dbd2-p105">This affects the user's experiences of the add-in and the host application. When this occurs, the host application automatically restarts all the active add-ins for a document or mailbox (where applicable), and warns the user as to which add-in became unresponsive. Add-ins can reach this threshold when they do not regularly yield processing while performing long-running tasks. There are techniques to ensure that blocking does not occur. Administrators cannot override this threshold.</span></span>

### <a name="outlook-add-ins"></a><span data-ttu-id="7dbd2-126">Compléments Outlook</span><span class="sxs-lookup"><span data-stu-id="7dbd2-126">Outlook add-ins</span></span>

<span data-ttu-id="7dbd2-p106">§LTA Si un complément Outlook dépasse les seuils précédents en matière d’utilisation du cœur du processeur ou de la mémoire, ou en matière de tolérance d’incident, Outlook désactive le complément. Le Centre d’administration Exchange indique que l’état de l’application est désactivé.</span><span class="sxs-lookup"><span data-stu-id="7dbd2-p106">If any Outlook add-in exceeds the preceding thresholds for CPU core or memory usage, or tolerance limit for crashes, Outlook disables the add-in. The Exchange Admin Center displays the disabled status of the app.</span></span>

> [!NOTE]
> <span data-ttu-id="7dbd2-129">Même si seuls les clients enrichis Outlook et non les clients non-Outlook sur le web ou les appareils mobiles contrôlent l’utilisation des ressources, si un client enrichi désactive un complément Outlook, ce complément est également désactivé pour une utilisation dans Outlook sur le web et les appareils mobiles.</span><span class="sxs-lookup"><span data-stu-id="7dbd2-129">Even though only the Outlook rich clients and not Outlook on the web or mobile devices monitor resource usage, if a rich client disables an Outlook add-in, that add-in is also disabled for use in Outlook on the web and mobile devices.</span></span>

<span data-ttu-id="7dbd2-130">En plus du cœur du processeur, de la mémoire et des règles de fiabilité, les compléments Outlook doivent respecter les règles suivantes lors de l’activation :</span><span class="sxs-lookup"><span data-stu-id="7dbd2-130">In addition to the CPU core, memory, and reliability rules, Outlook add-ins should observe the following rules on activation:</span></span>

- <span data-ttu-id="7dbd2-p107">**Temps de réponse des expressions régulières** - Seuil par défaut de 1 000 millisecondes pour Outlook afin d’évaluer toutes les expressions régulières contenues dans le manifeste d’un complément Outlook. Le dépassement du seuil oblige Outlook à retenter l’évaluation un peu plus tard.</span><span class="sxs-lookup"><span data-stu-id="7dbd2-p107">**Regular expressions response time** - A default threshold of 1,000 milliseconds for Outlook to evaluate all regular expressions in the manifest of an Outlook add-in. Exceeding the threshold causes Outlook to retry evaluation at a later time.</span></span>

    <span data-ttu-id="7dbd2-133">À l’aide d’une stratégie de groupe ou d’un paramètre spécifique de l’application dans le Registre Windows, les administrateurs peuvent ajuster cette valeur seuil par défaut de 1 000 millisecondes dans le paramètre **OutlookActivationAlertThreshold**.</span><span class="sxs-lookup"><span data-stu-id="7dbd2-133">Using a group policy or application-specific setting in the Windows registry, administrators can adjust this default threshold value of 1,000 milliseconds in the **OutlookActivationAlertThreshold** setting.</span></span>

- <span data-ttu-id="7dbd2-p108">**Réévaluation des expressions régulières** -une limite par défaut de trois fois pour qu’Outlook réévalue toutes les expressions régulières dans un manifeste. Si l’évaluation échoue toutes les trois fois en dépassant le seuil applicable (soit la valeur par défaut de 1 000 millisecondes, soit une valeur spécifiée par **OutlookActivationAlertThreshold**, si ce paramètre existe dans le Registre Windows), Outlook désactive le complément Outlook. Le centre d’administration Exchange affiche l’état désactivé et le complément est désactivé pour une utilisation dans les clients riches Outlook, et Outlook sur le Web et les appareils mobiles.</span><span class="sxs-lookup"><span data-stu-id="7dbd2-p108">**Regular expressions re-evaluation** - A default limit of three times for Outlook to reevaluate all the regular expressions in a manifest. If evaluation fails all three times by exceeding the applicable threshold (which is either the default of 1,000 milliseconds or a value specified by **OutlookActivationAlertThreshold**, if that setting exists in the Windows registry), Outlook disables the Outlook add-in. The Exchange Admin Center displays the disabled status, and the add-in is disabled for use in the Outlook rich clients, and Outlook on the web and mobile devices.</span></span>

    <span data-ttu-id="7dbd2-137">À l’aide d’une stratégie de groupe ou d’un paramètre spécifique de l’application dans le Registre Windows, les administrateurs peuvent ajuster ce nombre de tentatives d’évaluation dans le paramètre **OutlookActivationManagerRetryLimit**.</span><span class="sxs-lookup"><span data-stu-id="7dbd2-137">Using a group policy or application-specific setting in the Windows registry, administrators can adjust this number of times to retry evaluation in the **OutlookActivationManagerRetryLimit** setting.</span></span>

### <a name="task-pane-and-content-add-ins"></a><span data-ttu-id="7dbd2-138">Compléments de volet Office et de contenu</span><span class="sxs-lookup"><span data-stu-id="7dbd2-138">Task pane and content add-ins</span></span>

<span data-ttu-id="7dbd2-p109">Si un complément de contenu ou de volet de tâches dépasse les seuils précédents en matière d’utilisation du cœur du processeur ou de la mémoire, ou en matière de tolérance d’incident, l’application hôte correspondante affiche un avertissement pour l’utilisateur. À ce stade, l’utilisateur peut effectuer l’une des actions suivantes :</span><span class="sxs-lookup"><span data-stu-id="7dbd2-p109">If any content or task pane add-in exceeds the preceding thresholds on CPU core or memory usage, or tolerance limit for crashes, the corresponding host application displays a warning for the user. At this point, the user can do one of the following:</span></span>

- <span data-ttu-id="7dbd2-141">Redémarrer le complément.</span><span class="sxs-lookup"><span data-stu-id="7dbd2-141">Restart the add-in.</span></span>
- <span data-ttu-id="7dbd2-p110">Annuler les alertes supplémentaires de dépassement de seuil. Dans l’idéal, l’utilisateur devrait supprimer le complément du document. La poursuite de l’exécution du complément risquerait d’entraîner des problèmes supplémentaires au niveau des performances et de la stabilité.</span><span class="sxs-lookup"><span data-stu-id="7dbd2-p110">Cancel further alerts about exceeding that threshold. Ideally, the user should then delete the add-in from the document; continuing the add-in would risk further performance and stability issues.</span></span>  

## <a name="verifying-resource-usage-issues-in-the-telemetry-log"></a><span data-ttu-id="7dbd2-144">Vérification des problèmes d’utilisation des ressources dans le journal de télémétrie</span><span class="sxs-lookup"><span data-stu-id="7dbd2-144">Verifying resource usage issues in the Telemetry Log</span></span>

<span data-ttu-id="7dbd2-p111">Office propose un journal de télémétrie qui tient à jour un enregistrement de certains événements (chargement, ouverture, fermeture et erreurs) des solutions Office qui s’exécutent sur l’ordinateur local, notamment les problèmes d’utilisation des ressources dans une Complément Office. Si le journal de télémétrie est configuré, vous pouvez utiliser Excel pour l’ouvrir à partir de l’emplacement par défaut suivant sur votre disque local :</span><span class="sxs-lookup"><span data-stu-id="7dbd2-p111">Office provides a Telemetry Log that maintains a record of certain events (loading, opening, closing, and errors) of Office solutions running on the local computer, including resource usage issues in an Office Add-in. If you have the Telemetry Log set up, you can use Excel to open the Telemetry Log in the following default location on your local drive:</span></span>

`%Users%\<Current user>\AppData\Local\Microsoft\Office\15.0\Telemetry`

<span data-ttu-id="7dbd2-p112">Le journal de télémétrie comprend pour chaque événement suivi pour un complément, les date/heure de l’occurrence, l’ID d’événement, la gravité et une courte description de l’événement, le nom convivial et l’ID unique du complément, ainsi que l’application qui a enregistré l’événement. Vous pouvez actualiser le journal de télémétrie pour afficher les événements suivis. Le tableau suivant répertorie des exemples de compléments Outlook qui ont été suivis dans le journal de télémétrie.</span><span class="sxs-lookup"><span data-stu-id="7dbd2-p112">For each event that the Telemetry Log tracks for an add-in, there is a date/time of the occurrence, event ID, severity, and short descriptive title for the event, the friendly name and unique ID of the add-in, and the application that logged the event. You can refresh the Telemetry Log to see the current tracked events. The following table shows examples of Outlook add-ins that were tracked in the Telemetry log.</span></span> 

|<span data-ttu-id="7dbd2-150">**Date/Heure**</span><span class="sxs-lookup"><span data-stu-id="7dbd2-150">**Date/Time**</span></span>|<span data-ttu-id="7dbd2-151">**ID d’évènement**</span><span class="sxs-lookup"><span data-stu-id="7dbd2-151">**Event ID**</span></span>|<span data-ttu-id="7dbd2-152">**Gravité**</span><span class="sxs-lookup"><span data-stu-id="7dbd2-152">**Severity**</span></span>|<span data-ttu-id="7dbd2-153">**Titre**</span><span class="sxs-lookup"><span data-stu-id="7dbd2-153">**Title**</span></span>|<span data-ttu-id="7dbd2-154">**Fichier**</span><span class="sxs-lookup"><span data-stu-id="7dbd2-154">**File**</span></span>|<span data-ttu-id="7dbd2-155">**ID**</span><span class="sxs-lookup"><span data-stu-id="7dbd2-155">**ID**</span></span>|<span data-ttu-id="7dbd2-156">**Application**</span><span class="sxs-lookup"><span data-stu-id="7dbd2-156">**Application**</span></span>|
|:-----|:-----|:-----|:-----|:-----|:-----|:-----|
|<span data-ttu-id="7dbd2-157">08/10/2012 17:57:10</span><span class="sxs-lookup"><span data-stu-id="7dbd2-157">10/8/2012 5:57:10 PM</span></span>|<span data-ttu-id="7dbd2-158">7</span><span class="sxs-lookup"><span data-stu-id="7dbd2-158">7</span></span>||<span data-ttu-id="7dbd2-159">Le manifeste du complément a été correctement téléchargé</span><span class="sxs-lookup"><span data-stu-id="7dbd2-159">add-in manifest downloaded successfully</span></span>|<span data-ttu-id="7dbd2-160">Who’s Who</span><span class="sxs-lookup"><span data-stu-id="7dbd2-160">Who's Who</span></span>|<span data-ttu-id="7dbd2-161">69cc567c-6737-4c49-88dd-123334943a22</span><span class="sxs-lookup"><span data-stu-id="7dbd2-161">69cc567c-6737-4c49-88dd-123334943a22</span></span>|<span data-ttu-id="7dbd2-162">Outlook</span><span class="sxs-lookup"><span data-stu-id="7dbd2-162">Outlook</span></span>|
|<span data-ttu-id="7dbd2-163">08/10/2012 17:57:01</span><span class="sxs-lookup"><span data-stu-id="7dbd2-163">10/8/2012 5:57:01 PM</span></span>|<span data-ttu-id="7dbd2-164">7</span><span class="sxs-lookup"><span data-stu-id="7dbd2-164">7</span></span>||<span data-ttu-id="7dbd2-165">Le manifeste du complément a été correctement téléchargé</span><span class="sxs-lookup"><span data-stu-id="7dbd2-165">add-in manifest downloaded successfully</span></span>|<span data-ttu-id="7dbd2-166">LinkedIn</span><span class="sxs-lookup"><span data-stu-id="7dbd2-166">LinkedIn</span></span>|<span data-ttu-id="7dbd2-167">333bf46d-7dad-4f2b-8cf4-c19ddc78b723</span><span class="sxs-lookup"><span data-stu-id="7dbd2-167">333bf46d-7dad-4f2b-8cf4-c19ddc78b723</span></span>|<span data-ttu-id="7dbd2-168">Outlook</span><span class="sxs-lookup"><span data-stu-id="7dbd2-168">Outlook</span></span>|

<span data-ttu-id="7dbd2-169">Le tableau suivant répertorie les événements que le journal de télémétrie suit pour les Compléments Office en général.</span><span class="sxs-lookup"><span data-stu-id="7dbd2-169">The following table lists the events that the Telemetry Log tracks for Office Add-ins in general.</span></span>

|<span data-ttu-id="7dbd2-170">**ID d’évènement**</span><span class="sxs-lookup"><span data-stu-id="7dbd2-170">**Event ID**</span></span>|<span data-ttu-id="7dbd2-171">**Titre**</span><span class="sxs-lookup"><span data-stu-id="7dbd2-171">**Title**</span></span>|<span data-ttu-id="7dbd2-172">**Gravité**</span><span class="sxs-lookup"><span data-stu-id="7dbd2-172">**Severity**</span></span>|<span data-ttu-id="7dbd2-173">**Description**</span><span class="sxs-lookup"><span data-stu-id="7dbd2-173">**Description**</span></span>|
|:-----|:-----|:-----|:-----|
|<span data-ttu-id="7dbd2-174">7</span><span class="sxs-lookup"><span data-stu-id="7dbd2-174">7</span></span>|<span data-ttu-id="7dbd2-175">Le manifeste du complément a été correctement téléchargé</span><span class="sxs-lookup"><span data-stu-id="7dbd2-175">Add-in manifest downloaded successfully</span></span>||<span data-ttu-id="7dbd2-176">Le manifeste de l’Complément Office a été chargé et lu correctement par l’application hôte.</span><span class="sxs-lookup"><span data-stu-id="7dbd2-176">The manifest of the Office Add-in was successfully loaded and read by the host application.</span></span>|
|<span data-ttu-id="7dbd2-177">8</span><span class="sxs-lookup"><span data-stu-id="7dbd2-177">8</span></span>|<span data-ttu-id="7dbd2-178">Échec du téléchargement du manifeste du complément</span><span class="sxs-lookup"><span data-stu-id="7dbd2-178">Add-in manifest did not download</span></span>|<span data-ttu-id="7dbd2-179">Critique</span><span class="sxs-lookup"><span data-stu-id="7dbd2-179">Critical</span></span>|<span data-ttu-id="7dbd2-180">L’application hôte n’a pas pu charger le fichier manifeste pour le complément Office à partir du catalogue SharePoint, du catalogue d’entreprise ou d’AppSource.</span><span class="sxs-lookup"><span data-stu-id="7dbd2-180">The host application was unable to load the manifest file for the Office Add-in from the SharePoint catalog, corporate catalog, or AppSource.</span></span>|
|<span data-ttu-id="7dbd2-181">9</span><span class="sxs-lookup"><span data-stu-id="7dbd2-181">9</span></span>|<span data-ttu-id="7dbd2-182">Impossible d’analyser le balisage du complément</span><span class="sxs-lookup"><span data-stu-id="7dbd2-182">Add-in markup could not be parsed</span></span>|<span data-ttu-id="7dbd2-183">Critique</span><span class="sxs-lookup"><span data-stu-id="7dbd2-183">Critical</span></span>|<span data-ttu-id="7dbd2-184">L’application hôte a chargé le manifeste de l’Complément Office, mais n’a pas pu lire le balisage HTML de l’application.</span><span class="sxs-lookup"><span data-stu-id="7dbd2-184">The host application loaded the Office Add-in manifest, but could not read the HTML markup of the app.</span></span>|
|<span data-ttu-id="7dbd2-185">10</span><span class="sxs-lookup"><span data-stu-id="7dbd2-185">10</span></span>|<span data-ttu-id="7dbd2-186">Le complément a trop sollicité le processeur</span><span class="sxs-lookup"><span data-stu-id="7dbd2-186">Add-in used too much CPU</span></span>|<span data-ttu-id="7dbd2-187">Critique</span><span class="sxs-lookup"><span data-stu-id="7dbd2-187">Critical</span></span>|<span data-ttu-id="7dbd2-188">L’Complément Office a utilisé plus de 90 % des ressources du processeur sur une période de temps définie.</span><span class="sxs-lookup"><span data-stu-id="7dbd2-188">The Office Add-in used more than 90% of the CPU resources over a finite period of time.</span></span>|
|<span data-ttu-id="7dbd2-189">15</span><span class="sxs-lookup"><span data-stu-id="7dbd2-189">15</span></span>|<span data-ttu-id="7dbd2-190">Le complément a été désactivé en raison de l’expiration de la recherche de chaîne</span><span class="sxs-lookup"><span data-stu-id="7dbd2-190">Add-in disabled due to string search time-out</span></span>||<span data-ttu-id="7dbd2-p113">§LTA Les compléments Outlook recherchent la ligne d’objet et le corps du message d’un courrier électronique pour déterminer s’ils doivent être affichés avec une expression régulière. Le complément Outlook répertorié dans la colonne **Fichier** a été désactivé par Outlook, car il a expiré à plusieurs reprises lors d’une tentative de mise en correspondance d’une expression régulière.</span><span class="sxs-lookup"><span data-stu-id="7dbd2-p113">Outlook add-ins search the subject line and message of an e-mail to determine whether they should be displayed by using a regular expression. The Outlook add-in listed in the **File** column was disabled by Outlook because it timed out repeatedly while trying to match a regular expression.</span></span>|
|<span data-ttu-id="7dbd2-193">18</span><span class="sxs-lookup"><span data-stu-id="7dbd2-193">18</span></span>|<span data-ttu-id="7dbd2-194">Le complément a été fermé</span><span class="sxs-lookup"><span data-stu-id="7dbd2-194">Add-in closed successfully</span></span>||<span data-ttu-id="7dbd2-195">L’application hôte a pu fermer l’Complément Office sans problème.</span><span class="sxs-lookup"><span data-stu-id="7dbd2-195">The host application was able to close the Office Add-in successfully.</span></span>|
|<span data-ttu-id="7dbd2-196">19</span><span class="sxs-lookup"><span data-stu-id="7dbd2-196">19</span></span>|<span data-ttu-id="7dbd2-197">Le complément a rencontré une erreur d’exécution</span><span class="sxs-lookup"><span data-stu-id="7dbd2-197">Add-in encountered runtime error</span></span>|<span data-ttu-id="7dbd2-198">Critique</span><span class="sxs-lookup"><span data-stu-id="7dbd2-198">Critical</span></span>|<span data-ttu-id="7dbd2-p114">Le complément Office a rencontré un problème à l’origine de l’échec. Pour plus d’informations, consultez le journal **Microsoft Office Alerts** à l’aide de l’observateur d’événements Windows sur l’ordinateur qui a rencontré l’erreur.</span><span class="sxs-lookup"><span data-stu-id="7dbd2-p114">The Office Add-in had a problem that caused it to fail. For more details, look at the **Microsoft Office Alerts** log using the Windows Event Viewer on the computer that encountered the error.</span></span>|
|<span data-ttu-id="7dbd2-201">20</span><span class="sxs-lookup"><span data-stu-id="7dbd2-201">20</span></span>|<span data-ttu-id="7dbd2-202">Le complément n’a pas pu vérifier la licence</span><span class="sxs-lookup"><span data-stu-id="7dbd2-202">Add-in failed to verify licensing</span></span>|<span data-ttu-id="7dbd2-203">Critique</span><span class="sxs-lookup"><span data-stu-id="7dbd2-203">Critical</span></span>|<span data-ttu-id="7dbd2-p115">Les informations de licence pour le complément Office n’ont pas pu être vérifiées et peuvent avoir expiré. Pour plus d’informations, consultez le journal **Microsoft Office Alerts** à l’aide de l’observateur d’événements Windows sur l’ordinateur qui a rencontré l’erreur.</span><span class="sxs-lookup"><span data-stu-id="7dbd2-p115">The licensing information for the Office Add-in could not be verified and may have expired. For more details, look at the **Microsoft Office Alerts** log using the Windows Event Viewer on the computer that encountered the error.</span></span>|

<span data-ttu-id="7dbd2-206">Pour plus d’informations, consultez [Déployer le Tableau de bord de télémétrie](/previous-versions/office/office-2013-resource-kit/jj219431(v=office.15)) et [Dépannage des fichiers et des solutions personnalisées d’Office avec le journal de télémétrie](/office/client-developer/shared/troubleshooting-office-files-and-custom-solutions-with-the-telemetry-log)</span><span class="sxs-lookup"><span data-stu-id="7dbd2-206">For more information, see [Deploying Telemetry Dashboard](/previous-versions/office/office-2013-resource-kit/jj219431(v=office.15)) and [Troubleshooting Office files and custom solutions with the telemetry log](/office/client-developer/shared/troubleshooting-office-files-and-custom-solutions-with-the-telemetry-log).</span></span>


## <a name="design-and-implementation-techniques"></a><span data-ttu-id="7dbd2-207">Techniques de conception et d’implémentation</span><span class="sxs-lookup"><span data-stu-id="7dbd2-207">Design and implementation techniques</span></span>

<span data-ttu-id="7dbd2-p116">Bien que les limites en matière d’utilisation des ressources de l’UC et de la mémoire, de tolérance d’incident et de réactivité de l’interface utilisateur s’appliquent aux Compléments Office qui s’exécutent uniquement sur les clients enrichis, l’optimisation de l’utilisation de ces ressources et de la batterie doit constituer une priorité si vous voulez que votre complément s’exécute de manière satisfaisante sur tous les clients et appareils de prise en charge. L’optimisation est particulièrement importante si votre complément effectue des opérations de longue durée ou manipule de grands jeux de données. La liste suivante suggère quelques techniques à suivre pour réduire la taille des opérations qui utilisent beaucoup de ressources d’UC ou de données afin de permettre à votre complément d’éviter une consommation excessive des ressources et à l’application hôte de rester réactive :</span><span class="sxs-lookup"><span data-stu-id="7dbd2-p116">While the resources limits on CPU and memory usage, crash tolerance, UI responsiveness apply to Office Add-ins running only on the rich clients, optimizing the usage of these resources and battery should be a priority if you want your add-in to perform satisfactorily on all supporting clients and devices. Optimization is particularly important if your add-in carries out long-running operations or handles large data sets. The following list suggests some techniques to break up CPU-intensive or data-intensive operations into smaller chunks so that your add-in can avoid excessive resource consumption and the host application can remain responsive:</span></span>

- <span data-ttu-id="7dbd2-211">Dans un scénario où votre complément a besoin de lire un important volume de données à partir d’un jeu de données illimité, vous pouvez appliquer la pagination lors de la lecture des données dans une table ou réduire la taille des données à chaque opération de lecture raccourcie, plutôt que de tenter de terminer la lecture en une seule opération.</span><span class="sxs-lookup"><span data-stu-id="7dbd2-211">In a scenario where your add-in needs to read a large volume of data from an unbounded dataset, you can apply paging when reading the data from a table, or reduce the size of data in each shorter read operation, rather than attempting to complete the read in one single operation.</span></span> 

   <span data-ttu-id="7dbd2-p117">For a JavaScript and jQuery code sample that shows breaking up a potentially long-running and CPU-intensive series of inputting and outputting operations on unbounded data, see [How can I give control back (briefly) to the browser during intensive JavaScript processing?](https://stackoverflow.com/questions/210821/how-can-i-give-control-back-briefly-to-the-browser-during-intensive-javascript). This example uses the [setTimeout](https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout) method of the global object to limit the duration of input and output. It also handles the data in defined chunks instead of randomly unbounded data.</span><span class="sxs-lookup"><span data-stu-id="7dbd2-p117">For a JavaScript and jQuery code sample that shows breaking up a potentially long-running and CPU-intensive series of inputting and outputting operations on unbounded data, see [How can I give control back (briefly) to the browser during intensive JavaScript processing?](https://stackoverflow.com/questions/210821/how-can-i-give-control-back-briefly-to-the-browser-during-intensive-javascript). This example uses the [setTimeout](https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout) method of the global object to limit the duration of input and output. It also handles the data in defined chunks instead of randomly unbounded data.</span></span>

- <span data-ttu-id="7dbd2-p118">Si votre complément utilise un algorithme qui sollicite l’UC de manière intensive pour traiter un important volume de données, vous pouvez recourir aux API Web Worker afin d’effectuer une tâche de longue durée en arrière-plan pendant qu’un script distinct s’exécute au premier plan (par exemple, l’affichage de la progression d’une opération dans l’interface utilisateur). Les API Web Worker ne bloquent pas les activités des utilisateurs. En outre, elles permettent à la page HTML de rester réactive. Pour obtenir un exemple d’API Web Worker, voir les [bases des API Web Worker](https://www.html5rocks.com/en/tutorials/workers/basics/). Pour plus d’informations sur l’API Web Worker, voir [API Web Worker](https://developer.mozilla.org/docs/Web/API/Web_Workers_API).</span><span class="sxs-lookup"><span data-stu-id="7dbd2-p118">If your add-in uses a CPU-intensive algorithm to process a large volume of data, you can use web workers to perform the long-running task in the background while running a separate script in the foreground, such as displaying progress in the user interface. Web workers do not block user activities and allow the HTML page to remain responsive. For an example of web workers, see [The Basics of Web Workers](https://www.html5rocks.com/en/tutorials/workers/basics/). See [Web Workers](https://developer.mozilla.org/docs/Web/API/Web_Workers_API) for more information about the Web Workers API.</span></span>

- <span data-ttu-id="7dbd2-219">Si votre complément utilise un algorithme qui sollicite l’UC de manière intensive et si vous pouvez décomposer les entrées ou sorties de données en jeux de données de plus petite taille, créez un service web afin de lui passer les données et d’alléger la charge de l’UC, puis attendez un rappel asynchrone.</span><span class="sxs-lookup"><span data-stu-id="7dbd2-219">If your add-in uses a CPU-intensive algorithm but you can divide the data input or output into smaller sets, consider creating a web service, passing the data to the web service to off-load the CPU, and wait for an asynchronous callback.</span></span>

- <span data-ttu-id="7dbd2-220">Veillez à tester votre complément par rapport au volume de données le plus important possible, puis limitez votre complément pour lui permettre d’atteindre cette limite.</span><span class="sxs-lookup"><span data-stu-id="7dbd2-220">Test your add-in against the highest volume of data you expect, and restrict your add-in to process up to that limit.</span></span>


## <a name="see-also"></a><span data-ttu-id="7dbd2-221">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="7dbd2-221">See also</span></span>

- [<span data-ttu-id="7dbd2-222">Confidentialité et sécurité pour les compléments Office</span><span class="sxs-lookup"><span data-stu-id="7dbd2-222">Privacy and security for Office Add-ins</span></span>](../concepts/privacy-and-security.md)
- [<span data-ttu-id="7dbd2-223">Limites pour l’activation et l’API JavaScript pour les compléments Outlook</span><span class="sxs-lookup"><span data-stu-id="7dbd2-223">Limits for activation and JavaScript API for Outlook add-ins</span></span>](../outlook/limits-for-activation-and-javascript-api-for-outlook-add-ins.md)
- [<span data-ttu-id="7dbd2-224">Optimisation des performances à l’aide de l’API JavaScript d’Excel</span><span class="sxs-lookup"><span data-stu-id="7dbd2-224">Performance optimization using the Excel JavaScript API</span></span>](../excel/performance.md)
