---
title: Ouvrir automatiquement un volet Office avec un document
description: ''
ms.date: 06/20/2019
localization_priority: Priority
ms.openlocfilehash: de848238979b68192bb8646e0ee6cb8d7c3879be
ms.sourcegitcommit: 382e2735a1295da914f2bfc38883e518070cec61
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/21/2019
ms.locfileid: "35127610"
---
# <a name="automatically-open-a-task-pane-with-a-document"></a><span data-ttu-id="17a42-102">Ouvrir automatiquement un volet Office avec un document</span><span class="sxs-lookup"><span data-stu-id="17a42-102">Automatically open a task pane with a document</span></span>

<span data-ttu-id="17a42-p101">Vous pouvez utiliser des commandes de complément dans votre complément Office pour étendre l’interface utilisateur Office en ajoutant des boutons au ruban Office. Lorsque les utilisateurs cliquent sur le bouton de commande, une action est réalisée, comme l’ouverture d’un volet des tâches.</span><span class="sxs-lookup"><span data-stu-id="17a42-p101">You can use add-in commands in your Office Add-in to extend the Office UI by adding buttons to the Office ribbon. When users click your command button, an action occurs, such as opening a task pane.</span></span>

<span data-ttu-id="17a42-105">Certains scénarios nécessitent qu’un volet des tâches s’ouvre automatiquement quand un document s’ouvre, sans intervention explicite de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="17a42-105">Some scenarios require that a task pane open automatically when a document opens, without explicit user interaction.</span></span> <span data-ttu-id="17a42-106">Vous pouvez utiliser la fonctionnalité d’ouverture automatique du volet des tâches, présentée dans l’ensemble des conditions AddInCommands 1.1, pour ouvrir automatiquement un volet des tâches lorsque votre scénario l’exige.</span><span class="sxs-lookup"><span data-stu-id="17a42-106">You can use the autoopen task pane feature, introduced in the AddInCommands 1.1 requirement set, to automatically open a task pane when your scenario requires it.</span></span>


## <a name="how-is-the-autoopen-feature-different-from-inserting-a-task-pane"></a><span data-ttu-id="17a42-107">En quoi la fonctionnalité d’ouverture automatique est-elle différente de l’insertion d’un volet des tâches ?</span><span class="sxs-lookup"><span data-stu-id="17a42-107">How is the autoopen feature different from inserting a task pane?</span></span>

<span data-ttu-id="17a42-p103">Quand un utilisateur lance des compléments qui n’utilisent pas les commandes de complément, par exemple, les compléments qui s’exécutent dans Office 2013, ils sont insérés et conservés dans le document. Par conséquent, lorsque d’autres utilisateurs ouvrent le document, ils sont invités à installer le complément, puis le volet des tâches s’ouvre. La difficulté avec ce modèle est que dans de nombreux cas, les utilisateurs ne veulent pas que le complément soit conservé dans le document. Par exemple, un étudiant qui utilise un complément de dictionnaire dans un document Word ne voudra peut-être pas que ses camarades de classe ou enseignants soient invités à installer ce complément lorsqu’ils ouvrent le document.</span><span class="sxs-lookup"><span data-stu-id="17a42-p103">When a user launches add-ins that don't use add-in commands - for example, add-ins that run in Office 2013 - they are inserted into the document, and persist in that document. As a result, when other users open the document, they are prompted to install the add-in, and the task pane opens. The challenge with this model is that in many cases, users don’t want the add-in to persist in the document. For example, a student who uses a dictionary add-in in a Word document might not want their classmates or teachers to be prompted to install that add-in when they open the document.</span></span>

<span data-ttu-id="17a42-112">Avec la fonctionnalité d’ouverture automatique, vous pouvez explicitement définir ou autoriser l’utilisateur à déterminer si un complément de volet des tâches spécifique est conservé dans un document spécifique.</span><span class="sxs-lookup"><span data-stu-id="17a42-112">With the autoopen feature, you can explicitly define or allow the user to define whether a specific task pane add-in persists in a specific document.</span></span>

## <a name="support-and-availability"></a><span data-ttu-id="17a42-113">Prise en charge et disponibilité</span><span class="sxs-lookup"><span data-stu-id="17a42-113">Support and availability</span></span>

<span data-ttu-id="17a42-114">La fonctionnalité d’ouverture automatique est maintenant</span><span class="sxs-lookup"><span data-stu-id="17a42-114">The autoopen feature is currently</span></span> <!-- in **developer preview** and it is only --> <span data-ttu-id="17a42-115">prise en charge dans les produits et les plateformes suivantes.</span><span class="sxs-lookup"><span data-stu-id="17a42-115">supported in the following products and platforms.</span></span>

|<span data-ttu-id="17a42-116">**Produits**</span><span class="sxs-lookup"><span data-stu-id="17a42-116">**Products**</span></span>|<span data-ttu-id="17a42-117">**Plateformes**</span><span class="sxs-lookup"><span data-stu-id="17a42-117">**Platforms**</span></span>|
|:-----------|:------------|
|<ul><li><span data-ttu-id="17a42-118">Word</span><span class="sxs-lookup"><span data-stu-id="17a42-118">Word</span></span></li><li><span data-ttu-id="17a42-119">Excel</span><span class="sxs-lookup"><span data-stu-id="17a42-119">Excel</span></span></li><li><span data-ttu-id="17a42-120">PowerPoint</span><span class="sxs-lookup"><span data-stu-id="17a42-120">PowerPoint</span></span></li></ul>|<span data-ttu-id="17a42-121">Plateformes prises en charge pour tous les produits :</span><span class="sxs-lookup"><span data-stu-id="17a42-121">Supported platforms for all products:</span></span><ul><li><span data-ttu-id="17a42-p104">Office pour bureau Windows. Build 16.0.8121.1000+</span><span class="sxs-lookup"><span data-stu-id="17a42-p104">Office on Windows Desktop. Build 16.0.8121.1000+</span></span></li><li><span data-ttu-id="17a42-p105">Office sur Mac. Build 15.34.17051500+</span><span class="sxs-lookup"><span data-stu-id="17a42-p105">Office for Mac. Build 15.34.17051500+</span></span></li><li><span data-ttu-id="17a42-126">Office sur le web</span><span class="sxs-lookup"><span data-stu-id="17a42-126">Office on the web</span></span></li></ul>|


## <a name="best-practices"></a><span data-ttu-id="17a42-127">Meilleures pratiques</span><span class="sxs-lookup"><span data-stu-id="17a42-127">Best practices</span></span>

<span data-ttu-id="17a42-128">Appliquez les meilleures pratiques suivantes lorsque vous utilisez la fonctionnalité d’ouverture automatique :</span><span class="sxs-lookup"><span data-stu-id="17a42-128">Apply the following best practices when you use the autoopen feature:</span></span>

- <span data-ttu-id="17a42-129">Utilisez la fonctionnalité d’ouverture automatique quand elle vous aide à rendre vos utilisateurs de complément plus efficaces, comme dans les cas suivants :</span><span class="sxs-lookup"><span data-stu-id="17a42-129">Use the autoopen feature when it will help make your add-in users more efficient, such as:</span></span>
  - <span data-ttu-id="17a42-p106">Lorsque le document a besoin du complément pour fonctionner correctement. Par exemple, une feuille de calcul qui contient des valeurs de stock régulièrement actualisées par un complément. Le complément doit s’ouvrir automatiquement lorsque la feuille de calcul est ouverte pour maintenir les valeurs à jour.</span><span class="sxs-lookup"><span data-stu-id="17a42-p106">When the document needs the add-in in order to function properly. For example, a spreadsheet that includes stock values that are periodically refreshed by an add-in. The add-in should open automatically when the spreadsheet is opened to keep the values up to date.</span></span>
  - <span data-ttu-id="17a42-p107">Lorsque l’utilisateur sera le plus susceptible d’utiliser le complément avec un document particulier. Par exemple, un complément qui permet aux utilisateurs de renseigner ou de modifier des données dans un document en extrayant des informations à partir d’un système principal.</span><span class="sxs-lookup"><span data-stu-id="17a42-p107">When the user will most likely always use the add-in with a particular document. For example, an add-in that helps users fill in or change data in a document by pulling information from a backend system.</span></span>
- <span data-ttu-id="17a42-p108">Autorisez les utilisateurs à activer ou à désactiver la fonctionnalité d’ouverture automatique. Incluez une option dans votre interface utilisateur pour choisir de ne plus ouvrir automatiquement le volet des tâches de complément.</span><span class="sxs-lookup"><span data-stu-id="17a42-p108">Allow users to turn on or turn off the autoopen feature. Include an option in your UI for users to choose to no longer automatically open the add-in task pane.</span></span>  
- <span data-ttu-id="17a42-137">Utilisez la détection de l’ensemble de conditions pour déterminer si la fonctionnalité d’ouverture automatique est disponible, et fournissez un comportement de secours si elle ne l’est pas.</span><span class="sxs-lookup"><span data-stu-id="17a42-137">Use requirement set detection to determine whether the autoopen feature is available, and provide a fallback behavior if it isn’t.</span></span>
- <span data-ttu-id="17a42-p109">N’utilisez pas la fonctionnalité d’ouverture automatique pour augmenter artificiellement l’utilisation de votre complément. Si l’ouverture automatique du complément n’est pas pertinente pour certains documents, cette fonctionnalité peut gêner les utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="17a42-p109">Don't use the autoopen feature to artificially increase usage of your add-in. If it doesn’t make sense for your add-in to open automatically with certain documents, this feature can annoy users.</span></span>

    > [!NOTE]
    > <span data-ttu-id="17a42-140">Si Microsoft détecte un abus de la fonctionnalité d’ouverture automatique, votre complément peut être rejeté d’AppSource.</span><span class="sxs-lookup"><span data-stu-id="17a42-140">If Microsoft detects abuse of the autoopen feature, your add-in might be rejected from AppSource.</span></span>

- <span data-ttu-id="17a42-p110">N’utilisez pas cette fonctionnalité pour épingler plusieurs volets de tâches. Vous pouvez uniquement définir l’ouverture automatique d’un volet de votre complément avec un document.</span><span class="sxs-lookup"><span data-stu-id="17a42-p110">Don't use this feature to pin multiple task panes. You can only set one pane of your add-in to open automatically with a document.</span></span>  

## <a name="implementation"></a><span data-ttu-id="17a42-143">Implémentation</span><span class="sxs-lookup"><span data-stu-id="17a42-143">Implementation</span></span>

<span data-ttu-id="17a42-144">Pour implémenter la fonctionnalité d’ouverture automatique, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="17a42-144">To implement the autoopen feature:</span></span>

- <span data-ttu-id="17a42-145">Spécifiez le volet des tâches à ouvrir automatiquement.</span><span class="sxs-lookup"><span data-stu-id="17a42-145">Specify the task pane to be opened automatically.</span></span>
- <span data-ttu-id="17a42-146">Ajoutez des balises au document pour ouvrir automatiquement le volet des tâches.</span><span class="sxs-lookup"><span data-stu-id="17a42-146">Tag the document to automatically open the task pane.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="17a42-p111">Le volet des tâches à ouvrir automatiquement s’ouvre uniquement si le complément est déjà installé sur l’appareil de l’utilisateur. Si le complément n’est pas installé lorsque l’utilisateur ouvre un document, la fonctionnalité d’ouverture automatique ne fonctionnera pas et le paramètre sera ignoré. Si vous avez également besoin que le complément soit distribué avec le document, vous devez définir la propriété de visibilité sur 1. Cette opération peut uniquement être effectuée à l’aide d’OpenXML. Un exemple est fourni plus loin dans cet article.</span><span class="sxs-lookup"><span data-stu-id="17a42-p111">The pane that you designate to open automatically will only open if the add-in is already installed on the user's device. If the user does not have the add-in installed when they open a document, the autoopen feature will not work and the setting will be ignored. If you also require the add-in to be distributed with the document you need to set the visibility property to 1; this can only be done using OpenXML, an example is provided later in this article.</span></span>

### <a name="step-1-specify-the-task-pane-to-open"></a><span data-ttu-id="17a42-150">Étape 1 : Spécifier le volet des tâches à ouvrir</span><span class="sxs-lookup"><span data-stu-id="17a42-150">Step 1: Specify the task pane to open</span></span>

<span data-ttu-id="17a42-p112">Pour spécifier le volet de tâches à ouvrir automatiquement, définissez la valeur [TaskpaneId](/office/dev/add-ins/reference/manifest/action#taskpaneid) sur **Office.AutoShowTaskpaneWithDocument**. Vous pouvez uniquement définir cette valeur sur un seul volet de tâches. Si vous définissez cette valeur sur plusieurs volets de tâches, la première occurrence de la valeur sera reconnue et les autres seront ignorées.</span><span class="sxs-lookup"><span data-stu-id="17a42-p112">To specify the task pane to open automatically, set the [TaskpaneId](/office/dev/add-ins/reference/manifest/action#taskpaneid) value to **Office.AutoShowTaskpaneWithDocument**. You can only set this value on one task pane. If you set this value on multiple task panes, the first occurrence of the value will be recognized and the others will be ignored.</span></span>

<span data-ttu-id="17a42-154">L’exemple suivant illustre la valeur TaskPaneId définie sur Office.AutoShowTaskpaneWithDocument.</span><span class="sxs-lookup"><span data-stu-id="17a42-154">The following example shows the TaskPaneId value set to Office.AutoShowTaskpaneWithDocument.</span></span>

```xml
<Action xsi:type="ShowTaskpane">
    <TaskpaneId>Office.AutoShowTaskpaneWithDocument</TaskpaneId>
    <SourceLocation resid="Contoso.Taskpane.Url" />
</Action>
```

### <a name="step-2-tag-the-document-to-automatically-open-the-task-pane"></a><span data-ttu-id="17a42-155">Étape 2 : Baliser le document pour ouvrir automatiquement le volet de tâches</span><span class="sxs-lookup"><span data-stu-id="17a42-155">Step 2: Tag the document to automatically open the task pane</span></span>

<span data-ttu-id="17a42-p113">Vous pouvez baliser le document pour déclencher la fonctionnalité d’ouverture automatique de deux façons possibles. Choisissez l’alternative qui convient le mieux à votre scénario.</span><span class="sxs-lookup"><span data-stu-id="17a42-p113">You can tag the document to trigger the autoopen feature in one of two ways. Pick the alternative that works best for your scenario.</span></span>  


#### <a name="tag-the-document-on-the-client-side"></a><span data-ttu-id="17a42-158">Baliser le document côté client</span><span class="sxs-lookup"><span data-stu-id="17a42-158">Tag the document on the client side</span></span>

<span data-ttu-id="17a42-159">Utilisez la méthode Office.js [settings.set](/javascript/api/office/office.settings) pour définir **Office.AutoShowTaskpaneWithDocument** sur **true**, comme illustré dans l’exemple suivant.</span><span class="sxs-lookup"><span data-stu-id="17a42-159">Use the Office.js [settings.set](/javascript/api/office/office.settings) method to set **Office.AutoShowTaskpaneWithDocument** to **true**, as shown in the following example.</span></span>

```js
Office.context.document.settings.set("Office.AutoShowTaskpaneWithDocument", true);
Office.context.document.settings.saveAsync();
```

<span data-ttu-id="17a42-160">Utilisez cette méthode si vous devez baliser le document dans le cadre de vos interactions de complément (par exemple, dès que l’utilisateur crée une liaison ou choisit une option pour indiquer qu’il souhaite que le volet s’ouvre automatiquement).</span><span class="sxs-lookup"><span data-stu-id="17a42-160">Use this method if you need to tag the document as part of your add-in interaction (for example, as soon as the user creates a binding, or chooses an option to indicate that they want the pane to open automatically).</span></span>

#### <a name="use-open-xml-to-tag-the-document"></a><span data-ttu-id="17a42-161">Utiliser Open XML pour baliser le document</span><span class="sxs-lookup"><span data-stu-id="17a42-161">Use Open XML to tag the document</span></span>

<span data-ttu-id="17a42-p114">Vous pouvez utiliser Open XML pour créer ou modifier un document et ajouter le balisage Open Office XML approprié afin de déclencher la fonctionnalité d’ouverture automatique. Pour obtenir un exemple montrant comment procéder, voir [Office-OOXML-EmbedAddin](https://github.com/OfficeDev/Office-OOXML-EmbedAddin).</span><span class="sxs-lookup"><span data-stu-id="17a42-p114">You can use Open XML to create or modify a document and add the appropriate Open Office XML markup to trigger the autoopen feature. For a sample that shows you how to do this, see [Office-OOXML-EmbedAddin](https://github.com/OfficeDev/Office-OOXML-EmbedAddin).</span></span>

<span data-ttu-id="17a42-164">Ajoutez deux composants Open XML dans le document :</span><span class="sxs-lookup"><span data-stu-id="17a42-164">Add two Open XML parts to the document:</span></span>

- <span data-ttu-id="17a42-165">Un composant `webextension`</span><span class="sxs-lookup"><span data-stu-id="17a42-165">A `webextension` part</span></span>
- <span data-ttu-id="17a42-166">Un composant `taskpane`</span><span class="sxs-lookup"><span data-stu-id="17a42-166">A `taskpane` part</span></span>

<span data-ttu-id="17a42-167">L’exemple suivant montre comment ajouter le composant `webextension`.</span><span class="sxs-lookup"><span data-stu-id="17a42-167">The following example shows how to add the `webextension` part.</span></span>

```xml
<we:webextension xmlns:we="http://schemas.microsoft.com/office/webextensions/webextension/2010/11" id="[ADD-IN ID PER MANIFEST]">
  <we:reference id="[GUID or AppSource asset ID]" version="[your add-in version]" store="[Pointer to store or catalog]" storeType="[Store or catalog type]"/>
  <we:alternateReferences/>
  <we:properties>
   <we:property name="Office.AutoShowTaskpaneWithDocument" value="true"/>
  </we:properties>
  <we:bindings/>
  <we:snapshot xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"/>
</we:webextension>
```

<span data-ttu-id="17a42-168">Le composant `webextension` inclut un conteneur de propriétés et une propriété nommée **Office.AutoShowTaskpaneWithDocument** qui doit être définie sur `true`.</span><span class="sxs-lookup"><span data-stu-id="17a42-168">The `webextension` part includes a property bag and a property named **Office.AutoShowTaskpaneWithDocument** that must be set to `true`.</span></span>

<span data-ttu-id="17a42-169">Le composant `webextension` comprend également une référence au store ou au catalogue avec des attributs pour `id`, `storeType`, `store` et `version`.</span><span class="sxs-lookup"><span data-stu-id="17a42-169">The `webextension` part also includes a reference to the store or catalog with attributes for `id`, `storeType`, `store`, and `version`.</span></span> <span data-ttu-id="17a42-170">Parmi les valeurs `storeType`, uniquement quatre sont pertinentes pour la fonctionnalité d’ouverture automatique.</span><span class="sxs-lookup"><span data-stu-id="17a42-170">Of the `storeType` values, only four are relevant to the autoopen feature.</span></span> <span data-ttu-id="17a42-171">Les valeurs pour les trois autres attributs dépendent de la valeur pour `storeType`, comme illustré dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="17a42-171">The values for the other three attributes depend on the value for `storeType`, as shown in the following table.</span></span>

| <span data-ttu-id="17a42-172">**`storeType`valeur**</span><span class="sxs-lookup"><span data-stu-id="17a42-172">**`storeType` value**</span></span> | <span data-ttu-id="17a42-173">**`id`valeur**</span><span class="sxs-lookup"><span data-stu-id="17a42-173">**`id` value**</span></span>    |<span data-ttu-id="17a42-174">**`store`valeur**</span><span class="sxs-lookup"><span data-stu-id="17a42-174">**`store` value**</span></span> | <span data-ttu-id="17a42-175">**`version`valeur**</span><span class="sxs-lookup"><span data-stu-id="17a42-175">**`version` value**</span></span>|
|:---------------|:---------------|:---------------|:---------------|
|<span data-ttu-id="17a42-176">OMEX (AppSource)</span><span class="sxs-lookup"><span data-stu-id="17a42-176">OMEX (AppSource)</span></span>|<span data-ttu-id="17a42-177">L’ID de la ressource AppSource du complément (voir la remarque).</span><span class="sxs-lookup"><span data-stu-id="17a42-177">The AppSource asset ID of the add-in (see Note)</span></span>|<span data-ttu-id="17a42-178">Les paramètres régionaux d’AppSource ; par exemple, « fr-fr ».</span><span class="sxs-lookup"><span data-stu-id="17a42-178">The locale of AppSource; for example, "en-us".</span></span>|<span data-ttu-id="17a42-179">La version dans le catalogue AppSource (voir la remarque).</span><span class="sxs-lookup"><span data-stu-id="17a42-179">The version in the AppSource catalog (see Note)</span></span>|
|<span data-ttu-id="17a42-180">Système de fichiers (un partage réseau)</span><span class="sxs-lookup"><span data-stu-id="17a42-180">FileSystem (a network share)</span></span>|<span data-ttu-id="17a42-181">Le GUID du complément dans le manifeste de complément.</span><span class="sxs-lookup"><span data-stu-id="17a42-181">The GUID of the add-in in the add-in manifest.</span></span>|<span data-ttu-id="17a42-182">Le chemin du partage réseau ; par exemple, « \\\\MyComputer\\MySharedFolder ».</span><span class="sxs-lookup"><span data-stu-id="17a42-182">The path of the network share; for example, "\\\\MyComputer\\MySharedFolder".</span></span>|<span data-ttu-id="17a42-183">La version dans le manifeste de complément.</span><span class="sxs-lookup"><span data-stu-id="17a42-183">The version in the add-in manifest.</span></span>|
|<span data-ttu-id="17a42-184">EXCatalog (déploiement via le serveur Exchange)</span><span class="sxs-lookup"><span data-stu-id="17a42-184">EXCatalog (deployment via the Exchange server)</span></span> |<span data-ttu-id="17a42-185">Le GUID du complément dans le manifeste de complément.</span><span class="sxs-lookup"><span data-stu-id="17a42-185">The GUID of the add-in in the add-in manifest.</span></span>|<span data-ttu-id="17a42-186">« EXCatalog »</span><span class="sxs-lookup"><span data-stu-id="17a42-186">"EXCatalog".</span></span> <span data-ttu-id="17a42-187">La ligne EXCatalog est celle à utiliser avec les compléments qui utilisent le déploiement centralisé dans le centre d’administration Office 365.</span><span class="sxs-lookup"><span data-stu-id="17a42-187">EXCatalog row is the row to use with add-ins that use Centralized Deployment in the Office 365 admin center.</span></span>|<span data-ttu-id="17a42-188">La version dans le manifeste de complément.</span><span class="sxs-lookup"><span data-stu-id="17a42-188">The version in the add-in manifest.</span></span>
|<span data-ttu-id="17a42-189">Registre (Registre système)</span><span class="sxs-lookup"><span data-stu-id="17a42-189">Registry (System registry)</span></span>|<span data-ttu-id="17a42-190">Le GUID du complément dans le manifeste de complément.</span><span class="sxs-lookup"><span data-stu-id="17a42-190">The GUID of the add-in in the add-in manifest.</span></span>|<span data-ttu-id="17a42-191">« développeur »</span><span class="sxs-lookup"><span data-stu-id="17a42-191">"developer"</span></span>|<span data-ttu-id="17a42-192">La version dans le manifeste de complément.</span><span class="sxs-lookup"><span data-stu-id="17a42-192">The version in the add-in manifest.</span></span>|

> [!NOTE]
> <span data-ttu-id="17a42-p117">Pour trouver l’ID de ressource et la version d’un complément dans AppSource, accédez à la page d’accueil d’AppSource pour le complément. L’ID de ressource apparaît dans la barre d’adresse dans le navigateur. La version est répertoriée dans la section **Détails** de la page.</span><span class="sxs-lookup"><span data-stu-id="17a42-p117">To find the asset ID and version of an add-in in AppSource, go to the AppSource landing page for the add-in. The asset ID appears in the address bar in the browser. The version is listed in the **Details** section of the page.</span></span>

<span data-ttu-id="17a42-196">Pour plus d’informations sur le balisage webextension, reportez-vous à [[MS-OWEXML] 2.2.5. WebExtensionReference](https://msdn.microsoft.com/library/hh695383(v=office.12).aspx).</span><span class="sxs-lookup"><span data-stu-id="17a42-196">For more information about the webextension markup, see [[MS-OWEXML] 2.2.5. WebExtensionReference](https://msdn.microsoft.com/library/hh695383(v=office.12).aspx).</span></span>

<span data-ttu-id="17a42-197">L’exemple suivant montre comment ajouter le composant `taskpane`.</span><span class="sxs-lookup"><span data-stu-id="17a42-197">The following example shows how to add the `taskpane` part.</span></span>

```xml
<wetp:taskpane dockstate="right" visibility="0" width="350" row="4" xmlns:wetp="http://schemas.microsoft.com/office/webextensions/taskpanes/2010/11">
  <wetp:webextensionref xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" r:id="rId1" />
</wetp:taskpane>
```

<span data-ttu-id="17a42-198">Notez que dans cet exemple, l’attribut `visibility` est défini sur « 0 ».</span><span class="sxs-lookup"><span data-stu-id="17a42-198">Note that in this example, the `visibility` attribute is set to "0".</span></span> <span data-ttu-id="17a42-199">Ainsi, après l’ajout des composants `taskpane` et du volet de tâches, l’utilisateur doit installer le complément via le bouton **Complément** sur le ruban lorsqu’il ouvre le document pour la première fois.</span><span class="sxs-lookup"><span data-stu-id="17a42-199">This means that after the webextension and `taskpane` parts are added, the first time the document is opened, the user has to install the add-in from the **Add-in** button on the ribbon.</span></span> <span data-ttu-id="17a42-200">Par la suite, le volet de tâches de complément s’ouvre automatiquement lorsque le fichier est ouvert.</span><span class="sxs-lookup"><span data-stu-id="17a42-200">Thereafter, the add-in task pane opens automatically when the file is opened.</span></span> <span data-ttu-id="17a42-201">En outre, lorsque vous définissez `visibility` sur « 0 », vous pouvez utiliser Office.js pour autoriser les utilisateurs à activer ou à désactiver la fonctionnalité d’ouverture automatique.</span><span class="sxs-lookup"><span data-stu-id="17a42-201">Also, when you set `visibility` to "0", you can use Office.js to enable users to turn on or turn off the autoopen feature.</span></span> <span data-ttu-id="17a42-202">Plus spécifiquement, le script définit le paramètre de document **Office.AutoShowTaskpaneWithDocument** sur `true` ou `false`.</span><span class="sxs-lookup"><span data-stu-id="17a42-202">Specifically, your script sets the **Office.AutoShowTaskpaneWithDocument** document setting to `true` or `false`.</span></span> <span data-ttu-id="17a42-203">(Pour plus d’informations, reportez-vous à la section [Baliser le document côté client](#tag-the-document-on-the-client-side).)</span><span class="sxs-lookup"><span data-stu-id="17a42-203">(For details, see [Tag the document on the client side](#tag-the-document-on-the-client-side).)</span></span>

<span data-ttu-id="17a42-p119">Si `visibility` est défini sur « 1 », le volet de tâches s’ouvre automatiquement à la première ouverture du document. L’utilisateur est invité à approuver le complément. Lorsque ce dernier est approuvé, le complément s’ouvre. Par la suite, le volet de tâches de complément s’ouvre automatiquement lorsque le fichier est ouvert. Toutefois, lorsque `visibility` est défini sur « 1 », vous ne pouvez pas utiliser Office.js pour autoriser les utilisateurs à activer ou à désactiver la fonctionnalité d’ouverture automatique.</span><span class="sxs-lookup"><span data-stu-id="17a42-p119">If `visibility` is set to "1", the task pane opens automatically the first time the document is opened. The user is prompted to trust the add-in, and when trust is granted, the add-in opens. Thereafter, the add-in task pane opens automatically when the file is opened. However, when `visibility` is set to "1", you can't use Office.js to enable users to turn on or turn off the autoopen feature.</span></span>

<span data-ttu-id="17a42-208">Définir `visibility` sur « 1 » est un bon choix lorsque le complément et le modèle ou contenu du document sont tellement étroitement intégrés que l’utilisateur ne choisirait pas de désactiver la fonctionnalité d’ouverture automatique.</span><span class="sxs-lookup"><span data-stu-id="17a42-208">Setting `visibility` to "1" is a good choice when the add-in and the template or content of the document are so closely integrated that the user would not opt out of the autoopen feature.</span></span>

> [!NOTE]
> <span data-ttu-id="17a42-p120">Si vous voulez distribuer votre complément avec le document, pour que les utilisateurs soient invités à l’installer, vous devez définir la propriété de visibilité sur 1. Cette opération peut uniquement être effectuée à l’aide d’Open XML.</span><span class="sxs-lookup"><span data-stu-id="17a42-p120">If you want to distribute your add-in with the document, so that users are prompted to install it, you must set the visibility property to 1. You can only do this via Open XML.</span></span>

<span data-ttu-id="17a42-p121">Une méthode simple d’écriture du code XML consiste à exécuter d’abord votre complément, puis à [baliser le document côté client](#tag-the-document-on-the-client-side) pour écrire la valeur, à enregistrer le document et à inspecter le code XML généré. Office détectera et fournira les valeurs d’attribut appropriées. Vous pouvez également utiliser l’outil de productivité [Kit de développement logiciel Open XML 2.5](https://www.microsoft.com/download/details.aspx?id=30425) pour générer le code C# pour ajouter par programme le balisage en fonction du XML vous générez.</span><span class="sxs-lookup"><span data-stu-id="17a42-p121">An easy way to write the XML is to first run your add-in and [tag the document on the client side](#tag-the-document-on-the-client-side) to write the value, and then save the document and inspect the XML that is generated. Office will detect and provide the appropriate attribute values. You can also use the [Open XML SDK 2.5 Productivity Tool](https://www.microsoft.com/download/details.aspx?id=30425) tool to generate C# code to programmatically add the markup based on the XML you generate.</span></span>

## <a name="test-and-verify-opening-task-panes"></a><span data-ttu-id="17a42-214">Tester et vérifier l’ouverture des volets Office</span><span class="sxs-lookup"><span data-stu-id="17a42-214">Test and verify opening task panes</span></span>

<span data-ttu-id="17a42-215">Vous pouvez déployer une version de test de votre complément qui ouvrira automatiquement un volet Office à l’aide du déploiement centralisé via le centre d’administration Office 365.</span><span class="sxs-lookup"><span data-stu-id="17a42-215">You can deploy a test version of your add-in that will automatically open a task pane using Centralized Deployment via the Office 365 admin center.</span></span> <span data-ttu-id="17a42-216">L’exemple suivant montre la façon dont les compléments sont insérés à partir du catalogue de déploiement centralisé à l’aide de la version store d’EXCatalog.</span><span class="sxs-lookup"><span data-stu-id="17a42-216">The following example shows how add-ins are inserted from the Centralized Deployment catalog using the EXCatalog store version.</span></span>

```xml
<we:webextension xmlns:we="http://schemas.microsoft.com/office/webextensions/webextension/2010/11" id="{52811C31-4593-43B8-A697-EB873422D156}">
    <we:reference id="af8fa5ba-4010-4bcc-9e03-a91ddadf6dd3" version="1.0.0.0" store="EXCatalog" storeType="EXCatalog"/>
    <we:alternateReferences/>
    <we:properties/>
    <we:bindings/>
    <we:snapshot xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"/>
</we:webextension>
```

<span data-ttu-id="17a42-217">Pour tester l’exemple précédent, songez éventuellement à rejoindre le [programme pour les développeurs Office 365](/office/developer-program/office-365-developer-program) et à créer un [compte développeur Office 365](https://developer.microsoft.com/office/dev-program) si vous ne possédez pas déjà un abonnement Office 365.</span><span class="sxs-lookup"><span data-stu-id="17a42-217">To test the previous example, please consider joining the [Office 365 Developer Program](/office/developer-program/office-365-developer-program) and signing up for an [Office 365 developer account](https://developer.microsoft.com/office/dev-program) if you don't already own an Office 365 subscription.</span></span> <span data-ttu-id="17a42-218">Vous pouvez essayer le déploiement centralisé en conditions réelles et vérifier que votre complément fonctionne comme prévu.</span><span class="sxs-lookup"><span data-stu-id="17a42-218">You can actually test drive Centralized Deployment and verify that your add-in works as expected.</span></span>


## <a name="see-also"></a><span data-ttu-id="17a42-219">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="17a42-219">See also</span></span>

<span data-ttu-id="17a42-220">Pour voir un exemple illustrant comment utiliser la fonctionnalité d’ouverture automatique, reportez-vous à [Exemples de commandes de complément Office](https://github.com/OfficeDev/Office-Add-in-Commands-Samples/tree/master/AutoOpenTaskpane).</span><span class="sxs-lookup"><span data-stu-id="17a42-220">For a sample that shows you how to use the autoopen feature, see [Office Add-in commands samples](https://github.com/OfficeDev/Office-Add-in-Commands-Samples/tree/master/AutoOpenTaskpane).</span></span>
<span data-ttu-id="17a42-221">[Rejoindre le programme pour les développeurs Office 365](/office/developer-program/office-365-developer-program).</span><span class="sxs-lookup"><span data-stu-id="17a42-221">[Join the Office 365 developer program](/office/developer-program/office-365-developer-program).</span></span>
