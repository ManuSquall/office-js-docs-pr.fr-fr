---
title: Autoriser des services externes dans votre compl?ment Office
description: ''
ms.date: 12/04/2017
ms.openlocfilehash: 34e8119d4ecf6432cde7f06552584d164b8c9b8e
ms.sourcegitcommit: c72c35e8389c47a795afbac1b2bcf98c8e216d82
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/23/2018
---
# <a name="authorize-external-services-in-your-office-add-in"></a><span data-ttu-id="56d62-102">Autoriser des services externes dans votre compl?ment Office</span><span class="sxs-lookup"><span data-stu-id="56d62-102">Authorize external services in your Office Add-in</span></span>

<span data-ttu-id="56d62-p101">Les services en ligne populaires, y compris Office 365, Google, Facebook, LinkedIn, SalesForce et GitHub, permettent aux d?veloppeurs d?accorder aux utilisateurs l?acc?s ? leurs comptes dans d?autres applications. Vous avez ainsi la possibilit? d?inclure ces services dans votre compl?ment Office.</span><span class="sxs-lookup"><span data-stu-id="56d62-p101">Popular online services, including Office 365, Google, Facebook, LinkedIn, SalesForce, and GitHub, let developers give users access to their accounts in other applications. This gives you the ability to include these services in your Office Add-in.</span></span>

<span data-ttu-id="56d62-p102">L?infrastructure standard dans le secteur permettant d?activer l?acc?s d?une application web ? un service en ligne est appel?e **OAuth 2.0**. En r?gle g?n?rale, vous n?avez pas besoin de conna?tre les d?tails du fonctionnement de l?infrastructure pour pouvoir l?utiliser dans votre compl?ment. Ces d?tails sont simplifi?s pour vous dans de nombreuses biblioth?ques disponibles.</span><span class="sxs-lookup"><span data-stu-id="56d62-p102">The industry standard framework for enabling web application access to an online service is **OAuth 2.0**. In most situations, you don't need to know the details of how the framework works to use it in your add-in. Many libraries are available that simplify the details for you.</span></span>

<span data-ttu-id="56d62-p103">L?un des fondements d?OAuth est qu?une application peut ?tre un principal de s?curit? en elle-m?me, de la m?me fa?on qu?un utilisateur ou un groupe, avec sa propre identit? et son ensemble d?autorisations. Dans les sc?narios les plus courants, lorsque l?utilisateur ex?cute une action dans le compl?ment Office ayant besoin du service en ligne, le compl?ment envoie une demande au service portant sur un ensemble sp?cifique d?autorisations pour le compte de l?utilisateur. Le service invite ensuite l?utilisateur ? octroyer ces autorisations au compl?ment. Une fois que les autorisations sont accord?es, le service envoie un petit *jeton d?acc?s* cod? au compl?ment. Le compl?ment peut utiliser le service en incluant le jeton dans toutes ses demandes aux API du service. Toutefois, le compl?ment agit uniquement dans la limite des autorisations que l?utilisateur lui a accord?es. En outre, le jeton expire apr?s un certain d?lai.</span><span class="sxs-lookup"><span data-stu-id="56d62-p103">A fundamental idea of OAuth is that an application can be a security principal unto itself, just like a user or a group, with its own identity and set of permissions. In the most typical scenarios, when the user takes an action in the Office add-in that requires the online service, the add-in sends the service a request for a specific set of permissions to the user's account. The service then prompts the user to grant the add-in those permissions. After the permissions are granted, the service sends the add-in a small encoded *access token*. The add-in can use the service by including the token in all its requests to the service's APIs. But the add-in can act only within the permissions that the user granted it. The token also expires after a specified time.</span></span>

<span data-ttu-id="56d62-115">Plusieurs mod?les OAuth, appel?s *flux* ou *types d?acc?s accord?*, sont con?us pour diff?rents sc?narios.</span><span class="sxs-lookup"><span data-stu-id="56d62-115">Several OAuth patterns, called *flows* or *grant types*, are designed for different scenarios.</span></span> <span data-ttu-id="56d62-116">Les deux mod?les suivants sont les plus couramment impl?ment?s :</span><span class="sxs-lookup"><span data-stu-id="56d62-116">The following two patterns are the most commonly implemented:</span></span>

- <span data-ttu-id="56d62-117">**Flux implicite** : la communication entre le compl?ment et le service en ligne est mise en ?uvre avec JavaScript c?t? client.</span><span class="sxs-lookup"><span data-stu-id="56d62-117">**Implicit flow**: Communication between the add-in and the online service is implemented with client-side JavaScript.</span></span>
- <span data-ttu-id="56d62-p105">**Flux de code d?autorisation** : la communication est effectu?e de *serveur ? serveur* entre l?application web de votre compl?ment et le service en ligne. Par cons?quent, elle est mise en ?uvre avec du code c?t? serveur.</span><span class="sxs-lookup"><span data-stu-id="56d62-p105">**Authorization Code flow**: Communication is *server-to-server* between your add-in's web application and the online service. So, it is implemented with server-side code.</span></span>

<span data-ttu-id="56d62-p106">L?objectif d?un flux OAuth est de s?curiser l?identit? et l?autorisation de l?application. Dans le flux de code d?autorisation, une *cl? secr?te client* devant rester masqu?e vous est fournie. Comme une application monopage (SPA) ne permet pas de prot?ger la cl? secr?te, nous vous recommandons d?utiliser le flux implicite dans ce type d?application.</span><span class="sxs-lookup"><span data-stu-id="56d62-p106">The purpose of an OAuth flow is to secure the identity and authorization of the application. In the Authorization Code flow, you're provided a *client secret* that needs to be kept hidden. A Single Page Application (SPA) has no way to protect the secret, so we recommend that you use the Implicit flow in SPAs.</span></span>

<span data-ttu-id="56d62-123">Vous devez ?tre familiaris? avec les avantages et inconv?nients du flux implicite et du flux de code d?autorisation.</span><span class="sxs-lookup"><span data-stu-id="56d62-123">You should be familiar with the pros and cons of the Implicit flow and the Authorization Code flow.</span></span> <span data-ttu-id="56d62-124">Pour plus d?informations sur ces deux flux, reportez-vous ? [Code d?autorisation](https://tools.ietf.org/html/rfc6749#section-1.3.1) et [Implicite](https://tools.ietf.org/html/rfc6749#section-1.3.2).</span><span class="sxs-lookup"><span data-stu-id="56d62-124">For more infomation about these two flows, see [Authorization Code](https://tools.ietf.org/html/rfc6749#section-1.3.1) and [Implicit](https://tools.ietf.org/html/rfc6749#section-1.3.2).</span></span>

> [!NOTE]
> <span data-ttu-id="56d62-125">Vous avez aussi la possibilit? de charger un service interm?diaire d?effectuer tout ce qui concerne les autorisations et de transmettre le jeton d?acc?s ? votre compl?ment.</span><span class="sxs-lookup"><span data-stu-id="56d62-125">You also have the option of using a middleman service to perform authorization and pass the access token to your add-in.</span></span> <span data-ttu-id="56d62-126">Pour plus d?informations sur ce sc?nario, consultez la rubrique **Services interm?diaires** plus loin dans cet article.</span><span class="sxs-lookup"><span data-stu-id="56d62-126">For details about this scenario, see the **Middleman services** section later in this article.</span></span>

## <a name="authorization-to-microsoft-graph"></a><span data-ttu-id="56d62-127">Autorisation d?acc?s ? Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="56d62-127">Authorization to Microsoft Graph</span></span>

<span data-ttu-id="56d62-128">Si le service externe est accessible via Microsoft Graph, par exemple Office 365 ou OneDrive, vous pouvez fournir ? vos utilisateurs la meilleure exp?rience possible tout en profitant vous-m?me d?une exp?rience de d?veloppement la plus simple possible, en utilisant le syst?me d?authentification unique d?crit sur la page [Autoriser Microsoft Graph dans vos compl?ments Office](authorize-to-microsoft-graph.md) et ses articles connexes.</span><span class="sxs-lookup"><span data-stu-id="56d62-128">If the external service is accessible through Microsoft Graph, such as Office 365 or OneDrive, then you can provide the best experience for your users, and the easiest development experience for yourself, by using the single sign-on system described at [Enable single sign-on for Office Add-ins](authorize-to-microsoft-graph.md) and its related articles.</span></span> <span data-ttu-id="56d62-129">Les techniques d?crites dans cet article trouvent leur meilleur usage dans des services externes qui ne sont pas accessibles avec Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="56d62-129">The techniques described in this article are best used for external services that are not accessible with Microsoft Graph.</span></span> <span data-ttu-id="56d62-130">Toutefois, elles *peuvent* ?tre utilis?es pour acc?der ? Microsoft Graph, et vous pouvez pr?f?rer leurs avantages ? ceux de l?authentification unique.</span><span class="sxs-lookup"><span data-stu-id="56d62-130">However, they *can* be used to access Microsoft Graph, and you might prefer them to the advantages of single sign-on.</span></span> <span data-ttu-id="56d62-131">Par exemple, le syst?me d?authentification unique requiert un code c?t? serveur, et ne peut donc pas ?tre utilis? dans une application web monopage.</span><span class="sxs-lookup"><span data-stu-id="56d62-131">For example, the single sign-on system requires server-side code, so it cannot be used with a true single page app.</span></span> <span data-ttu-id="56d62-132">En outre, le syst?me de l?authentification unique n?est pas encore pris en charge sur toutes les plateformes.</span><span class="sxs-lookup"><span data-stu-id="56d62-132">Also, the single sign-on system is not yet supported on all platforms.</span></span>

## <a name="using-the-implicit-flow-in-office-add-ins"></a><span data-ttu-id="56d62-133">Utilisation du flux implicite dans des compl?ments Office</span><span class="sxs-lookup"><span data-stu-id="56d62-133">Using the Implicit flow in Office Add-ins</span></span>
<span data-ttu-id="56d62-134">La meilleure fa?on de d?terminer si un service en ligne prend en charge le flux implicite est de consulter la documentation.</span><span class="sxs-lookup"><span data-stu-id="56d62-134">The best way to find out if an online service supports the Implicit flow is to consult the service's documentation.</span></span> <span data-ttu-id="56d62-135">Pour les services qui prennent en charge le flux implicite, vous pouvez charger la biblioth?que JavaScript **Office-js-helpers** d?effectuer ? votre place toutes les t?ches d?taill?es :</span><span class="sxs-lookup"><span data-stu-id="56d62-135">For services that support the Implicit flow, you can use the **Office-js-helpers** JavaScript library to do all the detailed work for you:</span></span>

- [<span data-ttu-id="56d62-136">Office-js-helpers</span><span class="sxs-lookup"><span data-stu-id="56d62-136">Office-js-helpers</span></span>](https://github.com/OfficeDev/office-js-helpers)

<span data-ttu-id="56d62-137">Pour plus d?informations sur les autres biblioth?ques prenant en charge le flux implicite, consultez la rubrique **biblioth?ques** plus loin dans cet article.</span><span class="sxs-lookup"><span data-stu-id="56d62-137">For information about other libraries that support the Implicit flow, see the **Libraries** section later in this article.</span></span>

## <a name="using-the-authorization-code-flow-in-office-add-ins"></a><span data-ttu-id="56d62-138">Utilisation du flux de code d?autorisation dans les compl?ments Office</span><span class="sxs-lookup"><span data-stu-id="56d62-138">Using the Authorization Code flow in Office Add-ins</span></span>

<span data-ttu-id="56d62-p111">De nombreuses biblioth?ques sont disponibles pour l?impl?mentation du flux de code d?autorisation dans diff?rentes langues et infrastructures. Pour plus d?informations sur ces biblioth?ques, reportez-vous ? la section **Biblioth?ques** plus loin dans cet article.</span><span class="sxs-lookup"><span data-stu-id="56d62-p111">Many libraries are available for implementing the Authorization Code flow in various languages and frameworks. For more information about some of these libraries, see the **Libraries** section later in this article.</span></span>

<span data-ttu-id="56d62-141">Les aper?us suivants fournissent des exemples de compl?ments qui impl?mentent le flux de code d?autorisation :</span><span class="sxs-lookup"><span data-stu-id="56d62-141">The following samples provide examples of add-ins that implement the Authorization Code flow:</span></span>

- <span data-ttu-id="56d62-142">[Office-Add-in-Nodejs-ServerAuth](https://github.com/OfficeDev/Office-Add-in-Nodejs-ServerAuth) (NodeJS)</span><span class="sxs-lookup"><span data-stu-id="56d62-142">[Office-Add-in-Nodejs-ServerAuth](https://github.com/OfficeDev/Office-Add-in-Nodejs-ServerAuth) (NodeJS)</span></span>
- <span data-ttu-id="56d62-143">[PowerPoint-Add-in-Microsoft-Graph-ASPNET-InsertChart](https://github.com/OfficeDev/PowerPoint-Add-in-Microsoft-Graph-ASPNET-InsertChart) (ASP.NET MVC)</span><span class="sxs-lookup"><span data-stu-id="56d62-143">[PowerPoint-Add-in-Microsoft-Graph-ASPNET-InsertChart](https://github.com/OfficeDev/PowerPoint-Add-in-Microsoft-Graph-ASPNET-InsertChart) (ASP.NET MVC)</span></span>

### <a name="relayproxy-functions"></a><span data-ttu-id="56d62-144">Fonctions de relais/proxy</span><span class="sxs-lookup"><span data-stu-id="56d62-144">Relay/Proxy functions</span></span>

<span data-ttu-id="56d62-p112">Vous pouvez utiliser le flux de code d?autorisation m?me avec une application web sans serveur en stockant les valeurs d?**identifiant client** et de **cl? secr?te client** dans une fonction simple, h?berg?e dans un service tel qu?[Azure Functions](https://azure.microsoft.com/en-us/services/functions) ou [Amazon Lambda](https://aws.amazon.com/lambda). La fonction remplace un code donn? par un **jeton d?acc?s** et le transmet au client. La s?curit? de cette approche d?pend de la surveillance de l?acc?s ? la fonction.</span><span class="sxs-lookup"><span data-stu-id="56d62-p112">You can use the Authorization Code flow even with a serverless web application by storing the **client ID** and **client secret** values in a simple function that is hosted in a service such as [Azure Functions](https://azure.microsoft.com/en-us/services/functions) or [Amazon Lambda](https://aws.amazon.com/lambda). The function exchanges a given code for an **access token** and relays it back to the client. The security of this approach depends on how well access to the function is guarded.</span></span>

<span data-ttu-id="56d62-p113">Pour utiliser cette technique, votre compl?ment ouvre une interface utilisateur/un menu contextuel pour afficher l??cran de connexion au service en ligne (Google, Facebook, etc.). Lorsque l?utilisateur est connect? et accorde l?autorisation au compl?ment d?acc?der ? ses ressources dans le service en ligne, le compl?ment re?oit un code qui peut ?tre envoy? ? la fonction en ligne. Les services d?crits dans la section **Services interm?diaires** plus loin dans cet article utilisent un flux semblable ? celui-ci.</span><span class="sxs-lookup"><span data-stu-id="56d62-p113">To use this technique, your add-in displays a UI/popup to show the login screen for the online service (Google, Facebook, and so on). When the user signs in and grants the add-in permission to her resources in the online service, the add-in receives a code which can be then sent to the online function. The services described in the **Middleman services** section later in this article use a similar flow.</span></span>

## <a name="libraries"></a><span data-ttu-id="56d62-151">Biblioth?ques</span><span class="sxs-lookup"><span data-stu-id="56d62-151">Libraries</span></span>

<span data-ttu-id="56d62-152">Des biblioth?ques sont disponibles dans de nombreuses langues et sur de nombreuses plateformes, aussi bien pour le flux implicite que pour le flux de code d?autorisation.</span><span class="sxs-lookup"><span data-stu-id="56d62-152">Libraries are available for many languages and platforms, for both the Implicit flow and the Authorization Code flow.</span></span> <span data-ttu-id="56d62-153">Certaines sont destin?es ? un usage g?n?ral, d?autres sont propres ? des services en ligne bien sp?cifiques.</span><span class="sxs-lookup"><span data-stu-id="56d62-153">Some libraries are general purpose, while others are for specific online services.</span></span>

<span data-ttu-id="56d62-p115">**Office 365 et autres services utilisant Azure Active Directory en tant que fournisseur d?autorisation** : [biblioth?ques d?authentification Azure Active Directory](https://azure.microsoft.com/en-us/documentation/articles/active-directory-authentication-libraries/). Un aper?u est ?galement disponible pour la [biblioth?que d?authentification Microsoft](https://www.nuget.org/packages/Microsoft.Identity.Client).</span><span class="sxs-lookup"><span data-stu-id="56d62-p115">**Office 365 and other services that use Azure Active Directory as the authorization provider**: [Azure Active Directory Authentication Libraries](https://azure.microsoft.com/en-us/documentation/articles/active-directory-authentication-libraries/). A preview is also available for the [Microsoft Authentication Library](https://www.nuget.org/packages/Microsoft.Identity.Client).</span></span>

<span data-ttu-id="56d62-p116">**Google** : cherchez ? auth ? ou le nom de votre langue sur [GitHub.com/Google](https://github.com/google). La plupart des r?f?rentiels pertinents sont nomm?s `google-auth-library-[name of language]`.</span><span class="sxs-lookup"><span data-stu-id="56d62-p116">**Google**: Search [GitHub.com/Google](https://github.com/google) for "auth" or the name of your language. Most of the relevant repos are named `google-auth-library-[name of language]`.</span></span>

<span data-ttu-id="56d62-158">**Facebook** : cherchez ? biblioth?que ? ou ? sdk ? sur le site [Facebook pour les d?veloppeurs](https://developers.facebook.com).</span><span class="sxs-lookup"><span data-stu-id="56d62-158">**Facebook**: Search [Facebook for Developers](https://developers.facebook.com) for "library" or "sdk".</span></span>

<span data-ttu-id="56d62-p117">**OAuth 2.0 g?n?ral** : une page contenant des liens vers des biblioth?ques pour plus d?une dizaine de langues est conserv?e par le groupe de travail OAuth de l?IETF sur une page relative au [code OAuth](http://oauth.net/code/). Notez que certaines de ces biblioth?ques sont destin?es ? l?impl?mentation d?un service compatible OAuth. Les biblioth?ques qui vous sont utiles en tant que d?veloppeur de compl?ments sont appel?es biblioth?ques *client* sur cette page car votre serveur web est un client du service compatible OAuth.</span><span class="sxs-lookup"><span data-stu-id="56d62-p117">**General OAuth 2.0**: A page of links to libraries for over a dozen languages is maintained by the IETF OAuth Working Group at: [OAuth Code](http://oauth.net/code/). Note that some of these libraries are for implementing an OAuth compliant service. The libraries of interest to you as a an add-in developer are called *client* libraries on this page because your web server is a client of the OAuth compliant service.</span></span>

## <a name="middleman-services"></a><span data-ttu-id="56d62-162">Services interm?diaires</span><span class="sxs-lookup"><span data-stu-id="56d62-162">Middleman services</span></span>

<span data-ttu-id="56d62-p118">Votre compl?ment peut utiliser un service interm?diaire tel qu?OAuth.io ou Auth0 pour g?rer des autorisations. Un service interm?diaire peut fournir des jetons d?acc?s pour de nombreux services en ligne populaires ou simplifier la proc?dure de connexion aux r?seaux sociaux pour votre compl?ment, ou qui effectue ces deux op?rations. Avec tr?s peu de code, votre compl?ment peut utiliser un script c?t? client ou du code c?t? serveur pour se connecter au service interm?diaire et envoyer les jetons requis ? votre compl?ment pour le service en ligne. L?ensemble du code de mise en ?uvre des autorisations se trouve dans le service interm?diaire.</span><span class="sxs-lookup"><span data-stu-id="56d62-p118">Your add-in can use a middleman service such as OAuth.io or Auth0 to perform authorization. A middleman service may either provide access tokens for popular online services or simplify the process of enabling social login for your add-in, or both. With very little code, your add-in can use either client-side script or server-side code to connect to the middleman service and it will send your add-in any required tokens for the online service. All of the authorization implementation code is in the middleman service.</span></span>

<span data-ttu-id="56d62-167">Pour obtenir des exemples de compl?ments qui utilisent un service interm?diaire d?autorisation, voir les exemples suivants :</span><span class="sxs-lookup"><span data-stu-id="56d62-167">For examples of add-ins that use a middleman service for authorization, see the following samples:</span></span>

- <span data-ttu-id="56d62-168">[Office-Add-in-Auth0](https://github.com/OfficeDev/Office-Add-in-Auth0) utilise Auth0 pour activer la connexion aux r?seaux sociaux avec les comptes Facebook, Google et Microsoft.</span><span class="sxs-lookup"><span data-stu-id="56d62-168">[Office-Add-in-Auth0](https://github.com/OfficeDev/Office-Add-in-Auth0) uses Auth0 to enable social login with Facebook, Google, and Microsoft Accounts.</span></span>

- <span data-ttu-id="56d62-169">[Office-Add-in-OAuth.io](https://github.com/OfficeDev/Office-Add-in-OAuth.io) utilise OAuth.io pour obtenir des jetons d?acc?s ? partir de Facebook et Google.</span><span class="sxs-lookup"><span data-stu-id="56d62-169">[Office-Add-in-OAuth.io](https://github.com/OfficeDev/Office-Add-in-OAuth.io) uses OAuth.io to get access tokens from Facebook and Google.</span></span>

## <a name="what-is-cors"></a><span data-ttu-id="56d62-170">Que signifie l?acronyme CORS ?</span><span class="sxs-lookup"><span data-stu-id="56d62-170">What is CORS?</span></span>

<span data-ttu-id="56d62-p119">CORS est l?acronyme de [Cross Origin Resource Sharing](https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS) (partage des ressources d?origines crois?es). Pour plus d?informations sur l?utilisation de CORS dans les compl?ments, reportez-vous ? la rubrique relative ? la [r?solution des limites de strat?gie d?origine identique dans les compl?ments Office](addressing-same-origin-policy-limitations.md).</span><span class="sxs-lookup"><span data-stu-id="56d62-p119">CORS stands for [Cross Origin Resource Sharing](https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS). For information about how to use CORS inside add-ins, see [Addressing same-origin policy limitations in Office Add-ins](addressing-same-origin-policy-limitations.md).</span></span>
