---
title: Autoriser des services externes dans votre complément Office
description: Autorisation d’accès à des sources de données non-Microsoft comme Google, Facebook, LinkedIn, SalesForce et GitHub à l’aide d’OAuth 2.0, du code d’autorisation et des flux implicites.
ms.date: 08/07/2019
localization_priority: Normal
ms.openlocfilehash: fd180e11106e7e1e2f20f539746535c4310ad81e
ms.sourcegitcommit: 7ef14753dce598a5804dad8802df7aaafe046da7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/10/2020
ms.locfileid: "45093741"
---
# <a name="authorize-external-services-in-your-office-add-in"></a><span data-ttu-id="29df8-103">Autoriser des services externes dans votre complément Office</span><span class="sxs-lookup"><span data-stu-id="29df8-103">Authorize external services in your Office Add-in</span></span>

<span data-ttu-id="29df8-104">Popular online services, including Microsoft 365, Google, Facebook, LinkedIn, SalesForce, and GitHub, let developers give users access to their accounts in other applications.</span><span class="sxs-lookup"><span data-stu-id="29df8-104">Popular online services, including Microsoft 365, Google, Facebook, LinkedIn, SalesForce, and GitHub, let developers give users access to their accounts in other applications.</span></span> <span data-ttu-id="29df8-105">This gives you the ability to include these services in your Office Add-in.</span><span class="sxs-lookup"><span data-stu-id="29df8-105">This gives you the ability to include these services in your Office Add-in.</span></span>

> [!NOTE]
> <span data-ttu-id="29df8-106">Le reste de cet article concerne l’accès aux services non-Microsoft.</span><span class="sxs-lookup"><span data-stu-id="29df8-106">The remainder of this article is about accessing non-Microsoft services.</span></span> <span data-ttu-id="29df8-107">Pour plus d’informations sur l’accès à Microsoft Graph (y compris Microsoft 365), voir [Access to Microsoft Graph with SSO](overview-authn-authz.md#access-to-microsoft-graph-with-sso) and [Access to Microsoft Graph with SSO](overview-authn-authz.md#access-to-microsoft-graph-without-sso).</span><span class="sxs-lookup"><span data-stu-id="29df8-107">For information about accessing Microsoft Graph (including Microsoft 365), see [Access to Microsoft Graph with SSO](overview-authn-authz.md#access-to-microsoft-graph-with-sso) and [Access to Microsoft Graph without SSO](overview-authn-authz.md#access-to-microsoft-graph-without-sso).</span></span>

<span data-ttu-id="29df8-108">The industry standard framework for enabling web application access to an online service is **OAuth 2.0**.</span><span class="sxs-lookup"><span data-stu-id="29df8-108">The industry standard framework for enabling web application access to an online service is **OAuth 2.0**.</span></span> <span data-ttu-id="29df8-109">In most situations, you don't need to know the details of how the framework works to use it in your add-in.</span><span class="sxs-lookup"><span data-stu-id="29df8-109">In most situations, you don't need to know the details of how the framework works to use it in your add-in.</span></span> <span data-ttu-id="29df8-110">Many libraries are available that simplify the details for you.</span><span class="sxs-lookup"><span data-stu-id="29df8-110">Many libraries are available that simplify the details for you.</span></span>

<span data-ttu-id="29df8-111">L’une des idées fondamentales d’OAuth est qu’une application peut être un [principal de sécurité](/windows/security/identity-protection/access-control/security-principals) en elle-même, de la même façon qu’un utilisateur ou un groupe, avec sa propre identité et son ensemble d’autorisations.</span><span class="sxs-lookup"><span data-stu-id="29df8-111">A fundamental idea of OAuth is that an application can be a [security principal](/windows/security/identity-protection/access-control/security-principals) unto itself, just like a user or a group, with its own identity and set of permissions.</span></span> <span data-ttu-id="29df8-112">Le plus souvent, quand l’utilisateur exécute une action dans le complément Office ayant besoin du service en ligne, le complément envoie une demande au service portant sur un ensemble spécifique d’autorisations pour le compte de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="29df8-112">In the most typical scenarios, when the user takes an action in the Office Add-in that requires the online service, the add-in sends the service a request for a specific set of permissions to the user's account.</span></span> <span data-ttu-id="29df8-113">Le service invite ensuite l’utilisateur à octroyer ces autorisations au complément.</span><span class="sxs-lookup"><span data-stu-id="29df8-113">The service then prompts the user to grant the add-in those permissions.</span></span> <span data-ttu-id="29df8-114">Une fois que les autorisations sont accordées, le service envoie un petit *jeton d’accès* codé au complément.</span><span class="sxs-lookup"><span data-stu-id="29df8-114">After the permissions are granted, the service sends the add-in a small encoded *access token*.</span></span> <span data-ttu-id="29df8-115">Le complément peut utiliser le service en incluant le jeton dans toutes ses demandes aux API du service.</span><span class="sxs-lookup"><span data-stu-id="29df8-115">The add-in can use the service by including the token in all its requests to the service's APIs.</span></span> <span data-ttu-id="29df8-116">Toutefois, le complément agit uniquement dans la limite des autorisations que l’utilisateur lui a accordées.</span><span class="sxs-lookup"><span data-stu-id="29df8-116">But the add-in can act only within the permissions that the user granted it.</span></span> <span data-ttu-id="29df8-117">En outre, le jeton expire après un certain délai.</span><span class="sxs-lookup"><span data-stu-id="29df8-117">The token also expires after a specified time.</span></span>

<span data-ttu-id="29df8-118">Plusieurs modèles OAuth, appelés *flux* ou *types d’accès accordé*, sont conçus pour différents scénarios.</span><span class="sxs-lookup"><span data-stu-id="29df8-118">Several OAuth patterns, called *flows* or *grant types*, are designed for different scenarios.</span></span> <span data-ttu-id="29df8-119">Les deux modèles suivants sont les plus couramment implémentés :</span><span class="sxs-lookup"><span data-stu-id="29df8-119">The following two patterns are the most commonly implemented:</span></span>

- <span data-ttu-id="29df8-120">**Flux implicite** : la communication entre le complément et le service en ligne est mise en œuvre avec JavaScript côté client.</span><span class="sxs-lookup"><span data-stu-id="29df8-120">**Implicit flow**: Communication between the add-in and the online service is implemented with client-side JavaScript.</span></span> <span data-ttu-id="29df8-121">Ce flux est couramment utilisé dans les applications à page unique (SPA).</span><span class="sxs-lookup"><span data-stu-id="29df8-121">This flow is commonly used in single-page applications (SPAs).</span></span>
- <span data-ttu-id="29df8-122">**Flux de code d’autorisation** : la communication est effectuée de *serveur à serveur* entre l’application web de votre complément et le service en ligne.</span><span class="sxs-lookup"><span data-stu-id="29df8-122">**Authorization Code flow**: Communication is *server-to-server* between your add-in's web application and the online service.</span></span> <span data-ttu-id="29df8-123">Par conséquent, elle est mise en œuvre avec du code côté serveur.</span><span class="sxs-lookup"><span data-stu-id="29df8-123">So, it is implemented with server-side code.</span></span>

<span data-ttu-id="29df8-124">L’objectif d’un flux OAuth est de sécuriser l’identité et l’autorisation de l’application.</span><span class="sxs-lookup"><span data-stu-id="29df8-124">The purpose of an OAuth flow is to secure the identity and authorization of the application.</span></span> <span data-ttu-id="29df8-125">Dans le flux de code d’autorisation, une *clé secrète client* devant rester masquée vous est fournie.</span><span class="sxs-lookup"><span data-stu-id="29df8-125">In the Authorization Code flow, you're provided a *client secret* that needs to be kept hidden.</span></span> <span data-ttu-id="29df8-126">Les applications sans élément principal côté serveur, comme les applications monopages, ne permettent pas de protéger la clé secrète et nous vous recommandons d’utiliser le flux implicite dans ce type d’application.</span><span class="sxs-lookup"><span data-stu-id="29df8-126">An application that has no server-side backend, such as an SPA, has no way to protect the secret, so we recommend that you use the Implicit flow in SPAs.</span></span>

<span data-ttu-id="29df8-127">Vous devez être familiarisé avec les avantages et inconvénients du flux implicite et du flux de code d’autorisation.</span><span class="sxs-lookup"><span data-stu-id="29df8-127">You should be familiar with the pros and cons of the Implicit flow and the Authorization Code flow.</span></span> <span data-ttu-id="29df8-128">Pour plus d’informations sur ces deux flux, reportez-vous à [Code d’autorisation](https://tools.ietf.org/html/rfc6749#section-1.3.1) et [Implicite](https://tools.ietf.org/html/rfc6749#section-1.3.2).</span><span class="sxs-lookup"><span data-stu-id="29df8-128">For more information about these two flows, see [Authorization Code](https://tools.ietf.org/html/rfc6749#section-1.3.1) and [Implicit](https://tools.ietf.org/html/rfc6749#section-1.3.2).</span></span>

> [!NOTE]
> <span data-ttu-id="29df8-129">You also have the option of using a middleman service to perform authorization and pass the access token to your add-in.</span><span class="sxs-lookup"><span data-stu-id="29df8-129">You also have the option of using a middleman service to perform authorization and pass the access token to your add-in.</span></span> <span data-ttu-id="29df8-130">For details about this scenario, see the **Middleman services** section later in this article.</span><span class="sxs-lookup"><span data-stu-id="29df8-130">For details about this scenario, see the **Middleman services** section later in this article.</span></span>

## <a name="using-the-implicit-flow-in-office-add-ins"></a><span data-ttu-id="29df8-131">Utilisation du flux implicite dans des compléments Office</span><span class="sxs-lookup"><span data-stu-id="29df8-131">Using the Implicit flow in Office Add-ins</span></span>

<span data-ttu-id="29df8-132">La meilleure façon de déterminer si un service en ligne prend en charge le flux implicite est de consulter la documentation.</span><span class="sxs-lookup"><span data-stu-id="29df8-132">The best way to find out if an online service supports the Implicit flow is to consult the service's documentation.</span></span>

<span data-ttu-id="29df8-133">Pour plus d’informations sur les bibliothèques prenant en charge le flux implicite, consultez la rubrique **bibliothèques** plus loin dans cet article.</span><span class="sxs-lookup"><span data-stu-id="29df8-133">For information about libraries that support the Implicit flow, see the **Libraries** section later in this article.</span></span>

## <a name="using-the-authorization-code-flow-in-office-add-ins"></a><span data-ttu-id="29df8-134">Utilisation du flux de code d’autorisation dans les compléments Office</span><span class="sxs-lookup"><span data-stu-id="29df8-134">Using the Authorization Code flow in Office Add-ins</span></span>

<span data-ttu-id="29df8-135">Many libraries are available for implementing the Authorization Code flow in various languages and frameworks.</span><span class="sxs-lookup"><span data-stu-id="29df8-135">Many libraries are available for implementing the Authorization Code flow in various languages and frameworks.</span></span> <span data-ttu-id="29df8-136">For more information about some of these libraries, see the **Libraries** section later in this article.</span><span class="sxs-lookup"><span data-stu-id="29df8-136">For more information about some of these libraries, see the **Libraries** section later in this article.</span></span>

## <a name="libraries"></a><span data-ttu-id="29df8-137">Bibliothèques</span><span class="sxs-lookup"><span data-stu-id="29df8-137">Libraries</span></span>

<span data-ttu-id="29df8-138">Libraries are available for many languages and platforms, for both the Implicit flow and the Authorization Code flow.</span><span class="sxs-lookup"><span data-stu-id="29df8-138">Libraries are available for many languages and platforms, for both the Implicit flow and the Authorization Code flow.</span></span> <span data-ttu-id="29df8-139">Some libraries are general purpose, while others are for specific online services.</span><span class="sxs-lookup"><span data-stu-id="29df8-139">Some libraries are general purpose, while others are for specific online services.</span></span>

<span data-ttu-id="29df8-140">**Google**: Search [GitHub.com/Google](https://github.com/google) for "auth" or the name of your language.</span><span class="sxs-lookup"><span data-stu-id="29df8-140">**Google**: Search [GitHub.com/Google](https://github.com/google) for "auth" or the name of your language.</span></span> <span data-ttu-id="29df8-141">Most of the relevant repos are named `google-auth-library-[name of language]`.</span><span class="sxs-lookup"><span data-stu-id="29df8-141">Most of the relevant repos are named `google-auth-library-[name of language]`.</span></span>

<span data-ttu-id="29df8-142">**Facebook** : cherchez « bibliothèque » ou « sdk » sur le site [Facebook pour les développeurs](https://developers.facebook.com).</span><span class="sxs-lookup"><span data-stu-id="29df8-142">**Facebook**: Search [Facebook for Developers](https://developers.facebook.com) for "library" or "sdk".</span></span>

<span data-ttu-id="29df8-143">**General OAuth 2.0**: A page of links to libraries for over a dozen languages is maintained by the IETF OAuth Working Group at: [OAuth Code](https://oauth.net/code/).</span><span class="sxs-lookup"><span data-stu-id="29df8-143">**General OAuth 2.0**: A page of links to libraries for over a dozen languages is maintained by the IETF OAuth Working Group at: [OAuth Code](https://oauth.net/code/).</span></span> <span data-ttu-id="29df8-144">Note that some of these libraries are for implementing an OAuth compliant service.</span><span class="sxs-lookup"><span data-stu-id="29df8-144">Note that some of these libraries are for implementing an OAuth compliant service.</span></span> <span data-ttu-id="29df8-145">The libraries of interest to you as a an add-in developer are called *client* libraries on this page because your web server is a client of the OAuth compliant service.</span><span class="sxs-lookup"><span data-stu-id="29df8-145">The libraries of interest to you as a an add-in developer are called *client* libraries on this page because your web server is a client of the OAuth compliant service.</span></span>

## <a name="middleman-services"></a><span data-ttu-id="29df8-146">Services intermédiaires</span><span class="sxs-lookup"><span data-stu-id="29df8-146">Middleman services</span></span>

<span data-ttu-id="29df8-147">Your add-in can use a middleman service such as [OAuth.io](https://oauth.io) or [Auth0](https://auth0.com) to perform authorization.</span><span class="sxs-lookup"><span data-stu-id="29df8-147">Your add-in can use a middleman service such as [OAuth.io](https://oauth.io) or [Auth0](https://auth0.com) to perform authorization.</span></span> <span data-ttu-id="29df8-148">A middleman service may either provide access tokens for popular online services or simplify the process of enabling social login for your add-in, or both.</span><span class="sxs-lookup"><span data-stu-id="29df8-148">A middleman service may either provide access tokens for popular online services or simplify the process of enabling social login for your add-in, or both.</span></span> <span data-ttu-id="29df8-149">With very little code, your add-in can use either client-side script or server-side code to connect to the middleman service and it will send your add-in any required tokens for the online service.</span><span class="sxs-lookup"><span data-stu-id="29df8-149">With very little code, your add-in can use either client-side script or server-side code to connect to the middleman service and it will send your add-in any required tokens for the online service.</span></span> <span data-ttu-id="29df8-150">All of the authorization implementation code is in the middleman service.</span><span class="sxs-lookup"><span data-stu-id="29df8-150">All of the authorization implementation code is in the middleman service.</span></span> 

<span data-ttu-id="29df8-151">Nous vous recommandons que l’interface utilisateur de l’authentification/autorisation dans votre complément utilise nos boîte de dialogue API pour ouvrir une page de connexion.</span><span class="sxs-lookup"><span data-stu-id="29df8-151">We recommend that the UI for authentication/authorization in your add-in use our Dialog APIs to open a login page.</span></span> <span data-ttu-id="29df8-152">Voir[ Utilisation des API de dialogue dans un flux d’authentification](dialog-api-in-office-add-ins.md#use-the-dialog-apis-in-an-authentication-flow)pour plus d’informations.</span><span class="sxs-lookup"><span data-stu-id="29df8-152">See [Use the Dialog APIs in an authentication flow](dialog-api-in-office-add-ins.md#use-the-dialog-apis-in-an-authentication-flow) for more information.</span></span> <span data-ttu-id="29df8-153">Lorsque vous ouvrez une boîte de dialogue Office de cette façon, la boîte de dialogue a une instance distincte et complètement nouvelle du moteur JavaScript à partir de l’instance de navigateur et dans la page parent (par exemple, volet Office du complément ou FunctionFile).</span><span class="sxs-lookup"><span data-stu-id="29df8-153">When you open an Office dialog in this way, the dialog has a completely new and separate instance of the browser and JavaScript engine from the instance in the parent page (e.g., the add-in's task pane or FunctionFile).</span></span> <span data-ttu-id="29df8-154">Un jeton et toute autre information peut être converti(e) en chaîne, est transmis(e) au parent à l’aide d’une API appelée `messageParent`.</span><span class="sxs-lookup"><span data-stu-id="29df8-154">A token, and any other information that can be converted to a string, is passed back to the parent using an API called `messageParent`.</span></span> <span data-ttu-id="29df8-155">La page parent peut ensuite utiliser le jeton pour passer des appels autorisés à la ressource.</span><span class="sxs-lookup"><span data-stu-id="29df8-155">The parent page can then use the token to make authorized calls to the resource.</span></span> <span data-ttu-id="29df8-156">En raison de cette architecture, vous devez être vigilant de l’utilisation API fournis par un service intermédiaires.</span><span class="sxs-lookup"><span data-stu-id="29df8-156">Because of this architecture, you must be careful how you use the APIs provided by a middleman service.</span></span> <span data-ttu-id="29df8-157">Le service fournit souvent une API définir dans lequel votre code crée un type d’objet de contexte qui obtient un jeton et utilise ce jeton afin de passer des appels conséquents à la ressource.</span><span class="sxs-lookup"><span data-stu-id="29df8-157">Often the service will provide an API set in which your code creates some kind of context object which both gets a token and uses that token in making subsequent calls to the resource.</span></span> <span data-ttu-id="29df8-158">Souvent le service a une méthode API unique qui effectue l’appel initiale *et* crée l’objet de contexte.</span><span class="sxs-lookup"><span data-stu-id="29df8-158">Often the service has a single API method that makes the initial call *and* creates the context object.</span></span> <span data-ttu-id="29df8-159">Un objet comme suit ne peut pas être complètement mis sous forme de chaîne, il ne peut donc pas être transmis à partir de la boîte de dialogue Office à la page parent.</span><span class="sxs-lookup"><span data-stu-id="29df8-159">An object like this cannot be completely stringified, so it cannot be passed from the Office dialog to the parent page.</span></span> <span data-ttu-id="29df8-160">En règle générale, le service intermédiaires fournit un ensemble de second API, du niveau inférieur d’abstraction, par exemple, une API REST.</span><span class="sxs-lookup"><span data-stu-id="29df8-160">Typically, the middleman service provides a second API set, at a lower level of abstraction, such as a REST API.</span></span> <span data-ttu-id="29df8-161">Cette seconde série comportera une API qui récupère un jeton à partir du service et autres API qui passe le jeton au service lorsque vous utilisez pour accéder à la ressource autorisée.</span><span class="sxs-lookup"><span data-stu-id="29df8-161">This second set will have an API that gets a token from the service, and other APIs that pass the token to service when using it to get authorized access to the resource.</span></span> <span data-ttu-id="29df8-162">Vous devez travailler avec une API à ce niveau inférieur d’abstraction afin que vous puissiez obtenir le jeton dans la boîte de dialogue Office, puis utiliser `messageParent` afin de le passer à la page parent.</span><span class="sxs-lookup"><span data-stu-id="29df8-162">You need to work with an API at this lower level of abstraction so that you can get the token in the Office dialog and then use `messageParent` to pass it to the parent page.</span></span> 

## <a name="what-is-cors"></a><span data-ttu-id="29df8-163">Que signifie l’acronyme CORS ?</span><span class="sxs-lookup"><span data-stu-id="29df8-163">What is CORS?</span></span>

<span data-ttu-id="29df8-164">CORS stands for [Cross Origin Resource Sharing](https://developer.mozilla.org/docs/Web/HTTP/Access_control_CORS).</span><span class="sxs-lookup"><span data-stu-id="29df8-164">CORS stands for [Cross Origin Resource Sharing](https://developer.mozilla.org/docs/Web/HTTP/Access_control_CORS).</span></span> <span data-ttu-id="29df8-165">For information about how to use CORS inside add-ins, see [Addressing same-origin policy limitations in Office Add-ins](addressing-same-origin-policy-limitations.md).</span><span class="sxs-lookup"><span data-stu-id="29df8-165">For information about how to use CORS inside add-ins, see [Addressing same-origin policy limitations in Office Add-ins](addressing-same-origin-policy-limitations.md).</span></span>
