---
title: Spécification des exigences en matière d’hôtes Office et d’API
description: Découvrez comment spécifier les applications Office et les conditions requises de l'API pour que votre application fonctionne comme prévu.
ms.date: 04/20/2021
localization_priority: Normal
ms.openlocfilehash: 0b0bd433a0b731437588b83cba0b37052babf2c1
ms.sourcegitcommit: 691fa338029c9cbd9a7194d163f390c3321a0cd8
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/23/2021
ms.locfileid: "51959158"
---
# <a name="specify-office-applications-and-api-requirements"></a><span data-ttu-id="32047-103">Spécifier les applications Office et les exigences de l’API</span><span class="sxs-lookup"><span data-stu-id="32047-103">Specify Office applications and API requirements</span></span>

<span data-ttu-id="32047-104">Votre application Office peut dépendre d'une application Office spécifique, d'un ensemble de conditions requises, d'un membre d'API ou d'une version de l'API pour fonctionner comme prévu.</span><span class="sxs-lookup"><span data-stu-id="32047-104">Your Office Add-in might depend on a specific Office application, a requirement set, an API member, or a version of the API in order to work as expected.</span></span> <span data-ttu-id="32047-105">Par exemple, votre complément peut :</span><span class="sxs-lookup"><span data-stu-id="32047-105">For example, your add-in might:</span></span>

- <span data-ttu-id="32047-106">Exécuter dans une application Office (Word ou Excel), ou plusieurs applications.</span><span class="sxs-lookup"><span data-stu-id="32047-106">Run in a single Office application (e.g., Word or Excel), or several applications.</span></span>

- <span data-ttu-id="32047-p102">utiliser des API JavaScript disponibles uniquement dans certaines versions d’Office. Par exemple, vous pouvez utiliser les API JavaScript d’Excel dans un complément qui fonctionne dans Excel 2016 ;</span><span class="sxs-lookup"><span data-stu-id="32047-p102">Make use of JavaScript APIs that are only available in some versions of Office. For example, you might use the Excel JavaScript APIs in an add-in that runs in Excel 2016.</span></span>

- <span data-ttu-id="32047-109">s’exécuter uniquement dans les versions d’Office qui prennent en charge les membres d’API utilisés par votre complément.</span><span class="sxs-lookup"><span data-stu-id="32047-109">Run only in versions of Office that support API members that your add-in uses.</span></span>

<span data-ttu-id="32047-110">Cet article vous aidera à comprendre les options que vous devez choisir afin de vous assurer que votre complément fonctionne comme prévu et atteint l’audience la plus large possible.</span><span class="sxs-lookup"><span data-stu-id="32047-110">This article helps you understand which options you should choose to ensure that your add-in works as expected and reaches the broadest audience possible.</span></span>

> [!NOTE]
> <span data-ttu-id="32047-111">Pour obtenir une vue générale de l'endroit où les applications Office sont actuellement pris en charge, consultez la page disponibilité de la plateforme et de l'application cliente Office pour les [applications Office.](../overview/office-add-in-availability.md)</span><span class="sxs-lookup"><span data-stu-id="32047-111">For a high-level view of where Office Add-ins are currently supported, see the [Office client application and platform availability for Office Add-ins](../overview/office-add-in-availability.md) page.</span></span>

<span data-ttu-id="32047-112">Le tableau suivant répertorie les concepts principaux décrits dans cet article.</span><span class="sxs-lookup"><span data-stu-id="32047-112">The following table lists core concepts discussed throughout this article.</span></span>

|<span data-ttu-id="32047-113">**Concept**</span><span class="sxs-lookup"><span data-stu-id="32047-113">**Concept**</span></span>|<span data-ttu-id="32047-114">**Description**</span><span class="sxs-lookup"><span data-stu-id="32047-114">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="32047-115">Application Office, application cliente Office</span><span class="sxs-lookup"><span data-stu-id="32047-115">Office application, Office client application</span></span>|<span data-ttu-id="32047-p103">Application Office utilisée pour exécuter votre complément. Par exemple, Word, Excel, etc.</span><span class="sxs-lookup"><span data-stu-id="32047-p103">The Office application used to run your add-in. For example, Word, Excel, and so on.</span></span>|
|<span data-ttu-id="32047-118">Plateforme</span><span class="sxs-lookup"><span data-stu-id="32047-118">Platform</span></span>|<span data-ttu-id="32047-119">L'endroit où l'application Office s'exécute, par exemple dans un navigateur ou sur un iPad.</span><span class="sxs-lookup"><span data-stu-id="32047-119">Where the Office application runs, such as in a browser or on an iPad.</span></span>|
|<span data-ttu-id="32047-120">Ensemble de conditions requises</span><span class="sxs-lookup"><span data-stu-id="32047-120">Requirement set</span></span>|<span data-ttu-id="32047-121">Groupe nommé de membres d’API associés.</span><span class="sxs-lookup"><span data-stu-id="32047-121">A named group of related API members.</span></span> <span data-ttu-id="32047-122">Les add-ins utilisent des ensembles de conditions requises pour déterminer si l'application Office prend en charge les membres d'API utilisés par votre application.</span><span class="sxs-lookup"><span data-stu-id="32047-122">Add-ins use requirement sets to determine whether the Office application supports API members used by your add-in.</span></span> <span data-ttu-id="32047-123">Il est plus facile de tester la prise en charge d’un ensemble de conditions requises, plutôt que la prise en charge de membres individuels d’API.</span><span class="sxs-lookup"><span data-stu-id="32047-123">It's easier to test for the support of a requirement set than for the support of individual API members.</span></span> <span data-ttu-id="32047-124">La prise en charge de l'ensemble de conditions requises varie selon l'application Office et la version de l'application Office.</span><span class="sxs-lookup"><span data-stu-id="32047-124">Requirement set support varies by Office application and the version of the Office application.</span></span> <br ><span data-ttu-id="32047-125">Les ensembles de conditions requises sont spécifiés dans le fichier manifeste.</span><span class="sxs-lookup"><span data-stu-id="32047-125">Requirement sets are specified in the manifest file.</span></span> <span data-ttu-id="32047-126">Lorsque vous spécifiez des ensembles de conditions requises dans le manifeste, vous définissez le niveau minimal de prise en charge de l'API que l'application Office doit fournir pour exécuter votre application.</span><span class="sxs-lookup"><span data-stu-id="32047-126">When you specify requirement sets in the manifest, you set the minimum level of API support that the Office application must provide in order to run your add-in.</span></span> <span data-ttu-id="32047-127">Les applications Office qui ne peuvent pas prendre en charge les ensembles de conditions <span class="ui">requises spécifiés</span>dans le manifeste ne peuvent pas exécuter votre application et votre application ne s'affichera pas dans Mes applications. Cela limite l'endroit où votre add-in est disponible.</span><span class="sxs-lookup"><span data-stu-id="32047-127">Office applications that don't support requirement sets specified in the manifest can't run your add-in, and your add-in won't display in <span class="ui">My Add-ins</span>. This restricts where your add-in is available.</span></span> <span data-ttu-id="32047-128">Dans le code utilisant les vérifications à l’exécution.</span><span class="sxs-lookup"><span data-stu-id="32047-128">In code using runtime checks.</span></span> <span data-ttu-id="32047-129">Pour obtenir la liste complète des ensembles de conditions requises, voir [Ensemble de conditions requises pour les compléments Office](../reference/requirement-sets/office-add-in-requirement-sets.md).</span><span class="sxs-lookup"><span data-stu-id="32047-129">For the complete list of requirement sets, see [Office Add-in requirement sets](../reference/requirement-sets/office-add-in-requirement-sets.md).</span></span>|
|<span data-ttu-id="32047-130">Vérification à l’exécution</span><span class="sxs-lookup"><span data-stu-id="32047-130">Runtime check</span></span>|<span data-ttu-id="32047-131">Test effectué au moment de l'exécution pour déterminer si l'application Office exécutant votre application prend en charge les ensembles de conditions requises ou les méthodes utilisées par votre application.</span><span class="sxs-lookup"><span data-stu-id="32047-131">A test that is performed at runtime to determine whether the Office application running your add-in supports requirement sets or methods used by your add-in.</span></span> <span data-ttu-id="32047-132">Pour effectuer une vérification à l'runtime, vous utilisez une instruction **if** avec la méthode, les ensembles de conditions requises ou les noms de méthodes qui ne font pas partie `isSetSupported` d'un ensemble de conditions requises.</span><span class="sxs-lookup"><span data-stu-id="32047-132">To perform a runtime check, you use an **if** statement with the `isSetSupported` method, the requirement sets, or the method names that aren't part of a requirement set.</span></span> <span data-ttu-id="32047-133">Les vérifications à l’exécution permettent de veiller à ce que votre complément atteigne le plus grand nombre possible de clients.</span><span class="sxs-lookup"><span data-stu-id="32047-133">Use runtime checks to ensure that your add-in reaches the broadest number of customers.</span></span> <span data-ttu-id="32047-134">Contrairement aux ensembles de conditions requises, les vérifications à l'runtime ne spécifient pas le niveau minimal de prise en charge de l'API que l'application Office doit fournir pour que votre application s'exécute.</span><span class="sxs-lookup"><span data-stu-id="32047-134">Unlike requirement sets, runtime checks don't specify the minimum level of API support that the Office application must provide for your add-in to run.</span></span> <span data-ttu-id="32047-135">À la place, vous utilisez **l'instruction if** pour déterminer si un membre d'API est pris en charge.</span><span class="sxs-lookup"><span data-stu-id="32047-135">Instead, you use the **if** statement to determine whether an API member is supported.</span></span> <span data-ttu-id="32047-136">Si c’est le cas, vous pouvez fournir des fonctionnalités supplémentaires dans votre complément.</span><span class="sxs-lookup"><span data-stu-id="32047-136">If it is, you can provide additional functionality in your add-in.</span></span> <span data-ttu-id="32047-137">Votre complément s’affiche toujours dans **Mes compléments** quand vous effectuez des vérifications à l’exécution.</span><span class="sxs-lookup"><span data-stu-id="32047-137">Your add-in will always display in **My Add-ins** when you use runtime checks.</span></span>|

## <a name="before-you-begin"></a><span data-ttu-id="32047-138">Avant de commencer</span><span class="sxs-lookup"><span data-stu-id="32047-138">Before you begin</span></span>

<span data-ttu-id="32047-139">Votre complément doit utiliser la version la plus récente du schéma de manifeste de complément.</span><span class="sxs-lookup"><span data-stu-id="32047-139">Your add-in must use the most current version of the add-in manifest schema.</span></span> <span data-ttu-id="32047-140">Si vous utilisez les vérifications à l'runtime dans votre application, assurez-vous d'utiliser la dernière bibliothèque d'API JavaScript (office.js) Office.</span><span class="sxs-lookup"><span data-stu-id="32047-140">If you use runtime checks in your add-in, ensure that you use the latest Office JavaScript API (office.js) library.</span></span>

### <a name="specify-the-latest-add-in-manifest-schema"></a><span data-ttu-id="32047-141">Indication du schéma de manifeste de complément le plus récent</span><span class="sxs-lookup"><span data-stu-id="32047-141">Specify the latest add-in manifest schema</span></span>

<span data-ttu-id="32047-142">Le manifeste de votre du complément doit utiliser la version 1.1 du schéma de manifeste de complément.</span><span class="sxs-lookup"><span data-stu-id="32047-142">Your add-in's manifest must use version 1.1 of the add-in manifest schema.</span></span> <span data-ttu-id="32047-143">Définissez [l'élément OfficeApp](../reference/manifest/officeapp.md) dans le manifeste de votre add-in comme suit.</span><span class="sxs-lookup"><span data-stu-id="32047-143">Set the [OfficeApp](../reference/manifest/officeapp.md) element in your add-in manifest as follows.</span></span> <span data-ttu-id="32047-144">Cet exemple montre le `TaskPaneApp` type.</span><span class="sxs-lookup"><span data-stu-id="32047-144">This example shows the `TaskPaneApp` type.</span></span>

```XML
<OfficeApp xmlns="http://schemas.microsoft.com/office/appforoffice/1.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="TaskPaneApp">
```

### <a name="specify-the-latest-office-javascript-api-library"></a><span data-ttu-id="32047-145">Spécifier la dernière bibliothèque d'API JavaScript pour Office</span><span class="sxs-lookup"><span data-stu-id="32047-145">Specify the latest Office JavaScript API library</span></span>

<span data-ttu-id="32047-146">Si vous utilisez des vérifications à l'exécution, référencez la version la plus récente de la bibliothèque d'API JavaScript Office à partir du réseau de distribution de contenu (CDN).</span><span class="sxs-lookup"><span data-stu-id="32047-146">If you use runtime checks, reference the most current version of the Office JavaScript API library from the content delivery network (CDN).</span></span> <span data-ttu-id="32047-147">Pour ce faire, ajoutez la balise `script` suivante à votre code HTML.</span><span class="sxs-lookup"><span data-stu-id="32047-147">To do this, add the following  `script` tag to your HTML.</span></span> <span data-ttu-id="32047-148">L’utilisation de `/1/` dans l’URL CDN garantit que vous référencez la version d’Office.js la plus récente.</span><span class="sxs-lookup"><span data-stu-id="32047-148">Using `/1/` in the CDN URL ensures that you reference the most recent version of Office.js.</span></span>

```HTML
<script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js" type="text/javascript"></script>
```

## <a name="options-to-specify-office-applications-or-api-requirements"></a><span data-ttu-id="32047-149">Options permettant de spécifier les applications Office ou les conditions requises des API</span><span class="sxs-lookup"><span data-stu-id="32047-149">Options to specify Office applications or API requirements</span></span>

<span data-ttu-id="32047-150">Lorsque vous spécifiez des applications Office ou des exigences d'API, plusieurs facteurs sont à prendre en compte.</span><span class="sxs-lookup"><span data-stu-id="32047-150">When you specify Office applications or API requirements, there are several factors to consider.</span></span> <span data-ttu-id="32047-151">Le diagramme suivant montre comment choisir la technique à utiliser dans votre complément.</span><span class="sxs-lookup"><span data-stu-id="32047-151">The following diagram shows how to decide which technique to use in your add-in.</span></span>

![Choisissez la meilleure option pour votre application lors de la spécification d'applications Office ou d'exigences d'API](../images/options-for-office-hosts.png)

- <span data-ttu-id="32047-153">Si votre add-in s'exécute dans une application Office, définissez `Hosts` l'élément dans le manifeste.</span><span class="sxs-lookup"><span data-stu-id="32047-153">If your add-in runs in one Office application, set the `Hosts` element in the manifest.</span></span> <span data-ttu-id="32047-154">Pour plus d’informations, consultez [Définition de l’élément Hosts](#set-the-hosts-element).</span><span class="sxs-lookup"><span data-stu-id="32047-154">For more information, see [Set the Hosts element](#set-the-hosts-element).</span></span>

- <span data-ttu-id="32047-155">Pour définir l'ensemble minimal de conditions requises ou les membres d'API qu'une application Office doit prendre en charge pour exécuter votre application, définissez l'élément `Requirements` dans le manifeste.</span><span class="sxs-lookup"><span data-stu-id="32047-155">To set the minimum requirement set or API members that an Office application must support to run your add-in, set the `Requirements` element in the manifest.</span></span> <span data-ttu-id="32047-156">Pour plus d’informations, consultez la section [ Définition de l’élément Requirements dans le manifeste](#set-the-requirements-element-in-the-manifest).</span><span class="sxs-lookup"><span data-stu-id="32047-156">For more information, see [Set the Requirements element in the manifest](#set-the-requirements-element-in-the-manifest).</span></span>

- <span data-ttu-id="32047-157">Si vous souhaitez fournir des fonctionnalités supplémentaires si des ensembles de conditions requises ou des membres d'API spécifiques sont disponibles dans l'application Office, effectuez une vérification à l'runtime dans le code JavaScript de votre complément.</span><span class="sxs-lookup"><span data-stu-id="32047-157">If you would like to provide additional functionality if specific requirement sets or API members are available in the Office application, perform a runtime check in your add-in's JavaScript code.</span></span> <span data-ttu-id="32047-158">Par exemple, si votre complément est exécuté dans Excel 2016, utilisez les membres d’API de l’API JavaScript Excel pour fournir des fonctionnalités supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="32047-158">For example, if your add-in runs in Excel 2016, use API members from the Excel JavaScript API to provide additional functionality.</span></span> <span data-ttu-id="32047-159">Pour plus d’informations, consultez la section [Utilisation des vérifications à l’exécution dans votre code JavaScript](#use-runtime-checks-in-your-javascript-code).</span><span class="sxs-lookup"><span data-stu-id="32047-159">For more information, see [Use runtime checks in your JavaScript code](#use-runtime-checks-in-your-javascript-code).</span></span>

## <a name="set-the-hosts-element"></a><span data-ttu-id="32047-160">Définition de l’élément Hosts</span><span class="sxs-lookup"><span data-stu-id="32047-160">Set the Hosts element</span></span>

<span data-ttu-id="32047-161">Pour exécuter votre application dans une application cliente Office, utilisez les éléments et `Hosts` `Host` les éléments du manifeste.</span><span class="sxs-lookup"><span data-stu-id="32047-161">To make your add-in run in one Office client application, use the `Hosts` and `Host` elements in the manifest.</span></span> <span data-ttu-id="32047-162">Si vous ne spécifiez pas l'élément, votre application s'exécutera dans toutes les applications Office pris en charge par le type spécifié (courrier, volet Office ou `Hosts` `OfficeApp` contenu).</span><span class="sxs-lookup"><span data-stu-id="32047-162">If you don't specify the `Hosts` element, your add-in will run in all Office applications supported by the specified `OfficeApp` type (that is, Mail, Task pane, or Content).</span></span>

<span data-ttu-id="32047-163">Par exemple, l'exemple suivant et la déclaration spécifient que le add-in fonctionne avec n'importe quelle version d'Excel, qui inclut Excel sur le `Hosts` `Host` web, Windows et iPad.</span><span class="sxs-lookup"><span data-stu-id="32047-163">For example, the following `Hosts` and `Host` declaration specifies that the add-in will work with any release of Excel, which includes Excel on the web, Windows, and iPad.</span></span>

```xml
<Hosts>
  <Host Name="Workbook" />
</Hosts>
```

<span data-ttu-id="32047-164">`Hosts`L'élément peut contenir un ou plusieurs `Host` éléments.</span><span class="sxs-lookup"><span data-stu-id="32047-164">The `Hosts` element can contain one or more `Host` elements.</span></span> <span data-ttu-id="32047-165">`Host`L'élément spécifie l'application Office dont votre application a besoin.</span><span class="sxs-lookup"><span data-stu-id="32047-165">The `Host` element specifies the Office application your add-in requires.</span></span> <span data-ttu-id="32047-166">`Name`L'attribut est obligatoire et peut être définie sur l'une des valeurs suivantes.</span><span class="sxs-lookup"><span data-stu-id="32047-166">The `Name` attribute is required and can be set to one of the following values.</span></span>

| <span data-ttu-id="32047-167">Nom</span><span class="sxs-lookup"><span data-stu-id="32047-167">Name</span></span>          | <span data-ttu-id="32047-168">Applications clientes Office</span><span class="sxs-lookup"><span data-stu-id="32047-168">Office client applications</span></span>                     | <span data-ttu-id="32047-169">Types de add-in disponibles</span><span class="sxs-lookup"><span data-stu-id="32047-169">Available add-in types</span></span> |
|:--------------|:-----------------------------------------------|:-----------------------|
| <span data-ttu-id="32047-170">Base de données</span><span class="sxs-lookup"><span data-stu-id="32047-170">Database</span></span>      | <span data-ttu-id="32047-171">applications web Access</span><span class="sxs-lookup"><span data-stu-id="32047-171">Access web apps</span></span>                                | <span data-ttu-id="32047-172">Volet de tâches</span><span class="sxs-lookup"><span data-stu-id="32047-172">Task pane</span></span>              |
| <span data-ttu-id="32047-173">Document</span><span class="sxs-lookup"><span data-stu-id="32047-173">Document</span></span>      | <span data-ttu-id="32047-174">Word sur le web, Windows, Mac, iPad</span><span class="sxs-lookup"><span data-stu-id="32047-174">Word on the web, Windows, Mac, iPad</span></span>            | <span data-ttu-id="32047-175">Volet de tâches</span><span class="sxs-lookup"><span data-stu-id="32047-175">Task pane</span></span>              |
| <span data-ttu-id="32047-176">MailHost</span><span class="sxs-lookup"><span data-stu-id="32047-176">MailHost</span></span>      | <span data-ttu-id="32047-177">Outlook sur le web, Windows, Mac, Android, iOS</span><span class="sxs-lookup"><span data-stu-id="32047-177">Outlook on the web, Windows, Mac, Android, iOS</span></span> | <span data-ttu-id="32047-178">Courrier</span><span class="sxs-lookup"><span data-stu-id="32047-178">Mail</span></span>                   |
| <span data-ttu-id="32047-179">Bloc-notes</span><span class="sxs-lookup"><span data-stu-id="32047-179">Notebook</span></span>      | <span data-ttu-id="32047-180">OneNote sur le web</span><span class="sxs-lookup"><span data-stu-id="32047-180">OneNote on the web</span></span>                             | <span data-ttu-id="32047-181">Volet De tâches, Contenu</span><span class="sxs-lookup"><span data-stu-id="32047-181">Task pane, Content</span></span>     |
| <span data-ttu-id="32047-182">Présentation</span><span class="sxs-lookup"><span data-stu-id="32047-182">Presentation</span></span>  | <span data-ttu-id="32047-183">PowerPoint sur le web, Windows, Mac, iPad</span><span class="sxs-lookup"><span data-stu-id="32047-183">PowerPoint on the web, Windows, Mac, iPad</span></span>      | <span data-ttu-id="32047-184">Volet De tâches, Contenu</span><span class="sxs-lookup"><span data-stu-id="32047-184">Task pane, Content</span></span>     |
| <span data-ttu-id="32047-185">Project</span><span class="sxs-lookup"><span data-stu-id="32047-185">Project</span></span>       | <span data-ttu-id="32047-186">Project sur Windows</span><span class="sxs-lookup"><span data-stu-id="32047-186">Project on Windows</span></span>                             | <span data-ttu-id="32047-187">Volet de tâches</span><span class="sxs-lookup"><span data-stu-id="32047-187">Task pane</span></span>              |
| <span data-ttu-id="32047-188">Classeur</span><span class="sxs-lookup"><span data-stu-id="32047-188">Workbook</span></span>      | <span data-ttu-id="32047-189">Excel sur le web, Windows, Mac, iPad</span><span class="sxs-lookup"><span data-stu-id="32047-189">Excel on the web, Windows, Mac, iPad</span></span>           | <span data-ttu-id="32047-190">Volet De tâches, Contenu</span><span class="sxs-lookup"><span data-stu-id="32047-190">Task pane, Content</span></span>     |

> [!NOTE]
> <span data-ttu-id="32047-191">`Name`L'attribut spécifie l'application cliente Office qui peut exécuter votre add-in.</span><span class="sxs-lookup"><span data-stu-id="32047-191">The `Name` attribute specifies the Office client application that can run your add-in.</span></span> <span data-ttu-id="32047-192">Les applications Office sont pris en charge sur différentes plateformes et s'exécutent sur des ordinateurs de bureau, des navigateurs web, des tablettes et des appareils mobiles.</span><span class="sxs-lookup"><span data-stu-id="32047-192">Office applications are supported on different platforms and run on desktops, web browsers, tablets, and mobile devices.</span></span> <span data-ttu-id="32047-193">Vous ne pouvez pas indiquer quelle plateforme peut être utilisée pour exécuter votre complément.</span><span class="sxs-lookup"><span data-stu-id="32047-193">You can't specify which platform can be used to run your add-in.</span></span> <span data-ttu-id="32047-194">Par exemple, si vous spécifiez , Outlook sur le web et sur Windows peuvent être utilisés pour `MailHost` exécuter votre application.</span><span class="sxs-lookup"><span data-stu-id="32047-194">For example, if you specify `MailHost`, both Outlook on the web and on Windows can be used to run your add-in.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="32047-195">Nous ne vous recommandons plus de créer et d’utiliser les bases de données et les applications web Access dans SharePoint.</span><span class="sxs-lookup"><span data-stu-id="32047-195">We no longer recommend that you create and use Access web apps and databases in SharePoint.</span></span> <span data-ttu-id="32047-196">Nous vous recommandons plutôt d’utiliser [Microsoft PowerApps](https://powerapps.microsoft.com/) pour créer des solutions professionnelles sans code pour des appareils mobiles et web.</span><span class="sxs-lookup"><span data-stu-id="32047-196">As an alternative, we recommend that you use [Microsoft PowerApps](https://powerapps.microsoft.com/) to build no-code business solutions for web and mobile devices.</span></span>

## <a name="set-the-requirements-element-in-the-manifest"></a><span data-ttu-id="32047-197">Définition de l’élément Requirements dans le manifeste</span><span class="sxs-lookup"><span data-stu-id="32047-197">Set the Requirements element in the manifest</span></span>

<span data-ttu-id="32047-198">L'élément spécifie les ensembles de conditions requises minimum ou les membres d'API qui doivent être pris en charge par `Requirements` l'application Office pour exécuter votre application.</span><span class="sxs-lookup"><span data-stu-id="32047-198">The `Requirements` element specifies the minimum requirement sets or API members that must be supported by the Office application to run your add-in.</span></span> <span data-ttu-id="32047-199">L'élément peut spécifier des ensembles de conditions requises et des méthodes `Requirements` individuelles utilisées dans votre add-in.</span><span class="sxs-lookup"><span data-stu-id="32047-199">The `Requirements` element can specify both requirement sets and individual methods used in your add-in.</span></span> <span data-ttu-id="32047-200">Dans la version 1.1 du schéma de manifeste du add-in, l'élément est facultatif pour tous les modules, à l'exception des `Requirements` autres.</span><span class="sxs-lookup"><span data-stu-id="32047-200">In version 1.1 of the add-in manifest schema, the `Requirements` element is optional for all add-ins, except for Outlook add-ins.</span></span>

> [!WARNING]
> <span data-ttu-id="32047-201">Utilisez uniquement l'élément pour spécifier des ensembles de conditions requises critiques ou des membres `Requirements` d'API que votre application doit utiliser.</span><span class="sxs-lookup"><span data-stu-id="32047-201">Only use the `Requirements` element to specify critical requirement sets or API members that your add-in must use.</span></span> <span data-ttu-id="32047-202">Si l'application ou la plateforme Office ne prend pas en charge les ensembles de conditions requises ou les membres `Requirements` d'API **spécifiés** dans l'élément, le module ne s'exécutera pas dans cette application ou plateforme et ne s'affichera pas dans Mes applications. Au lieu de cela, nous vous recommandons de rendre votre application disponible sur toutes les plateformes d'une application Office, telles qu'Excel sur le web, Windows et iPad.</span><span class="sxs-lookup"><span data-stu-id="32047-202">If the Office application or platform doesn't support the requirement sets or API members specified in the `Requirements` element, the add-in won't run in that application or platform, and won't display in **My Add-ins**. Instead, we recommend that you make your add-in available on all platforms of an Office application, such as Excel on the web, Windows, and iPad.</span></span> <span data-ttu-id="32047-203">Pour rendre votre application disponible sur toutes les applications  _et_ plateformes Office, utilisez les vérifications à l'runtime à la place de `Requirements` l'élément.</span><span class="sxs-lookup"><span data-stu-id="32047-203">To make your add-in available on  _all_ Office applications and platforms, use runtime checks instead of the `Requirements` element.</span></span>

<span data-ttu-id="32047-204">L'exemple de code suivant montre un add-in qui se charge dans toutes les applications clientes Office qui supportent les données suivantes :</span><span class="sxs-lookup"><span data-stu-id="32047-204">The following code example shows an add-in that loads in all Office client applications that support the following:</span></span>

-  <span data-ttu-id="32047-205">`TableBindings` ensemble de conditions requises, dont la version minimale est « 1.1 ».</span><span class="sxs-lookup"><span data-stu-id="32047-205">`TableBindings` requirement set, which has a minimum version of "1.1".</span></span>

-  <span data-ttu-id="32047-206">`OOXML` ensemble de conditions requises, dont la version minimale est « 1.1 ».</span><span class="sxs-lookup"><span data-stu-id="32047-206">`OOXML` requirement set, which has a minimum version of "1.1".</span></span>

-  <span data-ttu-id="32047-207">`Document.getSelectedDataAsync` .</span><span class="sxs-lookup"><span data-stu-id="32047-207">`Document.getSelectedDataAsync` method.</span></span>

```XML
<Requirements>
   <Sets DefaultMinVersion="1.1">
      <Set Name="TableBindings" MinVersion="1.1"/>
      <Set Name="OOXML" MinVersion="1.1"/>
   </Sets>
   <Methods>
      <Method Name="Document.getSelectedDataAsync"/>
   </Methods>
</Requirements>
```

- <span data-ttu-id="32047-208">`Requirements`L'élément contient les éléments enfants et les `Sets` `Methods` éléments.</span><span class="sxs-lookup"><span data-stu-id="32047-208">The `Requirements` element contains the `Sets` and `Methods` child elements.</span></span>

- <span data-ttu-id="32047-209">`Sets`L'élément peut contenir un ou plusieurs `Set` éléments.</span><span class="sxs-lookup"><span data-stu-id="32047-209">The `Sets` element can contain one or more `Set` elements.</span></span> <span data-ttu-id="32047-210">`DefaultMinVersion` spécifie la valeur par `MinVersion` défaut de tous les éléments `Set` enfants.</span><span class="sxs-lookup"><span data-stu-id="32047-210">`DefaultMinVersion` specifies the default `MinVersion` value of all child `Set` elements.</span></span>

- <span data-ttu-id="32047-211">`Set`L'élément spécifie les ensembles de conditions requises que l'application Office doit prendre en charge pour exécuter le module.</span><span class="sxs-lookup"><span data-stu-id="32047-211">The `Set` element specifies requirement sets that the Office application must support to run the add-in.</span></span> <span data-ttu-id="32047-212">`Name`L'attribut spécifie le nom de l'ensemble de conditions requises.</span><span class="sxs-lookup"><span data-stu-id="32047-212">The `Name` attribute specifies the name of the requirement set.</span></span> <span data-ttu-id="32047-213">Spécifie `MinVersion` la version minimale de l'ensemble de conditions requises.</span><span class="sxs-lookup"><span data-stu-id="32047-213">The `MinVersion` specifies the minimum version of the requirement set.</span></span> <span data-ttu-id="32047-214">`MinVersion`remplace la valeur de Pour plus d'informations sur les ensembles de conditions requises et les versions d'ensembles de conditions requises dont appartiennent les membres de votre API, consultez les ensembles de conditions requises pour les `DefaultMinVersion` [add-ins Office.](../reference/requirement-sets/office-add-in-requirement-sets.md)</span><span class="sxs-lookup"><span data-stu-id="32047-214">`MinVersion` overrides the value of `DefaultMinVersion` For more information about requirement sets and requirement set versions that your API members belong to, see [Office Add-in requirement sets](../reference/requirement-sets/office-add-in-requirement-sets.md).</span></span>

- <span data-ttu-id="32047-215">`Methods`L'élément peut contenir un ou plusieurs `Method` éléments.</span><span class="sxs-lookup"><span data-stu-id="32047-215">The `Methods` element can contain one or more `Method` elements.</span></span> <span data-ttu-id="32047-216">Vous ne pouvez pas utiliser `Methods` l'élément avec les add-ins Outlook.</span><span class="sxs-lookup"><span data-stu-id="32047-216">You can't use the `Methods` element with Outlook add-ins.</span></span>

- <span data-ttu-id="32047-217">L'élément spécifie une méthode individuelle qui doit être prise en charge dans `Method` l'application Office dans laquelle votre application s'exécute.</span><span class="sxs-lookup"><span data-stu-id="32047-217">The `Method` element specifies an individual method that must be supported in the Office application where your add-in runs.</span></span> <span data-ttu-id="32047-218">`Name`L'attribut est obligatoire et spécifie le nom de la méthode qualifiée avec son objet parent.</span><span class="sxs-lookup"><span data-stu-id="32047-218">The `Name` attribute is required and specifies the name of the method qualified with its parent object.</span></span>

## <a name="use-runtime-checks-in-your-javascript-code"></a><span data-ttu-id="32047-219">Utilisation des vérifications à l’exécution dans votre code JavaScript</span><span class="sxs-lookup"><span data-stu-id="32047-219">Use runtime checks in your JavaScript code</span></span>

<span data-ttu-id="32047-220">Vous souhaitez peut-être fournir des fonctionnalités supplémentaires dans votre complément si certains ensembles de conditions requises sont pris en charge par l'application Office.</span><span class="sxs-lookup"><span data-stu-id="32047-220">You might want to provide additional functionality in your add-in if certain requirement sets are supported by the Office application.</span></span> <span data-ttu-id="32047-221">Par exemple, vous pouvez utiliser les interfaces API JavaScript de Word dans votre complément existant si ce dernier est exécuté dans Word 2016.</span><span class="sxs-lookup"><span data-stu-id="32047-221">For example, you might want to use the Word JavaScript APIs in your existing add-in if your add-in runs in Word 2016.</span></span> <span data-ttu-id="32047-222">Pour ce faire, utilisez la méthode [isSetSupported](/javascript/api/office/office.requirementsetsupport#issetsupported-name--minversion-) avec le nom de l’ensemble de conditions requises.</span><span class="sxs-lookup"><span data-stu-id="32047-222">To do this, you use the [isSetSupported](/javascript/api/office/office.requirementsetsupport#issetsupported-name--minversion-) method with the name of the requirement set.</span></span> <span data-ttu-id="32047-223">`isSetSupported` détermine, au moment de l'exécution, si l'application Office qui exécute le add-in prend en charge l'ensemble de conditions requises.</span><span class="sxs-lookup"><span data-stu-id="32047-223">`isSetSupported` determines, at runtime, whether the Office application running the add-in supports the requirement set.</span></span> <span data-ttu-id="32047-224">Si l'ensemble de conditions requises est pris en charge, renvoie true et exécute le code supplémentaire qui utilise les membres `isSetSupported` d'API  de cet ensemble de conditions requises.</span><span class="sxs-lookup"><span data-stu-id="32047-224">If the requirement set is supported, `isSetSupported` returns **true** and runs the additional code that uses the API members from that requirement set.</span></span> <span data-ttu-id="32047-225">Si l'application Office ne prend pas en charge l'ensemble de conditions requises, renvoie false et le code supplémentaire `isSetSupported` ne s'exécute  pas.</span><span class="sxs-lookup"><span data-stu-id="32047-225">If the Office application doesn't support the requirement set, `isSetSupported` returns **false** and the additional code won't run.</span></span> <span data-ttu-id="32047-226">Le code suivant indique la syntaxe à utiliser avec `isSetSupported`</span><span class="sxs-lookup"><span data-stu-id="32047-226">The following code shows the syntax to use with `isSetSupported`.</span></span>

```js
if (Office.context.requirements.isSetSupported(RequirementSetName, MinimumVersion))
{
   // Code that uses API members from RequirementSetName.
}

```

- <span data-ttu-id="32047-227">_RequirementSetName_ (obligatoire) est une chaîne qui représente le nom de l’ensemble de la configuration requise (p. ex., « **ExcelApi** », « **Mailbox** », etc.).</span><span class="sxs-lookup"><span data-stu-id="32047-227">_RequirementSetName_ (required) is a string that represents the name of the requirement set (e.g., "**ExcelApi**", "**Mailbox**", etc.).</span></span> <span data-ttu-id="32047-228">Pour plus d’informations concernant les ensembles de conditions requises disponibles, voir [Ensembles de conditions requises pour complément Office](../reference/requirement-sets/office-add-in-requirement-sets.md).</span><span class="sxs-lookup"><span data-stu-id="32047-228">For more information about available requirement sets, see [Office Add-in requirement sets](../reference/requirement-sets/office-add-in-requirement-sets.md).</span></span>
- <span data-ttu-id="32047-229">_MinimumVersion_ (facultatif) est une chaîne qui spécifie la version minimale de l'ensemble de conditions requises que l'application Office doit prendre en charge pour que le code de l'instruction s'exécute `if` (par exemple, «**1,9**»).</span><span class="sxs-lookup"><span data-stu-id="32047-229">_MinimumVersion_ (optional) is a string that specifies the minimum requirement set version that the Office application must support in order for the code within the `if` statement to run (e.g., "**1.9**").</span></span>

> [!WARNING]
> <span data-ttu-id="32047-230">Lors de l'appel de la méthode, la valeur du paramètre `isSetSupported` `MinimumVersion` (si spécifié) doit être une chaîne.</span><span class="sxs-lookup"><span data-stu-id="32047-230">When calling the `isSetSupported` method, the value of the `MinimumVersion` parameter (if specified) should be a string.</span></span> <span data-ttu-id="32047-231">En effet, l’analyseur syntaxique JavaScript ne peut pas différencier les valeurs numériques, telles que 1.1 et 1.10, mais le peut pour les valeurs chaîne, telles que « 1.1 » et « 1.10 ».</span><span class="sxs-lookup"><span data-stu-id="32047-231">This is because the JavaScript parser cannot differentiate between numeric values such as 1.1 and 1.10, where as it can for string values such as "1.1" and "1.10".</span></span>
> <span data-ttu-id="32047-232">La surcharge `number` est déconseillée.</span><span class="sxs-lookup"><span data-stu-id="32047-232">The `number` overload is deprecated.</span></span>

<span data-ttu-id="32047-233">À `isSetSupported` utiliser avec `RequirementSetName` l'application Office associée comme suit.</span><span class="sxs-lookup"><span data-stu-id="32047-233">Use `isSetSupported` with the `RequirementSetName` associated with the Office application as follows.</span></span>

|<span data-ttu-id="32047-234">Application Office</span><span class="sxs-lookup"><span data-stu-id="32047-234">Office application</span></span>|<span data-ttu-id="32047-235">RequirementSetName</span><span class="sxs-lookup"><span data-stu-id="32047-235">RequirementSetName</span></span>|
|---|---|
|<span data-ttu-id="32047-236">Excel</span><span class="sxs-lookup"><span data-stu-id="32047-236">Excel</span></span>|<span data-ttu-id="32047-237">ExcelApi</span><span class="sxs-lookup"><span data-stu-id="32047-237">ExcelApi</span></span>|
|<span data-ttu-id="32047-238">OneNote</span><span class="sxs-lookup"><span data-stu-id="32047-238">OneNote</span></span>|<span data-ttu-id="32047-239">OneNoteApi</span><span class="sxs-lookup"><span data-stu-id="32047-239">OneNoteApi</span></span>|
|<span data-ttu-id="32047-240">Outlook</span><span class="sxs-lookup"><span data-stu-id="32047-240">Outlook</span></span>|<span data-ttu-id="32047-241">Boîte aux lettres</span><span class="sxs-lookup"><span data-stu-id="32047-241">Mailbox</span></span>|
|<span data-ttu-id="32047-242">Word</span><span class="sxs-lookup"><span data-stu-id="32047-242">Word</span></span>|<span data-ttu-id="32047-243">WordApi</span><span class="sxs-lookup"><span data-stu-id="32047-243">WordApi</span></span>|

<span data-ttu-id="32047-244">La méthode et les ensembles de conditions requises pour ces applications sont disponibles dans le dernier `isSetSupported` fichier Office.js sur le CDN.</span><span class="sxs-lookup"><span data-stu-id="32047-244">The `isSetSupported` method and the requirement sets for these applications are available in the latest Office.js file on the CDN.</span></span> <span data-ttu-id="32047-245">Si vous n'utilisez pas Office.js à partir du CDN, votre add-in peut générer des exceptions, car elle ne sera `isSetSupported` pas définie.</span><span class="sxs-lookup"><span data-stu-id="32047-245">If you don't use Office.js from the CDN, your add-in might generate exceptions because `isSetSupported` will be undefined.</span></span> <span data-ttu-id="32047-246">Pour plus d'informations, voir [Spécifier la dernière bibliothèque d'API JavaScript pour Office.](#specify-the-latest-office-javascript-api-library)</span><span class="sxs-lookup"><span data-stu-id="32047-246">For more information, see [Specify the latest Office JavaScript API library](#specify-the-latest-office-javascript-api-library).</span></span>

<span data-ttu-id="32047-247">L'exemple de code suivant montre comment un application peut fournir des fonctionnalités différentes pour différentes applications Office qui peuvent prendre en charge différents ensembles de conditions requises ou membres d'API.</span><span class="sxs-lookup"><span data-stu-id="32047-247">The following code example shows how an add-in can provide different functionality for different Office applications that might support different requirement sets or API members.</span></span>

```js
if (Office.context.requirements.isSetSupported('WordApi', '1.1'))
{
    // Run code that provides additional functionality using the Word JavaScript API when the add-in runs in Word 2016 or later.
}
else if (Office.context.requirements.isSetSupported('CustomXmlParts'))
{
    // Run code that uses API members from the CustomXmlParts requirement set.
}
else
{
    // Run additional code when the Office application is not Word 2016 or later and does not support the CustomXmlParts requirement set.
}

```

## <a name="runtime-checks-using-methods-not-in-a-requirement-set"></a><span data-ttu-id="32047-248">Vérifications à l’exécution à l’aide de méthodes ne faisant pas partie d’un ensemble de conditions requises</span><span class="sxs-lookup"><span data-stu-id="32047-248">Runtime checks using methods not in a requirement set</span></span>

<span data-ttu-id="32047-249">Certains membres API n’appartiennent pas à des ensembles de conditions requises.</span><span class="sxs-lookup"><span data-stu-id="32047-249">Some API members don't belong to requirement sets.</span></span> <span data-ttu-id="32047-250">Cela s'applique uniquement aux membres d'API qui font partie de l'espace de noms de [l'API JavaScript pour Office](../reference/javascript-api-for-office.md) (à l'exception des API de boîte aux lettres Outlook), mais pas aux membres d'API qui appartiennent à l'API JavaScript pour Word (quelque chose dans), à l'API JavaScript pour Excel (tout dans) ou à l'API `Office.` [](/javascript/api/outlook) [](../reference/overview/word-add-ins-reference-overview.md) `Word.` [](../reference/overview/excel-add-ins-reference-overview.md) `Excel.` [JavaScript OneNote](../reference/overview/onenote-add-ins-javascript-reference.md) (tout élément dans les espaces de `OneNote.` noms).</span><span class="sxs-lookup"><span data-stu-id="32047-250">This only applies to API members that are part of the [Office JavaScript API](../reference/javascript-api-for-office.md) namespace (anything under `Office.` except [Outlook Mailbox APIs](/javascript/api/outlook)), but not API members that belong to the [Word JavaScript API](../reference/overview/word-add-ins-reference-overview.md) (anything in `Word.`), [Excel JavaScript API](../reference/overview/excel-add-ins-reference-overview.md) (anything in `Excel.`), or [OneNote JavaScript API](../reference/overview/onenote-add-ins-javascript-reference.md) (anything in `OneNote.`) namespaces.</span></span> <span data-ttu-id="32047-251">Lorsque votre application dépend d'une méthode qui ne fait pas partie d'un ensemble de conditions requises, vous pouvez utiliser la vérification à l'runtime pour déterminer si la méthode est prise en charge par l'application Office, comme illustré dans l'exemple de code suivant.</span><span class="sxs-lookup"><span data-stu-id="32047-251">When your add-in depends on a method that is not part of a requirement set, you can use the runtime check to determine whether the method is supported by the Office application, as shown in the following code example.</span></span> <span data-ttu-id="32047-252">Pour consulter la liste complète des méthodes qui n’appartiennent pas à un ensemble de conditions requises, voir [Ensemble de conditions requises pour les compléments Office](../reference/requirement-sets/office-add-in-requirement-sets.md#methods-that-arent-part-of-a-requirement-set).</span><span class="sxs-lookup"><span data-stu-id="32047-252">For a complete list of methods that don't belong to a requirement set, see [Office Add-in requirement sets](../reference/requirement-sets/office-add-in-requirement-sets.md#methods-that-arent-part-of-a-requirement-set).</span></span>

> [!NOTE]
> <span data-ttu-id="32047-253">Nous vous recommandons de limiter l’utilisation de ce type de vérification à l’exécution dans le code de votre complément.</span><span class="sxs-lookup"><span data-stu-id="32047-253">We recommend that you limit the use of this type of runtime check in your add-in's code.</span></span>

<span data-ttu-id="32047-254">L'exemple de code suivant vérifie si l'application Office prend en charge `document.setSelectedDataAsync` .</span><span class="sxs-lookup"><span data-stu-id="32047-254">The following code example checks whether the Office application supports `document.setSelectedDataAsync`.</span></span>

```js
if (Office.context.document.setSelectedDataAsync)
{
    // Run code that uses `document.setSelectedDataAsync`.
}
```


## <a name="see-also"></a><span data-ttu-id="32047-255">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="32047-255">See also</span></span>

- [<span data-ttu-id="32047-256">Manifeste XML des compléments Office</span><span class="sxs-lookup"><span data-stu-id="32047-256">Office Add-ins XML manifest</span></span>](add-in-manifests.md)
- [<span data-ttu-id="32047-257">Ensembles de conditions requises pour les compléments Office</span><span class="sxs-lookup"><span data-stu-id="32047-257">Office Add-in requirement sets</span></span>](../reference/requirement-sets/office-add-in-requirement-sets.md)
- [<span data-ttu-id="32047-258">Word-Add-in-Get-Set-EditOpen-XML</span><span class="sxs-lookup"><span data-stu-id="32047-258">Word-Add-in-Get-Set-EditOpen-XML</span></span>](https://github.com/OfficeDev/Word-Add-in-Get-Set-EditOpen-XML)
