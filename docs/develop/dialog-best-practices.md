---
title: Pratiques recommandées et règles pour l’API de dialogue Office
description: Fournit des règles et des meilleures pratiques pour Office API de boîte de dialogue, telles que les meilleures pratiques pour une application mono-page (SPA)
ms.date: 02/09/2021
localization_priority: Normal
ms.openlocfilehash: 99129636cf722f98cef36c272f2e00e8a9321ccf
ms.sourcegitcommit: 883f71d395b19ccfc6874a0d5942a7016eb49e2c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/09/2021
ms.locfileid: "53349909"
---
# <a name="best-practices-and-rules-for-the-office-dialog-api"></a><span data-ttu-id="9360d-103">Pratiques recommandées et règles pour l’API de dialogue Office</span><span class="sxs-lookup"><span data-stu-id="9360d-103">Best practices and rules for the Office dialog API</span></span>

<span data-ttu-id="9360d-104">Cet article fournit des règles, des gotchas et des meilleures pratiques pour l’API de boîte de dialogue Office, y compris les meilleures pratiques pour la conception de l’interface utilisateur d’une boîte de dialogue et l’utilisation de l’API avec dans une application mono-page (SPA)</span><span class="sxs-lookup"><span data-stu-id="9360d-104">This article provides rules, gotchas, and best practices for the Office dialog API, including best practices for designing the UI of a dialog and using the API with in a single-page application (SPA)</span></span>

> [!NOTE]
> <span data-ttu-id="9360d-105">Cet article présuppose que vous connaissez les principes de base de l’utilisation de l’API de boîte de dialogue Office, comme décrit dans [l’API](dialog-api-in-office-add-ins.md)de boîte de dialogue Office dans vos Office.</span><span class="sxs-lookup"><span data-stu-id="9360d-105">This article presupposes that you are familiar with the basics of using the Office dialog API as described in [Use the Office dialog API in your Office Add-ins](dialog-api-in-office-add-ins.md).</span></span>
> 
> <span data-ttu-id="9360d-106">Voir aussi [Gestion des erreurs et des événements à l’Office boîte de dialogue .](dialog-handle-errors-events.md)</span><span class="sxs-lookup"><span data-stu-id="9360d-106">See also [Handling errors and events with the Office dialog box](dialog-handle-errors-events.md).</span></span>

## <a name="rules-and-gotchas"></a><span data-ttu-id="9360d-107">Règles et pièges</span><span class="sxs-lookup"><span data-stu-id="9360d-107">Rules and gotchas</span></span>

- <span data-ttu-id="9360d-108">La boîte de dialogue peut uniquement accéder aux URL HTTPS, et non à HTTP.</span><span class="sxs-lookup"><span data-stu-id="9360d-108">The dialog box can only navigate to HTTPS URLs, not HTTP.</span></span>
- <span data-ttu-id="9360d-109">L’URL transmise à la [méthode displayDialogAsync](/javascript/api/office/office.ui) doit se trouver exactement dans le même domaine que le add-in lui-même.</span><span class="sxs-lookup"><span data-stu-id="9360d-109">The URL passed to the [displayDialogAsync](/javascript/api/office/office.ui) method must be in the exact same domain as the add-in itself.</span></span> <span data-ttu-id="9360d-110">Il ne peut pas s’agit d’un sous-domaine.</span><span class="sxs-lookup"><span data-stu-id="9360d-110">It cannot be a subdomain.</span></span> <span data-ttu-id="9360d-111">Toutefois, la page qui lui est transmise peut rediriger vers une page d’un autre domaine.</span><span class="sxs-lookup"><span data-stu-id="9360d-111">But the page that is passed to it can redirect to a page in another domain.</span></span>
- <span data-ttu-id="9360d-112">Une fenêtre hôte, qui peut être un volet Des [](../reference/manifest/functionfile.md) tâches ou le fichier de fonction sans interface utilisateur d’une commande de add-in, ne peut avoir qu’une seule boîte de dialogue ouverte à la fois.</span><span class="sxs-lookup"><span data-stu-id="9360d-112">A host window, which can be a task pane or the UI-less [function file](../reference/manifest/functionfile.md) of an add-in command, can have only one dialog box open at a time.</span></span>
- <span data-ttu-id="9360d-113">Seules deux Office API peuvent être appelées dans la boîte de dialogue :</span><span class="sxs-lookup"><span data-stu-id="9360d-113">Only two Office APIs can be called in the dialog box:</span></span>
  - <span data-ttu-id="9360d-114">Fonction [messageParent.](/javascript/api/office/office.ui#messageparent-message-)</span><span class="sxs-lookup"><span data-stu-id="9360d-114">The [messageParent](/javascript/api/office/office.ui#messageparent-message-) function.</span></span>
  - <span data-ttu-id="9360d-115">`Office.context.requirements.isSetSupported`(Pour plus d’informations, voir Spécifier les Office [applications et les api requises.)](specify-office-hosts-and-api-requirements.md)</span><span class="sxs-lookup"><span data-stu-id="9360d-115">`Office.context.requirements.isSetSupported` (For more information, see [Specify Office applications and API requirements](specify-office-hosts-and-api-requirements.md).)</span></span>
- <span data-ttu-id="9360d-116">La [fonction messageParent](/javascript/api/office/office.ui#messageparent-message-) ne peut être appelée qu’à partir d’une page dans le même domaine que le add-in lui-même.</span><span class="sxs-lookup"><span data-stu-id="9360d-116">The [messageParent](/javascript/api/office/office.ui#messageparent-message-) function can only be called from a page in the exact same domain as the add-in itself.</span></span>

## <a name="best-practices"></a><span data-ttu-id="9360d-117">Meilleures pratiques</span><span class="sxs-lookup"><span data-stu-id="9360d-117">Best practices</span></span>

### <a name="avoid-overusing-dialog-boxes"></a><span data-ttu-id="9360d-118">Éviter de surutiliser les boîtes de dialogue</span><span class="sxs-lookup"><span data-stu-id="9360d-118">Avoid overusing dialog boxes</span></span>

<span data-ttu-id="9360d-119">Comme des éléments d’interface utilisateur qui se chevauchent peuvent gêner des utilisateurs, évitez d’ouvrir une boîte de dialogue à partir d’un volet Office à moins que votre scénario l’exige.</span><span class="sxs-lookup"><span data-stu-id="9360d-119">Because overlapping UI elements are discouraged, avoid opening a dialog box from a task pane unless your scenario requires it.</span></span> <span data-ttu-id="9360d-120">Lorsque vous envisagez d’utiliser la surface d’exposition d’un volet Office, tenez compte du fait que les volets Office peuvent être affichés sous forme d’onglets.</span><span class="sxs-lookup"><span data-stu-id="9360d-120">When you consider how to use the surface area of a task pane, note that task panes can be tabbed.</span></span> <span data-ttu-id="9360d-121">Pour obtenir un exemple de volet De tâches à onglets, voir l’exemple Excel de [salestracker JavaScript pour le](https://github.com/OfficeDev/Excel-Add-in-JavaScript-SalesTracker) module de développement.</span><span class="sxs-lookup"><span data-stu-id="9360d-121">For an example of a tabbed task pane, see the [Excel Add-in JavaScript SalesTracker](https://github.com/OfficeDev/Excel-Add-in-JavaScript-SalesTracker) sample.</span></span>

### <a name="designing-a-dialog-box-ui"></a><span data-ttu-id="9360d-122">Conception d’une interface utilisateur de boîte de dialogue</span><span class="sxs-lookup"><span data-stu-id="9360d-122">Designing a dialog box UI</span></span>

<span data-ttu-id="9360d-123">Pour obtenir les meilleures pratiques en matière de conception de boîte de dialogue, voir Boîtes de dialogue [Office des applications.](../design/dialog-boxes.md)</span><span class="sxs-lookup"><span data-stu-id="9360d-123">For best practices in dialog box design, see [Dialog boxes in Office Add-ins](../design/dialog-boxes.md).</span></span>

### <a name="handling-pop-up-blockers-with-office-on-the-web"></a><span data-ttu-id="9360d-124">Gestion des bloqueurs de fenêtres publicitaires avec Office sur le web</span><span class="sxs-lookup"><span data-stu-id="9360d-124">Handling pop-up blockers with Office on the web</span></span>

<span data-ttu-id="9360d-125">Toute tentative d’affichage d’une boîte de dialogue lors de l’Office sur le Web peut entraîner le blocage de la boîte de dialogue par le bloqueur de fenêtres d’affichage du navigateur.</span><span class="sxs-lookup"><span data-stu-id="9360d-125">Attempting to display a dialog box while using Office on the web may cause the browser's pop-up blocker to block the dialog box.</span></span> <span data-ttu-id="9360d-126">Office sur le Web a une fonctionnalité qui permet aux boîtes de dialogue de votre add-in d’être une exception au bloqueur de fenêtres pop-up du navigateur.</span><span class="sxs-lookup"><span data-stu-id="9360d-126">Office on the web has a feature that enables your add-in's dialog boxes to be an exception to the browser's pop-up blocker.</span></span> <span data-ttu-id="9360d-127">Lorsque votre code appelle la méthode, Office sur le Web ouvre une invite `displayDialogAsync` semblable à la suivante :</span><span class="sxs-lookup"><span data-stu-id="9360d-127">When your code calls the `displayDialogAsync` method, then Office on the web will open a prompt similar to the following:</span></span>

![Capture d’écran montrant l’invite avec une brève description et les boutons Autoriser et Ignorer qu’un add-in peut générer pour éviter les bloqueurs de fenêtres in-browser.](../images/dialog-prompt-before-open.png)

<span data-ttu-id="9360d-129">Si l’utilisateur choisit **Autoriser,** la boîte Office dialogue s’ouvre.</span><span class="sxs-lookup"><span data-stu-id="9360d-129">If the user chooses **Allow**, the Office dialog box opens.</span></span> <span data-ttu-id="9360d-130">Si l’utilisateur choisit **Ignorer,** l’invite se ferme et la boîte de dialogue Office’ouvre pas.</span><span class="sxs-lookup"><span data-stu-id="9360d-130">If the user chooses **Ignore**, the prompt closes and the Office dialog box does not open.</span></span> <span data-ttu-id="9360d-131">Au lieu de cela, `displayDialogAsync` la méthode renvoie l’erreur 12009.</span><span class="sxs-lookup"><span data-stu-id="9360d-131">Instead, the `displayDialogAsync` method returns error 12009.</span></span> <span data-ttu-id="9360d-132">Votre code doit capturer cette erreur et fournir une expérience de remplacement qui ne nécessite pas de boîte de dialogue ou afficher un message à l’utilisateur pour lui conseiller que le add-in exige qu’il autorise la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="9360d-132">Your code should catch this error and either provide an alternate experience that does not require a dialog, or display a message to the user advising that the add-in requires them to allow the dialog.</span></span> <span data-ttu-id="9360d-133">(Pour plus d’informations sur 12009, voir [Erreurs de displayDialogAsync.)](dialog-handle-errors-events.md#errors-from-displaydialogasync)</span><span class="sxs-lookup"><span data-stu-id="9360d-133">(For more about 12009, see [Errors from displayDialogAsync](dialog-handle-errors-events.md#errors-from-displaydialogasync).)</span></span>

<span data-ttu-id="9360d-134">Si, pour une raison quelconque, vous souhaitez désactiver cette fonctionnalité, votre code doit la désactiver. Il effectue cette demande avec [l’objet DialogOptions](/javascript/api/office/office.dialogoptions) qui est transmis à la `displayDialogAsync` méthode.</span><span class="sxs-lookup"><span data-stu-id="9360d-134">If, for any reason, you want to turn off this feature, then your code must opt out. It makes this request with the [DialogOptions](/javascript/api/office/office.dialogoptions) object that is passed to the `displayDialogAsync` method.</span></span> <span data-ttu-id="9360d-135">Plus précisément, l’objet doit inclure `promptBeforeOpen: false` .</span><span class="sxs-lookup"><span data-stu-id="9360d-135">Specifically, the object should include `promptBeforeOpen: false`.</span></span> <span data-ttu-id="9360d-136">Lorsque cette option est définie sur False, Office sur le Web demande pas à l’utilisateur d’autoriser le add-in à ouvrir une boîte de dialogue et la boîte de dialogue Office ne s’ouvre pas.</span><span class="sxs-lookup"><span data-stu-id="9360d-136">When this option is set to false, Office on the web will not prompt the user to allow the add-in open a dialog, and the Office dialog will not open.</span></span>

### <a name="do-not-use-the-_host_info-value"></a><span data-ttu-id="9360d-137">N’utilisez pas la valeur \_ \_ d’informations de l’hôte</span><span class="sxs-lookup"><span data-stu-id="9360d-137">Do not use the \_host\_info value</span></span>

<span data-ttu-id="9360d-138">Office ajoute automatiquement un paramètre de requête appelé `_host_info` à l’URL qui est transmise à `displayDialogAsync`.</span><span class="sxs-lookup"><span data-stu-id="9360d-138">Office automatically adds a query parameter called `_host_info` to the URL that is passed to `displayDialogAsync`.</span></span> <span data-ttu-id="9360d-139">Il est appended après vos paramètres de requête personnalisés, le cas cas.</span><span class="sxs-lookup"><span data-stu-id="9360d-139">It is appended after your custom query parameters, if any.</span></span> <span data-ttu-id="9360d-140">Elle n’est pas appendée aux URL suivantes vers qui la boîte de dialogue navigue.</span><span class="sxs-lookup"><span data-stu-id="9360d-140">It is not appended to any subsequent URLs that the dialog box navigates to.</span></span> <span data-ttu-id="9360d-141">Microsoft peut modifier le contenu de cette valeur ou le supprimer complètement, de sorte que votre code ne doit pas le lire.</span><span class="sxs-lookup"><span data-stu-id="9360d-141">Microsoft may change the content of this value, or remove it entirely, so your code should not read it.</span></span> <span data-ttu-id="9360d-142">La même valeur est ajoutée au stockage de session de la boîte de dialogue (autrement dit, la [propriété Window.sessionStorage).](https://developer.mozilla.org/docs/Web/API/Window/sessionStorage)</span><span class="sxs-lookup"><span data-stu-id="9360d-142">The same value is added to the dialog box's session storage (that is, the [Window.sessionStorage](https://developer.mozilla.org/docs/Web/API/Window/sessionStorage) property).</span></span> <span data-ttu-id="9360d-143">Là encore, *votre code ne doit ni lire, ni écrire cette valeur*.</span><span class="sxs-lookup"><span data-stu-id="9360d-143">Again, *your code should neither read nor write to this value*.</span></span>

### <a name="opening-another-dialog-immediately-after-closing-one"></a><span data-ttu-id="9360d-144">Ouverture d’une autre boîte de dialogue immédiatement après la fermeture d’une boîte de dialogue</span><span class="sxs-lookup"><span data-stu-id="9360d-144">Opening another dialog immediately after closing one</span></span>

<span data-ttu-id="9360d-145">Comme plusieurs boîtes de dialogue ne peuvent pas être ouvertes à partir d’une page hôte donnée, votre code doit appeler [Dialog.close](/javascript/api/office/office.dialog#close__) dans une boîte de dialogue ouverte avant d’appeler l’ouverture `displayDialogAsync` d’une autre boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="9360d-145">You can't have more than one dialog open from a given host page, so your code should call [Dialog.close](/javascript/api/office/office.dialog#close__) on an open dialog before it calls `displayDialogAsync` to open another dialog.</span></span> <span data-ttu-id="9360d-146">La `close` méthode est asynchrone.</span><span class="sxs-lookup"><span data-stu-id="9360d-146">The `close` method is asynchronous.</span></span> <span data-ttu-id="9360d-147">Pour cette raison, si vous appelez immédiatement après un appel de , il se peut que la première boîte de dialogue ne soit pas complètement fermée Office `displayDialogAsync` tente d’ouvrir `close` la seconde.</span><span class="sxs-lookup"><span data-stu-id="9360d-147">For this reason, if you call `displayDialogAsync` immediately after a call of `close`, the first dialog may not have completely closed when Office attempts to open the second.</span></span> <span data-ttu-id="9360d-148">Si cela se produit, Office renvoyer une erreur [12007](dialog-handle-errors-events.md#12007) : « L’opération a échoué, car ce module a déjà une boîte de dialogue active. »</span><span class="sxs-lookup"><span data-stu-id="9360d-148">If that happens, Office will return a [12007](dialog-handle-errors-events.md#12007) error: "The operation failed because this add-in already has an active dialog."</span></span>

<span data-ttu-id="9360d-149">La méthode n’accepte pas de paramètre de rappel et ne retourne pas d’objet Promise, elle ne peut donc pas être attendue avec le mot clé ou `close` `await` avec une `then` méthode.</span><span class="sxs-lookup"><span data-stu-id="9360d-149">The `close` method doesn't accept a callback parameter, and it doesn't return a Promise object so it cannot be awaited with either the `await` keyword or with a `then` method.</span></span> <span data-ttu-id="9360d-150">Pour cette raison, nous vous suggérons la technique suivante lorsque vous devez ouvrir une nouvelle boîte de dialogue immédiatement après la fermeture d’une boîte de dialogue : encapsulez le code pour ouvrir la nouvelle boîte de dialogue dans une méthode et concevez la méthode pour qu’elle s’appelle de manière récursive si l’appel de retour `displayDialogAsync` `12007` .</span><span class="sxs-lookup"><span data-stu-id="9360d-150">For this reason, we suggest the following technique when you need to open a new dialog immediately after closing a dialog: encapsulate the code to open the new dialog in a method and design the method to recursively call itself if the call of `displayDialogAsync` returns `12007`.</span></span> <span data-ttu-id="9360d-151">Voici un exemple.</span><span class="sxs-lookup"><span data-stu-id="9360d-151">The following is an example.</span></span>

```javascript
function openFirstDialog() {
  Office.context.ui.displayDialogAsync("https://MyDomain/firstDialog.html", { width: 50, height: 50},
     (result) => {
      if(result.status === Office.AsyncResultStatus.Succeeded) {
        const dialog = result.value;
        dialog.close();
        openSecondDialog();
      }
      else {
         // Handle errors
      }
    }
  );
}
 
function openSecondDialog() {
  Office.context.ui.displayDialogAsync("https://MyDomain/secondDialog.html", { width: 50, height: 50},
    (result) => {
      if(result.status === Office.AsyncResultStatus.Failed) {
        if (result.error.code === 12007) {
          openSecondDialog(); // Recursive call
        }
        else {
         // Handle other errors
        }
      }
    }
  );
}
```

<span data-ttu-id="9360d-152">Vous pouvez également forcer l’interruption du code avant d’essayer d’ouvrir la deuxième boîte de dialogue à l’aide de la [méthode setTimeout.](https://www.w3schools.com/jsref/met_win_settimeout.asp)</span><span class="sxs-lookup"><span data-stu-id="9360d-152">Alternatively, you could force the code to pause before it tries to open the second dialog by using the [setTimeout](https://www.w3schools.com/jsref/met_win_settimeout.asp) method.</span></span> <span data-ttu-id="9360d-153">Voici un exemple.</span><span class="sxs-lookup"><span data-stu-id="9360d-153">The following is an example.</span></span>

```javascript
function openFirstDialog() {
  Office.context.ui.displayDialogAsync("https://MyDomain/firstDialog.html", { width: 50, height: 50},
     (result) => {
      if(result.status === Office.AsyncResultStatus.Succeeded) {
        const dialog = result.value;
        dialog.close();
        setTimeout(() => { 
          Office.context.ui.displayDialogAsync("https://MyDomain/secondDialog.html", { width: 50, height: 50},
             (result) => { /* callback body */ }
          );
        }, 1000);
      }
      else {
         // Handle errors
      }
    }
  );
}
```

### <a name="best-practices-for-using-the-office-dialog-api-in-an-spa"></a><span data-ttu-id="9360d-154">Meilleures pratiques pour l’utilisation de l’API Office boîte de dialogue dans une SPA</span><span class="sxs-lookup"><span data-stu-id="9360d-154">Best practices for using the Office dialog API in an SPA</span></span>

<span data-ttu-id="9360d-155">Si votre application utilise le routage côté client, comme le font généralement les applications mono-page, vous avez la possibilité de transmettre l’URL d’un itinéraire à la méthode [displayDialogAsync](/javascript/api/office/office.ui) au lieu de l’URL d’une page HTML distincte.</span><span class="sxs-lookup"><span data-stu-id="9360d-155">If your add-in uses client-side routing, as single-page applications (SPAs) typically do, you have the option to pass the URL of a route to the [displayDialogAsync](/javascript/api/office/office.ui) method instead of the URL of a separate HTML page.</span></span> <span data-ttu-id="9360d-156">*Nous vous déconseillons de le faire pour les raisons ci-dessous.*</span><span class="sxs-lookup"><span data-stu-id="9360d-156">*We recommend against doing so for the reasons given below.*</span></span>

> [!NOTE]
> <span data-ttu-id="9360d-157">Cet article n’est pas pertinent pour *le* routage côté serveur, comme dans une application web express.</span><span class="sxs-lookup"><span data-stu-id="9360d-157">This article is not relevant to *server-side* routing, such as in an Express-based web application.</span></span>

#### <a name="problems-with-spas-and-the-office-dialog-api"></a><span data-ttu-id="9360d-158">Problèmes avec les SSA et l’API Office boîte de dialogue de gestion</span><span class="sxs-lookup"><span data-stu-id="9360d-158">Problems with SPAs and the Office dialog API</span></span>

<span data-ttu-id="9360d-159">La Office boîte de dialogue se trouve dans une nouvelle fenêtre avec sa propre instance du moteur JavaScript, et par conséquent son propre contexte d’exécution complet.</span><span class="sxs-lookup"><span data-stu-id="9360d-159">The Office dialog box is in a new window with its own instance of the JavaScript engine, and hence it's own complete execution context.</span></span> <span data-ttu-id="9360d-160">Si vous passez un itinéraire, votre page de base et tout son code d’initialisation et de mise en route s’exécutent à nouveau dans ce nouveau contexte, et toutes les variables sont définies sur leurs valeurs initiales dans la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="9360d-160">If you pass a route, your base page and all its initialization and bootstrapping code run again in this new context, and any variables are set to their initial values in the dialog box.</span></span> <span data-ttu-id="9360d-161">Par conséquent, cette technique télécharge et lance une deuxième instance de votre application dans la fenêtre box, ce qui va partiellement à l’emploi d’une SPA.</span><span class="sxs-lookup"><span data-stu-id="9360d-161">So this technique downloads and launches a second instance of your application in the  box window, which partially defeats the purpose of an SPA.</span></span> <span data-ttu-id="9360d-162">En outre, le code qui modifie des variables dans la fenêtre de boîte de dialogue ne modifie pas la version du volet Des tâches des mêmes variables.</span><span class="sxs-lookup"><span data-stu-id="9360d-162">In addition, code that changes variables in the dialog box window does not change the task pane version of the same variables.</span></span> <span data-ttu-id="9360d-163">De même, la fenêtre de la boîte de dialogue possède son propre stockage de session (propriété [Window.sessionStorage),](https://developer.mozilla.org/docs/Web/API/Window/sessionStorage) qui n’est pas accessible à partir du code dans le volet Des tâches.</span><span class="sxs-lookup"><span data-stu-id="9360d-163">Similarly, the dialog box window has its own session storage (the [Window.sessionStorage](https://developer.mozilla.org/docs/Web/API/Window/sessionStorage) property), which is not accessible from code in the task pane.</span></span> <span data-ttu-id="9360d-164">La boîte de dialogue et la page hôte sur laquelle a été appelée ressemblent `displayDialogAsync` deux clients différents à votre serveur.</span><span class="sxs-lookup"><span data-stu-id="9360d-164">The dialog box and the host page on which `displayDialogAsync` was called look like two different clients to your server.</span></span> <span data-ttu-id="9360d-165">(Pour un rappel de ce qu’est une page hôte, voir Ouvrir une boîte de dialogue [à partir d’une page hôte.)](dialog-api-in-office-add-ins.md#open-a-dialog-box-from-a-host-page)</span><span class="sxs-lookup"><span data-stu-id="9360d-165">(For a reminder of what a host page is, see [Open a dialog box from a host page](dialog-api-in-office-add-ins.md#open-a-dialog-box-from-a-host-page).)</span></span>

<span data-ttu-id="9360d-166">Par exemple, si vous avez transmis un itinéraire à la méthode, vous n’ariez pas vraiment de SPA ; vous ariez deux `displayDialogAsync` *instances de la même SPA*.</span><span class="sxs-lookup"><span data-stu-id="9360d-166">So, if you passed a route to the `displayDialogAsync` method, you wouldn't really have an SPA; you'd have *two instances of the same SPA*.</span></span> <span data-ttu-id="9360d-167">En outre, une grande partie du code dans l’instance du volet Des tâches ne sera jamais utilisée dans cette instance et la plus grande partie du code dans l’instance de la boîte de dialogue ne sera jamais utilisée dans cette instance.</span><span class="sxs-lookup"><span data-stu-id="9360d-167">Moreover, much of the code in the task pane instance would never be used in that instance and much of the code in the dialog box instance would never be used in that instance.</span></span> <span data-ttu-id="9360d-168">Ce serait comme avoir deux SPAs dans le même lot.</span><span class="sxs-lookup"><span data-stu-id="9360d-168">It would be like having two SPAs in the same bundle.</span></span>

#### <a name="microsoft-recommendations"></a><span data-ttu-id="9360d-169">Recommandations de Microsoft</span><span class="sxs-lookup"><span data-stu-id="9360d-169">Microsoft recommendations</span></span>

<span data-ttu-id="9360d-170">Au lieu de transmettre un itinéraire côté client à la méthode, nous vous recommandons d’adopter l’une des `displayDialogAsync` méthodes suivantes :</span><span class="sxs-lookup"><span data-stu-id="9360d-170">Instead of passing a client-side route to the `displayDialogAsync` method, we recommend that you do one of the following:</span></span>

* <span data-ttu-id="9360d-171">Si le code que vous souhaitez exécuter dans la boîte de dialogue est suffisamment complexe, créez explicitement deux spa différents . autrement dit, avoir deux spas dans des dossiers différents du même domaine.</span><span class="sxs-lookup"><span data-stu-id="9360d-171">If the code that you want to run in the dialog box is sufficiently complex, create two different SPAs explicitly; that is, have two SPAs in different folders of the same domain.</span></span> <span data-ttu-id="9360d-172">Une SPA s’exécute dans la boîte de dialogue et l’autre dans la page hôte de la boîte de dialogue où `displayDialogAsync` elle a été appelée.</span><span class="sxs-lookup"><span data-stu-id="9360d-172">One SPA runs in the dialog box and the other in the dialog box's host page where `displayDialogAsync` was called.</span></span> 
* <span data-ttu-id="9360d-173">Dans la plupart des scénarios, seule une logique simple est nécessaire dans la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="9360d-173">In most scenarios, only simple logic is needed in the dialog box.</span></span> <span data-ttu-id="9360d-174">Dans ce cas, votre projet sera considérablement simplifié en hébergeant une page HTML unique, avec javaScript incorporé ou référencé, dans le domaine de votre SPA.</span><span class="sxs-lookup"><span data-stu-id="9360d-174">In such cases, your project will be greatly simplified by hosting a single HTML page, with embedded or referenced JavaScript, in the domain of your SPA.</span></span> <span data-ttu-id="9360d-175">Passez l’URL de la page à la méthode`displayDialogAsync`.</span><span class="sxs-lookup"><span data-stu-id="9360d-175">Pass the URL of the page to the `displayDialogAsync` method.</span></span> <span data-ttu-id="9360d-176">Cela signifie que vous déviez de l’idée littérale d’une application à page unique ; vous n’avez pas vraiment une seule instance d’une SPA lorsque vous utilisez l’API Office dialogue.</span><span class="sxs-lookup"><span data-stu-id="9360d-176">While this means that you are deviating from the literal idea of a single-page app; you don't really have a single instance of an SPA when you are using the Office dialog API.</span></span>
