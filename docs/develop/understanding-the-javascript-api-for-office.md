---
title: Présentation de l’API JavaScript pour Office
description: ''
ms.date: 10/17/2018
ms.openlocfilehash: 266014305af67d53046dac9a5492e08dbbb8dc29
ms.sourcegitcommit: 2ac7d64bb2db75ace516a604866850fce5cb2174
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/14/2018
ms.locfileid: "26298557"
---
# <a name="understanding-the-javascript-api-for-office"></a><span data-ttu-id="4aaec-102">Présentation de l’API JavaScript pour Office</span><span class="sxs-lookup"><span data-stu-id="4aaec-102">Understanding the JavaScript API for Office</span></span>

<span data-ttu-id="4aaec-p101">Cet article fournit des informations sur l’API JavaScript pour Office et son utilisation. Pour obtenir des informations de référence, voir [API JavaScript pour Office](https://docs.microsoft.com/office/dev/add-ins/reference/javascript-api-for-office?view=office-js). Pour plus d’informations sur la mise à jour des fichiers de projet Visual Studio vers la version la plus récente de l’API JavaScript pour Office, voir [Mettre à jour la version de votre API JavaScript pour Office et les fichiers de schéma manifeste](update-your-javascript-api-for-office-and-manifest-schema-version.md).</span><span class="sxs-lookup"><span data-stu-id="4aaec-p101">This article provides information about the JavaScript API for Office and how to use it. For reference information, see [JavaScript API for Office](https://docs.microsoft.com/office/dev/add-ins/reference/javascript-api-for-office?view=office-js). For information about updating Visual Studio project files to the most current version of the JavaScript API for Office, see [Update the version of your JavaScript API for Office and manifest schema files](update-your-javascript-api-for-office-and-manifest-schema-version.md).</span></span>

> [!NOTE]
> <span data-ttu-id="4aaec-p102">Si vous prévoyez de [publier](../publish/publish.md) votre complément sur AppSource et de le rendre disponible dans l’expérience Office, assurez-vous que vous respectez les [stratégies de validation AppSource](https://docs.microsoft.com/office/dev/store/validation-policies). Par exemple, pour réussir la validation, votre complément doit fonctionner sur toutes les plateformes prenant en charge les méthodes définies (pour en savoir plus, consultez la [section 4.12](https://docs.microsoft.com/office/dev/store/validation-policies#4-apps-and-add-ins-behave-predictably) et la [page relative à la disponibilité des compléments Office sur les plateformes et les hôtes](../overview/office-add-in-availability.md)).</span><span class="sxs-lookup"><span data-stu-id="4aaec-p102">If you plan to [publish](../publish/publish.md) your add-in to AppSource and make it available within the Office experience, make sure that you conform to the [AppSource validation policies](https://docs.microsoft.com/office/dev/store/validation-policies). For example, to pass validation, your add-in must work across all platforms that support the methods that you define (for more information, see [section 4.12](https://docs.microsoft.com/office/dev/store/validation-policies#4-apps-and-add-ins-behave-predictably) and the [Office Add-in host and availability page](../overview/office-add-in-availability.md)).</span></span> 

## <a name="referencing-the-javascript-api-for-office-library-in-your-add-in"></a><span data-ttu-id="4aaec-108">Référencer la bibliothèque de l’interface API JavaScript pour Office dans votre complément</span><span class="sxs-lookup"><span data-stu-id="4aaec-108">Referencing the JavaScript API for Office library in your add-in</span></span>

<span data-ttu-id="4aaec-p103">La bibliothèque de l’[interface API JavaScript pour Office](https://docs.microsoft.com/office/dev/add-ins/reference/javascript-api-for-office?view=office-js) comprend le fichier Office.js et des fichiers .js propres aux applications hôtes associées, comme Excel-15.js et Outlook15.js. La méthode la plus simple pour référencer l’interface API est d’utiliser notre CDN en ajoutant le `<script>` suivant à la balise `<head>` de votre page :</span><span class="sxs-lookup"><span data-stu-id="4aaec-p103">The [JavaScript API for Office](https://docs.microsoft.com/office/dev/add-ins/reference/javascript-api-for-office?view=office-js) library consists of the Office.js file and associated host application-specific .js files, such as Excel-15.js and Outlook-15.js. The simplest method of referencing the API is using our CDN by adding the following `<script>` to your page's `<head>` tag:</span></span>  

```html
<script src="https://appsforoffice.microsoft.com/lib/1/hosted/Office.js" type="text/javascript"></script>
```

<span data-ttu-id="4aaec-111">Cette opération permet de télécharger et de mettre en cache les fichiers de l’interface API JavaScript pour Office lors du premier chargement de votre complément pour garantir qu’elle utilise l’implémentation d’Office.js la plus récente et les fichiers .js qui lui sont associés pour la version indiquée.</span><span class="sxs-lookup"><span data-stu-id="4aaec-111">This will download and cache the JavaScript API for Office files the first time your add-in loads to make sure that it is using the most up-to-date implementation of Office.js and its associated files for the specified version.</span></span>

<span data-ttu-id="4aaec-112">Pour obtenir plus d’informations sur le CDN Office.js et la gestion du contrôle de version et de la rétrocompatibilité, consultez la page relative au [référencement de la bibliothèque de l’interface API JavaScript pour Office à partir de son réseau de distribution de contenu (CDN)](referencing-the-javascript-api-for-office-library-from-its-cdn.md).</span><span class="sxs-lookup"><span data-stu-id="4aaec-112">For more details around the Office.js CDN, including how versioning and backward compatability is handled, see [Referencing the JavaScript API for Office library from its content delivery network (CDN)](referencing-the-javascript-api-for-office-library-from-its-cdn.md).</span></span>

## <a name="initializing-your-add-in"></a><span data-ttu-id="4aaec-113">Initialisation de votre complément</span><span class="sxs-lookup"><span data-stu-id="4aaec-113">Initializing your add-in</span></span>

<span data-ttu-id="4aaec-114">**S’applique à :** tous les types de complément</span><span class="sxs-lookup"><span data-stu-id="4aaec-114">**Applies to:** All add-in types</span></span>

<span data-ttu-id="4aaec-115">Les compléments Office ont souvent une logique de démarrage pour effectuer des actions telles que :</span><span class="sxs-lookup"><span data-stu-id="4aaec-115">Office Add-ins often have start-up logic to do things such as:</span></span>

- <span data-ttu-id="4aaec-116">Vérifiez que version de l’utilisateur d’Office prendra en charge tous les API Office que votre code appelle.</span><span class="sxs-lookup"><span data-stu-id="4aaec-116">Check that the user's version of Office will support all the Office APIs that your code calls.</span></span>

- <span data-ttu-id="4aaec-117">Vérifiez l’existence de certains artefacts tels que des feuille de calcul avec un nom spécifique.</span><span class="sxs-lookup"><span data-stu-id="4aaec-117">Ensure the existence of certain artifacts, such as worksheet with a specific name.</span></span>

- <span data-ttu-id="4aaec-118">Avertir l’utilisateur pour sélectionner certaines cellules dans Excel, puis insérer un graphique initialisé avec ces valeurs sélectionnées.</span><span class="sxs-lookup"><span data-stu-id="4aaec-118">You can use the initialize event handler to implement common add-in initialization scenarios, such as prompting the user to select some cells in Excel, and then inserting a chart initialized with those selected values.</span></span>

- <span data-ttu-id="4aaec-119">Établir des liaisons.</span><span class="sxs-lookup"><span data-stu-id="4aaec-119">Establish bindings.</span></span>

- <span data-ttu-id="4aaec-120">Utilisez la boîte de dialogue Office API pour inviter l’utilisateur pour les valeurs de paramètres des compléments par défaut.</span><span class="sxs-lookup"><span data-stu-id="4aaec-120">Use the Office dialog API to prompt the user for default add-in settings values.</span></span>

<span data-ttu-id="4aaec-121">Mais votre code démarrage ne doit pas appeler n’importe quel APIs Office.js jusqu'à ce que la bibliothèque ne soit entièrement chargée.</span><span class="sxs-lookup"><span data-stu-id="4aaec-121">But your start-up code must not call any Office.js APIs until the library is fully loaded.</span></span> <span data-ttu-id="4aaec-122">Il existe deux manières pour votre code de s’assurer que la bibliothèque est chargée.</span><span class="sxs-lookup"><span data-stu-id="4aaec-122">There are two ways that your code can ensure that the library is loaded.</span></span> <span data-ttu-id="4aaec-123">Ceci est décrit en détail dans les sections ci-après :</span><span class="sxs-lookup"><span data-stu-id="4aaec-123">These attributes are described in the following sections.</span></span> 

- [<span data-ttu-id="4aaec-124">Initialiser avec Office.onReady()</span><span class="sxs-lookup"><span data-stu-id="4aaec-124">Initialize with Office.onReady()</span></span>](#initialize-with-officeonready)
- [<span data-ttu-id="4aaec-125">Initialiser avec Office.initialize</span><span class="sxs-lookup"><span data-stu-id="4aaec-125">Initialize with Office.initialize</span></span>](#initialize-with-officeinitialize)

<span data-ttu-id="4aaec-126">Pour plus d’informations sur les différences entre ces techniques, voir [Différences majeures entre Office.initialize et Office.onReady()](#major-differences-between-officeinitialize-and-officeonready).</span><span class="sxs-lookup"><span data-stu-id="4aaec-126">For information about the differences in these techniques, see [Major differences between Office.initialize and Office.onReady()](#major-differences-between-officeinitialize-and-officeonready).</span></span> <span data-ttu-id="4aaec-127">Pour plus de détails sur la séquence d’événements lors de l’initialisation d’un complément, reportez-vous à la rubrique [Chargement du DOM et environnement d’exécution](loading-the-dom-and-runtime-environment.md).</span><span class="sxs-lookup"><span data-stu-id="4aaec-127">For more detail about the sequence of events when an add-in is initialized, see [Loading the DOM and runtime environment](loading-the-dom-and-runtime-environment.md).</span></span>

### <a name="initialize-with-officeonready"></a><span data-ttu-id="4aaec-128">Initialiser avec Office.onReady()</span><span class="sxs-lookup"><span data-stu-id="4aaec-128">Initialize with Office.onReady()</span></span>

<span data-ttu-id="4aaec-129">`Office.onReady()` est une méthode asynchrone qui renvoie un objet Promise tandis qu’il vérifie si la bibliothèque Office.js est entièrement chargée.</span><span class="sxs-lookup"><span data-stu-id="4aaec-129">`Office.onReady()` is an asynchronous method that returns a Promise object while it checks to see if the Office.js library is fully loaded.</span></span> <span data-ttu-id="4aaec-130">Uniquement lorsque la bibliothèque est chargée, cela résout la promesse sous forme d’objet qui spécifie l’application Office hôte avec une`Office.HostType` valeur enum (`Excel`, `Word`, etc.) et la plateforme avec une`Office.PlatformType` valeur enum (`PC`, `Mac`, `OfficeOnline`, etc..).</span><span class="sxs-lookup"><span data-stu-id="4aaec-130">When, and only when, the library is loaded, it resolves the Promise as an object that specifies the Office host application with an `Office.HostType` enum value (`Excel`, `Word`, etc.) and the platform with an `Office.PlatformType` enum value (`PC`, `Mac`, `OfficeOnline`, etc.).</span></span> <span data-ttu-id="4aaec-131">Si la bibliothèque est déjà chargée quand `Office.onReady()` est appelée, la promesse se résout immédiatement.</span><span class="sxs-lookup"><span data-stu-id="4aaec-131">If the library is already loaded when `Office.onReady()` is called, then the Promise resolves immediately.</span></span>

<span data-ttu-id="4aaec-132">Une méthode pour appeler `Office.onReady()` consiste à transmettre une méthode de rappel.</span><span class="sxs-lookup"><span data-stu-id="4aaec-132">One way to call `Office.onReady()` is to pass it a callback method.</span></span> <span data-ttu-id="4aaec-133">Voici un exemple :</span><span class="sxs-lookup"><span data-stu-id="4aaec-133">Here's an example:</span></span>

```js
Office.onReady(function(info) {
    if (info.host === Office.HostType.Excel) {
        // Do Excel-specific initialization (for example, make add-in task pane's
        // appearance compatible with Excel "green").
    }
    if (info.platform === Office.PlatformType.PC) {
        // Make minor layout changes in the task pane.
    }
    console.log(`Office.js is now ready in ${info.host} on ${info.platform}`);
});
```

<span data-ttu-id="4aaec-134">Par ailleurs, vous pouvez mettre en chaîne une`then()` méthode permettant d’appeler `Office.onReady()`, au lieu de spécifier un rappel.</span><span class="sxs-lookup"><span data-stu-id="4aaec-134">Alternatively, you can chain a `then()` method to the call of `Office.onReady()`, instead of passing a callback.</span></span> <span data-ttu-id="4aaec-135">Par exemple, le code suivant vérifie que la version de l’utilisateur d’Excel prend en charge tous les API que le complément peut appeler.</span><span class="sxs-lookup"><span data-stu-id="4aaec-135">For example, the following code checks to see that the user's version of Excel supports all the APIs that the add-in might call.</span></span>

```js
Office.onReady()
    .then(function() {
        if (!Office.context.requirements.isSetSupported('ExcelApi', '1.7')) {
            console.log("Sorry, this add-in only works with newer versions of Excel.");
        }
    });
```

<span data-ttu-id="4aaec-136">Voici le même exemple utilisant les mots clés `async` et `await` dans TypeScript :</span><span class="sxs-lookup"><span data-stu-id="4aaec-136">Here is the same example using the `async` and `await` keywords in TypeScript:</span></span>

```typescript
(async () => {
    await Office.onReady();
    if (!Office.context.requirements.isSetSupported('ExcelApi', '1.7')) {
        console.log("Sorry, this add-in only works with newer versions of Excel.");
    }
})();
```

<span data-ttu-id="4aaec-137">Si vous utilisez des infrastructures JavaScript supplémentaires qui incluent leur propre gestionnaire d’initialisation ou tests, elles doivent être*habituellement* placées dans la réponse à`Office.onReady()`.</span><span class="sxs-lookup"><span data-stu-id="4aaec-137">If you are using additional JavaScript frameworks that include their own initialization handler or tests, these should be placed within the Office.initialize event.</span></span> <span data-ttu-id="4aaec-138">Par exemple, la fonction `$(document).ready()` de [JQuery](https://jquery.com) sera référencée comme suit :</span><span class="sxs-lookup"><span data-stu-id="4aaec-138">For example, [JQuery's](https://jquery.com) `$(document).ready()` function would be referenced as follows:</span></span>

```js
Office.onReady(function() {
    // Office is ready
    $(document).ready(function () {
        // The document is ready
    });
});
```

<span data-ttu-id="4aaec-139">Toutefois, il existe des exceptions à cette pratique.</span><span class="sxs-lookup"><span data-stu-id="4aaec-139">However, there are exceptions to this practice.</span></span> <span data-ttu-id="4aaec-140">Par exemple, supposons que vous voulez ouvrir votre complément dans un navigateur (au lieu de le charger dans un hôte Office) afin de déboguer votre interface utilisateur avec les outils de navigateur.</span><span class="sxs-lookup"><span data-stu-id="4aaec-140">For example, suppose you want to open your add-in in a browser (instead of sideload it in an Office host) in order to debug your UI with browser tools.</span></span> <span data-ttu-id="4aaec-141">Étant donné que Office.js ne sera pas chargé dans le navigateur, `onReady` ne s’exécutera pas et le `$(document).ready` ne s’exécutera pas si cette opération est appelée à l’intérieur d’Office `onReady`.</span><span class="sxs-lookup"><span data-stu-id="4aaec-141">Since Office.js won't load in the browser, `onReady` won't run and the `$(document).ready` won't run if it's called inside the Office `onReady`.</span></span> <span data-ttu-id="4aaec-142">Une autre exception : vous souhaitez qu’un indicateur de progression s’affiche dans le volet Office tandis que le complément se charge.</span><span class="sxs-lookup"><span data-stu-id="4aaec-142">Another exception: you want a progress indicator to appear in the task pane while the add-in is loading.</span></span> <span data-ttu-id="4aaec-143">Dans ce scénario, votre code doit appeler la jQuery `ready` et utiliser le rappel pour afficher l’indicateur de progression.</span><span class="sxs-lookup"><span data-stu-id="4aaec-143">In this scenario, your code should call the jQuery `ready` and use it's callback to render the progress indicator.</span></span> <span data-ttu-id="4aaec-144">Puis le rappel `onReady` Office peut remplacer l’indicateur de progression par l’interface utilisateur final.</span><span class="sxs-lookup"><span data-stu-id="4aaec-144">Then the Office `onReady`'s callback can replace the progress indicator with the final UI.</span></span> 

### <a name="initialize-with-officeinitialize"></a><span data-ttu-id="4aaec-145">Initialiser avec Office.initialize</span><span class="sxs-lookup"><span data-stu-id="4aaec-145">Initialize with Office.initialize</span></span>

<span data-ttu-id="4aaec-146">Un événement initialisé se déclenche lorsque la bibliothèque Office.js est entièrement chargée et prête pour une interaction avec l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="4aaec-146">An initialize event fires when the Office.js library is fully loaded and ready for user interaction.</span></span> <span data-ttu-id="4aaec-147">Vous pouvez attribuer un gestionnaire à `Office.initialize` qui implémente votre logique d’initialisation.</span><span class="sxs-lookup"><span data-stu-id="4aaec-147">You can assign a handler to `Office.initialize` that implements your initialization logic.</span></span> <span data-ttu-id="4aaec-148">L’exemple suivant vérifie que la version de l’utilisateur d’Excel prend en charge tous les API que le complément peut appeler.</span><span class="sxs-lookup"><span data-stu-id="4aaec-148">The following is an example that checks to see that the user's version of Excel supports all the APIs that the add-in might call.</span></span>

```js
Office.initialize = function () {
    if (!Office.context.requirements.isSetSupported('ExcelApi', '1.7')) {
        console.log("Sorry, this add-in only works with newer versions of Excel.");
    }
};
```

<span data-ttu-id="4aaec-149">Si vous utilisez des infrastructures JavaScript supplémentaires qui incluent leur propre gestionnaire d’initialisation ou tests, elles doivent être*habituellement* placées dans l’événement`Office.initialize`.</span><span class="sxs-lookup"><span data-stu-id="4aaec-149">If you are using additional JavaScript frameworks that include their own initialization handler or tests, these should be placed within the Office.initialize event.</span></span> <span data-ttu-id="4aaec-150">(Mais les exceptions décrites dans la section **initialiser avec Office.onReady()** précédente s’appliquent dans ce cas également.) Par exemple, la fonction[ JQuery](https://jquery.com) `$(document).ready()` serait référencée comme suit :</span><span class="sxs-lookup"><span data-stu-id="4aaec-150">(But the exceptions described in the **Initialize with Office.onReady()** section earlier apply in this case also.) For example, [JQuery's](https://jquery.com) `$(document).ready()` function would be referenced as follows:</span></span>

```js
Office.initialize = function () {
    // Office is ready
    $(document).ready(function () {
        // The document is ready
    });
  };
```

<span data-ttu-id="4aaec-151">Pour les compléments de tâches et de contenu, `Office.initialize` fournit un paramètre_raison_ supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="4aaec-151">For task pane and content add-ins, `Office.initialize` provides an additional _reason_ parameter.</span></span> <span data-ttu-id="4aaec-152">Ce paramètre peut être utilisé pour savoir comment un complément a été ajouté au document actif.</span><span class="sxs-lookup"><span data-stu-id="4aaec-152">This parameter specifies how an add-in was added to the current document.</span></span> <span data-ttu-id="4aaec-153">Vous pouvez l’utiliser pour fournir une logique différente quand un complément est inséré pour la première fois par opposition au moment où il fait déjà partie du document.</span><span class="sxs-lookup"><span data-stu-id="4aaec-153">For task pane and content add-ins, Office.initialize provides an additional reason parameter. This parameter can be used to determine how an add-in was added to the current document. You can use this to provide different logic for when an add-in is first inserted versus when it already existed within the document.</span></span>

```js
Office.initialize = function (reason) {
    $(document).ready(function () {
        switch (reason) {
            case 'inserted': console.log('The add-in was just inserted.');
            case 'documentOpened': console.log('The add-in is already part of the document.');
        }
    });
 };
```

<span data-ttu-id="4aaec-154">Pour plus d’informations, consultez les pages relatives à l’[Événement Office.initialize](https://docs.microsoft.com/javascript/api/office?view=office-js) et à l’[Énumération InitializationReason](https://docs.microsoft.com/javascript/api/office/office.initializationreason?view=office-js).</span><span class="sxs-lookup"><span data-stu-id="4aaec-154">For more information, see [Office.initialize Event](https://docs.microsoft.com/javascript/api/office?view=office-js) and [InitializationReason Enumeration](https://docs.microsoft.com/javascript/api/office/office.initializationreason?view=office-js).</span></span>

> [!NOTE]
> <span data-ttu-id="4aaec-155">Pour l’instant, vous devez définir `Office.Initialize`, peu importe si `Office.onReady()` est également appelé.</span><span class="sxs-lookup"><span data-stu-id="4aaec-155">Currently, you must set `Office.Initialize`, regardless of whether `Office.onReady()` is also called.</span></span> <span data-ttu-id="4aaec-156">Si vous ne vous servez pas de `Office.Initialize`, vous pouvez le définir sur une fonction vide comme illustré dans l’exemple suivant.</span><span class="sxs-lookup"><span data-stu-id="4aaec-156">If you have no use for `Office.Initialize`, you can set it to an empty function as shown in the following example.</span></span>
> 
>```js
>Office.initialize = function () {};
>```

### <a name="major-differences-between-officeinitialize-and-officeonready"></a><span data-ttu-id="4aaec-157">Principales différences entre Office.initialize et Office.onReady</span><span class="sxs-lookup"><span data-stu-id="4aaec-157">Major differences between Office.initialize and Office.onReady</span></span>

- <span data-ttu-id="4aaec-158">Vous ne pouvez assigner qu’un seul gestionnaire à `Office.initialize` et il n’est appelé qu’une seule fois par l’infrastructure d’Office, mais vous pouvez appeler `Office.onReady()`à plusieurs endroits dans votre code et utiliser des rappels différents.</span><span class="sxs-lookup"><span data-stu-id="4aaec-158">You can assign only one handler to `Office.initialize` and it is called, only once, by the Office infrastructure; but you can call `Office.onReady()` in different places in your code and use different callbacks.</span></span> <span data-ttu-id="4aaec-159">Par exemple, votre code pourrait appeler `Office.onReady()` dès que votre script personnalisé charge avec un rappel qui exécute la logique d’initialisation ; et votre code peut également comporter un bouton dans le volet Office dont le script appelle `Office.onReady()` avec un rappel différent.</span><span class="sxs-lookup"><span data-stu-id="4aaec-159">For example, your code could call `Office.onReady()` as soon as your custom script loads with a callback that runs initialization logic; and your code could also have a button in the task pane, whose script calls `Office.onReady()` with a different callback.</span></span> <span data-ttu-id="4aaec-160">Si c’est le cas, le deuxième rappel s’exécute quand l’utilisateur clique sur le bouton.</span><span class="sxs-lookup"><span data-stu-id="4aaec-160">If so, the second callback runs when the button is clicked.</span></span>

- <span data-ttu-id="4aaec-161">L’événement`Office.initialize` se déclenche à la fin du processus interne dans lequel Office.js s’initialise lui-même.</span><span class="sxs-lookup"><span data-stu-id="4aaec-161">The `Office.initialize` event fires at the end of the internal process in which Office.js initializes itself.</span></span> <span data-ttu-id="4aaec-162">Et il se déclenche *immédiatement* après la fin du processus interne.</span><span class="sxs-lookup"><span data-stu-id="4aaec-162">And it fires *immediately* after the internal process ends.</span></span> <span data-ttu-id="4aaec-163">Si le code dans lequel vous attribuez un gestionnaire à l’événement s’exécute trop longtemps après le déclenchement de l’événement, votre gestionnaire ne s’exécutera pas.</span><span class="sxs-lookup"><span data-stu-id="4aaec-163">If the code in which you assign a handler to the event executes too long after the event fires, then your handler doesn't run.</span></span> <span data-ttu-id="4aaec-164">Par exemple, si vous utilisez le Gestionnaire des tâches WebPack, il peut configurer page d’accueil du complément pour charger les fichiers polyfill une fois que le serveur charge Office.js mais avant que le serveur ne charge votre code JavaScript personnalisé.</span><span class="sxs-lookup"><span data-stu-id="4aaec-164">For example, if you are using the WebPack task manager, it might configure the add-in's home page to load polyfill files after it loads Office.js but before it loads your custom JavaScript.</span></span> <span data-ttu-id="4aaec-165">Le temps que votre script se charge et affecte le Gestionnaire, l’événement initialisé s’est déjà produit.</span><span class="sxs-lookup"><span data-stu-id="4aaec-165">By the time your script loads and assigns the handler, the initialize event has already happened.</span></span> <span data-ttu-id="4aaec-166">Mais il n’est jamais « trop tard » pour appeler `Office.onReady()`.</span><span class="sxs-lookup"><span data-stu-id="4aaec-166">But it is never "too late" to call `Office.onReady()`.</span></span> <span data-ttu-id="4aaec-167">Si l’événement initialisé s’est déjà produit, le rappel s’exécute immédiatement.</span><span class="sxs-lookup"><span data-stu-id="4aaec-167">If the initialize event has already happened, the callback runs immediately.</span></span>

> [!NOTE]
> <span data-ttu-id="4aaec-168">Même si vous n’avez aucune logique de démarrage, attribuez une fonction vide à `Office.initialize` lorsque votre complément JavaScript se charge, comme illustré dans l’exemple suivant.</span><span class="sxs-lookup"><span data-stu-id="4aaec-168">Even if you have no start-up logic, you should assign an empty function to `Office.initialize` when your add-in JavaScript loads, as shown in the following example.</span></span> <span data-ttu-id="4aaec-169">Certaines combinaisons de plateforme et hôte Office ne chargent pas le volet Office jusqu'à ce que l’événement initialisé ne se déclenche et que la fonction gestionnaire d’événements spécifiée ne s’exécute.</span><span class="sxs-lookup"><span data-stu-id="4aaec-169">Some Office host and platform combinations won't load the task pane until the initialize event fires and the specified event handler function runs.</span></span>
> 
>```js
>Office.initialize = function () {};
>```

## <a name="office-javascript-api-object-model"></a><span data-ttu-id="4aaec-170">Modèle d’objet API JavaScript Office</span><span class="sxs-lookup"><span data-stu-id="4aaec-170">Office JavaScript API object model</span></span>

<span data-ttu-id="4aaec-171">Une fois initialisé, le complément peut interagir avec l’hôte (par exemple, Excel, Outlook).</span><span class="sxs-lookup"><span data-stu-id="4aaec-171">Once initialized, the add-in can interact with the host (e.g. Excel, Outlook).</span></span> <span data-ttu-id="4aaec-172">La page [Modèle objet API JavaScript Office](office-javascript-api-object-model.md) comporte plus d’informations sur les modèles d’utilisation spécifiques.</span><span class="sxs-lookup"><span data-stu-id="4aaec-172">The [Office JavaScript API object model](office-javascript-api-object-model.md) page has more details on specific usage patterns.</span></span> <span data-ttu-id="4aaec-173">Il existe également une documentation de référence détaillée pour les deux hôtes [partage API](https://docs.microsoft.com/office/dev/add-ins/reference/javascript-api-for-office?view=office-js) et spécifique.</span><span class="sxs-lookup"><span data-stu-id="4aaec-173">There is also detailed reference documentation for both [shared APIs](https://docs.microsoft.com/office/dev/add-ins/reference/javascript-api-for-office?view=office-js) and specific hosts.</span></span>

## <a name="api-support-matrix"></a><span data-ttu-id="4aaec-174">Matrice de prise en charge d’API</span><span class="sxs-lookup"><span data-stu-id="4aaec-174">API support matrix</span></span>

<span data-ttu-id="4aaec-175">Ce tableau récapitule l’API et les fonctionnalités prises en charge dans les types de complément (contenu, volet Office et Outlook), ainsi que les applications Office qui peuvent les héberger lorsque vous indiquez les applications hôte Office prises en charge par votre complément à l’aide du [schéma de manifeste de complément 1.1 et des fonctionnalités prises en charge par la version 1.1 de l’interface API JavaScript pour Office](update-your-javascript-api-for-office-and-manifest-schema-version.md).</span><span class="sxs-lookup"><span data-stu-id="4aaec-175">This table summarizes the API and features supported across add-in types (content, task pane, and Outlook) and the Office applications that can host them when you specify the Office host applications your add-in supports by using the [1.1 add-in manifest schema and features supported by v1.1 JavaScript API for Office](update-your-javascript-api-for-office-and-manifest-schema-version.md).</span></span>


|||||||||
|:-----|:-----|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|
||<span data-ttu-id="4aaec-176">**Nom de l’hôte**</span><span class="sxs-lookup"><span data-stu-id="4aaec-176">**Host name**</span></span>|<span data-ttu-id="4aaec-177">Base de données</span><span class="sxs-lookup"><span data-stu-id="4aaec-177">Database</span></span>|<span data-ttu-id="4aaec-178">Classeur</span><span class="sxs-lookup"><span data-stu-id="4aaec-178">Workbook</span></span>|<span data-ttu-id="4aaec-179">Boîte aux lettres</span><span class="sxs-lookup"><span data-stu-id="4aaec-179">Mailbox</span></span>|<span data-ttu-id="4aaec-180">Présentation</span><span class="sxs-lookup"><span data-stu-id="4aaec-180">Presentation</span></span>|<span data-ttu-id="4aaec-181">Document</span><span class="sxs-lookup"><span data-stu-id="4aaec-181">Document</span></span>|<span data-ttu-id="4aaec-182">Projet</span><span class="sxs-lookup"><span data-stu-id="4aaec-182">Project</span></span>|
||<span data-ttu-id="4aaec-183">**Applications hôtes** **prises en charge**</span><span class="sxs-lookup"><span data-stu-id="4aaec-183">**Supported** **Host applications**</span></span>|<span data-ttu-id="4aaec-184">Applications web Access</span><span class="sxs-lookup"><span data-stu-id="4aaec-184">Access web apps</span></span>|<span data-ttu-id="4aaec-185">Excel,</span><span class="sxs-lookup"><span data-stu-id="4aaec-185">Excel</span></span><br/><span data-ttu-id="4aaec-186">Excel Online</span><span class="sxs-lookup"><span data-stu-id="4aaec-186">Excel Online</span></span>|<span data-ttu-id="4aaec-187">Outlook,</span><span class="sxs-lookup"><span data-stu-id="4aaec-187">Outlook</span></span><br/><span data-ttu-id="4aaec-188">Outlook Web App,</span><span class="sxs-lookup"><span data-stu-id="4aaec-188">Outlook Web App</span></span><br/><span data-ttu-id="4aaec-189">OWA pour les périphériques</span><span class="sxs-lookup"><span data-stu-id="4aaec-189">OWA for Devices</span></span>|<span data-ttu-id="4aaec-190">PowerPoint,</span><span class="sxs-lookup"><span data-stu-id="4aaec-190">PowerPoint</span></span><br/><span data-ttu-id="4aaec-191">PowerPoint Online</span><span class="sxs-lookup"><span data-stu-id="4aaec-191">PowerPoint Online</span></span>|<span data-ttu-id="4aaec-192">Word</span><span class="sxs-lookup"><span data-stu-id="4aaec-192">Word</span></span>|<span data-ttu-id="4aaec-193">Project</span><span class="sxs-lookup"><span data-stu-id="4aaec-193">Project</span></span>|
|<span data-ttu-id="4aaec-194">**Types de compléments pris en charge**</span><span class="sxs-lookup"><span data-stu-id="4aaec-194">**Supported add-in types**</span></span>|<span data-ttu-id="4aaec-195">Contenu</span><span class="sxs-lookup"><span data-stu-id="4aaec-195">Content</span></span>|<span data-ttu-id="4aaec-196">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-196">Y</span></span>|<span data-ttu-id="4aaec-197">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-197">Y</span></span>||<span data-ttu-id="4aaec-198">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-198">Y</span></span>|||
||<span data-ttu-id="4aaec-199">Volet de tâches</span><span class="sxs-lookup"><span data-stu-id="4aaec-199">Task pane</span></span>||<span data-ttu-id="4aaec-200">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-200">Y</span></span>||<span data-ttu-id="4aaec-201">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-201">Y</span></span>|<span data-ttu-id="4aaec-202">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-202">Y</span></span>|<span data-ttu-id="4aaec-203">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-203">Y</span></span>|
||<span data-ttu-id="4aaec-204">Outlook</span><span class="sxs-lookup"><span data-stu-id="4aaec-204">Outlook</span></span>|||<span data-ttu-id="4aaec-205">O</span><span class="sxs-lookup"><span data-stu-id="4aaec-205">Y</span></span>||||
|<span data-ttu-id="4aaec-206">**Fonctionnalités d’API prises en charge**</span><span class="sxs-lookup"><span data-stu-id="4aaec-206">**Supported API features**</span></span>|<span data-ttu-id="4aaec-207">Lecture/écriture de texte</span><span class="sxs-lookup"><span data-stu-id="4aaec-207">Read/Write Text</span></span>||<span data-ttu-id="4aaec-208">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-208">Y</span></span>||<span data-ttu-id="4aaec-209">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-209">Y</span></span>|<span data-ttu-id="4aaec-210">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-210">Y</span></span>|<span data-ttu-id="4aaec-211">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-211">Y</span></span><br/><span data-ttu-id="4aaec-212">(En lecture seule)</span><span class="sxs-lookup"><span data-stu-id="4aaec-212">√Read only</span></span>|
||<span data-ttu-id="4aaec-213">Lecture/Écriture de matrice</span><span class="sxs-lookup"><span data-stu-id="4aaec-213">Read/Write Matrix</span></span>||<span data-ttu-id="4aaec-214">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-214">Y</span></span>|||<span data-ttu-id="4aaec-215">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-215">Y</span></span>||
||<span data-ttu-id="4aaec-216">Lecture/écriture de tableau</span><span class="sxs-lookup"><span data-stu-id="4aaec-216">Read/Write Table</span></span>||<span data-ttu-id="4aaec-217">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-217">Y</span></span>|||<span data-ttu-id="4aaec-218">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-218">Y</span></span>||
||<span data-ttu-id="4aaec-219">Lecture/écriture HTML</span><span class="sxs-lookup"><span data-stu-id="4aaec-219">Read/Write HTML</span></span>|||||<span data-ttu-id="4aaec-220">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-220">Y</span></span>||
||<span data-ttu-id="4aaec-221">Lecture/Écriture</span><span class="sxs-lookup"><span data-stu-id="4aaec-221">Read/Write</span></span><br/><span data-ttu-id="4aaec-222">Office Open XML</span><span class="sxs-lookup"><span data-stu-id="4aaec-222">Office Open XML</span></span>|||||<span data-ttu-id="4aaec-223">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-223">Y</span></span>||
||<span data-ttu-id="4aaec-224">Lecture des propriétés de tâche, de ressource, de vue et de champ</span><span class="sxs-lookup"><span data-stu-id="4aaec-224">Read task, resource, view, and field properties</span></span>||||||<span data-ttu-id="4aaec-225">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-225">Y</span></span>|
||<span data-ttu-id="4aaec-226">Événements modifiés de sélection</span><span class="sxs-lookup"><span data-stu-id="4aaec-226">Selection changed events</span></span>||<span data-ttu-id="4aaec-227">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-227">Y</span></span>|||<span data-ttu-id="4aaec-228">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-228">Y</span></span>||
||<span data-ttu-id="4aaec-229">Obtention de l’ensemble du document</span><span class="sxs-lookup"><span data-stu-id="4aaec-229">Get whole document</span></span>||||<span data-ttu-id="4aaec-230">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-230">Y</span></span>|<span data-ttu-id="4aaec-231">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-231">Y</span></span>||
||<span data-ttu-id="4aaec-232">Liaisons et événements de liaison</span><span class="sxs-lookup"><span data-stu-id="4aaec-232">Bindings and binding events</span></span>|<span data-ttu-id="4aaec-233">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-233">Y</span></span><br/><span data-ttu-id="4aaec-234">(Liaisons de tableau complètes et partielles uniquement)</span><span class="sxs-lookup"><span data-stu-id="4aaec-234">(Only full and partial table bindings)</span></span>|<span data-ttu-id="4aaec-235">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-235">Y</span></span>|||<span data-ttu-id="4aaec-236">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-236">Y</span></span>||
||<span data-ttu-id="4aaec-237">Lecture/écriture des parties XML personnalisées</span><span class="sxs-lookup"><span data-stu-id="4aaec-237">Read/Write Custom XML Parts</span></span>|||||<span data-ttu-id="4aaec-238">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-238">Y</span></span>||
||<span data-ttu-id="4aaec-239">Faire persister les données d’état de complément (paramètres)</span><span class="sxs-lookup"><span data-stu-id="4aaec-239">Persist add-in state data (settings)</span></span>|<span data-ttu-id="4aaec-240">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-240">Y</span></span><br/><span data-ttu-id="4aaec-241">(Par complément hôte)</span><span class="sxs-lookup"><span data-stu-id="4aaec-241">(Per host add-in)</span></span>|<span data-ttu-id="4aaec-242">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-242">Y</span></span><br/><span data-ttu-id="4aaec-243">(Par document)</span><span class="sxs-lookup"><span data-stu-id="4aaec-243">√Per document</span></span>|<span data-ttu-id="4aaec-244">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-244">Y</span></span><br/><span data-ttu-id="4aaec-245">(Par boîte aux lettres)</span><span class="sxs-lookup"><span data-stu-id="4aaec-245">(Per mailbox)</span></span>|<span data-ttu-id="4aaec-246">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-246">Y</span></span><br/><span data-ttu-id="4aaec-247">(Par document)</span><span class="sxs-lookup"><span data-stu-id="4aaec-247">√Per document</span></span>|<span data-ttu-id="4aaec-248">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-248">Y</span></span><br/><span data-ttu-id="4aaec-249">(Par document)</span><span class="sxs-lookup"><span data-stu-id="4aaec-249">√Per document</span></span>||
||<span data-ttu-id="4aaec-250">Événements modifiés de paramètres</span><span class="sxs-lookup"><span data-stu-id="4aaec-250">Settings changed events</span></span>|<span data-ttu-id="4aaec-251">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-251">Y</span></span>|<span data-ttu-id="4aaec-252">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-252">Y</span></span>||<span data-ttu-id="4aaec-253">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-253">Y</span></span>|<span data-ttu-id="4aaec-254">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-254">Y</span></span>||
||<span data-ttu-id="4aaec-255">Obtention du mode de vue active</span><span class="sxs-lookup"><span data-stu-id="4aaec-255">Get active view mode</span></span><br/><span data-ttu-id="4aaec-256">et affichage des événements modifiés</span><span class="sxs-lookup"><span data-stu-id="4aaec-256">and view changed events</span></span>||||<span data-ttu-id="4aaec-257">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-257">Y</span></span>|||
||<span data-ttu-id="4aaec-258">Accès à des emplacements</span><span class="sxs-lookup"><span data-stu-id="4aaec-258">Navigate to locations</span></span><br/><span data-ttu-id="4aaec-259">dans le document</span><span class="sxs-lookup"><span data-stu-id="4aaec-259">in the document</span></span>||<span data-ttu-id="4aaec-260">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-260">Y</span></span>||<span data-ttu-id="4aaec-261">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-261">Y</span></span>|<span data-ttu-id="4aaec-262">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-262">Y</span></span>||
||<span data-ttu-id="4aaec-263">Activation en fonction du contexte</span><span class="sxs-lookup"><span data-stu-id="4aaec-263">Activate contextually</span></span><br/><span data-ttu-id="4aaec-264">à l’aide de règles et de RegEx</span><span class="sxs-lookup"><span data-stu-id="4aaec-264">using rules and RegEx</span></span>|||<span data-ttu-id="4aaec-265">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-265">Y</span></span>||||
||<span data-ttu-id="4aaec-266">Lecture des propriétés d’élément</span><span class="sxs-lookup"><span data-stu-id="4aaec-266">Read Item properties</span></span>|||<span data-ttu-id="4aaec-267">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-267">Y</span></span>||||
||<span data-ttu-id="4aaec-268">Lecture de profil utilisateur</span><span class="sxs-lookup"><span data-stu-id="4aaec-268">Read User profile</span></span>|||<span data-ttu-id="4aaec-269">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-269">Y</span></span>||||
||<span data-ttu-id="4aaec-270">Obtention des pièces jointes</span><span class="sxs-lookup"><span data-stu-id="4aaec-270">Get attachments</span></span>|||<span data-ttu-id="4aaec-271">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-271">Y</span></span>||||
||<span data-ttu-id="4aaec-272">Obtention du jeton d’identité d’utilisateur</span><span class="sxs-lookup"><span data-stu-id="4aaec-272">Get User identity token</span></span>|||<span data-ttu-id="4aaec-273">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-273">Y</span></span>||||
||<span data-ttu-id="4aaec-274">Appel des services web Exchange</span><span class="sxs-lookup"><span data-stu-id="4aaec-274">Call Exchange web services</span></span>|||<span data-ttu-id="4aaec-275">v</span><span class="sxs-lookup"><span data-stu-id="4aaec-275">Y</span></span>||||
