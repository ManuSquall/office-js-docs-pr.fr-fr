---
title: Demande d’autorisations d’utilisation de l’API dans des compléments
description: Découvrez les différents niveaux d’autorisation à déclarer dans le manifeste d’un complément de contenu ou de volet de tâches pour spécifier le niveau d’accès de l’API JavaScript.
ms.date: 03/19/2019
localization_priority: Normal
ms.openlocfilehash: 37aef33f5e86460d8f471dd4253b309d2051c097
ms.sourcegitcommit: fa4e81fcf41b1c39d5516edf078f3ffdbd4a3997
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/17/2020
ms.locfileid: "42719356"
---
# <a name="requesting-permissions-for-api-use-in-add-ins"></a><span data-ttu-id="3bd85-103">Demande d’autorisations d’utilisation de l’API dans des compléments</span><span class="sxs-lookup"><span data-stu-id="3bd85-103">Requesting permissions for API use in add-ins</span></span>

<span data-ttu-id="3bd85-104">Cet article décrit les différents niveaux d’autorisation que vous pouvez déclarer dans le manifeste de votre complément de contenu ou du volet Office afin de spécifier le niveau d’accès de l’API JavaScript requis pour les fonctionnalités de votre complément.</span><span class="sxs-lookup"><span data-stu-id="3bd85-104">This article describes the different permission levels that you can declare in your content or task pane add-in's manifest to specify the level of JavaScript API access your add-in requires for its features.</span></span> 

## <a name="permissions-model"></a><span data-ttu-id="3bd85-105">Modèles d’autorisation</span><span class="sxs-lookup"><span data-stu-id="3bd85-105">Permissions model</span></span>

<span data-ttu-id="3bd85-106">Le modèle d’autorisations d’accès de l’API JavaScript à cinq niveaux fournit les bases de confidentialité et de sécurité pour les utilisateurs de vos compléments de contenu et du volet Office. La figure 1 montre les cinq niveaux d’autorisations de l’API que vous pouvez déclarer dans le manifeste de votre complément.</span><span class="sxs-lookup"><span data-stu-id="3bd85-106">A five-level JavaScript API access-permissions model provides the basis for privacy and security for users of your content and task pane add-ins. Figure 1 shows the five levels of API permissions you can declare in your add-in's manifest.</span></span>

<span data-ttu-id="3bd85-107">*Figure 1. Modèle d’autorisations à cinq niveaux pour les compléments de contenu et du volet Office*</span><span class="sxs-lookup"><span data-stu-id="3bd85-107">*Figure 1. The five-level permission model for content and task pane add-ins*</span></span>

![Niveaux d’autorisations des applications de volet de tâches](../images/office15-app-sdk-task-pane-app-permission.png)

<span data-ttu-id="3bd85-p101">Ces autorisations spécifient le sous-ensemble de l’API auquel votre complément de contenu ou du volet Office est autorisé à accéder par l’environnement d’exécution lorsqu’un utilisateur insère, puis active (approuve) votre complément. Pour déclarer le niveau d’autorisation nécessaire à votre complément de contenu ou du volet Office, indiquez l’une des valeurs de texte d’autorisation dans l’élément [Permissions](../reference/manifest/permissions.md) du manifeste de votre complément. L’exemple suivant demande l’autorisation **WriteDocument**, laquelle n’autorise que les méthodes pouvant écrire dans le document (et non le lire).</span><span class="sxs-lookup"><span data-stu-id="3bd85-p101">These permissions specify the subset of the API that the add-in runtime will allow your content or task pane add-in to use when a user inserts, and then activates (trusts) your add-in. To declare the permission level your content or task pane add-in requires, specify one of the permission text values in the [Permissions](../reference/manifest/permissions.md) element of your add-in's manifest. The following example requests the **WriteDocument** permission, which will allow only methods that can write to (but not read) the document.</span></span>

```XML
<Permissions>WriteDocument</Permissions>
```

<span data-ttu-id="3bd85-p102">Il est recommandé de toujours demander les autorisations sur la base du principe d’ _autorisation minimum_. En d’autres termes, vous devez demander l’autorisation d’accéder uniquement au sous-ensemble de l’API nécessaire au bon fonctionnement de votre complément. Par exemple, si votre complément est conçu pour uniquement lire des données dans le document d’un utilisateur, vous ne devez demander que l’autorisation **ReadDocument**.</span><span class="sxs-lookup"><span data-stu-id="3bd85-p102">As a best practice, you should request permissions based on the principle of  _least privilege_. That is, you should request permission to access only the minimum subset of the API that your add-in requires to function correctly. For example, if your add-in needs only to read data in a user's document for its features, you should request no more than the **ReadDocument** permission.</span></span>

<span data-ttu-id="3bd85-115">Le tableau suivant décrit le sous-ensemble de l’API JavaScript activé pour chaque niveau d’autorisation.</span><span class="sxs-lookup"><span data-stu-id="3bd85-115">The following table describes the subset of the JavaScript API that is enabled by each permission level.</span></span>

|<span data-ttu-id="3bd85-116">**Autorisation**</span><span class="sxs-lookup"><span data-stu-id="3bd85-116">**Permission**</span></span>|<span data-ttu-id="3bd85-117">**Sous-ensemble de l’API activé**</span><span class="sxs-lookup"><span data-stu-id="3bd85-117">**Enabled subset of the API**</span></span>|
|:-----|:-----|
|<span data-ttu-id="3bd85-118">**Restricted**</span><span class="sxs-lookup"><span data-stu-id="3bd85-118">**Restricted**</span></span>|<span data-ttu-id="3bd85-119">Les méthodes de l’objet [Settings](/javascript/api/office/office.settings) et la méthode [Document.getActiveViewAsync](/javascript/api/office/office.document#getactiveviewasync-options--callback-).Niveau d’autorisation minimal pouvant être demandé par un complément de contenu ou du volet Office.</span><span class="sxs-lookup"><span data-stu-id="3bd85-119">The methods of the [Settings](/javascript/api/office/office.settings) object, and the [Document.getActiveViewAsync](/javascript/api/office/office.document#getactiveviewasync-options--callback-) method.This is the minimum permission level that can be requested by a content or task pane add-in.</span></span>|
|<span data-ttu-id="3bd85-120">**ReadDocument**</span><span class="sxs-lookup"><span data-stu-id="3bd85-120">**ReadDocument**</span></span>|<span data-ttu-id="3bd85-121">En plus de l’API autorisé par l’autorisation **Restricted** , ajoute l’accès aux membres de l’API nécessaires à la lecture du document et à la gestion des liaisons. Cela inclut l’utilisation des éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="3bd85-121">In addition to the API allowed by the **Restricted** permission, adds access to the API members necessary to read the document and manage bindings.This includes the use of:</span></span><br/><ul><li><span data-ttu-id="3bd85-122">La méthode <a href="/javascript/api/office/office.document#getselecteddataasync-coerciontype--options--callback-" target="_blank">Document.getSelectedDataAsync</a> pour obtenir les données texte, HTML (Word uniquement) ou tabulaires sélectionnées, mais pas le code sous-jacent Open Office XML (OOXML) contenant toutes les données du document.</span><span class="sxs-lookup"><span data-stu-id="3bd85-122">The <a href="/javascript/api/office/office.document#getselecteddataasync-coerciontype--options--callback-" target="_blank">Document.getSelectedDataAsync</a> method to get the selected text, HTML (Word only), or tabular data, but not the underlying Open Office XML (OOXML) code that contains all of the data in the document.</span></span></p></li><li><p><span data-ttu-id="3bd85-123">La méthode <a href="/javascript/api/office/office.document#getfileasync-filetype--options--callback-" target="_blank">Document.getFileAsync</a> pour obtenir la totalité du texte du document, mais pas la copie binaire OOXML sous-jacente du document.</span><span class="sxs-lookup"><span data-stu-id="3bd85-123">The <a href="/javascript/api/office/office.document#getfileasync-filetype--options--callback-" target="_blank">Document.getFileAsync</a> method to get all of the text in the document, but not the underlying OOXML binary copy of the document.</span></span></p></li><li><p><span data-ttu-id="3bd85-124">La méthode <a href="/javascript/api/office/office.binding#getdataasync-options--callback-" target="_blank">Binding.getDataAsync</a> pour la lecture des données liées dans le document.</span><span class="sxs-lookup"><span data-stu-id="3bd85-124">The <a href="/javascript/api/office/office.binding#getdataasync-options--callback-" target="_blank">Binding.getDataAsync</a> method for reading bound data in the document.</span></span></p></li><li><p><span data-ttu-id="3bd85-125">Les méthodes <a href="/javascript/api/office/office.bindings#addfromnameditemasync-itemname--bindingtype--options--callback-" target="_blank">addFromNamedItemAsync</a>, <a href="/javascript/api/office/office.bindings#addfrompromptasync-bindingtype--options--callback-" target="_blank">addFromPromptAsync</a> et <a href="/javascript/api/office/office.bindings#addfromselectionasync-bindingtype--options--callback-" target="_blank">addFromSelectionAsync</a> de l’objet <span class="keyword">Bindings</span> pour la création de liaisons dans le document.</span><span class="sxs-lookup"><span data-stu-id="3bd85-125">The <a href="/javascript/api/office/office.bindings#addfromnameditemasync-itemname--bindingtype--options--callback-" target="_blank">addFromNamedItemAsync</a>, <a href="/javascript/api/office/office.bindings#addfrompromptasync-bindingtype--options--callback-" target="_blank">addFromPromptAsync</a>, <a href="/javascript/api/office/office.bindings#addfromselectionasync-bindingtype--options--callback-" target="_blank">addFromSelectionAsync</a> methods of the <span class="keyword">Bindings</span> object for creating bindings in the document.</span></span></p></li><li><p><span data-ttu-id="3bd85-126">Les méthodes <a href="/javascript/api/office/office.bindings#getallasync-options--callback-" target="_blank">getAllAsync</a>, <a href="/javascript/api/office/office.bindings#getbyidasync-id--options--callback-" target="_blank">getByIdAsync</a> et <a href="/javascript/api/office/office.bindings#releasebyidasync-id--options--callback-" target="_blank">releaseByIdAsync</a> de l’objet <span class="keyword">Bindings</span> pour accéder aux liaisons du document et les supprimer.</span><span class="sxs-lookup"><span data-stu-id="3bd85-126">The <a href="/javascript/api/office/office.bindings#getallasync-options--callback-" target="_blank">getAllAsync</a>, <a href="/javascript/api/office/office.bindings#getbyidasync-id--options--callback-" target="_blank">getByIdAsync</a>, and <a href="/javascript/api/office/office.bindings#releasebyidasync-id--options--callback-" target="_blank">releaseByIdAsync</a> methods of the <span class="keyword">Bindings</span> object for accessing and removing bindings in the document.</span></span></p></li><li><p><span data-ttu-id="3bd85-127">La méthode <a href="/javascript/api/office/office.document#getfilepropertiesasync-options--callback-" target="_blank">Document.getFilePropertiesAsync</a> pour accéder aux propriétés du fichier de document, comme l’URL du document.</span><span class="sxs-lookup"><span data-stu-id="3bd85-127">The <a href="/javascript/api/office/office.document#getfilepropertiesasync-options--callback-" target="_blank">Document.getFilePropertiesAsync</a> method to access document file properties, such as the URL of the document.</span></span></p></li><li><p><span data-ttu-id="3bd85-128">La méthode <a href="/javascript/api/office/office.document#gotobyidasync-id--gototype--options--callback-" target="_blank">Document.goToByIdAsync</a> pour accéder aux objets et aux emplacements nommés dans le document.</span><span class="sxs-lookup"><span data-stu-id="3bd85-128">The <a href="/javascript/api/office/office.document#gotobyidasync-id--gototype--options--callback-" target="_blank">Document.goToByIdAsync</a> method to navigate to named objects and locations in the document.</span></span></p></li><li><p><span data-ttu-id="3bd85-129">Pour les compléments du volet Office de Project, toutes les méthodes d’obtention (get) de l’objet <a href="/javascript/api/office/office.document" target="_blank">ProjectDocument</a>.</span><span class="sxs-lookup"><span data-stu-id="3bd85-129">For task pane add-ins for Project, all of the "get" methods of the <a href="/javascript/api/office/office.document" target="_blank">ProjectDocument</a> object.</span></span> </p></li></ul>|
|<span data-ttu-id="3bd85-130">**ReadAllDocument**</span><span class="sxs-lookup"><span data-stu-id="3bd85-130">**ReadAllDocument**</span></span>|<span data-ttu-id="3bd85-131">En plus de l’API autorisé par les autorisations **Restricted** et **ReadDocument** , permet l’accès supplémentaire aux données de document ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="3bd85-131">In addition to the API allowed by the **Restricted** and **ReadDocument** permissions, allows the following additional access to document data:</span></span><br/><ul><li><p><span data-ttu-id="3bd85-132">Les méthodes <span class="keyword">Document.getSelectedDataAsync</span> et <span class="keyword">Document.getFileAsync</span> pour accéder au code OOXML sous-jacent du document (qui peut inclure une mise en forme, des liens, des graphiques incorporés, des commentaires, des révisions, etc. en plus du texte).</span><span class="sxs-lookup"><span data-stu-id="3bd85-132">The <span class="keyword">Document.getSelectedDataAsync</span> and <span class="keyword">Document.getFileAsync</span> methods can access the underlying OOXML code of the document (which in addition to the text may include formatting, links, embedded graphics, comments, revisions, and so forth).</span></span></p></li></ul>|
|<span data-ttu-id="3bd85-133">**WriteDocument**</span><span class="sxs-lookup"><span data-stu-id="3bd85-133">**WriteDocument**</span></span>|<span data-ttu-id="3bd85-134">En plus de l’API autorisé par l’autorisation **Restricted** , permet l’accès aux membres de l’API suivants :</span><span class="sxs-lookup"><span data-stu-id="3bd85-134">In addition to the API allowed by the **Restricted** permission, adds access to the following API members:</span></span><br/><ul><li><p><span data-ttu-id="3bd85-135">La méthode <a href="/javascript/api/office/office.document#setselecteddataasync-data--options--callback-" target="_blank">Document.setSelectedDataAsync</a> pour écrire dans la sélection de l’utilisateur dans le document.</span><span class="sxs-lookup"><span data-stu-id="3bd85-135">The <a href="/javascript/api/office/office.document#setselecteddataasync-data--options--callback-" target="_blank">Document.setSelectedDataAsync</a> method to write to the user's selection in the document.</span></span></p></li></ul>|
|<span data-ttu-id="3bd85-136">**ReadWriteDocument**</span><span class="sxs-lookup"><span data-stu-id="3bd85-136">**ReadWriteDocument**</span></span>|<span data-ttu-id="3bd85-137">En plus de l’API autorisé par les autorisations **Restricted**, **ReadDocument**, **ReadAllDocument**et **WriteDocument** , inclut l’accès à toutes les API restantes prises en charge par les compléments de contenu et du volet Office, y compris les méthodes permettant de s’abonner à des événements. Vous devez déclarer l’autorisation **ReadWriteDocument** pour accéder à ces membres supplémentaires de l’API :</span><span class="sxs-lookup"><span data-stu-id="3bd85-137">In addition to the API allowed by the **Restricted**, **ReadDocument**, **ReadAllDocument**, and **WriteDocument** permissions, includes access to all remaining API supported by content and task pane add-ins, including methods for subscribing to events.You must declare the **ReadWriteDocument** permission to access these additional API members:</span></span><br/><ul><li><p><span data-ttu-id="3bd85-138">La méthode <a href="/javascript/api/office/office.binding#setdataasync-data--options--callback-" target="_blank">Binding.setDataAsync</a> pour écrire dans des zones liées du document.</span><span class="sxs-lookup"><span data-stu-id="3bd85-138">The <a href="/javascript/api/office/office.binding#setdataasync-data--options--callback-" target="_blank">Binding.setDataAsync</a> method for writing to bound regions of the document.</span></span></p></li><li><p><span data-ttu-id="3bd85-139">La méthode <a href="/javascript/api/office/office.tablebinding#addrowsasync-rows--options--callback-" target="_blank">TableBinding.addRowsAsync</a> pour ajouter des lignes dans les tables liées.</span><span class="sxs-lookup"><span data-stu-id="3bd85-139">The <a href="/javascript/api/office/office.tablebinding#addrowsasync-rows--options--callback-" target="_blank">TableBinding.addRowsAsync</a> method for adding rows to bound tables.</span></span></p></li><li><p><span data-ttu-id="3bd85-140">La méthode <a href="/javascript/api/office/office.tablebinding#addcolumnsasync-tabledata--options--callback-" target="_blank">TableBinding.addColumnsAsync</a> pour ajouter des colonnes dans les tables liées.</span><span class="sxs-lookup"><span data-stu-id="3bd85-140">The <a href="/javascript/api/office/office.tablebinding#addcolumnsasync-tabledata--options--callback-" target="_blank">TableBinding.addColumnsAsync</a> method for adding columns to bound tables.</span></span></p></li><li><p><span data-ttu-id="3bd85-141">La méthode <a href="/javascript/api/office/office.tablebinding#deletealldatavaluesasync-options--callback-" target="_blank">TableBinding.deleteAllDataValuesAsync</a> pour supprimer toutes les données d’une table liée.</span><span class="sxs-lookup"><span data-stu-id="3bd85-141">The <a href="/javascript/api/office/office.tablebinding#deletealldatavaluesasync-options--callback-" target="_blank">TableBinding.deleteAllDataValuesAsync</a> method for deleting all data in a bound table.</span></span></p></li><li><p><span data-ttu-id="3bd85-142">Les méthodes <a href="/javascript/api/office/office.tablebinding#setformatsasync-cellformat--options--callback-" target="_blank">setFormatsAsync</a>, <a href="/javascript/api/office/office.tablebinding#clearformatsasync-options--callback-" target="_blank">clearFormatsAsync</a> et <a href="/javascript/api/office/office.tablebinding#settableoptionsasync-tableoptions--options--callback-" target="_blank">setTableOptionsAsync</a> de l’objet <span class="keyword">TableBinding</span> pour définir la mise en forme et les options des tables liées.</span><span class="sxs-lookup"><span data-stu-id="3bd85-142">The <a href="/javascript/api/office/office.tablebinding#setformatsasync-cellformat--options--callback-" target="_blank">setFormatsAsync</a>, <a href="/javascript/api/office/office.tablebinding#clearformatsasync-options--callback-" target="_blank">clearFormatsAsync</a>, and <a href="/javascript/api/office/office.tablebinding#settableoptionsasync-tableoptions--options--callback-" target="_blank">setTableOptionsAsync</a> methods of the <span class="keyword">TableBinding</span> object for setting formatting and options on bound tables.</span></span></p></li><li><p><span data-ttu-id="3bd85-143">Tous les membres des objets <a href="/javascript/api/office/office.customxmlnode" target="_blank">CustomXmlNode</a>, <a href="/javascript/api/office/office.customxmlpart" target="_blank">CustomXmlPart</a>, <a href="/javascript/api/office/office.customxmlparts" target="_blank">CustomXmlParts</a> et <a href="/javascript/api/office/office.customxmlprefixmappings" target="_blank">CustomXmlPrefixMappings</a>.</span><span class="sxs-lookup"><span data-stu-id="3bd85-143">All of the members of the <a href="/javascript/api/office/office.customxmlnode" target="_blank">CustomXmlNode</a>, <a href="/javascript/api/office/office.customxmlpart" target="_blank">CustomXmlPart</a>, <a href="/javascript/api/office/office.customxmlparts" target="_blank">CustomXmlParts</a>, and <a href="/javascript/api/office/office.customxmlprefixmappings" target="_blank">CustomXmlPrefixMappings</a> objects.</span></span></p></li><li><p><span data-ttu-id="3bd85-144">Toutes les méthodes d’abonnement à des événements prises en charge par les compléments de contenu et du volet Office, en particulier les méthodes <span class="keyword">addHandlerAsync</span> et <span class="keyword">removeHandlerAsync</span> des objets <a href="/javascript/api/office/office.binding" target="_blank">Binding</a>, <a href="/javascript/api/office/office.customxmlpart" target="_blank">CustomXmlPart</a>, <a href="/javascript/api/office/office.document" target="_blank">Document</a>, <a href="/javascript/api/office/office.document" target="_blank">ProjectDocument</a> et <a href="/javascript/api/office/office.document#settings" target="_blank">Settings</a>.</span><span class="sxs-lookup"><span data-stu-id="3bd85-144">All of the methods for subscribing to the events supported by content and task pane add-ins, specifically the <span class="keyword">addHandlerAsync</span> and <span class="keyword">removeHandlerAsync</span> methods of the <a href="/javascript/api/office/office.binding" target="_blank">Binding</a>, <a href="/javascript/api/office/office.customxmlpart" target="_blank">CustomXmlPart</a>, <a href="/javascript/api/office/office.document" target="_blank">Document</a>, <a href="/javascript/api/office/office.document" target="_blank">ProjectDocument</a>, and <a href="/javascript/api/office/office.document#settings" target="_blank">Settings</a> objects.</span></span></p></li></ul>|

## <a name="see-also"></a><span data-ttu-id="3bd85-145">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="3bd85-145">See also</span></span>

- [<span data-ttu-id="3bd85-146">Confidentialité et sécurité pour les compléments Office</span><span class="sxs-lookup"><span data-stu-id="3bd85-146">Privacy and security for Office Add-ins</span></span>](../concepts/privacy-and-security.md)
