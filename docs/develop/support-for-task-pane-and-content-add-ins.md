---
title: Prise en charge de l’API JavaScript pour Office pour les compléments de contenu et du volet Office dans Office 2013
description: Utiliser l’API JavaScript pour Office pour créer un volet de tâches dans Office 2013.
ms.date: 02/27/2020
localization_priority: Normal
ms.openlocfilehash: 35a8ff5c36d5a4bc5ce77a2aeb94d58054471086
ms.sourcegitcommit: 9609bd5b4982cdaa2ea7637709a78a45835ffb19
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/28/2020
ms.locfileid: "47293141"
---
# <a name="office-javascript-api-support-for-content-and-task-pane-add-ins-in-office-2013"></a><span data-ttu-id="63f90-103">Prise en charge de l’API JavaScript pour Office pour les compléments de contenu et du volet Office dans Office 2013</span><span class="sxs-lookup"><span data-stu-id="63f90-103">Office JavaScript API support for content and task pane add-ins in Office 2013</span></span>

[!include[information about the common API](../includes/alert-common-api-info.md)]

<span data-ttu-id="63f90-104">Vous pouvez utiliser l' [API JavaScript pour Office](../reference/javascript-api-for-office.md) pour créer des compléments de volet de tâches ou de contenu pour les applications clientes Office 2013.</span><span class="sxs-lookup"><span data-stu-id="63f90-104">You can use the [Office JavaScript API](../reference/javascript-api-for-office.md) to create task pane or content add-ins for Office 2013 client applications.</span></span> <span data-ttu-id="63f90-105">Les méthodes et les objets pris en charge par les compléments du volet Office et de contenu sont classés de la manière suivante :</span><span class="sxs-lookup"><span data-stu-id="63f90-105">The objects and methods that content and task pane add-ins support are categorized as follows:</span></span>

1. <span data-ttu-id="63f90-106">**Objets communs partagés avec d’autres compléments Office.** Ces objets incluent [Office](/javascript/api/office), [Context](/javascript/api/office/office.context)et [asyncResult](/javascript/api/office/office.asyncresult).</span><span class="sxs-lookup"><span data-stu-id="63f90-106">**Common objects shared with other Office Add-ins.** These objects include [Office](/javascript/api/office), [Context](/javascript/api/office/office.context), and [AsyncResult](/javascript/api/office/office.asyncresult).</span></span> <span data-ttu-id="63f90-107">L' `Office` objet est l’objet racine de l’API JavaScript pour Office.</span><span class="sxs-lookup"><span data-stu-id="63f90-107">The `Office` object is the root object of the Office JavaScript API.</span></span> <span data-ttu-id="63f90-108">L' `Context` objet représente l’environnement d’exécution du complément.</span><span class="sxs-lookup"><span data-stu-id="63f90-108">The `Context` object represents the add-in's runtime environment.</span></span> <span data-ttu-id="63f90-109">Les deux `Office` et `Context` sont les objets fondamentaux de n’importe quel complément Office.</span><span class="sxs-lookup"><span data-stu-id="63f90-109">Both `Office` and `Context` are the fundamental objects for any Office Add-in.</span></span> <span data-ttu-id="63f90-110">L' `AsyncResult` objet représente les résultats d’une opération asynchrone, telle que les données renvoyées à la `getSelectedDataAsync` méthode, qui lit ce qu’un utilisateur a sélectionné dans un document.</span><span class="sxs-lookup"><span data-stu-id="63f90-110">The `AsyncResult` object represents the results of an asynchronous operation, such as the data returned to the `getSelectedDataAsync` method, which reads what a user has selected in a document.</span></span>

2. <span data-ttu-id="63f90-111">**Objet document.**</span><span class="sxs-lookup"><span data-stu-id="63f90-111">**The Document object.**</span></span> <span data-ttu-id="63f90-112">La majorité des éléments de l’API disponibles pour les compléments de contenu et du volet Office sont exposés via les méthodes, propriétés et événements de l’objet [Document](/javascript/api/office/office.document).</span><span class="sxs-lookup"><span data-stu-id="63f90-112">The majority of the API available to content and task pane add-ins is exposed through the methods, properties, and events of the [Document](/javascript/api/office/office.document) object.</span></span> <span data-ttu-id="63f90-113">Un complément de contenu ou de volet de tâches peut utiliser la propriété [Office.context.document](/javascript/api/office/office.context#document) pour accéder à l’objet **document** , et via ce dernier, peut accéder aux membres clés de l’API pour l’utilisation de données dans des documents, telles que les objets [bindings](/javascript/api/office/office.bindings) et [CustomXmlParts](/javascript/api/office/office.customxmlparts) , ainsi que les méthodes [getSelectedDataAsync](/javascript/api/office/office.document#getselecteddataasync-coerciontype--options--callback-), [setSelectedDataAsync](/javascript/api/office/office.document#setselecteddataasync-data--options--callback-)et [getFileAsync](/javascript/api/office/office.document#getfileasync-filetype--options--callback-) .</span><span class="sxs-lookup"><span data-stu-id="63f90-113">A content or task pane add-in can use the [Office.context.document](/javascript/api/office/office.context#document) property to access the **Document** object, and through it, can access the key members of the API for working with data in documents, such as the [Bindings](/javascript/api/office/office.bindings) and [CustomXmlParts](/javascript/api/office/office.customxmlparts) objects, and the [getSelectedDataAsync](/javascript/api/office/office.document#getselecteddataasync-coerciontype--options--callback-), [setSelectedDataAsync](/javascript/api/office/office.document#setselecteddataasync-data--options--callback-), and [getFileAsync](/javascript/api/office/office.document#getfileasync-filetype--options--callback-) methods.</span></span> <span data-ttu-id="63f90-114">L' `Document` objet fournit également la propriété [mode](/javascript/api/office/office.document#mode) permettant de déterminer si un document est en lecture seule ou en mode édition, la propriété [URL](/javascript/api/office/office.document#url) pour obtenir l’URL du document actif et l’accès à l’objet [Settings](/javascript/api/office/office.settings) .</span><span class="sxs-lookup"><span data-stu-id="63f90-114">The `Document` object also provides the [mode](/javascript/api/office/office.document#mode) property for determining whether a document is read-only or in edit mode, the [url](/javascript/api/office/office.document#url) property to get the URL of the current document, and access to the [Settings](/javascript/api/office/office.settings) object.</span></span> <span data-ttu-id="63f90-115">L' `Document` objet prend également en charge l’ajout de gestionnaires d’événements pour l’événement [SelectionChanged](/javascript/api/office/office.documentselectionchangedeventargs) , afin que vous puissiez détecter lorsqu’un utilisateur modifie sa sélection dans le document.</span><span class="sxs-lookup"><span data-stu-id="63f90-115">The `Document` object also supports adding event handlers for the [SelectionChanged](/javascript/api/office/office.documentselectionchangedeventargs) event, so you can detect when a user changes their selection in the document.</span></span>

   <span data-ttu-id="63f90-116">Un complément de contenu ou de volet de tâches ne peut accéder à l' `Document` objet qu’une fois que le DOM et l’environnement d’exécution ont été chargés, généralement dans le gestionnaire d’événements pourOffice.inil’événement [ tialize](/javascript/api/office) .</span><span class="sxs-lookup"><span data-stu-id="63f90-116">A content or task pane add-in can access the `Document` object only after the DOM and runtime environment has been loaded, typically in the event handler for the [Office.initialize](/javascript/api/office) event.</span></span> <span data-ttu-id="63f90-117">Pour plus d’informations sur le flux d’événements lors de l’initialisation d’un complément et sur la vérification du chargement correct du DOM et de l’environnement d’exécution, voir la page relative au [chargement du DOM et de l’environnement d’exécution](loading-the-dom-and-runtime-environment.md).</span><span class="sxs-lookup"><span data-stu-id="63f90-117">For information about the flow of events when an add-in is initialized, and how to check that the DOM and runtime and loaded successfully, see [Loading the DOM and runtime environment](loading-the-dom-and-runtime-environment.md).</span></span>

3. <span data-ttu-id="63f90-p105">**Objets pour l’utilisation de fonctionnalités spécifiques.** Pour travailler avec des fonctionnalités spécifiques de l’API, utilisez les méthodes et les objets suivants :</span><span class="sxs-lookup"><span data-stu-id="63f90-p105">**Objects for working with specific features.** To work with specific features of the API, use the following objects and methods:</span></span>

    - <span data-ttu-id="63f90-120">Les objets [CustomXmlParts](/javascript/api/office/office.bindings), [CustomXmlPart](/javascript/api/office/office.binding) et les objets associés pour créer et manipuler des parties XML personnalisées dans des documents Word.</span><span class="sxs-lookup"><span data-stu-id="63f90-120">The methods of the [Bindings](/javascript/api/office/office.bindings) object to create or get bindings, and the methods and properties of the [Binding](/javascript/api/office/office.binding) object to work with data.</span></span>

    - <span data-ttu-id="63f90-121">Les objets [CustomXmlParts](/javascript/api/office/office.customxmlparts) et [CustomXmlPart](/javascript/api/office/office.customxmlpart) et les objets associés pour créer et manipuler des parties XML personnalisées dans des documents Word.</span><span class="sxs-lookup"><span data-stu-id="63f90-121">The [CustomXmlParts](/javascript/api/office/office.customxmlparts), [CustomXmlPart](/javascript/api/office/office.customxmlpart) and associated objects to create and manipulate custom XML parts in Word documents.</span></span>

    - <span data-ttu-id="63f90-122">Les objets [File](/javascript/api/office/office.file) et [Slice](/javascript/api/office/office.slice) pour créer une copie de l’intégralité du document, le diviser en blocs ou en « sections », puis lire ou transmettre les données dans ces sections.</span><span class="sxs-lookup"><span data-stu-id="63f90-122">The [File](/javascript/api/office/office.file) and [Slice](/javascript/api/office/office.slice) objects to create a copy of the entire document, break it into chunks or "slices", and then read or transmit the data in those slices.</span></span>

    - <span data-ttu-id="63f90-123">L’objet [Settings](/javascript/api/office/office.settings) pour enregistrer des données personnalisées, telles que des préférences utilisateur et l’état du complément.</span><span class="sxs-lookup"><span data-stu-id="63f90-123">The [Settings](/javascript/api/office/office.settings) object to save custom data, such as user preferences, and add-in state.</span></span>


> [!IMPORTANT]
> <span data-ttu-id="63f90-124">Certains des membres d’API ne sont pas pris en charge dans toutes les applications Office pouvant héberger des compléments de contenu et du volet Office. Pour déterminer les membres pris en charge, voir les ressources suivantes :</span><span class="sxs-lookup"><span data-stu-id="63f90-124">Some of the API members aren't supported across all Office applications that can host content and task pane add-ins. To determine which members are supported, see any of the following:</span></span>

<span data-ttu-id="63f90-125">Pour obtenir un résumé de la prise en charge de l’API JavaScript pour Office dans les applications clientes Office, consultez [la rubrique Understanding the Office JavaScript API](understanding-the-javascript-api-for-office.md).</span><span class="sxs-lookup"><span data-stu-id="63f90-125">For a summary of Office JavaScript API support across Office client applications, see [Understanding the Office JavaScript API](understanding-the-javascript-api-for-office.md).</span></span>


## <a name="reading-and-writing-to-an-active-selection"></a><span data-ttu-id="63f90-126">Reading and writing to an active selection</span><span class="sxs-lookup"><span data-stu-id="63f90-126">Reading and writing to an active selection</span></span>

<span data-ttu-id="63f90-127">Vous pouvez lire ou écrire dans la sélection en cours de l’utilisateur dans un document, une feuille de calcul ou une présentation.</span><span class="sxs-lookup"><span data-stu-id="63f90-127">You can read or write to the user's current selection in a document, spreadsheet, or presentation.</span></span> <span data-ttu-id="63f90-128">En fonction de l’application Office de votre complément, vous pouvez spécifier le type de structure de données à lire ou à écrire en tant que paramètre dans les méthodes [getSelectedDataAsync](/javascript/api/office/office.document#getselecteddataasync-coerciontype--options--callback-) et [setSelectedDataAsync](/javascript/api/office/office.document#setselecteddataasync-data--options--callback-) de l’objet [document](/javascript/api/office/office.document) .</span><span class="sxs-lookup"><span data-stu-id="63f90-128">Depending on the Office application for your add-in, you can specify the type of data structure to read or write as a parameter in the [getSelectedDataAsync](/javascript/api/office/office.document#getselecteddataasync-coerciontype--options--callback-) and [setSelectedDataAsync](/javascript/api/office/office.document#setselecteddataasync-data--options--callback-) methods of the [Document](/javascript/api/office/office.document) object.</span></span> <span data-ttu-id="63f90-129">Par exemple, vous pouvez indiquer n’importe quel type de données (HTML, données tabulaires, Office Open XML ou texte) pour Word, des données texte et tabulaires pour Excel et des données texte pour PowerPoint et Project.</span><span class="sxs-lookup"><span data-stu-id="63f90-129">For example, you can specify any type of data (text, HTML, tabular data, or Office Open XML) for Word, text and tabular data for Excel, and text for PowerPoint and Project.</span></span> <span data-ttu-id="63f90-130">Vous pouvez également créer des gestionnaires d’événements pour détecter les modifications apportées à la sélection de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="63f90-130">You can also create event handlers to detect changes to the user's selection.</span></span> <span data-ttu-id="63f90-131">L’exemple suivant récupère les données de la sélection au format texte à l’aide de la `getSelectedDataAsync` méthode.</span><span class="sxs-lookup"><span data-stu-id="63f90-131">The following example gets data from the selection as text using the `getSelectedDataAsync` method.</span></span>


```js
Office.context.document.getSelectedDataAsync(
    Office.CoercionType.Text, function (asyncResult) {
        if (asyncResult.status == Office.AsyncResultStatus.Failed) {
            write('Action failed. Error: ' + asyncResult.error.message);
        }
        else {
            write('Selected data: ' + asyncResult.value);
        }
    });

// Function that writes to a div with id='message' on the page.
function write(message){
    document.getElementById('message').innerText += message;
}

```

<span data-ttu-id="63f90-132">For more details and examples, see [Read and write data to the active selection in a document or spreadsheet](read-and-write-data-to-the-active-selection-in-a-document-or-spreadsheet.md).</span><span class="sxs-lookup"><span data-stu-id="63f90-132">For more details and examples, see [Read and write data to the active selection in a document or spreadsheet](read-and-write-data-to-the-active-selection-in-a-document-or-spreadsheet.md).</span></span>


## <a name="binding-to-a-region-in-a-document-or-spreadsheet"></a><span data-ttu-id="63f90-133">Binding to a region in a document or spreadsheet</span><span class="sxs-lookup"><span data-stu-id="63f90-133">Binding to a region in a document or spreadsheet</span></span>

<span data-ttu-id="63f90-134">Vous pouvez utiliser les `getSelectedDataAsync` `setSelectedDataAsync` méthodes et pour lire ou écrire dans la sélection *actuelle* de l’utilisateur dans un document, une feuille de calcul ou une présentation.</span><span class="sxs-lookup"><span data-stu-id="63f90-134">You can use the `getSelectedDataAsync` and `setSelectedDataAsync` methods to read or write to the user's *current* selection in a document, spreadsheet, or presentation.</span></span> <span data-ttu-id="63f90-135">Toutefois, si vous souhaitez accéder à la même région dans un document via des sessions d’exécution de votre complément sans demander à l’utilisateur d’effectuer une sélection, vous devez d’abord établir une liaison avec cette région.</span><span class="sxs-lookup"><span data-stu-id="63f90-135">However, if you would like to access the same region in a document across sessions of running your add-in without requiring the user to make a selection, you should first bind to that region.</span></span> <span data-ttu-id="63f90-136">Avec une liaison, vous pouvez également vous abonner à des données et à des événements de modification de sélection, uniquement pour la région liée.</span><span class="sxs-lookup"><span data-stu-id="63f90-136">You can also subscribe to data and selection change events for that bound region.</span></span>

<span data-ttu-id="63f90-p108">Vous pouvez ajouter une liaison à l’aide des méthodes [addFromNamedItemAsync](/javascript/api/office/office.bindings#addfromnameditemasync-itemname--bindingtype--options--callback-), [addFromPromptAsync](/javascript/api/office/office.bindings#addfrompromptasync-bindingtype--options--callback-) ou [addFromSelectionAsync](/javascript/api/office/office.bindings#addfromselectionasync-bindingtype--options--callback-) de l’objet [Bindings](/javascript/api/office/office.bindings).</span><span class="sxs-lookup"><span data-stu-id="63f90-p108">You can add a binding by using [addFromNamedItemAsync](/javascript/api/office/office.bindings#addfromnameditemasync-itemname--bindingtype--options--callback-), [addFromPromptAsync](/javascript/api/office/office.bindings#addfrompromptasync-bindingtype--options--callback-), or [addFromSelectionAsync](/javascript/api/office/office.bindings#addfromselectionasync-bindingtype--options--callback-) methods of the [Bindings](/javascript/api/office/office.bindings) object. These methods return an identifier that you can use to access data in the binding, or to subscribe to its data change or selection change events.</span></span>

<span data-ttu-id="63f90-139">Voici un exemple qui ajoute une liaison au texte actuellement sélectionné dans un document, à l’aide de la `Bindings.addFromSelectionAsync` méthode.</span><span class="sxs-lookup"><span data-stu-id="63f90-139">The following is an example that adds a binding to the currently selected text in a document, by using the `Bindings.addFromSelectionAsync` method.</span></span>



```js
Office.context.document.bindings.addFromSelectionAsync(
    Office.BindingType.Text, { id: 'myBinding' }, function (asyncResult) {
    if (asyncResult.status == Office.AsyncResultStatus.Failed) {
        write('Action failed. Error: ' + asyncResult.error.message);
    } else {
        write('Added new binding with type: ' +
            asyncResult.value.type + ' and id: ' + asyncResult.value.id);
    }
});

// Function that writes to a div with id='message' on the page.
function write(message){
    document.getElementById('message').innerText += message; 
}
```

<span data-ttu-id="63f90-140">For more details and examples, see [Bind to regions in a document or spreadsheet](bind-to-regions-in-a-document-or-spreadsheet.md).</span><span class="sxs-lookup"><span data-stu-id="63f90-140">For more details and examples, see [Bind to regions in a document or spreadsheet](bind-to-regions-in-a-document-or-spreadsheet.md).</span></span>


## <a name="getting-entire-documents"></a><span data-ttu-id="63f90-141">Getting entire documents</span><span class="sxs-lookup"><span data-stu-id="63f90-141">Getting entire documents</span></span>

<span data-ttu-id="63f90-142">Si votre complément du volet Office s’exécute dans PowerPoint ou Word, vous pouvez utiliser les méthodes [Document.getFileAsync](/javascript/api/office/office.document#getfileasync-filetype--options--callback-), [File.getSliceAsync](/javascript/api/office/office.file#getsliceasync-sliceindex--callback-) et [File.closeAsync](/javascript/api/office/office.file#closeasync-callback-) pour obtenir la totalité d’une présentation ou d’un document.</span><span class="sxs-lookup"><span data-stu-id="63f90-142">If your task pane add-in runs in PowerPoint or Word, you can use the [Document.getFileAsync](/javascript/api/office/office.document#getfileasync-filetype--options--callback-), [File.getSliceAsync](/javascript/api/office/office.file#getsliceasync-sliceindex--callback-), and [File.closeAsync](/javascript/api/office/office.file#closeasync-callback-) methods to get an entire presentation or document.</span></span>

<span data-ttu-id="63f90-143">Lorsque vous appelez `Document.getFileAsync` , vous obtenez une copie du document dans un objet [file](/javascript/api/office/office.file) .</span><span class="sxs-lookup"><span data-stu-id="63f90-143">When you call `Document.getFileAsync` you get a copy of the document in a [File](/javascript/api/office/office.file) object.</span></span> <span data-ttu-id="63f90-144">L' `File` objet donne accès au document dans des « segments » représentés par des objets [Slice](/javascript/api/office/office.slice) .</span><span class="sxs-lookup"><span data-stu-id="63f90-144">The `File` object provides access to the document in "chunks" represented as [Slice](/javascript/api/office/office.slice) objects.</span></span> <span data-ttu-id="63f90-145">Lorsque vous appelez `getFileAsync` , vous pouvez spécifier le type de fichier (format texte ou Office XML ouvert compressé), ainsi que la taille des secteurs (jusqu’à 4 Mo).</span><span class="sxs-lookup"><span data-stu-id="63f90-145">When you call `getFileAsync`, you can specify the file type (text or compressed Open Office XML format), and size of the slices (up to 4MB).</span></span> <span data-ttu-id="63f90-146">Pour accéder au contenu de l' `File` objet, appelez ensuite, `File.getSliceAsync` qui renvoie les données brutes dans la propriété [Slice. Data](/javascript/api/office/office.slice#data) .</span><span class="sxs-lookup"><span data-stu-id="63f90-146">To access the contents of the `File` object, you then call `File.getSliceAsync` which returns the raw data in the [Slice.data](/javascript/api/office/office.slice#data) property.</span></span> <span data-ttu-id="63f90-147">Si vous avez spécifié un format compressé, vous obtiendrez les données du fichier sous la forme d’un tableau d’octets.</span><span class="sxs-lookup"><span data-stu-id="63f90-147">If you specified compressed format, you will get the file data as a byte array.</span></span> <span data-ttu-id="63f90-148">Si vous transférez le fichier à un service web, vous pouvez transformer les données brutes compressées dans une chaîne codée en Base64 avant l’envoi.</span><span class="sxs-lookup"><span data-stu-id="63f90-148">If you are transmitting the file to a web service, you can transform the compressed raw data to a base64-encoded string before submission.</span></span> <span data-ttu-id="63f90-149">Enfin, lorsque vous avez terminé d’obtenir les sections du fichier, utilisez la `File.closeAsync` méthode pour fermer le document.</span><span class="sxs-lookup"><span data-stu-id="63f90-149">Finally, when you are finished getting slices of the file, use the `File.closeAsync` method to close the document.</span></span>

<span data-ttu-id="63f90-150">For more details, see how to [get the whole document from an add-in for PowerPoint or Word](../word/get-the-whole-document-from-an-add-in-for-word.md).</span><span class="sxs-lookup"><span data-stu-id="63f90-150">For more details, see how to [get the whole document from an add-in for PowerPoint or Word](../word/get-the-whole-document-from-an-add-in-for-word.md).</span></span>


## <a name="reading-and-writing-custom-xml-parts-of-a-word-document"></a><span data-ttu-id="63f90-151">Reading and writing custom XML parts of a Word document</span><span class="sxs-lookup"><span data-stu-id="63f90-151">Reading and writing custom XML parts of a Word document</span></span>

<span data-ttu-id="63f90-p110">Grâce aux contrôles de contenu et au format de fichier Office Open XML, vous pouvez ajouter des parties XML personnalisées à un document Word et lier des éléments dans les parties XML aux contrôles de contenu de ce document. Lorsque vous ouvrez le document, Word lit et remplit automatiquement les contrôles de contenu liés avec les données des parties XML personnalisées. Les utilisateurs peuvent également écrire des données dans les contrôles de contenu. Lorsqu’ils enregistrent le document, les données des contrôles sont alors enregistrées dans les parties XML liées. Si votre complément du volet Office s’exécute dans Word, vous pouvez utiliser la propriété [Document.customXmlParts](/javascript/api/office/office.document#customxmlparts), ainsi que les objets [CustomXmlParts](/javascript/api/office/office.customxmlparts), [CustomXmlPart](/javascript/api/office/office.customxmlpart) et [CustomXmlNode](/javascript/api/office/office.customxmlnode) pour lire et écrire des données de manière dynamique dans le document.</span><span class="sxs-lookup"><span data-stu-id="63f90-p110">Using the Open Office XML file format and content controls, you can add custom XML parts to a Word document and bind elements in the XML parts to content controls in that document. When you open the document, Word reads and automatically populates bound content controls with data from the custom XML parts. Users can also write data into the content controls, and when the user saves the document, the data in the controls will be saved to the bound XML parts. Task pane add-ins for Word, can use the [Document.customXmlParts](/javascript/api/office/office.document#customxmlparts) property,[CustomXmlParts](/javascript/api/office/office.customxmlparts), [CustomXmlPart](/javascript/api/office/office.customxmlpart), and [CustomXmlNode](/javascript/api/office/office.customxmlnode) objects to read and write data dynamically to the document.</span></span>

<span data-ttu-id="63f90-p111">Les parties XML personnalisées peuvent être associées à des espaces de noms. Pour obtenir des données à partir des parties XML personnalisées dans un espace de noms, utilisez la méthode [CustomXmlParts.getByNamespaceAsync](/javascript/api/office/office.customxmlparts#getbynamespaceasync-ns--options--callback-).</span><span class="sxs-lookup"><span data-stu-id="63f90-p111">Custom XML parts may be associated with namespaces. To get data from custom XML parts in a namespace, use the [CustomXmlParts.getByNamespaceAsync](/javascript/api/office/office.customxmlparts#getbynamespaceasync-ns--options--callback-) method.</span></span>

<span data-ttu-id="63f90-p112">Vous pouvez également utiliser la [CustomXmlParts.getByIdAsync](/javascript/api/office/office.customxmlparts#getbyidasync-id--options--callback-) pour accéder aux parties XML personnalisées par leur GUID. Après avoir obtenu une partie XML personnalisée, utilisez la méthode [CustomXmlPart.getXmlAsync](/javascript/api/office/office.customxmlpart#getxmlasync-options--callback-) pour obtenir les données XML.</span><span class="sxs-lookup"><span data-stu-id="63f90-p112">You can also use the [CustomXmlParts.getByIdAsync](/javascript/api/office/office.customxmlparts#getbyidasync-id--options--callback-) method to access custom XML parts by their GUIDs. After getting a custom XML part, use the [CustomXmlPart.getXmlAsync](/javascript/api/office/office.customxmlpart#getxmlasync-options--callback-) method to get the XML data.</span></span>

<span data-ttu-id="63f90-160">Pour ajouter une nouvelle partie XML personnalisée à un document, utilisez la `Document.customXmlParts` propriété pour obtenir les parties XML personnalisées dans le document, puis appelez la méthode [CustomXmlParts. addAsync](/javascript/api/office/office.customxmlparts#addasync-xml--options--callback-) .</span><span class="sxs-lookup"><span data-stu-id="63f90-160">To add a new custom XML part to a document, use the `Document.customXmlParts` property to get the custom XML parts that are in the document, and call the [CustomXmlParts.addAsync](/javascript/api/office/office.customxmlparts#addasync-xml--options--callback-) method.</span></span>

<span data-ttu-id="63f90-161">Pour obtenir des informations détaillées sur l’utilisation de parties XML personnalisées avec un complément du volet Office, voir [Création de meilleurs compléments pour Word avec Office Open XML](../word/create-better-add-ins-for-word-with-office-open-xml.md).</span><span class="sxs-lookup"><span data-stu-id="63f90-161">For detailed information about how to work with custom XML parts with a task pane add-in, see [Creating Better Add-ins for Word with Office Open XML](../word/create-better-add-ins-for-word-with-office-open-xml.md).</span></span>


## <a name="persisting-add-in-settings"></a><span data-ttu-id="63f90-162">Persistance des paramètres de complément</span><span class="sxs-lookup"><span data-stu-id="63f90-162">Persisting add-in settings</span></span>


<span data-ttu-id="63f90-163">Vous devez souvent enregistrer les données personnalisées pour votre complément, telles que les préférences d’un utilisateur ou l’état du complément, et accéder à ces données lors de la prochaine ouverture du complément.</span><span class="sxs-lookup"><span data-stu-id="63f90-163">Often you need to save custom data for your add-in, such as a user's preferences or the add-in's state, and access that data the next time the add-in is opened.</span></span> <span data-ttu-id="63f90-164">Vous pouvez utiliser des techniques de programmation web courantes pour enregistrer les données, comme les cookies de navigateur ou le stockage web HTML 5.</span><span class="sxs-lookup"><span data-stu-id="63f90-164">You can use common web programming techniques to save that data, such as browser cookies or HTML 5 web storage.</span></span> <span data-ttu-id="63f90-165">Si votre complément est également exécuté dans Excel, PowerPoint ou Word, vous pouvez également utiliser les méthodes de l’objet [Settings](/javascript/api/office/office.settings).</span><span class="sxs-lookup"><span data-stu-id="63f90-165">Alternatively, if your add-in runs in Excel, PowerPoint, or Word, you can use the methods of the [Settings](/javascript/api/office/office.settings) object.</span></span> <span data-ttu-id="63f90-166">Les données créées avec l' `Settings` objet sont stockées dans la feuille de calcul, la présentation ou le document dans laquelle le complément a été inséré et enregistré.</span><span class="sxs-lookup"><span data-stu-id="63f90-166">Data created with the `Settings` object is stored in the spreadsheet, presentation, or document that the add-in was inserted into and saved with.</span></span> <span data-ttu-id="63f90-167">Ces données sont disponibles seulement pour le complément qui les a créées.</span><span class="sxs-lookup"><span data-stu-id="63f90-167">This data is available to only the add-in that created it.</span></span>

<span data-ttu-id="63f90-168">Pour éviter les allers-retours vers le serveur où le document est stocké, les données créées avec l' `Settings` objet sont gérées en mémoire au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="63f90-168">To avoid roundtrips to the server where the document is stored, data created with the `Settings` object is managed in memory at run time.</span></span> <span data-ttu-id="63f90-169">Les données de paramètres enregistrées précédemment sont chargées en mémoire lors de l’initialisation du complément et les modifications apportées à ces données sont uniquement enregistrées dans le document quand vous appelez la méthode [Settings.saveAsync](/javascript/api/office/office.settings#saveasync-options--callback-).</span><span class="sxs-lookup"><span data-stu-id="63f90-169">Previously saved settings data is loaded into memory when the add-in is initialized, and changes to that data are only saved back to the document when you call the [Settings.saveAsync](/javascript/api/office/office.settings#saveasync-options--callback-) method.</span></span> <span data-ttu-id="63f90-170">En interne, les données sont stockées dans un objet JSON sérialisé en tant que paires nom/valeur.</span><span class="sxs-lookup"><span data-stu-id="63f90-170">Internally, the data is stored in a serialized JSON object as name/value pairs.</span></span> <span data-ttu-id="63f90-171">Vous pouvez utiliser les méthodes [get](/javascript/api/office/office.settings#get-name-), [set](/javascript/api/office/office.settings#set-name--value-) et [remove](/javascript/api/office/office.settings#remove-name-) de l’objet **Settings** pour lire, écrire et supprimer des éléments dans la copie en mémoire des données.</span><span class="sxs-lookup"><span data-stu-id="63f90-171">You use the [get](/javascript/api/office/office.settings#get-name-), [set](/javascript/api/office/office.settings#set-name--value-), and [remove](/javascript/api/office/office.settings#remove-name-) methods of the **Settings** object, to read, write, and delete items from the in-memory copy of the data.</span></span> <span data-ttu-id="63f90-172">La ligne de code suivante explique comment créer un paramètre nommé `themeColor` et définir sa valeur sur « green ».</span><span class="sxs-lookup"><span data-stu-id="63f90-172">The following line of code shows how to create a setting named `themeColor` and set its value to 'green'.</span></span>




```js
Office.context.document.settings.set('themeColor', 'green');
```

<span data-ttu-id="63f90-173">Étant donné que les données de paramètres créées ou supprimées avec les `set` `remove` méthodes et agissent sur une copie en mémoire des données, vous devez appeler `saveAsync` pour conserver les modifications apportées aux données de paramètres dans le document avec lequel votre complément fonctionne.</span><span class="sxs-lookup"><span data-stu-id="63f90-173">Because settings data created or deleted with the `set` and `remove` methods is acting on an in-memory copy of the data, you must call `saveAsync` to persist changes to settings data into the document your add-in is working with.</span></span>

<span data-ttu-id="63f90-174">Pour plus d’informations sur l’utilisation des données personnalisées à l’aide des méthodes de l' `Settings` objet, voir [Persisting Add-in State and Settings](persisting-add-in-state-and-settings.md).</span><span class="sxs-lookup"><span data-stu-id="63f90-174">For more details about working with custom data using the methods of the `Settings` object, see [Persisting add-in state and settings](persisting-add-in-state-and-settings.md).</span></span>


## <a name="reading-properties-of-a-project-document"></a><span data-ttu-id="63f90-175">Lecture des propriétés d’un document de projet</span><span class="sxs-lookup"><span data-stu-id="63f90-175">Reading properties of a project document</span></span>

<span data-ttu-id="63f90-176">Si votre complément de volet Office s’exécute dans Project, vous pouvez lire les données de certains champs, ressources et champs de tâche du projet actif.</span><span class="sxs-lookup"><span data-stu-id="63f90-176">If your task pane add-in runs in Project, your add-in can read data from some of the project fields, resource, and task fields in the active project.</span></span> <span data-ttu-id="63f90-177">Pour ce faire, utilisez les méthodes et les événements de l’objet [ProjectDocument](/javascript/api/office/office.document) , qui étend l' `Document` objet pour fournir des fonctionnalités supplémentaires propres au projet.</span><span class="sxs-lookup"><span data-stu-id="63f90-177">To do that, you use the methods and events of the [ProjectDocument](/javascript/api/office/office.document) object, which extends the `Document` object to provide additional Project-specific functionality.</span></span>

<span data-ttu-id="63f90-178">Pour des exemples de lecture de données Project, voir [Créer votre premier complément du volet Office pour Projet 2013 à l’aide d’un éditeur de texte](../project/create-your-first-task-pane-add-in-for-project-by-using-a-text-editor.md).</span><span class="sxs-lookup"><span data-stu-id="63f90-178">For examples of reading Project data, see [Create your first task pane add-in for Project 2013 by using a text editor](../project/create-your-first-task-pane-add-in-for-project-by-using-a-text-editor.md).</span></span>


## <a name="permissions-model-and-governance"></a><span data-ttu-id="63f90-179">Modèle d’autorisations et gouvernance</span><span class="sxs-lookup"><span data-stu-id="63f90-179">Permissions model and governance</span></span>

<span data-ttu-id="63f90-180">Votre complément utilise l' `Permissions` élément dans son manifeste pour demander l’autorisation d’accéder au niveau de fonctionnalité requis à partir de l’API JavaScript pour Office.</span><span class="sxs-lookup"><span data-stu-id="63f90-180">Your add-in uses the `Permissions` element in its manifest to request permission to access the level of functionality it requires from the Office JavaScript API.</span></span> <span data-ttu-id="63f90-181">Par exemple, si votre complément nécessite un accès en lecture/écriture au document, son manifeste doit spécifier `ReadWriteDocument` comme valeur de texte dans son `Permissions` élément.</span><span class="sxs-lookup"><span data-stu-id="63f90-181">For example, if your add-in requires read/write access to the document, its manifest must specify `ReadWriteDocument` as the text value in its `Permissions` element.</span></span> <span data-ttu-id="63f90-182">Étant donné que les autorisations ont pour objectif de protéger la vie privée et la sécurité de l’utilisateur, en tant que meilleures pratiques, nous vous recommandons de demander le niveau d’autorisation minimal requis pour ses fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="63f90-182">Because permissions exist to protect a user's privacy and security, as a best practice you should request the minimum level of permissions it needs for its features.</span></span> <span data-ttu-id="63f90-183">L’exemple suivant illustre la demande de l’autorisation **ReadDocument** dans le manifeste d’un complément du volet Office.</span><span class="sxs-lookup"><span data-stu-id="63f90-183">The following example shows how to request the **ReadDocument** permission in a task pane's manifest.</span></span>


```XML
<?xml version="1.0" encoding="utf-8"?>
<OfficeApp xmlns="http://schemas.microsoft.com/office/appforoffice/1.0"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
 xsi:type="TaskPaneApp">
???<!-- Other manifest elements omitted. -->
  <Permissions>ReadDocument</Permissions>
???
</OfficeApp>

```

<span data-ttu-id="63f90-184">Pour plus d’informations, consultez la rubrique [demande d’autorisations pour l’utilisation d’API dans les compléments](requesting-permissions-for-api-use-in-content-and-task-pane-add-ins.md).</span><span class="sxs-lookup"><span data-stu-id="63f90-184">For more information, see [Requesting permissions for API use in add-ins](requesting-permissions-for-api-use-in-content-and-task-pane-add-ins.md).</span></span>


## <a name="see-also"></a><span data-ttu-id="63f90-185">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="63f90-185">See also</span></span>

- [<span data-ttu-id="63f90-186">API JavaScript pour Office</span><span class="sxs-lookup"><span data-stu-id="63f90-186">Office JavaScript API</span></span>](../reference/javascript-api-for-office.md)
- [<span data-ttu-id="63f90-187">Référence de schéma pour les manifestes des compléments Office</span><span class="sxs-lookup"><span data-stu-id="63f90-187">Schema reference for Office Add-ins manifests</span></span>](../develop/add-in-manifests.md)
- [<span data-ttu-id="63f90-188">Résolution des erreurs rencontrées par l’utilisateur avec des compléments Office</span><span class="sxs-lookup"><span data-stu-id="63f90-188">Troubleshoot user errors with Office Add-ins</span></span>](../testing/testing-and-troubleshooting.md)
