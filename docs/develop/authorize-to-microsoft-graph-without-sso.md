---
title: Autoriser la connexion à Microsoft Graph sans authentification unique
description: Découvrir l'autorisation de connexion à Microsoft Graph sans authentification unique
ms.date: 01/29/2020
localization_priority: Normal
ms.openlocfilehash: 828779a766c41088435ff5fdfa693e1d9939c710
ms.sourcegitcommit: a0262ea40cd23f221e69bcb0223110f011265d13
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/17/2020
ms.locfileid: "42688977"
---
# <a name="authorize-to-microsoft-graph-without-sso"></a><span data-ttu-id="60aa3-103">Autoriser la connexion à Microsoft Graph sans authentification unique</span><span class="sxs-lookup"><span data-stu-id="60aa3-103">Authorize to Microsoft Graph without SSO</span></span>

<span data-ttu-id="60aa3-104">Votre complément peut recevoir une autorisation d’accès aux données Microsoft Graph en obtenant un jeton d’accès auprès d’Azure Active Directory (AAD).</span><span class="sxs-lookup"><span data-stu-id="60aa3-104">Your add-in can get authorization to Microsoft Graph data by obtaining an access token to Graph from Azure Active Directory (AAD).</span></span> <span data-ttu-id="60aa3-105">Utilisez le flux de codes d’autorisation ou le flux implicite, comme vous le feriez dans d'autres applications web, mais à une exception près : AAD n’autorise pas la page de connexion à s’ouvrir dans un iFrame.</span><span class="sxs-lookup"><span data-stu-id="60aa3-105">Use either the Authorization Code flow or the Implicit flow just as you would in other web applications but with one exception: AAD does not allow its login page to open in an iframe.</span></span> <span data-ttu-id="60aa3-106">Lorsqu’un complément Office est exécuté sur *Office sur le web*, le volet Office est un IFrame.</span><span class="sxs-lookup"><span data-stu-id="60aa3-106">When an Office Add-in is running on *Office on the web*, the task pane is an iframe.</span></span> <span data-ttu-id="60aa3-107">Cela signifie que vous devez ouvrir l’écran de connexion Azure Active Directory dans une boîte de dialogue ouverte avec l’API de boîte de dialogue Office.</span><span class="sxs-lookup"><span data-stu-id="60aa3-107">This means you'll need to open the AAD login screen in a dialog box opened with the Office dialog API.</span></span> <span data-ttu-id="60aa3-108">Cela a un effet sur votre utilisation des bibliothèques d’aide à l’authentification et l’autorisation.</span><span class="sxs-lookup"><span data-stu-id="60aa3-108">This affects how you use authentication and authorization helper libraries.</span></span> <span data-ttu-id="60aa3-109">Pour plus d’informations, consultez l'[Authentification avec l’API de boîte de dialogue Office](auth-with-office-dialog-api.md).</span><span class="sxs-lookup"><span data-stu-id="60aa3-109">For more information, see [Authentication with the Office dialog API](auth-with-office-dialog-api.md).</span></span>

<span data-ttu-id="60aa3-110">Pour plus d’informations sur la programmation de l’authentification avec Azure Active Directory, commencez par la [Vue d’ensemble de la plateforme d’identité Microsoft (v 2.0)](/azure/active-directory/develop/v2-overview) où se trouvent les didacticiels et guides de cet ensemble de documentation, ainsi que des liens vers des exemples pertinents.</span><span class="sxs-lookup"><span data-stu-id="60aa3-110">For information about programming authentication with AAD, begin with [Microsoft identity platform (v2.0) overview](/azure/active-directory/develop/v2-overview), where you'll find tutorials and guides in that documentation set, as well as links to relevant samples.</span></span> <span data-ttu-id="60aa3-111">Une fois encore, vous devrez peut-être ajuster le code dans les exemples pour qu’il s’exécute dans la boîte de dialogue Office, afin de tenir compte du fait que la boîte de dialogue Office s’exécute dans un processus distinct de celui du volet Office.</span><span class="sxs-lookup"><span data-stu-id="60aa3-111">Once again, you may need to adjust the code in the samples to run in the Office dialog box to account for the fact that the Office dialog box runs in a separate process from the task pane.</span></span>

<span data-ttu-id="60aa3-112">Une fois que votre code obtient le jeton d’accès à Graph, soit il passe le jeton d’accès de la boîte de dialogue au volet Office, soit il stocke le jeton dans une base de données et signale au volet Office que le jeton est disponible.</span><span class="sxs-lookup"><span data-stu-id="60aa3-112">After your code obtains the access token to Graph, either it passes the access token from the dialog box to the task pane, or it stores the token in a database and signals the task pane that the token is available.</span></span> <span data-ttu-id="60aa3-113">(Pour plus d’informations, voir [Authentification avec l’API de boîte de dialogue Office](auth-with-office-dialog-api.md).) Le code dans le volet Office demande les données de Graph et inclut le jeton dans ces demandes.</span><span class="sxs-lookup"><span data-stu-id="60aa3-113">(See [Authentication with the Office dialog API](auth-with-office-dialog-api.md) for details.) Code in the task pane requests data from Graph, and includes the token in those requests.</span></span> <span data-ttu-id="60aa3-114">Pour plus d’informations sur l’appel de Graph et des kits de développement Graph, voir la [documentation de Microsoft Graph](/graph/).</span><span class="sxs-lookup"><span data-stu-id="60aa3-114">For more information about calling Graph and the Graph SDKs, see [Microsoft Graph documentation](/graph/).</span></span>

## <a name="recommended-libraries-and-samples"></a><span data-ttu-id="60aa3-115">Bibliothèques et exemples recommandés</span><span class="sxs-lookup"><span data-stu-id="60aa3-115">Recommended libraries and samples</span></span>

<span data-ttu-id="60aa3-116">Nous vous recommandons d’utiliser les bibliothèques suivantes lorsque vous accédez à Microsoft Graph sans utiliser l’authentification unique :</span><span class="sxs-lookup"><span data-stu-id="60aa3-116">We recommend that you use the following libraries when accessing Microsoft Graph without using SSO:</span></span>

- <span data-ttu-id="60aa3-117">Pour les compléments utilisant un élément côté serveur avec une infrastructure .NET basée sur le réseau, comme .NET Core ou ASP.NET, utilisez [MSAL.NET](https://github.com/AzureAD/microsoft-authentication-library-for-dotnet/wiki#conceptual-documentation).</span><span class="sxs-lookup"><span data-stu-id="60aa3-117">For add-ins using a server-side with a .NET-based framework such as .NET Core or ASP.NET, use [MSAL.NET](https://github.com/AzureAD/microsoft-authentication-library-for-dotnet/wiki#conceptual-documentation).</span></span>
- <span data-ttu-id="60aa3-118">Pour les compléments utilisant un élément côté serveur NodeJS, utilisez [Passport Azure AD](https://github.com/AzureAD/passport-azure-ad).</span><span class="sxs-lookup"><span data-stu-id="60aa3-118">For add-ins using a NodeJS-based server-side, use [Passport Azure AD](https://github.com/AzureAD/passport-azure-ad).</span></span>
- <span data-ttu-id="60aa3-119">Pour les compléments utilisant le flux implicite, utilisez [msal.js](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki).</span><span class="sxs-lookup"><span data-stu-id="60aa3-119">For add-ins using the Implicit flow, use [msal.js](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki).</span></span>

<span data-ttu-id="60aa3-120">Pour plus d’informations sur les bibliothèques recommandées avec la plateforme d’identité Microsoft (anciennement AAD v. 2.0), voir [Bibliothèques d’authentification de la plateforme d’identité Microsoft](/azure/active-directory/develop/reference-v2-libraries).</span><span class="sxs-lookup"><span data-stu-id="60aa3-120">For more information about recommended libraries for working with Microsoft Identity Platform (formerly AAD v.2.0), see [Microsoft identity platform authentication libraries](/azure/active-directory/develop/reference-v2-libraries).</span></span>

<span data-ttu-id="60aa3-121">Les exemples suivants obtiennent les données Microsoft Graph d’un complément Office :</span><span class="sxs-lookup"><span data-stu-id="60aa3-121">The following samples get Microsoft Graph data from an Office Add-in:</span></span>

- [<span data-ttu-id="60aa3-122">Complément Office Microsoft Graph ASP.NET</span><span class="sxs-lookup"><span data-stu-id="60aa3-122">Office Add-in Microsoft Graph ASP.NET</span></span>](https://github.com/OfficeDev/PnP-OfficeAddins/tree/master/Samples/auth/Office-Add-in-Microsoft-Graph-ASPNET)
- [<span data-ttu-id="60aa3-123">Complément Outlook Microsoft Graph ASP.NET</span><span class="sxs-lookup"><span data-stu-id="60aa3-123">Outlook Add-in Microsoft Graph ASP.NET</span></span>](https://github.com/OfficeDev/PnP-OfficeAddins/tree/master/Samples/auth/Outlook-Add-in-Microsoft-Graph-ASPNET)
- [<span data-ttu-id="60aa3-124">Complément Office Microsoft Graph React</span><span class="sxs-lookup"><span data-stu-id="60aa3-124">Office Add-in Microsoft Graph React</span></span>](https://github.com/OfficeDev/PnP-OfficeAddins/tree/master/Samples/auth/Office-Add-in-Microsoft-Graph-React)
