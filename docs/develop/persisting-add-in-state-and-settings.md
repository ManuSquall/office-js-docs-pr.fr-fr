---
title: Conservation de l’état et des paramètres des compléments
description: Apprenez à rendre persistantes les données dans les applications web de l’Application Office qui s’exécutent dans l’environnement sans état d’un contrôle de navigateur.
ms.date: 03/23/2021
localization_priority: Normal
ms.openlocfilehash: 47f1b9a5000660f13f8bba5e747d0f5ca5e9d6a0
ms.sourcegitcommit: 54fef33bfc7d18a35b3159310bbd8b1c8312f845
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/09/2021
ms.locfileid: "51651078"
---
# <a name="persisting-add-in-state-and-settings"></a><span data-ttu-id="3abaa-103">Conservation de l’état et des paramètres des compléments</span><span class="sxs-lookup"><span data-stu-id="3abaa-103">Persisting add-in state and settings</span></span>

[!include[information about the common API](../includes/alert-common-api-info.md)]

<span data-ttu-id="3abaa-p101">Les compléments Office sont essentiellement des applications web exécutées dans l’environnement sans état d’un contrôle de navigateur. En conséquence, votre complément devra peut-être faire persister les données pour assurer la continuité de certaines opérations ou fonctionnalités entre les sessions d’utilisation du complément. Par exemple, votre complément peut disposer de paramètres personnalisés ou d’autres valeurs dont il a besoin pour l’enregistrement et le rechargement à la prochaine initialisation, tels que l’affichage préféré d’un utilisateur ou l’emplacement par défaut. Pour ce faire, vous pouvez procéder comme suit :</span><span class="sxs-lookup"><span data-stu-id="3abaa-p101">Office Add-ins are essentially web applications running in the stateless environment of a browser control. As a result, your add-in may need to persist data to maintain the continuity of certain operations or features across sessions of using your add-in. For example, your add-in may have custom settings or other values that it needs to save and reload the next time it's initialized, such as a user's preferred view or default location. To do that, you can:</span></span>

- <span data-ttu-id="3abaa-108">Utilisez les membres de l’API JavaScript Office qui stockent les données sous la forme :</span><span class="sxs-lookup"><span data-stu-id="3abaa-108">Use members of the Office JavaScript API that store data as either:</span></span>
  - <span data-ttu-id="3abaa-109">Paires nom/valeur dans un conteneur de propriétés stocké dans un emplacement qui dépend du type de complément.</span><span class="sxs-lookup"><span data-stu-id="3abaa-109">Name/value pairs in a property bag stored in a location that depends on add-in type.</span></span>
  - <span data-ttu-id="3abaa-110">Éléments XML personnalisés stockés dans le document.</span><span class="sxs-lookup"><span data-stu-id="3abaa-110">Custom XML stored in the document.</span></span>

- <span data-ttu-id="3abaa-111">Utilisez des techniques fournies par le contrôle de navigateur sous-jacent : les cookies de navigateur ou le stockage web HTML5 ([localStorage](https://developer.mozilla.org/docs/Web/API/Window/localStorage) ou [sessionStorage](https://developer.mozilla.org/docs/Web/API/Window/sessionStorage)).</span><span class="sxs-lookup"><span data-stu-id="3abaa-111">Use techniques provided by the underlying browser control: browser cookies, or HTML5 web storage ([localStorage](https://developer.mozilla.org/docs/Web/API/Window/localStorage) or [sessionStorage](https://developer.mozilla.org/docs/Web/API/Window/sessionStorage)).</span></span>
    > [!NOTE]
    > <span data-ttu-id="3abaa-112">L’utilisateur peut bloquer les techniques de stockage basées sur le navigateur en fonction des paramètres qu’il choisit.</span><span class="sxs-lookup"><span data-stu-id="3abaa-112">The user can block browser-based storage techniques depending on the settings they choose.</span></span>

<span data-ttu-id="3abaa-113">Cet article se concentre sur l’utilisation de l’API JavaScript pour Office afin de rendre persistant l’état du add-in dans le document actuel.</span><span class="sxs-lookup"><span data-stu-id="3abaa-113">This article focuses on how to use the Office JavaScript API to persist add-in state to the current document.</span></span> <span data-ttu-id="3abaa-114">Si vous devez rendre persistant l’état entre les documents, par exemple suivre les préférences des utilisateurs dans tous les documents qu’ils ouvrent, vous devez utiliser une approche différente.</span><span class="sxs-lookup"><span data-stu-id="3abaa-114">If you need to persist state across documents, such as tracking user preferences across any documents they open, you will need to use a different approach.</span></span> <span data-ttu-id="3abaa-115">Par exemple, vous [](sso-in-office-add-ins.md#using-the-sso-token-as-an-identity) pouvez utiliser l' utilisateur unique pour obtenir l’identité de l’utilisateur, puis enregistrer l’ID utilisateur et ses paramètres dans une base de données en ligne.</span><span class="sxs-lookup"><span data-stu-id="3abaa-115">For example, you could use [SSO](sso-in-office-add-ins.md#using-the-sso-token-as-an-identity) to obtain the user identity, and then save the user ID and their settings to an online database.</span></span>

## <a name="persisting-add-in-state-and-settings-with-the-office-javascript-api"></a><span data-ttu-id="3abaa-116">Persistance de l’état et des paramètres du add-in avec l’API JavaScript pour Office</span><span class="sxs-lookup"><span data-stu-id="3abaa-116">Persisting add-in state and settings with the Office JavaScript API</span></span>

<span data-ttu-id="3abaa-117">L’API JavaScript pour Office fournit les objets [Settings,](/javascript/api/office/office.settings) [RoamingSettings](/javascript/api/outlook/office.roamingsettings)et [CustomProperties](/javascript/api/outlook/office.customproperties) pour enregistrer l’état du add-in entre les sessions, comme décrit dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="3abaa-117">The Office JavaScript API provides the [Settings](/javascript/api/office/office.settings), [RoamingSettings](/javascript/api/outlook/office.roamingsettings), and [CustomProperties](/javascript/api/outlook/office.customproperties) objects for saving add-in state across sessions as described in the following table.</span></span> <span data-ttu-id="3abaa-118">Dans tous les cas, les valeurs de paramètre enregistrées sont associées à l’[ID](../reference/manifest/id.md) du complément qui les a créées.</span><span class="sxs-lookup"><span data-stu-id="3abaa-118">In all cases, the saved settings values are associated with the [Id](../reference/manifest/id.md) of the add-in that created them.</span></span>

|<span data-ttu-id="3abaa-119">**Objet**</span><span class="sxs-lookup"><span data-stu-id="3abaa-119">**Object**</span></span>|<span data-ttu-id="3abaa-120">**Type de complément**</span><span class="sxs-lookup"><span data-stu-id="3abaa-120">**Add-in type support**</span></span>|<span data-ttu-id="3abaa-121">**Emplacement de stockage**</span><span class="sxs-lookup"><span data-stu-id="3abaa-121">**Storage location**</span></span>|<span data-ttu-id="3abaa-122">**Prise en charge des applications Office**</span><span class="sxs-lookup"><span data-stu-id="3abaa-122">**Office application support**</span></span>|
|:-----|:-----|:-----|:-----|
|[<span data-ttu-id="3abaa-123">Paramètres</span><span class="sxs-lookup"><span data-stu-id="3abaa-123">Settings</span></span>](/javascript/api/office/office.settings)|<span data-ttu-id="3abaa-124">Contenu et volet de tâches</span><span class="sxs-lookup"><span data-stu-id="3abaa-124">content and task pane</span></span>|<span data-ttu-id="3abaa-125">Document, feuille de calcul ou présentation qu’utilise le complément.</span><span class="sxs-lookup"><span data-stu-id="3abaa-125">The document, spreadsheet, or presentation the add-in is working with.</span></span> <span data-ttu-id="3abaa-126">Seul le complément qui a créé les paramètres de complément de contenu et du volet Office peut y accéder à partir du document où ils sont enregistrés.</span><span class="sxs-lookup"><span data-stu-id="3abaa-126">Content and task pane add-in settings are available to the add-in that created them from the document where they are saved.</span></span><br/><br/><span data-ttu-id="3abaa-p105">**Remarque importante :** ne stockez pas de mots de passe ou autres informations d’identification personnelle (PII) avec l’objet **Settings**. Les données enregistrées ne sont pas visibles par les utilisateurs finals. Toutefois, elles sont stockées en tant que partie du document, qui est accessible en lisant directement le format de fichier. Vous devez limiter l’utilisation de PII de votre complément et stocker ces informations requises par votre complément uniquement sur le serveur qui l’héberge en tant que ressource sécurisée par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3abaa-p105">**Important:** Don't store passwords and other sensitive personally identifiable information (PII) with the **Settings** object. The data saved isn't visible to end users, but it is stored as part of the document, which is accessible by reading the document's file format directly. You should limit your add-in's use of PII and store any PII required by your add-in only on the server hosting your add-in as a user-secured resource.</span></span>|<span data-ttu-id="3abaa-130">Word, Excel ou PowerPoint</span><span class="sxs-lookup"><span data-stu-id="3abaa-130">Word, Excel, or PowerPoint</span></span><br/><br/> <span data-ttu-id="3abaa-131">**Remarque :** les compléments du volet Office pour Project 2013 ne prennent pas en charge l’API **Settings** pour le stockage de l’état ou des paramètres du complément.</span><span class="sxs-lookup"><span data-stu-id="3abaa-131">**Note:** Task pane add-ins for Project 2013 don't support the **Settings** API for storing add-in state or settings.</span></span> <span data-ttu-id="3abaa-132">Toutefois, pour les applications qui s’exécutent dans Project (ainsi que d’autres applications clientes Office), vous pouvez utiliser des techniques telles que les cookies de navigateur ou le stockage web.</span><span class="sxs-lookup"><span data-stu-id="3abaa-132">However, for add-ins running in Project (as well as other Office client applications) you can use techniques such as browser cookies or web storage.</span></span> <span data-ttu-id="3abaa-133">Pour plus d’informations sur ces techniques, reportez-vous à l’exemple de code [Excel-Add-in-JavaScript-PersistCustomSettings](https://github.com/OfficeDev/Excel-Add-in-JavaScript-PersistCustomSettings).</span><span class="sxs-lookup"><span data-stu-id="3abaa-133">For more information on these techniques, see the [Excel-Add-in-JavaScript-PersistCustomSettings](https://github.com/OfficeDev/Excel-Add-in-JavaScript-PersistCustomSettings).</span></span> |
|[<span data-ttu-id="3abaa-134">RoamingSettings</span><span class="sxs-lookup"><span data-stu-id="3abaa-134">RoamingSettings</span></span>](/javascript/api/outlook/office.roamingsettings)|<span data-ttu-id="3abaa-135">Outlook</span><span class="sxs-lookup"><span data-stu-id="3abaa-135">Outlook</span></span>|<span data-ttu-id="3abaa-136">Boîte aux lettres de serveur Exchange de l’utilisateur où le complément est installé.</span><span class="sxs-lookup"><span data-stu-id="3abaa-136">The user's Exchange server mailbox where the add-in is installed.</span></span> <span data-ttu-id="3abaa-137">Étant donné que ces paramètres sont stockés dans la boîte aux lettres du serveur de l’utilisateur, ils peuvent « se déplacer » avec l’utilisateur et sont disponibles pour le module lorsqu’il est en cours d’exécution dans le contexte d’une application cliente Office prise en charge ou d’un navigateur accédant à la boîte aux lettres de cet utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3abaa-137">Because these settings are stored in the user's server mailbox, they can "roam" with the user and are available to the add-in when it is running in the context of any supported Office client application or browser accessing that user's mailbox.</span></span><br/><br/> <span data-ttu-id="3abaa-138">Seul le complément qui a créé les paramètres d’itinérance du complément Outlook peut y accéder, et uniquement dans la boîte aux lettres où le complément est installé.</span><span class="sxs-lookup"><span data-stu-id="3abaa-138">Outlook add-in roaming settings are available only to the add-in that created them, and only from the mailbox where the add-in is installed.</span></span>|<span data-ttu-id="3abaa-139">Outlook</span><span class="sxs-lookup"><span data-stu-id="3abaa-139">Outlook</span></span>|
|[<span data-ttu-id="3abaa-140">CustomProperties</span><span class="sxs-lookup"><span data-stu-id="3abaa-140">CustomProperties</span></span>](/javascript/api/outlook/office.customproperties)|<span data-ttu-id="3abaa-141">Outlook</span><span class="sxs-lookup"><span data-stu-id="3abaa-141">Outlook</span></span>|<span data-ttu-id="3abaa-p108">Élément de message, de rendez-vous ou de demande de réunion qu’utilise le complément. Seul le complément qui a créé les propriétés personnalisées d’élément de complément Outlook peut y accéder, et uniquement dans l’élément où elles sont enregistrées.</span><span class="sxs-lookup"><span data-stu-id="3abaa-p108">The message, appointment, or meeting request item the add-in is working with. Outlook add-in item custom properties are available only to the add-in that created them, and only from the item where they are saved.</span></span>|<span data-ttu-id="3abaa-144">Outlook</span><span class="sxs-lookup"><span data-stu-id="3abaa-144">Outlook</span></span>|
|[<span data-ttu-id="3abaa-145">CustomXmlParts</span><span class="sxs-lookup"><span data-stu-id="3abaa-145">CustomXmlParts</span></span>](/javascript/api/office/office.customxmlparts)|<span data-ttu-id="3abaa-146">volet Office</span><span class="sxs-lookup"><span data-stu-id="3abaa-146">task pane</span></span>|<span data-ttu-id="3abaa-p109">Document, feuille de calcul ou présentation que le complément utilise. Les paramètres de complément de volet Office sont disponibles pour le complément qui les a créés dans le document dans lequel ils sont enregistrés.</span><span class="sxs-lookup"><span data-stu-id="3abaa-p109">The document, spreadsheet, or presentation the add-in is working with. Task pane add-in settings are available to the add-in that created them from the document where they are saved.</span></span><br/><br/><span data-ttu-id="3abaa-p110">**Important :** ne stockez pas de mot de passe ni d’autres informations d’identification personnelle dans une partie XML personnalisée. Les données enregistrées ne sont pas visibles par les utilisateurs finals. Toutefois, elles sont stockées en tant que partie du document, qui est accessible en lisant directement le format de fichier. Vous devez limiter l’utilisation des informations d’identification personnelle de votre complément et stocker ces informations requises par votre complément uniquement sur le serveur qui l’héberge en tant que ressource sécurisée par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3abaa-p110">**Important:** Don't store passwords and other sensitive personally identifiable information (PII) in a custom XML part. The data saved isn't visible to end users, but it is stored as part of the document, which is accessible by reading the document's file format directly. You should limit your add-in's use of PII and store any PII required by your add-in only on the server hosting your add-in as a user-secured resource.</span></span>|<span data-ttu-id="3abaa-152">Word (à l’aide de l’API javaScript commune Office) Excel (à l’aide de l’API JavaScript excel spécifique à l’application</span><span class="sxs-lookup"><span data-stu-id="3abaa-152">Word (using the Office JavaScript Common API) Excel (using the application-specific Excel JavaScript API</span></span>|

## <a name="settings-data-is-managed-in-memory-at-runtime"></a><span data-ttu-id="3abaa-153">Données de paramètres gérées en mémoire à l’exécution</span><span class="sxs-lookup"><span data-stu-id="3abaa-153">Settings data is managed in memory at runtime</span></span>

> [!NOTE]
> <span data-ttu-id="3abaa-154">Les deux sections suivantes abordent les paramètres dans le contexte de l’API JavaScript courante pour Office.</span><span class="sxs-lookup"><span data-stu-id="3abaa-154">The following two sections discuss settings in the context of the Office Common JavaScript API.</span></span> <span data-ttu-id="3abaa-155">L’API JavaScript pour Excel spécifique à l’application permet également d’accéder aux paramètres personnalisés.</span><span class="sxs-lookup"><span data-stu-id="3abaa-155">The application-specific Excel JavaScript API also provides access to the custom settings.</span></span> <span data-ttu-id="3abaa-156">Les API Excel et les modes de programmation sont légèrement différents.</span><span class="sxs-lookup"><span data-stu-id="3abaa-156">The Excel APIs and programming patterns are somewhat different.</span></span> <span data-ttu-id="3abaa-157">Pour plus d’informations, reportez-vous à l’article sur l’objet [SettingCollection pour Excel](/javascript/api/excel/excel.settingcollection).</span><span class="sxs-lookup"><span data-stu-id="3abaa-157">For more information, see [Excel SettingCollection](/javascript/api/excel/excel.settingcollection).</span></span>

<span data-ttu-id="3abaa-158">En interne, les données du sac de propriétés accessibles avec le ou les objets sont stockées sous la forme d’un objet JSON (JavaScript Object Notation) sérialisé qui contient des `Settings` `CustomProperties` `RoamingSettings` paires nom/valeur.</span><span class="sxs-lookup"><span data-stu-id="3abaa-158">Internally, the data in the property bag accessed with the `Settings`, `CustomProperties`, or `RoamingSettings` objects is stored as a serialized JavaScript Object Notation (JSON) object that contains name/value pairs.</span></span> <span data-ttu-id="3abaa-159">Le nom (clé) de chaque valeur doit être un , et la valeur stockée peut être un JavaScript , ou , mais pas `string` `string` une `number` `date` `object` **fonction**.</span><span class="sxs-lookup"><span data-stu-id="3abaa-159">The name (key) for each value must be a `string`, and the stored value can be a JavaScript `string`, `number`, `date`, or `object`, but not a **function**.</span></span>

<span data-ttu-id="3abaa-160">Cet exemple de structure de conteneur des propriétés contient trois valeurs de type **string** (chaîne) définies, nommées `firstName`, `location` et `defaultView`.</span><span class="sxs-lookup"><span data-stu-id="3abaa-160">This example of the property bag structure contains three defined **string** values named `firstName`,  `location`, and  `defaultView`.</span></span>

```json
{
    "firstName":"Erik",
    "location":"98052",
    "defaultView":"basic"
}
```

<span data-ttu-id="3abaa-161">Après avoir enregistré le conteneur des propriétés de paramètres durant la session de complément précédente, vous pouvez le charger pendant ou après l’initialisation du complément, durant la session actuelle du complément.</span><span class="sxs-lookup"><span data-stu-id="3abaa-161">After the settings property bag is saved during the previous add-in session, it can be loaded when the add-in is initialized or at any point after that during the add-in's current session.</span></span> <span data-ttu-id="3abaa-162">Pendant la session, les paramètres sont gérés entièrement en mémoire à l’aide des méthodes et des méthodes de l’objet qui correspondent au type de paramètres que vous créez `get` `set` ( `remove` **Paramètres,** **CustomProperties** ou **RoamingSettings**).</span><span class="sxs-lookup"><span data-stu-id="3abaa-162">During the session, the settings are managed in entirely in memory using the `get`, `set`, and `remove` methods of the object that corresponds to the kind of settings you are creating (**Settings**, **CustomProperties**, or **RoamingSettings**).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="3abaa-163">Pour rendre persistants les ajouts, mises à jour ou suppressions effectués au cours de la session actuelle du complément vers l’emplacement de stockage, vous devez appeler la méthode de l’objet correspondant utilisé pour travailler avec ce type de `saveAsync` paramètres.</span><span class="sxs-lookup"><span data-stu-id="3abaa-163">To persist any additions, updates, or deletions made during the add-in's current session to the storage location, you must call the `saveAsync` method of the corresponding object used to work with that kind of settings.</span></span> <span data-ttu-id="3abaa-164">Les méthodes et les paramètres fonctionnent uniquement sur la copie en mémoire du sac des `get` `set` `remove` propriétés des paramètres.</span><span class="sxs-lookup"><span data-stu-id="3abaa-164">The `get`, `set`, and `remove` methods operate only on the in-memory copy of the settings property bag.</span></span> <span data-ttu-id="3abaa-165">Si votre add-in est fermé sans appel, toutes les modifications apportées aux paramètres au cours de `saveAsync` cette session seront perdues.</span><span class="sxs-lookup"><span data-stu-id="3abaa-165">If your add-in is closed without calling `saveAsync`, any changes made to settings during that session will be lost.</span></span>

## <a name="how-to-save-add-in-state-and-settings-per-document-for-content-and-task-pane-add-ins"></a><span data-ttu-id="3abaa-166">Enregistrement de l’état et des paramètres d’un complément par document pour les compléments de contenu et du volet Office</span><span class="sxs-lookup"><span data-stu-id="3abaa-166">How to save add-in state and settings per document for content and task pane add-ins</span></span>

<span data-ttu-id="3abaa-167">Pour conserver l’état ou les paramètres personnalisés d’un complément de contenu ou du volet Office pour Word, Excel ou PowerPoint, utilisez l’objet [Settings](/javascript/api/office/office.settings) et ses méthodes.</span><span class="sxs-lookup"><span data-stu-id="3abaa-167">To persist state or custom settings of a content or task pane add-in for Word, Excel, or PowerPoint, you use the [Settings](/javascript/api/office/office.settings) object and its methods.</span></span> <span data-ttu-id="3abaa-168">Le sac de propriétés créé avec les méthodes de l’objet est disponible uniquement pour l’instance du contenu ou du module de tâches qui l’a créé, et uniquement à partir du document dans lequel il est `Settings` enregistré.</span><span class="sxs-lookup"><span data-stu-id="3abaa-168">The property bag created with the methods of the `Settings` object are available only to the instance of the content or task pane add-in that created it, and only from the document in which it is saved.</span></span>

<span data-ttu-id="3abaa-169">L’objet est automatiquement chargé dans le cadre de l’objet Document et est disponible lorsque le volet Des tâches ou le module de contenu `Settings` est activé. [](/javascript/api/office/office.document)</span><span class="sxs-lookup"><span data-stu-id="3abaa-169">The `Settings` object is automatically loaded as part of the [Document](/javascript/api/office/office.document) object, and is available when the task pane or content add-in is activated.</span></span> <span data-ttu-id="3abaa-170">Une fois l’objet ins instantié, vous pouvez accéder à l’objet avec la propriété `Document` `Settings` [settings](/javascript/api/office/office.document#settings) de `Document` l’objet.</span><span class="sxs-lookup"><span data-stu-id="3abaa-170">After the `Document` object is instantiated, you can access the `Settings` object with the [settings](/javascript/api/office/office.document#settings) property of the `Document` object.</span></span> <span data-ttu-id="3abaa-171">Pendant toute la durée de vie de la session, vous pouvez simplement utiliser le , et les méthodes pour lire, écrire ou supprimer les paramètres persistants et l’état du add-in de la copie en mémoire du sac des `Settings.get` `Settings.set` `Settings.remove` propriétés.</span><span class="sxs-lookup"><span data-stu-id="3abaa-171">During the lifetime of the session, you can just use the `Settings.get`, `Settings.set`, and `Settings.remove` methods to read, write, or remove persisted settings and add-in state from the in-memory copy of the property bag.</span></span>

<span data-ttu-id="3abaa-172">Étant donné que les méthodes de définition (set) et de suppression (remove) fonctionnent uniquement par rapport à la copie en mémoire du conteneur des propriétés de paramètres, pour enregistrer de nouveaux paramètres ou des paramètres modifiés dans le document auquel le complément est associé, vous devez appeler la méthode [Settings.saveAsync](/javascript/api/office/office.settings#saveasync-options--callback-).</span><span class="sxs-lookup"><span data-stu-id="3abaa-172">Because the set and remove methods operate against only the in-memory copy of the settings property bag, to save new or changed settings back to the document the add-in is associated with you must call the [Settings.saveAsync](/javascript/api/office/office.settings#saveasync-options--callback-) method.</span></span>

### <a name="creating-or-updating-a-setting-value"></a><span data-ttu-id="3abaa-173">Création ou mise à jour d’une valeur de paramètre</span><span class="sxs-lookup"><span data-stu-id="3abaa-173">Creating or updating a setting value</span></span>

<span data-ttu-id="3abaa-p117">L’exemple de code suivant montre comment utiliser la méthode [Settings.set](/javascript/api/office/office.settings#set-name--value-) pour créer un paramètre appelé `'themeColor'` avec la valeur `'green'`. Le premier paramètre de la méthode set est le _name_ (ID) respectant la casse du paramètre à définir ou à créer. Le second paramètre est la _value_ du paramètre.</span><span class="sxs-lookup"><span data-stu-id="3abaa-p117">The following code example shows how to use the [Settings.set](/javascript/api/office/office.settings#set-name--value-) method to create a setting called `'themeColor'` with a value `'green'`. The first parameter of the set method is the case-sensitive  _name_ (Id) of the setting to set or create. The second parameter is the _value_ of the setting.</span></span>

```js
Office.context.document.settings.set('themeColor', 'green');
```

 <span data-ttu-id="3abaa-177">Le paramètre avec le nom spécifié est créé s’il n’existe pas déjà ou sa valeur est mise à jour s’il existe.</span><span class="sxs-lookup"><span data-stu-id="3abaa-177">The setting with the specified name is created if it doesn't already exist, or its value is updated if it does exist.</span></span> <span data-ttu-id="3abaa-178">Utilisez la méthode pour rendre persistants les paramètres nouveaux ou mis à `Settings.saveAsync` jour dans le document.</span><span class="sxs-lookup"><span data-stu-id="3abaa-178">Use the `Settings.saveAsync` method to persist the new or updated settings to the document.</span></span>

### <a name="getting-the-value-of-a-setting"></a><span data-ttu-id="3abaa-179">Obtention de la valeur d’un paramètre</span><span class="sxs-lookup"><span data-stu-id="3abaa-179">Getting the value of a setting</span></span>

<span data-ttu-id="3abaa-180">L’exemple suivant illustre comment utiliser la méthode [Settings.get](/javascript/api/office/office.settings#get-name-) pour obtenir la valeur d’un paramètre nommé « themeColor ».</span><span class="sxs-lookup"><span data-stu-id="3abaa-180">The following example shows how use the [Settings.get](/javascript/api/office/office.settings#get-name-) method to get the value of a setting called "themeColor".</span></span> <span data-ttu-id="3abaa-181">Le seul paramètre de la méthode est le nom du paramètre sensible `get` _à la_ cas.</span><span class="sxs-lookup"><span data-stu-id="3abaa-181">The only parameter of the `get` method is the case-sensitive _name_ of the setting.</span></span>

```js
write('Current value for mySetting: ' + Office.context.document.settings.get('themeColor'));

// Function that writes to a div with id='message' on the page.
function write(message){
    document.getElementById('message').innerText += message;
}
```

 <span data-ttu-id="3abaa-182">La méthode renvoie la valeur précédemment enregistrée pour le nom du paramètre `get` qui a été transmis. </span><span class="sxs-lookup"><span data-stu-id="3abaa-182">The `get` method returns the value that was previously saved for the setting _name_ that was passed in.</span></span> <span data-ttu-id="3abaa-183">Si le paramètre n’existe pas, la méthode retourne **null**.</span><span class="sxs-lookup"><span data-stu-id="3abaa-183">If the setting doesn't exist, the method returns **null**.</span></span>

### <a name="removing-a-setting"></a><span data-ttu-id="3abaa-184">Suppression d’un paramètre</span><span class="sxs-lookup"><span data-stu-id="3abaa-184">Removing a setting</span></span>

<span data-ttu-id="3abaa-185">L’exemple suivant illustre comment utiliser la méthode [Settings.remove](/javascript/api/office/office.settings#remove-name-) pour supprimer un paramètre portant le nom « themeColor ».</span><span class="sxs-lookup"><span data-stu-id="3abaa-185">The following example shows how to use the [Settings.remove](/javascript/api/office/office.settings#remove-name-) method to remove a setting with the name "themeColor".</span></span> <span data-ttu-id="3abaa-186">Le seul paramètre de la méthode est le nom du paramètre sensible `remove` _à la_ cas.</span><span class="sxs-lookup"><span data-stu-id="3abaa-186">The only parameter of the `remove` method is the case-sensitive _name_ of the setting.</span></span>

```js
Office.context.document.settings.remove('themeColor');
```

<span data-ttu-id="3abaa-187">Rien ne se produit si le paramètre n’existe pas.</span><span class="sxs-lookup"><span data-stu-id="3abaa-187">Nothing will happen if the setting does not exist.</span></span> <span data-ttu-id="3abaa-188">Utilisez la `Settings.saveAsync` méthode pour rendre persistant la suppression du paramètre du document.</span><span class="sxs-lookup"><span data-stu-id="3abaa-188">Use the `Settings.saveAsync` method to persist removal of the setting from the document.</span></span>

### <a name="saving-your-settings"></a><span data-ttu-id="3abaa-189">Enregistrement de vos paramètres</span><span class="sxs-lookup"><span data-stu-id="3abaa-189">Saving your settings</span></span>

<span data-ttu-id="3abaa-190">Pour enregistrer les ajouts, modifications ou suppressions que votre complément a effectués sur la copie en mémoire du conteneur de propriétés des paramètres pendant la session en cours, vous devez appeler la méthode [Settings.saveAsync](/javascript/api/office/office.settings#saveasync-options--callback-) pour les stocker dans le document.</span><span class="sxs-lookup"><span data-stu-id="3abaa-190">To save any additions, changes, or deletions your add-in made to the in-memory copy of the settings property bag during the current session, you must call the [Settings.saveAsync](/javascript/api/office/office.settings#saveasync-options--callback-) method to store them in the document.</span></span> <span data-ttu-id="3abaa-191">Le seul paramètre de la méthode est le rappel, qui est une fonction `saveAsync` de rappel avec un seul paramètre. </span><span class="sxs-lookup"><span data-stu-id="3abaa-191">The only parameter of the `saveAsync` method is _callback_, which is a callback function with a single parameter.</span></span>

```js
Office.context.document.settings.saveAsync(function (asyncResult) {
    if (asyncResult.status == Office.AsyncResultStatus.Failed) {
        write('Settings save failed. Error: ' + asyncResult.error.message);
    } else {
        write('Settings saved.');
    }
});
// Function that writes to a div with id='message' on the page.
function write(message){
    document.getElementById('message').innerText += message;
}
```

<span data-ttu-id="3abaa-192">La fonction anonyme transmise dans la méthode en tant que paramètre de rappel est `saveAsync` exécutée lorsque l’opération  est terminée.</span><span class="sxs-lookup"><span data-stu-id="3abaa-192">The anonymous function passed into the `saveAsync` method as the _callback_ parameter is executed when the operation is completed.</span></span> <span data-ttu-id="3abaa-193">Le _paramètre asyncResult_ du rappel permet d’accéder à un objet qui contient `AsyncResult` l’état de l’opération.</span><span class="sxs-lookup"><span data-stu-id="3abaa-193">The _asyncResult_ parameter of the callback provides access to an `AsyncResult` object that contains the status of the operation.</span></span> <span data-ttu-id="3abaa-194">Dans l’exemple, la fonction vérifie la propriété pour voir si l’opération d’enregistrer a réussi ou échoué, puis affiche le résultat dans la page du `AsyncResult.status` module.</span><span class="sxs-lookup"><span data-stu-id="3abaa-194">In the example, the function checks the `AsyncResult.status` property to see if the save operation succeeded or failed, and then displays the result in the add-in's page.</span></span>

## <a name="how-to-save-custom-xml-to-the-document"></a><span data-ttu-id="3abaa-195">Enregistrement du XML personnalisé dans le document</span><span class="sxs-lookup"><span data-stu-id="3abaa-195">How to save custom XML to the document</span></span>

> [!NOTE]
> <span data-ttu-id="3abaa-196">Cette section décrit les parties XML personnalisées dans le contexte de l’API JavaScript courante pour Office qui est prise en charge dans Word.</span><span class="sxs-lookup"><span data-stu-id="3abaa-196">This section discusses custom XML parts in the context of the Office Common JavaScript API which is supported in Word.</span></span> <span data-ttu-id="3abaa-197">L’API JavaScript excel spécifique à l’application permet également d’accéder aux parties XML personnalisées.</span><span class="sxs-lookup"><span data-stu-id="3abaa-197">The application-specific Excel JavaScript API also provides access to the custom XML parts.</span></span> <span data-ttu-id="3abaa-198">Les API Excel et les modes de programmation sont légèrement différents.</span><span class="sxs-lookup"><span data-stu-id="3abaa-198">The Excel APIs and programming patterns are somewhat different.</span></span> <span data-ttu-id="3abaa-199">Pour plus d’informations, reportez-vous à l’article sur l’objet [CustomXmlPart pour Excel](/javascript/api/excel/excel.customxmlpart).</span><span class="sxs-lookup"><span data-stu-id="3abaa-199">For more information, see [Excel CustomXmlPart](/javascript/api/excel/excel.customxmlpart).</span></span>

<span data-ttu-id="3abaa-200">Il existe une option de stockage supplémentaire lorsque vous devez stocker des informations qui dépassent les limites de taille des paramètres du document ou qui ont un caractère structuré.</span><span class="sxs-lookup"><span data-stu-id="3abaa-200">There is an additional storage option when you need to store information that exceeds the size limits of the document Settings or which has a structured character.</span></span> <span data-ttu-id="3abaa-201">Vous pouvez conserver le balisage XML personnalisé dans un complément de volet Office pour Word (et pour Excel, mais reportez-vous à la remarque en haut de cette section).</span><span class="sxs-lookup"><span data-stu-id="3abaa-201">You can persist custom XML markup in a task pane add-in for Word (and for Excel, but see the note at the top of this section).</span></span> <span data-ttu-id="3abaa-202">Dans Word, utilisez l’objet [CustomXmlPart](/javascript/api/office/office.customxmlpart) et ses méthodes (rappel : pour Excel, consultez la note précédente).</span><span class="sxs-lookup"><span data-stu-id="3abaa-202">In Word, you use the [CustomXmlPart](/javascript/api/office/office.customxmlpart) object and its methods (again, see the note above for Excel).</span></span> <span data-ttu-id="3abaa-203">Le code suivant crée une partie XML personnalisée, puis affiche son ID et son contenu dans des balises div sur la page.</span><span class="sxs-lookup"><span data-stu-id="3abaa-203">The following code creates a custom XML part and displays its ID and then its content in divs on the page.</span></span> <span data-ttu-id="3abaa-204">Un attribut `xmlns` doit figurer dans la chaîne XML.</span><span class="sxs-lookup"><span data-stu-id="3abaa-204">Note that there must be an `xmlns` attribute in the XML string.</span></span>

```js
function createCustomXmlPart() {
    const xmlString = "<Reviewers xmlns='http://schemas.contoso.com/review/1.0'><Reviewer>Juan</Reviewer><Reviewer>Hong</Reviewer><Reviewer>Sally</Reviewer></Reviewers>";
    Office.context.document.customXmlParts.addAsync(xmlString,
        (asyncResult) => {
            $("#xml-id").text("Your new XML part's ID: " + asyncResult.value.id);
            asyncResult.value.getXmlAsync(
                (asyncResult) => {
                    $("#xml-blob").text(asyncResult.value);
                }
            );
        }
    );
}
```

<span data-ttu-id="3abaa-p127">Pour récupérer une partie XML personnalisée, vous utilisez la méthode [getByIdAsync](/javascript/api/office/office.customxmlparts#getbyidasync-id--options--callback-), mais l’identifiant correspond à un GUID généré lorsque la partie XML est créée. Vous ne pouvez donc pas connaître l’identifiant lors du codage. Pour cette raison, il est recommandé de stocker immédiatement l’identifiant de la partie XML en tant que paramètre et de lui donner une clé facilement mémorisable lorsque vous créez une partie XML. L’exemple de méthode suivant montre comment procéder. (Toutefois, reportez-vous aux sections précédentes de cet article pour obtenir des détails et des meilleures pratiques lorsque vous utilisez des paramètres personnalisés).</span><span class="sxs-lookup"><span data-stu-id="3abaa-p127">To retrieve a custom XML part, you use the [getByIdAsync](/javascript/api/office/office.customxmlparts#getbyidasync-id--options--callback-) method, but the ID is a GUID that is generated when the XML part is created, so you can't know when coding what the ID is. For that reason, it is a good practice when creating an XML part to immediately store the ID of the XML part as a setting and give it a memorable key. The following method shows how to do this. (But see earlier sections of this article for details and best practices when working with custom settings).</span></span>

 ```js
function createCustomXmlPartAndStoreId() {
    const xmlString = "<Reviewers xmlns='http://schemas.contoso.com/review/1.0'><Reviewer>Juan</Reviewer><Reviewer>Hong</Reviewer><Reviewer>Sally</Reviewer></Reviewers>";
    Office.context.document.customXmlParts.addAsync(xmlString,
        (asyncResult) => {
            Office.context.document.settings.set('ReviewersID', asyncResult.id);
            Office.context.document.settings.saveAsync();
        }
    );
}
```

<span data-ttu-id="3abaa-209">Le code suivant montre comment récupérer la partie XML en obtenant d’abord son identifiant partir d’un paramètre.</span><span class="sxs-lookup"><span data-stu-id="3abaa-209">The following code shows how to retrieve the XML part by first getting its ID from a setting.</span></span>

 ```js
function getReviewers() {
    const reviewersXmlId = Office.context.document.settings.get('ReviewersID');
    Office.context.document.customXmlParts.getByIdAsync(reviewersXmlId,
        (asyncResult) => {
            asyncResult.value.getXmlAsync(
                (asyncResult) => {
                    $("#xml-blob").text(asyncResult.value);
                }
            );
        }
    );
}
```

## <a name="how-to-save-settings-in-an-outlook-add-in"></a><span data-ttu-id="3abaa-210">Comment enregistrer des paramètres dans un add-in Outlook</span><span class="sxs-lookup"><span data-stu-id="3abaa-210">How to save settings in an Outlook add-in</span></span>

<span data-ttu-id="3abaa-211">Pour plus d’informations sur la façon d’enregistrer des paramètres dans un add-in Outlook, voir Gérer l’état et les [paramètres d’un add-in Outlook.](../outlook/manage-state-and-settings-outlook.md)</span><span class="sxs-lookup"><span data-stu-id="3abaa-211">For information about how to save settings in an Outlook add-in, see [Manage state and settings for an Outlook add-in](../outlook/manage-state-and-settings-outlook.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="3abaa-212">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="3abaa-212">See also</span></span>

- [<span data-ttu-id="3abaa-213">Compréhension de l’API JavaScript pour Office</span><span class="sxs-lookup"><span data-stu-id="3abaa-213">Understanding the Office JavaScript API</span></span>](understanding-the-javascript-api-for-office.md)
- [<span data-ttu-id="3abaa-214">Compléments Outlook</span><span class="sxs-lookup"><span data-stu-id="3abaa-214">Outlook add-ins</span></span>](../outlook/outlook-add-ins-overview.md)
- [<span data-ttu-id="3abaa-215">Gérer l’état et les paramètres d’un add-in Outlook</span><span class="sxs-lookup"><span data-stu-id="3abaa-215">Manage state and settings for an Outlook add-in</span></span>](../outlook/manage-state-and-settings-outlook.md)
- [<span data-ttu-id="3abaa-216">Excel-Add-in-JavaScript-PersistCustomSettings</span><span class="sxs-lookup"><span data-stu-id="3abaa-216">Excel-Add-in-JavaScript-PersistCustomSettings</span></span>](https://github.com/OfficeDev/Excel-Add-in-JavaScript-PersistCustomSettings)
